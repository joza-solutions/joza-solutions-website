(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{8323:function(e,t,r){"use strict";r.d(t,{x:function(){return d}});var n=r(2110),i=r(2265),o=r(6376),a=r(2930),s=r(7934),l=r(1690),c=r(6934),u=r(1359),h=r(674);let d=i.forwardRef(function(e,t){var r,d;let{points:A,color:f=16777215,vertexColors:p,linewidth:m,lineWidth:g,segments:v,dashed:y,...E}=e,C=(0,a.A)(e=>e.size),w=i.useMemo(()=>v?new s.w:new l.w,[v]),[B]=i.useState(()=>new c.Y),x=(null==p||null==(r=p[0])?void 0:r.length)===4?4:3,I=i.useMemo(()=>{let e=v?new u.z:new h.L,t=A.map(e=>{let t=Array.isArray(e);return e instanceof o.Vector3||e instanceof o.Vector4?[e.x,e.y,e.z]:e instanceof o.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e});if(e.setPositions(t.flat()),p){f=16777215;let t=p.map(e=>e instanceof o.Color?e.toArray():e);e.setColors(t.flat(),x)}return e},[A,v,p,x]);return i.useLayoutEffect(()=>{w.computeLineDistances()},[A,w]),i.useLayoutEffect(()=>{y?B.defines.USE_DASH="":delete B.defines.USE_DASH,B.needsUpdate=!0},[y,B]),i.useEffect(()=>()=>I.dispose(),[I]),i.createElement("primitive",(0,n.Z)({object:w,ref:t},E),i.createElement("primitive",{object:I,attach:"geometry"}),i.createElement("primitive",(0,n.Z)({object:B,attach:"material",color:f,vertexColors:!!p,resolution:[C.width,C.height],linewidth:null!==(d=null!=m?m:g)&&void 0!==d?d:1,dashed:y,transparent:4===x},E)))})},1782:function(e,t,r){"use strict";let n,i,o,a,s,l,c,u,h,d,A,f,p,m,g,v,y,E,C,w,B,x,I,b,_,M,S,T,D,R,P,F,Q,O,L,k,U,G,N,z,H,V,j,J,Y;r.r(t),r.d(t,{AccumulativeShadows:function(){return mG},AdaptiveDpr:function(){return vh},AdaptiveEvents:function(){return vd},ArcballControls:function(){return cb},AsciiRenderer:function(){return lO},BBAnchor:function(){return fD},Backdrop:function(){return mY},BakeShadows:function(){return vo},Billboard:function(){return o3},Bounds:function(){return p6},Box:function(){return pP},Bvh:function(){return fx},CameraControls:function(){return uc},CameraShake:function(){return mn},Capsule:function(){return pK},CatmullRomLine:function(){return as},Caustics:function(){return m0},Center:function(){return fO},Circle:function(){return pF},Clone:function(){return sb},Cloud:function(){return gI},CloudInstance:function(){return gx},Clouds:function(){return gB},ComputedAttribute:function(){return sC},Cone:function(){return pQ},ContactShadows:function(){return mL},CubeCamera:function(){return lX},CubeTexture:function(){return uj},CubicBezierLine:function(){return aa},CurveModifier:function(){return pi},CycleRaycast:function(){return eV},Cylinder:function(){return pO},Decal:function(){return sL},Detailed:function(){return vn},DetectGPU:function(){return dH},DeviceOrientationControls:function(){return l2},Dodecahedron:function(){return pY},DragControls:function(){return t3},Edges:function(){return st},Effects:function(){return aZ},Environment:function(){return mF},EnvironmentCube:function(){return mD},EnvironmentMap:function(){return mT},EnvironmentPortal:function(){return mR},Example:function(){return fL},Extrude:function(){return pW},FaceControls:function(){return yV},FaceLandmarker:function(){return yU},FaceLandmarkerDefaults:function(){return yk},Facemesh:function(){return yO.vQ},FacemeshDatas:function(){return yO._p},FacemeshEye:function(){return yO.ix},FacemeshEyeDefaults:function(){return yO.ZV},Fbo:function(){return lj},Fbx:function(){return hj},FirstPersonControls:function(){return cK},Fisheye:function(){return vw},Float:function(){return mi},FlyControls:function(){return l8},GizmoHelper:function(){return u_},GizmoViewcube:function(){return uk},GizmoViewport:function(){return uN},Gltf:function(){return lF},GradientTexture:function(){return a0},GradientType:function(){return a$},Grid:function(){return uH},Helper:function(){return dC},Html:function(){return eH},Hud:function(){return um},Icosahedron:function(){return pj},Image:function(){return se},Instance:function(){return f0},Instances:function(){return f1},IsObject:function(){return a2},KeyboardControls:function(){return oO},Ktx2:function(){return du},Lathe:function(){return pq},Lightformer:function(){return ge},Line:function(){return an.x},Loader:function(){return eX},MapControls:function(){return cl},MarchingCube:function(){return sR},MarchingCubes:function(){return sD},MarchingPlane:function(){return sP},Mask:function(){return vE},MatcapTexture:function(){return gF},Merged:function(){return f2},MeshDiscardMaterial:function(){return pI},MeshDistortMaterial:function(){return pa},MeshPortalMaterial:function(){return vI},MeshReflectorMaterial:function(){return pd},MeshRefractionMaterial:function(){return pC},MeshTransmissionMaterial:function(){return px},MeshWobbleMaterial:function(){return pl},MotionPathControls:function(){return uf},NormalTexture:function(){return gO},Octahedron:function(){return pJ},OrbitControls:function(){return cc},OrthographicCamera:function(){return lY},Outlines:function(){return sn},PerformanceMonitor:function(){return vf},PerspectiveCamera:function(){return lq},PivotControls:function(){return yQ},Plane:function(){return pk},Point:function(){return g2},PointMaterial:function(){return pM},PointMaterialImpl:function(){return p_},PointerLockControls:function(){return cV},Points:function(){return g4},PointsBuffer:function(){return g3},Polyhedron:function(){return pV},PositionPoint:function(){return gX},PositionalAudio:function(){return al},Preload:function(){return vi},PresentationControls:function(){return oP},Progress:function(){return eq},QuadraticBezierLine:function(){return ao},RandomizedLight:function(){return mN},Reflector:function(){return m1},RenderCubeTexture:function(){return vv},RenderTexture:function(){return vm},Resize:function(){return p1},Ring:function(){return pH},RoundedBox:function(){return pZ},Sampler:function(){return sE},ScreenQuad:function(){return p0},ScreenSizer:function(){return ar},ScreenSpace:function(){return o4},Scroll:function(){return rq},ScrollControls:function(){return rJ},Segment:function(){return vr},SegmentObject:function(){return ve},Segments:function(){return g7},Select:function(){return o1},Shadow:function(){return mW},ShadowAlpha:function(){return gJ},Shape:function(){return pX},Sky:function(){return gl},SoftShadows:function(){return pD},Sparkles:function(){return gR},Sphere:function(){return pL},Splat:function(){return lH},SpotLight:function(){return m7},SpotLightShadow:function(){return m8},SpriteAnimator:function(){return f5},Stage:function(){return mj},Stars:function(){return gh},Stats:function(){return dI},StatsGl:function(){return dM},Svg:function(){return sU},Tetrahedron:function(){return pz},Text:function(){return ah},Text3D:function(){return ab},Texture:function(){return a4},Torus:function(){return pG},TorusKnot:function(){return pN},TrackballControls:function(){return cf},Trail:function(){return sp},TrailTexture:function(){return fQ},TransformControls:function(){return cP},Tube:function(){return pU},VideoTexture:function(){return dp},View:function(){return vW},Wireframe:function(){return gj},accumulativeContext:function(){return mk},calcPosFromAngles:function(){return gs},calculateAspectRatio:function(){return dv},calculateScaleFactor:function(){return ae},checkIfFrameIsEmpty:function(){return dg},getFirstItem:function(){return dm},isWebGL2Available:function(){return aX},meshBounds:function(){return vu},shaderMaterial:function(){return a1},useAnimations:function(){return fb},useAspect:function(){return dT},useBVH:function(){return fB},useBounds:function(){return p8},useBoxProjectedEnv:function(){return fM},useCamera:function(){return dD},useContextBridge:function(){return fI},useCubeCamera:function(){return lK},useCubeTexture:function(){return uV},useCursor:function(){return ej},useDepthBuffer:function(){return dS},useDetectGPU:function(){return dz},useEnvironment:function(){return mb},useFBO:function(){return lV},useFBX:function(){return hV},useFaceControls:function(){return yj},useFaceLandmarker:function(){return yG},useFont:function(){return aB},useGLTF:function(){return lP},useGizmoContext:function(){return uv},useHelper:function(){return dE},useIntersect:function(){return f_},useKTX2:function(){return dc},useKeyboardControls:function(){return oL},useMask:function(){return vC},useMatcapTexture:function(){return gP},useMotion:function(){return ud},useNormalTexture:function(){return gQ},usePerformanceMonitor:function(){return vp},useProgress:function(){return eW},useScroll:function(){return rj},useSelect:function(){return o2},useSpriteAnimator:function(){return f4},useSpriteLoader:function(){return dy},useSurfaceSampler:function(){return sy},useTexture:function(){return a3},useTrail:function(){return sf},useTrailTexture:function(){return fF},useVideoTexture:function(){return df}});var W,q,K,X,Z,$,ee,et,er,en,ei,eo,ea,es,el,ec,eu,eh,ed,eA,ef,ep,em,eg,ev,ey,eE,eC,ew,eB,ex,eI,eb,e_,eM,eS=r(2110),eT=r(2265),eD=r(4040),eR=r(6376),eP=r(2930);let eF=new eR.Vector3,eQ=new eR.Vector3,eO=new eR.Vector3,eL=new eR.Vector2;function ek(e,t,r){let n=eF.setFromMatrixPosition(e.matrixWorld);n.project(t);let i=r.width/2,o=r.height/2;return[n.x*i+i,-(n.y*o)+o]}let eU=e=>1e-10>Math.abs(e)?0:e;function eG(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n="matrix3d(";for(let r=0;16!==r;r++)n+=eU(t[r]*e.elements[r])+(15!==r?",":")");return r+n}let eN=(W=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>eG(e,W)),ez=(q=e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1],(e,t)=>eG(e,q(t),"translate(-50%,-50%)")),eH=eT.forwardRef((e,t)=>{let{children:r,eps:n=.001,style:i,className:o,prepend:a,center:s,fullscreen:l,portal:c,distanceFactor:u,sprite:h=!1,transform:d=!1,occlude:A,onOcclude:f,castShadow:p,receiveShadow:m,material:g,geometry:v,zIndexRange:y=[16777271,0],calculatePosition:E=ek,as:C="div",wrapperClass:w,pointerEvents:B="auto",...x}=e,{gl:I,camera:b,scene:_,size:M,raycaster:S,events:T,viewport:D}=(0,eP.A)(),[R]=eT.useState(()=>document.createElement(C)),P=eT.useRef(),F=eT.useRef(null),Q=eT.useRef(0),O=eT.useRef([0,0]),L=eT.useRef(null),k=eT.useRef(null),U=(null==c?void 0:c.current)||T.connected||I.domElement.parentNode,G=eT.useRef(null),N=eT.useRef(!1),z=eT.useMemo(()=>{var e;return A&&"blending"!==A||Array.isArray(A)&&A.length&&(e=A[0])&&"object"==typeof e&&"current"in e},[A]);eT.useLayoutEffect(()=>{let e=I.domElement;A&&"blending"===A?(e.style.zIndex="".concat(Math.floor(y[0]/2)),e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)},[A]),eT.useLayoutEffect(()=>{if(F.current){let e=P.current=eD.createRoot(R);if(_.updateMatrixWorld(),d)R.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{let e=E(F.current,b,M);R.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(e[0],"px,").concat(e[1],"px,0);transform-origin:0 0;")}return U&&(a?U.prepend(R):U.appendChild(R)),()=>{U&&U.removeChild(R),e.unmount()}}},[U,d]),eT.useLayoutEffect(()=>{w&&(R.className=w)},[w]);let H=eT.useMemo(()=>d?{position:"absolute",top:0,left:0,width:M.width,height:M.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...l&&{top:-M.height/2,left:-M.width/2,width:M.width,height:M.height},...i},[i,s,l,M,d]),V=eT.useMemo(()=>({position:"absolute",pointerEvents:B}),[B]);eT.useLayoutEffect(()=>{var e,n;N.current=!1,d?null==(e=P.current)||e.render(eT.createElement("div",{ref:L,style:H},eT.createElement("div",{ref:k,style:V},eT.createElement("div",{ref:t,className:o,style:i,children:r})))):null==(n=P.current)||n.render(eT.createElement("div",{ref:t,style:H,className:o,children:r}))});let j=eT.useRef(!0);(0,eP.C)(e=>{if(F.current){b.updateMatrixWorld(),F.current.updateWorldMatrix(!0,!1);let e=d?O.current:E(F.current,b,M);if(d||Math.abs(Q.current-b.zoom)>n||Math.abs(O.current[0]-e[0])>n||Math.abs(O.current[1]-e[1])>n){let t=function(e,t){let r=eF.setFromMatrixPosition(e.matrixWorld),n=eQ.setFromMatrixPosition(t.matrixWorld),i=r.sub(n),o=t.getWorldDirection(eO);return i.angleTo(o)>Math.PI/2}(F.current,b),r=!1;z&&(Array.isArray(A)?r=A.map(e=>e.current):"blending"!==A&&(r=[_]));let n=j.current;if(r){let e=function(e,t,r,n){let i=eF.setFromMatrixPosition(e.matrixWorld),o=i.clone();o.project(t),eL.set(o.x,o.y),r.setFromCamera(eL,t);let a=r.intersectObjects(n,!0);if(a.length){let e=a[0].distance;return i.distanceTo(r.ray.origin)<e}return!0}(F.current,b,S,r);j.current=e&&!t}else j.current=!t;n!==j.current&&(f?f(!j.current):R.style.display=j.current?"block":"none");let i=Math.floor(y[0]/2),o=A?z?[y[0],i]:[i-1,0]:y;if(R.style.zIndex="".concat(function(e,t,r){if(t instanceof eR.PerspectiveCamera||t instanceof eR.OrthographicCamera){let n=eF.setFromMatrixPosition(e.matrixWorld),i=eQ.setFromMatrixPosition(t.matrixWorld),o=n.distanceTo(i),a=(r[1]-r[0])/(t.far-t.near),s=r[1]-a*t.far;return Math.round(a*o+s)}}(F.current,b,o)),d){let[e,t]=[M.width/2,M.height/2],r=b.projectionMatrix.elements[5]*t,{isOrthographicCamera:n,top:i,left:o,bottom:a,right:s}=b,l=eN(b.matrixWorldInverse),c=n?"scale(".concat(r,")translate(").concat(eU(-(s+o)/2),"px,").concat(eU((i+a)/2),"px)"):"translateZ(".concat(r,"px)"),d=F.current.matrixWorld;h&&((d=b.matrixWorldInverse.clone().transpose().copyPosition(d).scale(F.current.scale)).elements[3]=d.elements[7]=d.elements[11]=0,d.elements[15]=1),R.style.width=M.width+"px",R.style.height=M.height+"px",R.style.perspective=n?"":"".concat(r,"px"),L.current&&k.current&&(L.current.style.transform="".concat(c).concat(l,"translate(").concat(e,"px,").concat(t,"px)"),k.current.style.transform=ez(d,1/((u||10)/400)))}else{let t=void 0===u?1:function(e,t){if(t instanceof eR.OrthographicCamera)return t.zoom;if(!(t instanceof eR.PerspectiveCamera))return 1;{let r=eF.setFromMatrixPosition(e.matrixWorld),n=eQ.setFromMatrixPosition(t.matrixWorld);return 1/(2*Math.tan(t.fov*Math.PI/180/2)*r.distanceTo(n))}}(F.current,b)*u;R.style.transform="translate3d(".concat(e[0],"px,").concat(e[1],"px,0) scale(").concat(t,")")}O.current=e,Q.current=b.zoom}}if(!z&&G.current&&!N.current){if(d){if(L.current){let e=L.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){let{isOrthographicCamera:t}=b;if(t||v)x.scale&&(Array.isArray(x.scale)?x.scale instanceof eR.Vector3?G.current.scale.copy(x.scale.clone().divideScalar(1)):G.current.scale.set(1/x.scale[0],1/x.scale[1],1/x.scale[2]):G.current.scale.setScalar(1/x.scale));else{let t=(u||10)/400,r=e.clientWidth*t,n=e.clientHeight*t;G.current.scale.set(r,n,1)}N.current=!0}}}else{let t=R.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){let e=1/D.factor,r=t.clientWidth*e,n=t.clientHeight*e;G.current.scale.set(r,n,1),N.current=!0}G.current.lookAt(e.camera.position)}}});let J=eT.useMemo(()=>({vertexShader:d?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "}),[d]);return eT.createElement("group",(0,eS.Z)({},x,{ref:F}),A&&!z&&eT.createElement("mesh",{castShadow:p,receiveShadow:m,ref:G},v||eT.createElement("planeGeometry",null),g||eT.createElement("shaderMaterial",{side:eR.DoubleSide,vertexShader:J.vertexShader,fragmentShader:J.fragmentShader})))});function eV(e){let{onChanged:t,portal:r,preventDefault:n=!0,scroll:i=!0,keyCode:o=9}=e,a=eT.useRef(0),s=(0,eP.A)(e=>e.setEvents),l=(0,eP.A)(e=>e.get),c=(0,eP.A)(e=>e.gl);return eT.useEffect(()=>{var e;let u;let h=[],d=l().events.filter,A=null!==(e=null==r?void 0:r.current)&&void 0!==e?e:c.domElement.parentNode,f=()=>A&&t&&t(h,Math.round(a.current)%h.length);s({filter:(e,t)=>{let r=[...e];r.length===h.length&&h.every(e=>r.map(e=>e.object.uuid).includes(e.object.uuid))||(a.current=0,h=r,f()),d&&(r=d(r,t));for(let e=0;e<Math.round(a.current)%r.length;e++){let e=r.shift();r=[...r,e]}return r}});let p=e=>{var t,r;a.current=e(a.current),null==(t=l().events.handlers)||t.onPointerCancel(void 0),null==(r=l().events.handlers)||r.onPointerMove(u),f()},m=e=>{(e.keyCode||e.which)===o&&(n&&e.preventDefault(),h.length>1&&p(e=>e+1))},g=e=>{n&&e.preventDefault();let t=0;e||(e=window.event),e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),h.length>1&&p(e=>Math.abs(e-t))},v=e=>u=e;return document.addEventListener("pointermove",v,{passive:!0}),i&&document.addEventListener("wheel",g),void 0!==o&&document.addEventListener("keydown",m),()=>{s({filter:d}),void 0!==o&&document.removeEventListener("keydown",m),i&&document.removeEventListener("wheel",g),document.removeEventListener("pointermove",v)}},[c,l,s,n,i,o]),null}function ej(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pointer",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.body;eT.useEffect(()=>{if(e)return n.style.cursor=t,()=>void(n.style.cursor=r)},[e])}var eJ=r(8132);let eY=0,eW=(0,eJ.Z)(e=>(eR.DefaultLoadingManager.onStart=(t,r,n)=>{e({active:!0,item:t,loaded:r,total:n,progress:(r-eY)/(n-eY)*100})},eR.DefaultLoadingManager.onLoad=()=>{e({active:!1})},eR.DefaultLoadingManager.onError=t=>e(e=>({errors:[...e.errors,t]})),eR.DefaultLoadingManager.onProgress=(t,r,n)=>{r===n&&(eY=n),e({active:!0,item:t,loaded:r,total:n,progress:(r-eY)/(n-eY)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function eq(e){let{children:t}=e,r=eW();return eT.createElement(eT.Fragment,null,null==t?void 0:t(r))}let eK=e=>"Loading ".concat(e.toFixed(2),"%");function eX(e){let{containerStyles:t,innerStyles:r,barStyles:n,dataStyles:i,dataInterpolation:o=eK,initialState:a=e=>e}=e,{active:s,progress:l}=eW(),c=eT.useRef(0),u=eT.useRef(0),h=eT.useRef(null),[d,A]=eT.useState(a(s));eT.useEffect(()=>{let e;return s!==d&&(e=setTimeout(()=>A(s),300)),()=>clearTimeout(e)},[d,s]);let f=eT.useCallback(()=>{h.current&&(c.current+=(l-c.current)/2,(c.current>.95*l||100===l)&&(c.current=l),h.current.innerText=o(c.current),c.current<l&&(u.current=requestAnimationFrame(f)))},[o,l]);return eT.useEffect(()=>(f(),()=>cancelAnimationFrame(u.current)),[f]),d?eT.createElement("div",{style:{...eZ.container,opacity:s?1:0,...t}},eT.createElement("div",null,eT.createElement("div",{style:{...eZ.inner,...r}},eT.createElement("div",{style:{...eZ.bar,transform:"scaleX(".concat(l/100,")"),...n}}),eT.createElement("span",{ref:h,style:{...eZ.data,...i}})))):null}let eZ={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}},e$={toVector:(e,t)=>(void 0===e&&(e=t),Array.isArray(e)?e:[e,e]),add:(e,t)=>[e[0]+t[0],e[1]+t[1]],sub:(e,t)=>[e[0]-t[0],e[1]-t[1]],addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function e0(e,t,r){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*r):e*t*r/(t+r*e)}function e1(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.15;return 0===n?Math.max(t,Math.min(e,r)):e<t?-e0(t-e,r-t,n)+t:e>r?+e0(e-r,r-t,n)+r:e}function e2(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function e4(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?e3(Object(r),!0).forEach(function(t){e2(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e3(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let e5={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function e9(e){return e?e[0].toUpperCase()+e.slice(1):""}let e6=["enter","leave"],e8=["gotpointercapture","lostpointercapture"];function e7(e){return"touches"in e}function te(e){return e7(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function tt(e){return e7(e)?("touchend"===e.type||"touchcancel"===e.type?e.changedTouches:e.targetTouches)[0]:e}function tr(e,t){try{let r=t.clientX-e.clientX,n=t.clientY-e.clientY,i=(t.clientX+e.clientX)/2,o=(t.clientY+e.clientY)/2;return{angle:-(180*Math.atan2(r,n))/Math.PI,distance:Math.hypot(r,n),origin:[i,o]}}catch(e){}return null}function tn(e,t){let[r,n]=Array.from(e.touches).filter(e=>t.includes(e.identifier));return tr(r,n)}function ti(e){let t=tt(e);return e7(e)?t.identifier:t.pointerId}function to(e){let t=tt(e);return[t.clientX,t.clientY]}function ta(e){let{deltaX:t,deltaY:r,deltaMode:n}=e;return 1===n?(t*=40,r*=40):2===n&&(t*=800,r*=800),[t,r]}function ts(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return"function"==typeof e?e(...r):e}function tl(){}function tc(e,t){return Object.assign({},t,e||{})}class tu{get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:r,args:n}=this;t[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=n,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,r=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=r.from?ts(r.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:r,shared:n}=this;t.args=this.args;let i=0;if(e&&(t.event=e,r.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,n.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,n.locked=!!document.pointerLockElement,Object.assign(n,function(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:r,altKey:n,metaKey:i,ctrlKey:o}=e;Object.assign(t,{shiftKey:r,altKey:n,metaKey:i,ctrlKey:o})}return t}(e)),n.down=n.pressed=n.buttons%2==1||n.touches>0,i=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let e=t._delta.map(Math.abs);e$.addTo(t._distance,e)}this.axisIntent&&this.axisIntent(e);let[o,a]=t._movement,[s,l]=r.threshold,{_step:c,values:u}=t;if(r.hasCustomTransform?(!1===c[0]&&(c[0]=Math.abs(o)>=s&&u[0]),!1===c[1]&&(c[1]=Math.abs(a)>=l&&u[1])):(!1===c[0]&&(c[0]=Math.abs(o)>=s&&Math.sign(o)*s),!1===c[1]&&(c[1]=Math.abs(a)>=l&&Math.sign(a)*l)),t.intentional=!1!==c[0]||!1!==c[1],!t.intentional)return;let h=[0,0];if(r.hasCustomTransform){let[e,t]=u;h[0]=!1!==c[0]?e-c[0]:0,h[1]=!1!==c[1]?t-c[1]:0}else h[0]=!1!==c[0]?o-c[0]:0,h[1]=!1!==c[1]?a-c[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(h);let d=t.offset,A=t._active&&!t._blocked||t.active;A&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=n[this.ingKey]=t._active,e&&(t.first&&("bounds"in r&&(t._bounds=ts(r.bounds,t)),this.setup&&this.setup()),t.movement=h,this.computeOffset()));let[f,p]=t.offset,[[m,g],[v,y]]=t._bounds;t.overflow=[f<m?-1:f>g?1:0,p<v?-1:p>y?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);let E=t._active&&r.rubberband||[0,0];if(t.offset=function(e,t,r){let[n,i]=t,[o,a]=r,[[s,l],[c,u]]=e;return[e1(n,s,l,o),e1(i,c,u,a)]}(t._bounds,t.offset,E),t.delta=e$.sub(t.offset,d),this.computeMovement(),A&&(!t.last||i>32)){t.delta=e$.sub(t.offset,d);let e=t.delta.map(Math.abs);e$.addTo(t.distance,e),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&i>0&&(t.velocity=[e[0]/i,e[1]/i],t.timeDelta=i)}}emit(){let e=this.state,t=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;let n=this.handler(e4(e4(e4({},t),e),{},{[this.aliasKey]:e.values}));void 0!==n&&(e.memo=n)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}constructor(e,t,r){this.ctrl=e,this.args=t,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}}class th extends tu{reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=e$.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=e$.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,r=this.config;if(!t.axis&&e){let n="object"==typeof r.axisThreshold?r.axisThreshold[te(e)]:r.axisThreshold;t.axis=function(e,t){let[r,n]=e,i=Math.abs(r),o=Math.abs(n);return i>o&&i>t?"x":o>i&&o>t?"y":void 0}(t._movement,n)}t._blocked=(r.lockDirection||!!r.axis)&&!t.axis||!!r.axis&&r.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}constructor(...e){super(...e),e2(this,"aliasKey","xy")}}let td=e=>e,tA={enabled(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return e},eventOptions:(e,t,r)=>e4(e4({},r.shared.eventOptions),e),preventDefault(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e},triggerAllEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e},rubberband(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return e$.toVector(e)}},from:e=>"function"==typeof e?e:null!=e?e$.toVector(e):void 0,transform(e,t,r){let n=e||r.shared.transform;return this.hasCustomTransform=!!n,n||td},threshold:e=>e$.toVector(e,0)},tf=e4(e4({},tA),{},{axis(e,t,r){let{axis:n}=r;if(this.lockDirection="lock"===n,!this.lockDirection)return n},axisThreshold(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e},bounds(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("function"==typeof e)return t=>tf.bounds(e(t));if("current"in e)return()=>e.current;if("function"==typeof HTMLElement&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:r=1/0,top:n=-1/0,bottom:i=1/0}=e;return[[t,r],[n,i]]}}),tp={ArrowRight:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return[e*t,0]},ArrowLeft:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return[-1*e*t,0]},ArrowUp:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return[0,-1*e*t]},ArrowDown:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return[0,e*t]}};class tm extends th{reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),r=e.currentTarget.getBoundingClientRect(),n={left:t.left-r.left+e.offset[0],right:t.right-r.right+e.offset[0],top:t.top-r.top+e.offset[1],bottom:t.bottom-r.bottom+e.offset[1]};e._bounds=tf.bounds(n)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,r=this.state;if(null!=e.buttons&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):-1!==t.pointerButtons&&t.pointerButtons!==e.buttons))return;let n=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),n&&n.size>1&&r._pointerActive||(this.start(e),this.setupPointer(e),r._pointerId=ti(e),r._pointerActive=!0,this.computeValues(to(e)),this.computeInitial(),t.preventScrollAxis&&"mouse"!==te(e)?(r._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,r=this.config;if(!t._pointerActive)return;let n=ti(e);if(void 0!==t._pointerId&&n!==t._pointerId)return;let i=to(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=e$.sub(i,t._values),this.computeValues(i)),e$.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(r.preventScrollAxis&&!t._preventScroll){if(!t.axis)return;if(t.axis===r.preventScrollAxis||"xy"===r.preventScrollAxis){t._active=!1,this.clean();return}this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch(e){}let t=this.state,r=this.config;if(!t._active||!t._pointerActive)return;let n=ti(e);if(void 0!==t._pointerId&&n!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[i,o]=t._distance;if(t.tap=i<=r.tapsThreshold&&o<=r.tapsThreshold,t.tap&&r.filterTaps)t._force=!0;else{let[e,n]=t._delta,[i,o]=t._movement,[a,s]=r.swipe.velocity,[l,c]=r.swipe.distance,u=r.swipe.duration;if(t.elapsedTime<u){let r=Math.abs(e/t.timeDelta),u=Math.abs(n/t.timeDelta);r>a&&Math.abs(i)>l&&(t.swipe[0]=Math.sign(e)),u>s&&Math.abs(o)>c&&(t.swipe[1]=Math.sign(n))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,r=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,"persist"in e&&"function"==typeof e.persist&&e.persist();let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){let t=tp[e.key];if(t){let r=this.state,n=e.shiftKey?10:e.altKey?.1:1;this.start(e),r._delta=t(this.config.keyboardDisplacement,n),r._keyboardActive=!0,e$.addTo(r._movement,r._delta),this.compute(e),this.emit()}}keyUp(e){e.key in tp&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}constructor(...e){super(...e),e2(this,"ingKey","dragging")}}let tg="undefined"!=typeof window&&window.document&&window.document.createElement;function tv(){return tg&&"ontouchstart"in window}let ty={isBrowser:tg,gesture:function(){try{return"constructor"in GestureEvent}catch(e){return!1}}(),touch:tv(),touchscreen:tv()||tg&&window.navigator.maxTouchPoints>1,pointer:tg&&"onpointerdown"in window,pointerLock:tg&&"exitPointerLock"in window.document},tE={mouse:0,touch:0,pen:8},tC=e4(e4({},tf),{},{device(e,t,r){let{pointer:{touch:n=!1,lock:i=!1,mouse:o=!1}={}}=r;return(this.pointerLock=i&&ty.pointerLock,ty.touch&&n)?"touch":this.pointerLock?"mouse":ty.pointer&&!o?"pointer":ty.touch?"touch":"mouse"},preventScrollAxis(e,t,r){let{preventScroll:n}=r;if(this.preventScrollDelay="number"==typeof n?n:n||void 0===n&&e?250:void 0,ty.touchscreen&&!1!==n)return e||(void 0!==n?"y":void 0)},pointerCapture(e,t,r){let{pointer:{capture:n=!0,buttons:i=1,keys:o=!0}={}}=r;return this.pointerButtons=i,this.keys=o,!this.pointerLock&&"pointer"===this.device&&n},threshold(e,t,r){let{filterTaps:n=!1,tapsThreshold:i=3,axis:o}=r,a=e$.toVector(e,n?i:o?1:0);return this.filterTaps=n,this.tapsThreshold=i,a},swipe(){let{velocity:e=.5,distance:t=50,duration:r=250}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{velocity:this.transform(e$.toVector(e)),distance:this.transform(e$.toVector(t)),duration:r}},delay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:e=>e?e4(e4({},tE),e):tE,keyboardDisplacement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return e}});function tw(e){let[t,r]=e.overflow,[n,i]=e._delta,[o,a]=e._direction;(t<0&&n>0&&o<0||t>0&&n<0&&o>0)&&(e._movement[0]=e._movementBound[0]),(r<0&&i>0&&a<0||r>0&&i<0&&a>0)&&(e._movement[1]=e._movementBound[1])}class tB extends tu{init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();let e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){let{type:e,movement:t,lastOffset:r}=this.state;"wheel"===e?this.state.offset=e$.add(t,r):this.state.offset=[(1+t[0])*r[0],t[1]+r[1]]}computeMovement(){let{offset:e,lastOffset:t}=this.state;this.state.movement=[e[0]/t[0],e[1]-t[1]]}axisIntent(){let e=this.state,[t,r]=e._movement;if(!e.axis){let n=30*Math.abs(t)-Math.abs(r);n<0?e.axis="angle":n>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&("scale"===this.state.axis?e[1]=0:"angle"===this.state.axis&&(e[0]=0))}cancel(){let e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);let t=this.state,r=this.ctrl.touchIds;if(t._active&&t._touchIds.every(e=>r.has(e))||r.size<2)return;this.start(e),t._touchIds=Array.from(r).slice(0,2);let n=tn(e,t._touchIds);n&&this.pinchStart(e,n)}pointerStart(e){if(null!=e.buttons&&e.buttons%2!=1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);let t=this.state,r=t._pointerEvents,n=this.ctrl.pointerIds;if(t._active&&Array.from(r.keys()).every(e=>n.has(e))||(r.size<2&&r.set(e.pointerId,e),t._pointerEvents.size<2))return;this.start(e);let i=tr(...Array.from(r.values()));i&&this.pinchStart(e,i)}pinchStart(e,t){this.state.origin=t.origin,this.computeValues([t.distance,t.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;let t=tn(e,this.state._touchIds);t&&this.pinchMove(e,t)}pointerMove(e){let t=this.state._pointerEvents;if(t.has(e.pointerId)&&t.set(e.pointerId,e),!this.state._active)return;let r=tr(...Array.from(t.values()));r&&this.pinchMove(e,r)}pinchMove(e,t){let r=this.state,n=r._values[1],i=t.angle-n,o=0;Math.abs(i)>270&&(o+=Math.sign(i)),this.computeValues([t.distance,t.angle-360*o]),r.origin=t.origin,r.turns=o,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(e=>!this.ctrl.touchIds.has(e))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){let t=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch(e){}t._pointerEvents.has(e.pointerId)&&t._pointerEvents.delete(e.pointerId),t._active&&t._pointerEvents.size<2&&(t._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();let t=this.state;t._active||(this.start(e),this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;let t=this.state;this.computeValues([e.scale,e.rotation]),t.origin=[e.clientX,e.clientY];let r=t._movement;t._movement=[e.scale-1,e.rotation],t._delta=e$.sub(t._movement,r),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){let t=this.config.modifierKey;(!t||(Array.isArray(t)?t.find(t=>e[t]):e[t]))&&(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||!e.cancelable||e.preventDefault();let t=this.state;t._delta=[-ta(e)[1]/100*t.offset[0],0],e$.addTo(t._movement,t._delta),tw(t),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){let t=this.config.device;t&&(e(t,"start",this[t+"Start"].bind(this)),e(t,"change",this[t+"Move"].bind(this)),e(t,"end",this[t+"End"].bind(this)),e(t,"cancel",this[t+"End"].bind(this)),e("lostPointerCapture","",this[t+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}constructor(...e){super(...e),e2(this,"ingKey","pinching"),e2(this,"aliasKey","da")}}let tx=e4(e4({},tA),{},{device(e,t,r){let{shared:n,pointer:{touch:i=!1}={}}=r;if(n.target&&!ty.touch&&ty.gesture)return"gesture";if(ty.touch&&i)return"touch";if(ty.touchscreen){if(ty.pointer)return"pointer";if(ty.touch)return"touch"}},bounds(e,t,r){let{scaleBounds:n={},angleBounds:i={}}=r,o=e=>{let t=tc(ts(n,e),{min:-1/0,max:1/0});return[t.min,t.max]},a=e=>{let t=tc(ts(i,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!=typeof n&&"function"!=typeof i?[o(),a()]:e=>[o(e),a(e)]},threshold(e,t,r){return this.lockDirection="lock"===r.axis,e$.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey:e=>void 0===e?"ctrlKey":e,pinchOnWheel(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return e}});class tI extends th{move(e){this.config.mouseOnly&&"mouse"!==e.pointerType||(this.state._active?this.moveChange(e):this.moveStart(e),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(e){this.start(e),this.computeValues(to(e)),this.compute(e),this.computeInitial(),this.emit()}moveChange(e){if(!this.state._active)return;let t=to(e),r=this.state;r._delta=e$.sub(t,r._values),e$.addTo(r._movement,r._delta),this.computeValues(t),this.compute(e),this.emit()}moveEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}bind(e){e("pointer","change",this.move.bind(this)),e("pointer","leave",this.moveEnd.bind(this))}constructor(...e){super(...e),e2(this,"ingKey","moving")}}let tb=e4(e4({},tf),{},{mouseOnly:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return e}});class t_ extends th{scroll(e){this.state._active||this.start(e),this.scrollChange(e),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(e){e.cancelable&&e.preventDefault();let t=this.state,r=function(e){var t,r;let{scrollX:n,scrollY:i,scrollLeft:o,scrollTop:a}=e.currentTarget;return[null!==(t=null!=n?n:o)&&void 0!==t?t:0,null!==(r=null!=i?i:a)&&void 0!==r?r:0]}(e);t._delta=e$.sub(r,t._values),e$.addTo(t._movement,t._delta),this.computeValues(r),this.compute(e),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("scroll","",this.scroll.bind(this))}constructor(...e){super(...e),e2(this,"ingKey","scrolling")}}class tM extends th{wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){let t=this.state;t._delta=ta(e),e$.addTo(t._movement,t._delta),tw(t),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}constructor(...e){super(...e),e2(this,"ingKey","wheeling")}}class tS extends th{enter(e){this.config.mouseOnly&&"mouse"!==e.pointerType||(this.start(e),this.computeValues(to(e)),this.compute(e),this.emit())}leave(e){if(this.config.mouseOnly&&"mouse"!==e.pointerType)return;let t=this.state;if(!t._active)return;t._active=!1;let r=to(e);t._movement=t._delta=e$.sub(r,t._values),this.computeValues(r),this.compute(e),t.delta=t.movement,this.emit()}bind(e){e("pointer","enter",this.enter.bind(this)),e("pointer","leave",this.leave.bind(this))}constructor(...e){super(...e),e2(this,"ingKey","hovering")}}let tT=e4(e4({},tf),{},{mouseOnly:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return e}}),tD=new Map,tR=new Map;function tP(e){tD.set(e.key,e.engine),tR.set(e.key,e.resolver)}let tF={key:"drag",engine:tm,resolver:tC},tQ={key:"hover",engine:tS,resolver:tT},tO={key:"move",engine:tI,resolver:tb},tL={key:"pinch",engine:tB,resolver:tx},tk={key:"scroll",engine:t_,resolver:tf},tU={key:"wheel",engine:tM,resolver:tf},tG={target(e){if(e)return()=>"current"in e?e.current:e},enabled(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return e},window(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ty.isBrowser?window:void 0;return e},eventOptions(){let{passive:e=!0,capture:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{passive:e,capture:t}},transform:e=>e},tN=["target","eventOptions","window","enabled","transform"];function tz(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r={};for(let[n,i]of Object.entries(t))switch(typeof i){case"function":r[n]=i.call(r,e[n],n,e);break;case"object":r[n]=tz(e[n],i);break;case"boolean":i&&(r[n]=e[n])}return r}class tH{add(e,t,r,n,i){let o=this._listeners,a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e5[e];return e+(r&&r[t]||t)}(t,r),s=e4(e4({},this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{}),i);e.addEventListener(a,n,s);let l=()=>{e.removeEventListener(a,n,s),o.delete(l)};return o.add(l),l}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}constructor(e,t){e2(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}}class tV{add(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:140;for(var n=arguments.length,i=Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];this.remove(e),this._timeouts.set(e,window.setTimeout(t,r,...i))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}constructor(){e2(this,"_timeouts",new Map)}}class tj{setEventIds(e){return e7(e)?(this.touchIds=new Set(Array.from(e.touches).filter(t=>{var r,n;return t.target===e.currentTarget||(null===(r=e.currentTarget)||void 0===r||null===(n=r.contains)||void 0===n?void 0:n.call(r,t.target))}).map(e=>e.identifier)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{target:n,eventOptions:i,window:o,enabled:a,transform:s}=e,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,tN);if(r.shared=tz({target:n,eventOptions:i,window:o,enabled:a,transform:s},tG),t){let e=tR.get(t);r[t]=tz(e4({shared:r.shared},l),e)}else for(let e in l){let t=tR.get(e);t&&(r[e]=tz(e4({shared:r.shared},l[e]),t))}return r}(e,t,this.config)}clean(){for(let e of(this._targetEventStore.clean(),this.gestures))this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(){let e;for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];let i=this.config.shared,o={};if(!i.target||(e=i.target())){if(i.enabled){for(let t of this.gestures){let n=this.config[t],i=tY(o,n.eventOptions,!!e);n.enabled&&new(tD.get(t))(this,r,t).bind(i)}let t=tY(o,i.eventOptions,!!e);for(let e in this.nativeHandlers)t(e,"",t=>this.nativeHandlers[e](e4(e4({},this.state.shared),{},{event:t,args:r})),void 0,!0)}for(let e in o)o[e]=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?tl:1===t.length?t[0]:function(){let e;for(let r of t)e=r.apply(this,arguments)||e;return e}}(...o[e]);if(!e)return o;for(let t in o){let{device:r,capture:n,passive:i}=function(e){let t=e.substring(2).toLowerCase(),r=!!~t.indexOf("passive");r&&(t=t.replace("passive",""));let n=e8.includes(t)?"capturecapture":"capture",i=!!~t.indexOf(n);return i&&(t=t.replace("capture","")),{device:t,capture:i,passive:r}}(t);this._targetEventStore.add(e,r,"",o[t],{capture:n,passive:i})}}}constructor(e){e2(this,"gestures",new Set),e2(this,"_targetEventStore",new tH(this)),e2(this,"gestureEventStores",{}),e2(this,"gestureTimeoutStores",{}),e2(this,"handlers",{}),e2(this,"config",{}),e2(this,"pointerIds",new Set),e2(this,"touchIds",new Set),e2(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),e.drag&&tJ(this,"drag"),e.wheel&&tJ(this,"wheel"),e.scroll&&tJ(this,"scroll"),e.move&&tJ(this,"move"),e.pinch&&tJ(this,"pinch"),e.hover&&tJ(this,"hover")}}function tJ(e,t){e.gestures.add(t),e.gestureEventStores[t]=new tH(e,t),e.gestureTimeoutStores[t]=new tV}let tY=(e,t,r)=>function(n,i,o){var a,s;let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=null!==(a=l.capture)&&void 0!==a?a:t.capture,h=null!==(s=l.passive)&&void 0!==s?s:t.passive,d=c?n:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e5[e],i=n&&n[t]||t;return"on"+e9(e)+e9(i)+(!function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return e&&!e6.includes(t)}(r,i)?"":"Capture")}(n,i,u);r&&h&&(d+="Passive"),e[d]=e[d]||[],e[d].push(o)},tW=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function tq(e,t,r,n,i,o){if(!e.has(r)||!tD.has(n))return;let a=r+"Start",s=r+"End";i[n]=e=>{let n;return e.first&&a in t&&t[a](e),r in t&&(n=t[r](e)),e.last&&s in t&&t[s](e),n},o[n]=o[n]||{}}function tK(e,t){return([tF,tL,tk,tU,tO,tQ].forEach(tP),function(e,t){let{handlers:r,nativeHandlers:n,config:i}=function(e,t){let[r,n,i]=function(e){let t={},r={},n=new Set;for(let i in e)tW.test(i)?(n.add(RegExp.lastMatch),r[i]=e[i]):t[i]=e[i];return[r,t,n]}(e),o={};return tq(i,r,"onDrag","drag",o,t),tq(i,r,"onWheel","wheel",o,t),tq(i,r,"onScroll","scroll",o,t),tq(i,r,"onPinch","pinch",o,t),tq(i,r,"onMove","move",o,t),tq(i,r,"onHover","hover",o,t),{handlers:o,config:t,nativeHandlers:n}}(e,t||{});return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=eT.useMemo(()=>new tj(e),[]);if(i.applyHandlers(e,n),i.applyConfig(t,r),eT.useEffect(i.effect.bind(i)),eT.useEffect(()=>i.clean.bind(i),[]),void 0===t.target)return i.bind.bind(i)}(r,i,void 0,n)})(e,t||{})}let tX=new eR.Vector3,tZ=new eR.Vector2,t$=new eR.Vector3,t0=new eR.Vector3,t1=new eR.Vector3,t2=new eR.Plane,t3=eT.forwardRef((e,t)=>{let{autoTransform:r=!0,matrix:n,axisLock:i,dragLimits:o,onHover:a,onDragStart:s,onDrag:l,onDragEnd:c,children:u,dragConfig:h,...d}=e,A=(0,eP.A)(e=>e.controls),{camera:f,size:p,raycaster:m,invalidate:g}=(0,eP.A)(),v=eT.useRef(null),y=tK({onHover:e=>{let{hovering:t}=e;return a&&a(null!=t&&t)},onDragStart:e=>{let{event:t}=e;A&&(A.enabled=!1);let{point:r}=t;v.current.matrix.decompose(tX,new eR.Quaternion,new eR.Vector3),t$.copy(r),t0.copy(t$).sub(tX),s&&s(tX),g()},onDrag:e=>{let{xy:[t,n],intentional:a}=e;if(!a)return;let s=(t-p.left)/p.width*2-1,c=-((n-p.top)/p.height*2)+1;if(tZ.set(s,c),m.setFromCamera(tZ,f),i)switch(i){case"x":t1.set(1,0,0);break;case"y":t1.set(0,1,0);break;case"z":t1.set(0,0,1)}else f.getWorldDirection(t1).negate();t2.setFromNormalAndCoplanarPoint(t1,t$),m.ray.intersectPlane(t2,t$);let u=v.current.matrix.clone(),h=v.current.matrixWorld.clone(),d=new eR.Vector3(t$.x-t0.x,t$.y-t0.y,t$.z-t0.z);if(o&&(d.x=o[0]?Math.max(Math.min(d.x,o[0][1]),o[0][0]):d.x,d.y=o[1]?Math.max(Math.min(d.y,o[1][1]),o[1][0]):d.y,d.z=o[2]?Math.max(Math.min(d.z,o[2][1]),o[2][0]):d.z),r){v.current.matrix.setPosition(d);let e=v.current.matrix.clone().multiply(u.invert()),t=v.current.matrix.clone().multiply(h.invert());l&&l(v.current.matrix,e,v.current.matrixWorld,t)}else{let e=new eR.Matrix4().copy(v.current.matrix);e.setPosition(d);let t=e.clone().multiply(u.invert()),r=e.clone().multiply(h.invert());l&&l(e,t,v.current.matrixWorld,r)}g()},onDragEnd:()=>{A&&(A.enabled=!0),c&&c(),g()}},{drag:{filterTaps:!0,threshold:1,..."object"==typeof h?h:{}}});return eT.useImperativeHandle(t,()=>v.current,[]),eT.useLayoutEffect(()=>{n&&(v.current.matrix=n)},[n]),eT.createElement("group",(0,eS.Z)({ref:v},y(),{matrix:n,matrixAutoUpdate:!1},d),u)});function t4(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t5(e,t){return(t5=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function t9(e,t){for(var r=[],n=e.toArray(),i=t.toArray(),o=0;o<n.length;o++)r[o]=n[o]+i[o];return new eR.Matrix3().fromArray(r)}function t6(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t8(e,t){if(e){if("string"==typeof e)return t6(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t6(e,t)}}function t7(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],a=!0,s=!1;try{for(i=i.call(e);!(a=(r=i.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,n=e}finally{try{a||null==i.return||i.return()}finally{if(s)throw n}}return o}}(e,t)||t8(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e){return function(e){if(Array.isArray(e))return t6(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||t8(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t,r){return(rt=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&t5(i,r.prototype),i}:Reflect.construct).apply(null,arguments)}var rr=new eR.Vector2,rn=new eR.Vector2;function ri(e){var t,r,n,i,o,a,s,l,c=t7(e.map(function(e){return Array.isArray(e)?rt(eR.Vector2,re(e)):e}),3),u=c[0],h=c[1],d=c[2];if(0===(n=(r=t7((t=e)[0],2))[0],i=r[1],a=(o=t7(t[1],2))[0],s=o[1],function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],c=t[6],u=t[7],h=t[8];return n*s*h+i*l*c+o*a*u-o*s*c-i*a*h-n*l*u}(n,i,1,a,s,1,(l=t7(t[2],2))[0],l[1],1)))return!1;var A=rr.subVectors(h,u);return rn.subVectors(d,u).cross(A)>0}function ro(e,t,r){return Math.max(t,Math.min(r,e))}function ra(e,t){return ro(e-Math.floor(e/t)*t,0,t)}function rs(e,t){var r=ra(t-e,2*Math.PI);return r>Math.PI&&(r-=2*Math.PI),r}function rl(e,t){return e.x===t.x?void 0!==e.z&&e.y===t.y?e.z-t.z:e.y-t.y:e.x-t.x}function rc(e,t,r){return(r-e)/(t-e)}function ru(e,t){var r=new eR.Vector3().crossVectors(e,t),n=e.dot(t),i=new eR.Matrix3().identity(),o=new eR.Matrix3().set(0,-r.z,r.y,r.z,0,-r.x,-r.y,r.x,0),a=new eR.Matrix3().multiplyMatrices(o,o).multiplyScalar(1/(1+n));return t9(t9(i,o),a)}var rh=Object.freeze({__proto__:null,clamp:ro,repeat:ra,deltaAngle:rs,degToRad:function(e){return e/180*Math.PI},radToDeg:function(e){return 180*e/Math.PI},fibonacciOnSphere:function(e,t){for(var r=t.radius,n=void 0===r?1:r,i=e.length/3,o=2/i,a=Math.PI*(3-2.2360679775),s=0;s<e.length;s+=3){var l=s*o-1+o/2,c=Math.sqrt(1-Math.pow(l,2)),u=s%i*a,h=Math.cos(u)*c,d=Math.sin(u)*c;e[s]=h*n,e[s+1]=l*n,e[s+2]=d*n}},vectorEquals:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return Math.abs(e.x-t.x)<r&&Math.abs(e.y-t.y)<r&&Math.abs(e.z-t.z)<r},lexicographic:rl,convexHull:function(e){for(var t=e.sort(rl),r=[t[0],t[1]],n=2;n<t.length;n++)for(r.push(t[n]);r.length>2&&ri(re(r.slice(-3)));)r.splice(r.length-2,1);for(var i=[t[t.length-1],t[t.length-2]],o=t.length-3;o>=0;o--)for(i.push(t[o]);i.length>2&&ri(re(i.slice(-3)));)i.splice(i.length-2,1);return i.splice(0,1),i.splice(i.length-1,1),[].concat(r,i)},remap:function(e,t,r){var n=t7(t,2),i=n[0],o=n[1],a=t7(r,2),s=a[0];return s+(e-i)*(a[1]-s)/(o-i)},fade:function(e){return e*e*e*(e*(6*e-15)+10)},lerp:function(e,t,r){return e*(1-r)+t*r},inverseLerp:rc,normalize:function(e,t,r){var n=Math.sqrt(e*e+t*t+r*r);return[e/n,t/n,r/n]},pointOnCubeToPointOnSphere:function(e,t,r){var n=e*e,i=t*t,o=r*r;return[e*Math.sqrt(1-(i+o)/2+i*o/3),t*Math.sqrt(1-(o+n)/2+o*n/3),r*Math.sqrt(1-(n+i)/2+n*i/3)]},rotateVectorOnVector:ru,pointToCoordinate:function(e,t,r){return[Math.asin(t),Math.atan2(e,-r)]},coordinateToPoint:function(e,t){var r=Math.cos(e);return[Math.sin(t)*r,Math.sin(e),-Math.cos(t)*r]},planeSegmentIntersection:function(e,t){var r=t7(t,2),n=r[0],i=r[1],o=ru(e.normal,new eR.Vector3(0,1,0)),a=rc(n.clone().applyMatrix3(o).y,i.clone().applyMatrix3(o).y,0);return new eR.Vector3().lerpVectors(n,i,a)},pointToPlaneDistance:function(e,t){return t.normal.dot(e)},getIndexFrom3D:function(e,t){var r=t7(e,3),n=r[0],i=r[1],o=r[2],a=t7(t,2),s=a[0];return o*s*a[1]+i*s+n},get3DFromIndex:function(e,t){var r=t7(t,2),n=r[0],i=n*r[1],o=e/i,a=e-i*o;return[a%n,a/n,o]},getIndexFrom2D:function(e,t){return e[0]+t[0]*e[1]},get2DFromIndex:function(e,t){return[e%t,Math.floor(e/t)]}});function rd(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}var rA=function e(t,r,n){var i=this;rd(this,e),t4(this,"dot2",function(e,t){return i.x*e+i.y*t}),t4(this,"dot3",function(e,t,r){return i.x*e+i.y*t+i.z*r}),this.x=t,this.y=r,this.z=n},rf=[new rA(1,1,0),new rA(-1,1,0),new rA(1,-1,0),new rA(-1,-1,0),new rA(1,0,1),new rA(-1,0,1),new rA(1,0,-1),new rA(-1,0,-1),new rA(0,1,1),new rA(0,-1,1),new rA(0,1,-1),new rA(0,-1,-1)],rp=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],rm=Array(512),rg=Array(512);function rv(e){var t=function(e){if("number"==typeof e)e=Math.abs(e);else if("string"==typeof e){var t=e;e=0;for(var r=0;r<t.length;r++)e=(e+t.charCodeAt(r)%96*(r+1))%2147483647}return 0===e&&(e=311),e}(e);return function(){var e=48271*t%2147483647;return t=e,e/2147483647}}!function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t,r=0;r<256;r++)t=1&r?rp[r]^255&e:rp[r]^e>>8&255,rm[r]=rm[r+256]=t,rg[r]=rg[r+256]=rf[t%12]}(0),new function e(t){var r=this;rd(this,e),t4(this,"seed",0),t4(this,"init",function(e){r.seed=e,r.value=rv(e)}),t4(this,"value",rv(this.seed)),this.init(t)}(Math.random());var ry=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function rE(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.25,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.01,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ry,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:.001,l="velocity_"+t;if(void 0===e.__damp&&(e.__damp={}),void 0===e.__damp[l]&&(e.__damp[l]=0),Math.abs(e[t]-r)<=s)return e[t]=r,!1;var c=2/(n=Math.max(1e-4,n)),u=a(c*i),h=e[t]-r,d=r,A=o*n;h=Math.min(Math.max(h,-A),A),r=e[t]-h;var f=(e.__damp[l]+c*h)*i;e.__damp[l]=(e.__damp[l]-c*f)*u;var p=r+(h+f)*u;return d-e[t]>0==p>d&&(p=d,e.__damp[l]=(p-d)/i),e[t]=p,!0}var rC=new eR.Vector3,rw=new eR.Quaternion,rB=new eR.Quaternion,rx=new eR.Matrix4,rI=new eR.Vector3;function rb(e,t,r,n,i,o,a,s){return rE(e,t,e[t]+rs(e[t],r),n,i,o,a,s)}var r_=new eR.Vector2,rM=new eR.Vector3;function rS(e,t,r,n,i,o,a){return"number"==typeof t?rM.setScalar(t):Array.isArray(t)?rM.set(t[0],t[1],t[2]):rM.copy(t),et=rE(e,"x",rM.x,r,n,i,o,a),er=rE(e,"y",rM.y,r,n,i,o,a),en=rE(e,"z",rM.z,r,n,i,o,a),et||er||en}var rT=new eR.Vector4,rD=new eR.Euler,rR=new eR.Color,rP=new eR.Quaternion,rF=new eR.Vector4,rQ=new eR.Vector4,rO=new eR.Vector4;function rL(e,t,r,n,i,o,a){Array.isArray(t)?rP.set(t[0],t[1],t[2],t[3]):rP.copy(t);var s=e.dot(rP)>0?1:-1;return rP.x*=s,rP.y*=s,rP.z*=s,rP.w*=s,ef=rE(e,"x",rP.x,r,n,i,o,a),ep=rE(e,"y",rP.y,r,n,i,o,a),em=rE(e,"z",rP.z,r,n,i,o,a),eg=rE(e,"w",rP.w,r,n,i,o,a),rF.set(e.x,e.y,e.z,e.w).normalize(),rQ.set(e.__damp.velocity_x,e.__damp.velocity_y,e.__damp.velocity_z,e.__damp.velocity_w),rO.copy(rF).multiplyScalar(rQ.dot(rF)/rF.dot(rF)),e.__damp.velocity_x-=rO.x,e.__damp.velocity_y-=rO.y,e.__damp.velocity_z-=rO.z,e.__damp.velocity_w-=rO.w,e.set(rF.x,rF.y,rF.z,rF.w),ef||ep||em||eg}var rk=new eR.Spherical,rU=new eR.Matrix4,rG=new eR.Vector3,rN=new eR.Quaternion,rz=new eR.Vector3,rH=Object.freeze({__proto__:null,rsqw:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/(2*Math.PI);return r/Math.atan(1/t)*Math.atan(Math.sin(2*Math.PI*e*n)/t)},exp:ry,linear:function(e){return e},sine:{in:function(e){return 1-Math.cos(e*Math.PI/2)},out:function(e){return Math.sin(e*Math.PI/2)},inOut:function(e){return-(Math.cos(Math.PI*e)-1)/2}},cubic:{in:function(e){return e*e*e},out:function(e){return 1-Math.pow(1-e,3)},inOut:function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}},quint:{in:function(e){return e*e*e*e*e},out:function(e){return 1-Math.pow(1-e,5)},inOut:function(e){return e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2}},circ:{in:function(e){return 1-Math.sqrt(1-Math.pow(e,2))},out:function(e){return Math.sqrt(1-Math.pow(e-1,2))},inOut:function(e){return e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2}},quart:{in:function(e){return e*e*e*e},out:function(e){return 1- --e*e*e*e},inOut:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e}},expo:{in:function(e){return 0===e?0:Math.pow(2,10*e-10)},out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},inOut:function(e){return 0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2}},damp:rE,dampLookAt:function(e,t,r,n,i,o,a){"number"==typeof t?rC.setScalar(t):Array.isArray(t)?rC.set(t[0],t[1],t[2]):rC.copy(t);var s=e.parent;(e.updateWorldMatrix(!0,!1),rI.setFromMatrixPosition(e.matrixWorld),e&&e.isCamera||e&&e.isLight)?rx.lookAt(rI,rC,e.up):rx.lookAt(rC,rI,e.up),rL(e.quaternion,rB.setFromRotationMatrix(rx),r,n,i,o,a),s&&(rx.extractRotation(s.matrixWorld),rw.setFromRotationMatrix(rx),rL(e.quaternion,rB.copy(e.quaternion).premultiply(rw.invert()),r,n,i,o,a))},dampAngle:rb,damp2:function(e,t,r,n,i,o,a){return"number"==typeof t?r_.setScalar(t):Array.isArray(t)?r_.set(t[0],t[1]):r_.copy(t),$=rE(e,"x",r_.x,r,n,i,o,a),ee=rE(e,"y",r_.y,r,n,i,o,a),$||ee},damp3:rS,damp4:function(e,t,r,n,i,o,a){return"number"==typeof t?rT.setScalar(t):Array.isArray(t)?rT.set(t[0],t[1],t[2],t[3]):rT.copy(t),ei=rE(e,"x",rT.x,r,n,i,o,a),eo=rE(e,"y",rT.y,r,n,i,o,a),ea=rE(e,"z",rT.z,r,n,i,o,a),es=rE(e,"w",rT.w,r,n,i,o,a),ei||eo||ea||es},dampE:function(e,t,r,n,i,o,a){return Array.isArray(t)?rD.set(t[0],t[1],t[2],t[3]):rD.copy(t),el=rb(e,"x",rD.x,r,n,i,o,a),ec=rb(e,"y",rD.y,r,n,i,o,a),eu=rb(e,"z",rD.z,r,n,i,o,a),el||ec||eu},dampC:function(e,t,r,n,i,o,a){return t instanceof eR.Color?rR.copy(t):Array.isArray(t)?rR.setRGB(t[0],t[1],t[2]):rR.set(t),eh=rE(e,"r",rR.r,r,n,i,o,a),ed=rE(e,"g",rR.g,r,n,i,o,a),eA=rE(e,"b",rR.b,r,n,i,o,a),eh||ed||eA},dampQ:rL,dampS:function(e,t,r,n,i,o,a){return Array.isArray(t)?rk.set(t[0],t[1],t[2]):rk.copy(t),ev=rE(e,"radius",rk.radius,r,n,i,o,a),ey=rb(e,"phi",rk.phi,r,n,i,o,a),eE=rb(e,"theta",rk.theta,r,n,i,o,a),ev||ey||eE},dampM:function(e,t,r,n,i,o,a){return void 0===e.__damp&&(e.__damp={position:new eR.Vector3,rotation:new eR.Quaternion,scale:new eR.Vector3},e.decompose(e.__damp.position,e.__damp.rotation,e.__damp.scale)),Array.isArray(t)?rU.set.apply(rU,re(t)):rU.copy(t),rU.decompose(rG,rN,rz),eC=rS(e.__damp.position,rG,r,n,i,o,a),ew=rL(e.__damp.rotation,rN,r,n,i,o,a),eB=rS(e.__damp.scale,rz,r,n,i,o,a),e.compose(e.__damp.position,e.__damp.rotation,e.__damp.scale),eC||ew||eB}});eR.BufferGeometry;let rV=eT.createContext(null);function rj(){return eT.useContext(rV)}function rJ(e){let{eps:t=1e-5,enabled:r=!0,infinite:n,horizontal:i,pages:o=1,distance:a=1,damping:s=.25,maxSpeed:l=1/0,prepend:c=!1,style:u={},children:h}=e,{get:d,setEvents:A,gl:f,size:p,invalidate:m,events:g}=(0,eP.A)(),[v]=eT.useState(()=>document.createElement("div")),[y]=eT.useState(()=>document.createElement("div")),[E]=eT.useState(()=>document.createElement("div")),C=f.domElement.parentNode,w=eT.useRef(0),B=eT.useMemo(()=>({el:v,eps:t,fill:y,fixed:E,horizontal:i,damping:s,offset:0,delta:0,scroll:w,pages:o,range(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e-r,i=n+t+2*r;return this.offset<n?0:this.offset>i?1:(this.offset-n)/(i-n)},curve(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.sin(this.range(e,t,r)*Math.PI)},visible(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e-r;return this.offset>=n&&this.offset<=n+t+2*r}}),[t,s,i,o]);eT.useEffect(()=>{for(let e in v.style.position="absolute",v.style.width="100%",v.style.height="100%",v.style[i?"overflowX":"overflowY"]="auto",v.style[i?"overflowY":"overflowX"]="hidden",v.style.top="0px",v.style.left="0px",u)v.style[e]=u[e];E.style.position="sticky",E.style.top="0px",E.style.left="0px",E.style.width="100%",E.style.height="100%",E.style.overflow="hidden",v.appendChild(E),y.style.height=i?"100%":"".concat(o*a*100,"%"),y.style.width=i?"".concat(o*a*100,"%"):"100%",y.style.pointerEvents="none",v.appendChild(y),c?C.prepend(v):C.appendChild(v),v[i?"scrollLeft":"scrollTop"]=1;let e=g.connected||f.domElement;requestAnimationFrame(()=>null==g.connect?void 0:g.connect(v));let t=d().events.compute;return A({compute(e,t){let{left:r,top:n}=C.getBoundingClientRect(),i=e.clientX-r,o=e.clientY-n;t.pointer.set(i/t.size.width*2-1,-(o/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{C.removeChild(v),A({compute:t}),null==g.connect||g.connect(e)}},[o,a,i,v,y,E,C]),eT.useEffect(()=>{if(g.connected===v){let e=p[i?"width":"height"],t=v[i?"scrollWidth":"scrollHeight"],o=t-e,a=0,s=!0,l=!0,c=()=>{if(r&&!l&&(m(),a=v[i?"scrollLeft":"scrollTop"],w.current=a/o,n)){if(!s){if(a>=o){let e=1-B.offset;v[i?"scrollLeft":"scrollTop"]=1,w.current=B.offset=-e,s=!0}else if(a<=0){let e=1+B.offset;v[i?"scrollLeft":"scrollTop"]=t,w.current=B.offset=e,s=!0}}s&&setTimeout(()=>s=!1,40)}};v.addEventListener("scroll",c,{passive:!0}),requestAnimationFrame(()=>l=!1);let u=e=>v.scrollLeft+=e.deltaY/2;return i&&v.addEventListener("wheel",u,{passive:!0}),()=>{v.removeEventListener("scroll",c),i&&v.removeEventListener("wheel",u)}}},[v,g,p,n,B,m,i,r]);let x=0;return(0,eP.C)((e,r)=>{x=B.offset,rH.damp(B,"offset",w.current,s,r,l,void 0,t),rH.damp(B,"delta",Math.abs(x-B.offset),s,r,l,void 0,t),B.delta>t&&m()}),eT.createElement(rV.Provider,{value:B},h)}let rY=eT.forwardRef((e,t)=>{let{children:r}=e,n=eT.useRef(null);eT.useImperativeHandle(t,()=>n.current,[]);let i=rj(),{width:o,height:a}=(0,eP.A)(e=>e.viewport);return(0,eP.C)(()=>{n.current.position.x=i.horizontal?-o*(i.pages-1)*i.offset:0,n.current.position.y=i.horizontal?0:a*(i.pages-1)*i.offset}),eT.createElement("group",{ref:n},r)}),rW=eT.forwardRef((e,t)=>{let{children:r,style:n,...i}=e,o=rj(),a=eT.useRef(null);eT.useImperativeHandle(t,()=>a.current,[]);let{width:s,height:l}=(0,eP.A)(e=>e.size),c=eT.useContext(eP.f),u=eT.useMemo(()=>eD.createRoot(o.fixed),[o.fixed]);return(0,eP.C)(()=>{o.delta>o.eps&&(a.current.style.transform="translate3d(".concat(o.horizontal?-s*(o.pages-1)*o.offset:0,"px,").concat(o.horizontal?0:-(l*(o.pages-1)*o.offset),"px,0)"))}),u.render(eT.createElement("div",(0,eS.Z)({ref:a,style:{...n,position:"absolute",top:0,left:0,willChange:"transform"}},i),eT.createElement(rV.Provider,{value:o},eT.createElement(eP.f.Provider,{value:c},r)))),null}),rq=eT.forwardRef((e,t)=>{let{html:r,...n}=e;return eT.createElement(r?rW:rY,(0,eS.Z)({ref:t},n))}),rK=nr(),rX=e=>r8(e,rK),rZ=nr();rX.write=e=>r8(e,rZ);let r$=nr();rX.onStart=e=>r8(e,r$);let r0=nr();rX.onFrame=e=>r8(e,r0);let r1=nr();rX.onFinish=e=>r8(e,r1);let r2=[];rX.setTimeout=(e,t)=>{let r=rX.now()+t,n=()=>{let e=r2.findIndex(e=>e.cancel==n);~e&&r2.splice(e,1),r9-=~e?1:0},i={time:r,handler:e,cancel:n};return r2.splice(r3(r),0,i),r9+=1,r7(),i};let r3=e=>~(~r2.findIndex(t=>t.time>e)||~r2.length);rX.cancel=e=>{r$.delete(e),r0.delete(e),r1.delete(e),rK.delete(e),rZ.delete(e)},rX.sync=e=>{r6=!0,rX.batchedUpdates(e),r6=!1},rX.throttle=e=>{let t;function r(){try{e(...t)}finally{t=null}}function n(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];t=n,rX.onStart(r)}return n.handler=e,n.cancel=()=>{r$.delete(r),t=null},n};let r4="undefined"!=typeof window?window.requestAnimationFrame:()=>{};rX.use=e=>r4=e,rX.now="undefined"!=typeof performance?()=>performance.now():Date.now,rX.batchedUpdates=e=>e(),rX.catch=console.error,rX.frameLoop="always",rX.advance=()=>{"demand"!==rX.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):nt()};let r5=-1,r9=0,r6=!1;function r8(e,t){r6?(t.delete(e),e(0)):(t.add(e),r7())}function r7(){r5<0&&(r5=0,"demand"!==rX.frameLoop&&r4(ne))}function ne(){~r5&&(r4(ne),rX.batchedUpdates(nt))}function nt(){let e=r5,t=r3(r5=rX.now());if(t&&(nn(r2.splice(0,t),e=>e.handler()),r9-=t),!r9){r5=-1;return}r$.flush(),rK.flush(e?Math.min(64,r5-e):16.667),r0.flush(),rZ.flush(),r1.flush()}function nr(){let e=new Set,t=e;return{add(r){r9+=t!=e||e.has(r)?0:1,e.add(r)},delete:r=>(r9-=t==e&&e.has(r)?1:0,e.delete(r)),flush(r){t.size&&(e=new Set,r9-=t.size,nn(t,t=>t(r)&&e.add(t)),r9+=e.size,t=e)}}}function nn(e,t){e.forEach(e=>{try{t(e)}catch(e){rX.catch(e)}})}function ni(){}let no=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),na={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function ns(e,t){if(na.arr(e)){if(!na.arr(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return e===t}let nl=(e,t)=>e.forEach(t);function nc(e,t,r){if(na.arr(e)){for(let n=0;n<e.length;n++)t.call(r,e[n],"".concat(n));return}for(let n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n)}let nu=e=>na.und(e)?[]:na.arr(e)?e:[e];function nh(e,t){if(e.size){let r=Array.from(e);e.clear(),nl(r,t)}}let nd=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return nh(e,e=>e(...r))},nA=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),nf=null,np=!1,nm=ni;var ng=Object.freeze({__proto__:null,get createStringInterpolator(){return n},get to(){return i},get colors(){return nf},get skipAnimation(){return np},get willAdvance(){return nm},assign:e=>{e.to&&(i=e.to),e.now&&(rX.now=e.now),void 0!==e.colors&&(nf=e.colors),null!=e.skipAnimation&&(np=e.skipAnimation),e.createStringInterpolator&&(n=e.createStringInterpolator),e.requestAnimationFrame&&rX.use(e.requestAnimationFrame),e.batchedUpdates&&(rX.batchedUpdates=e.batchedUpdates),e.willAdvance&&(nm=e.willAdvance),e.frameLoop&&(rX.frameLoop=e.frameLoop)}});let nv=new Set,ny=[],nE=[],nC=0,nw={get idle(){return!nv.size&&!ny.length},start(e){nC>e.priority?(nv.add(e),rX.onStart(nB)):(nx(e),rX(nb))},advance:nb,sort(e){if(nC)rX.onFrame(()=>nw.sort(e));else{let t=ny.indexOf(e);~t&&(ny.splice(t,1),nI(e))}},clear(){ny=[],nv.clear()}};function nB(){nv.forEach(nx),nv.clear(),rX(nb)}function nx(e){ny.includes(e)||nI(e)}function nI(e){ny.splice(function(e,t){let r=e.findIndex(t);return r<0?e.length:r}(ny,t=>t.priority>e.priority),0,e)}function nb(e){let t=nE;for(let r=0;r<ny.length;r++){let n=ny[r];nC=n.priority,n.idle||(nm(n),n.advance(e),n.idle||t.push(n))}return nC=0,(nE=ny).length=0,(ny=t).length>0}let n_="[-+]?\\d*\\.?\\d+",nM=n_+"%";function nS(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}let nT=RegExp("rgb"+nS(n_,n_,n_)),nD=RegExp("rgba"+nS(n_,n_,n_,n_)),nR=RegExp("hsl"+nS(n_,nM,nM)),nP=RegExp("hsla"+nS(n_,nM,nM,n_)),nF=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,nQ=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,nO=/^#([0-9a-fA-F]{6})$/,nL=/^#([0-9a-fA-F]{8})$/;function nk(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function nU(e,t,r){let n=r<.5?r*(1+t):r+t-r*t,i=2*r-n;return Math.round(255*nk(i,n,e+1/3))<<24|Math.round(255*nk(i,n,e))<<16|Math.round(255*nk(i,n,e-1/3))<<8}function nG(e){let t=parseInt(e,10);return t<0?0:t>255?255:t}function nN(e){return(parseFloat(e)%360+360)%360/360}function nz(e){let t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function nH(e){let t=parseFloat(e);return t<0?0:t>100?1:t/100}function nV(e){let t;let r="number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=nO.exec(e))?parseInt(t[1]+"ff",16)>>>0:nf&&void 0!==nf[e]?nf[e]:(t=nT.exec(e))?(nG(t[1])<<24|nG(t[2])<<16|nG(t[3])<<8|255)>>>0:(t=nD.exec(e))?(nG(t[1])<<24|nG(t[2])<<16|nG(t[3])<<8|nz(t[4]))>>>0:(t=nF.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=nL.exec(e))?parseInt(t[1],16)>>>0:(t=nQ.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=nR.exec(e))?(255|nU(nN(t[1]),nH(t[2]),nH(t[3])))>>>0:(t=nP.exec(e))?(nU(nN(t[1]),nH(t[2]),nH(t[3]))|nz(t[4]))>>>0:null;if(null===r)return e;let n=(4278190080&(r=r||0))>>>24,i=(16711680&r)>>>16,o=(65280&r)>>>8,a=(255&r)/255;return"rgba(".concat(n,", ").concat(i,", ").concat(o,", ").concat(a,")")}let nj=(e,t,r)=>{if(na.fun(e))return e;if(na.arr(e))return nj({range:e,output:t,extrapolate:r});if(na.str(e.output[0]))return n(e);let i=e.output,o=e.range||[0,1],a=e.extrapolateLeft||e.extrapolate||"extend",s=e.extrapolateRight||e.extrapolate||"extend",l=e.easing||(e=>e);return t=>{let r=function(e,t){for(var r=1;r<t.length-1&&!(t[r]>=e);++r);return r-1}(t,o);return function(e,t,r,n,i,o,a,s,l){let c=l?l(e):e;if(c<t){if("identity"===a)return c;"clamp"===a&&(c=t)}if(c>r){if("identity"===s)return c;"clamp"===s&&(c=r)}return n===i?n:t===r?e<=t?n:i:(t===-1/0?c=-c:r===1/0?c-=t:c=(c-t)/(r-t),c=o(c),n===-1/0?c=-c:i===1/0?c+=n:c=c*(i-n)+n,c)}(t,o[r],o[r+1],i[r],i[r+1],l,a,s,e.map)}};function nJ(){return(nJ=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let nY=Symbol.for("FluidValue.get"),nW=Symbol.for("FluidValue.observers"),nq=e=>!!(e&&e[nY]),nK=e=>e&&e[nY]?e[nY]():e,nX=e=>e[nW]||null;function nZ(e,t){let r=e[nW];r&&r.forEach(e=>{e.eventObserved?e.eventObserved(t):e(t)})}class n${constructor(e){if(this[nY]=void 0,this[nW]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");n0(this,e)}}let n0=(e,t)=>n3(e,nY,t);function n1(e,t){if(e[nY]){let r=e[nW];r||n3(e,nW,r=new Set),!r.has(t)&&(r.add(t),e.observerAdded&&e.observerAdded(r.size,t))}return t}function n2(e,t){let r=e[nW];if(r&&r.has(t)){let n=r.size-1;n?r.delete(t):e[nW]=null,e.observerRemoved&&e.observerRemoved(n,t)}}let n3=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),n4=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,n5=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,n9=RegExp("(".concat(n4.source,")(%|[a-z]+)"),"i"),n6=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,n8=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,n7=e=>{let[t,r]=ie(e);if(!t||nA())return e;let n=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(n)return n.trim();if(r&&r.startsWith("--")){let e=window.getComputedStyle(document.documentElement).getPropertyValue(r);if(e)return e}else if(r&&n8.test(r))return n7(r);else if(r)return r;return e},ie=e=>{let t=n8.exec(e);if(!t)return[,];let[,r,n]=t;return[r,n]},it=(e,t,r,n,i)=>"rgba(".concat(Math.round(t),", ").concat(Math.round(r),", ").concat(Math.round(n),", ").concat(i,")"),ir=e=>{o||(o=nf?RegExp("(".concat(Object.keys(nf).join("|"),")(?!\\w)"),"g"):/^\b$/);let t=e.output.map(e=>nK(e).replace(n8,n7).replace(n5,nV).replace(o,nV)),r=t.map(e=>e.match(n4).map(Number)),n=r[0].map((e,t)=>r.map(e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})).map(t=>nj(nJ({},e,{output:t})));return e=>{var r;let i=!n9.test(t[0])&&(null==(r=t.find(e=>n9.test(e)))?void 0:r.replace(n4,"")),o=0;return t[0].replace(n4,()=>"".concat(n[o++](e)).concat(i||"")).replace(n6,it)}},ii="react-spring: ",io=e=>{let t=!1;if("function"!=typeof e)throw TypeError("".concat(ii,"once requires a function parameter"));return function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];t||(e(...n),t=!0)}},ia=io(console.warn),is=io(console.warn);function il(e){return na.str(e)&&("#"==e[0]||/\d/.test(e)||!nA()&&n8.test(e)||e in(nf||{}))}new WeakMap,new WeakMap,new WeakMap,new WeakMap;let ic=nA()?eT.useEffect:eT.useLayoutEffect,iu=()=>{let e=(0,eT.useRef)(!1);return ic(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function ih(){let e=(0,eT.useState)()[1],t=iu();return()=>{t.current&&e(Math.random())}}let id=e=>(0,eT.useEffect)(e,iA),iA=[];function ip(e){let t=(0,eT.useRef)();return(0,eT.useEffect)(()=>{t.current=e}),t.current}let im=Symbol.for("Animated:node"),ig=e=>!!e&&e[im]===e,iv=e=>e&&e[im],iy=(e,t)=>no(e,im,t),iE=e=>e&&e[im]&&e[im].getPayload();class iC{getPayload(){return this.payload||[]}constructor(){this.payload=void 0,iy(this,this)}}class iw extends iC{static create(e){return new iw(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return na.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){let{done:e}=this;this.done=!1,na.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,na.num(this._value)&&(this.lastPosition=this._value)}}class iB extends iw{static create(e){return new iB(e)}getValue(){let e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(na.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=nj({output:[this.getValue(),e]})),this._value=0,super.reset()}constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=nj({output:[e,e]})}}let ix={dependencies:null};class iI extends iC{getValue(e){let t={};return nc(this.source,(r,n)=>{ig(r)?t[n]=r.getValue(e):nq(r)?t[n]=nK(r):e||(t[n]=r)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&nl(this.payload,e=>e.reset())}_makePayload(e){if(e){let t=new Set;return nc(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){ix.dependencies&&nq(e)&&ix.dependencies.add(e);let t=iE(e);t&&nl(t,e=>this.add(e))}constructor(e){super(),this.source=e,this.setValue(e)}}class ib extends iI{static create(e){return new ib(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){let t=this.getPayload();return e.length==t.length?t.map((t,r)=>t.setValue(e[r])).some(Boolean):(super.setValue(e.map(i_)),!0)}constructor(e){super(e)}}function i_(e){return(il(e)?iB:iw).create(e)}function iM(e){let t=iv(e);return t?t.constructor:na.arr(e)?ib:il(e)?iB:iw}function iS(){return(iS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}let iT=(e,t)=>{let r=!na.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,eT.forwardRef)((n,i)=>{let o=(0,eT.useRef)(null),a=r&&(0,eT.useCallback)(e=>{o.current=(i&&(na.fun(i)?i(e):i.current=e),e)},[i]),[s,l]=function(e,t){let r=new Set;return ix.dependencies=r,e.style&&(e=iS({},e,{style:t.createAnimatedStyle(e.style)})),e=new iI(e),ix.dependencies=null,[e,r]}(n,t),c=ih(),u=()=>{let e=o.current;(!r||e)&&!1===(!!e&&t.applyAnimatedValues(e,s.getValue(!0)))&&c()},h=new iD(u,l),d=(0,eT.useRef)();ic(()=>(d.current=h,nl(l,e=>n1(e,h)),()=>{d.current&&(nl(d.current.deps,e=>n2(e,d.current)),rX.cancel(d.current.update))})),(0,eT.useEffect)(u,[]),id(()=>()=>{let e=d.current;nl(e.deps,t=>n2(t,e))});let A=t.getComponentProps(s.getValue());return eT.createElement(e,iS({},A,{ref:a}))})};class iD{eventObserved(e){"change"==e.type&&rX.write(this.update)}constructor(e,t){this.update=e,this.deps=t}}let iR=Symbol.for("AnimatedComponent"),iP=e=>na.str(e)?e:e&&na.str(e.displayName)?e.displayName:na.fun(e)&&e.name||null;function iF(){return(iF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function iQ(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return na.fun(e)?e(...r):e}let iO=(e,t)=>!0===e||!!(t&&e&&(na.fun(e)?e(t):nu(e).includes(t))),iL=(e,t)=>na.obj(e)?t&&e[t]:e,ik=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,iU=e=>e,iG=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iU,r=iN;e.default&&!0!==e.default&&(r=Object.keys(e=e.default));let n={};for(let i of r){let r=t(e[i],i);na.und(r)||(n[i]=r)}return n},iN=["config","onProps","onStart","onChange","onPause","onResume","onRest"],iz={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function iH(e){let t=function(e){let t={},r=0;if(nc(e,(e,n)=>{!iz[n]&&(t[n]=e,r++)}),r)return t}(e);if(t){let r={to:t};return nc(e,(e,n)=>n in t||(r[n]=e)),r}return iF({},e)}function iV(e){return e=nK(e),na.arr(e)?e.map(iV):il(e)?ng.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function ij(e){return na.fun(e)||na.arr(e)&&na.obj(e[0])}let iJ=iF({},{tension:170,friction:26},{mass:1,damping:1,easing:e=>e,clamp:!1});class iY{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,iJ)}}function iW(e,t){if(na.und(t.decay)){let r=!na.und(t.tension)||!na.und(t.friction);!r&&na.und(t.frequency)&&na.und(t.damping)&&na.und(t.mass)||(e.duration=void 0,e.decay=void 0),r&&(e.frequency=void 0)}else e.duration=void 0}let iq=[];class iK{constructor(){this.changed=!1,this.values=iq,this.toValues=null,this.fromValues=iq,this.to=void 0,this.from=void 0,this.config=new iY,this.immediate=!1}}function iX(e,t){let{key:r,props:n,defaultProps:i,state:o,actions:a}=t;return new Promise((t,s)=>{var l;let c,u;let h=iO(null!=(l=n.cancel)?l:null==i?void 0:i.cancel,r);if(h)f();else{na.und(n.pause)||(o.paused=iO(n.pause,r));let e=null==i?void 0:i.pause;!0!==e&&(e=o.paused||iO(e,r)),c=iQ(n.delay||0,r),e?(o.resumeQueue.add(A),a.pause()):(a.resume(),A())}function d(){o.resumeQueue.add(A),o.timeouts.delete(u),u.cancel(),c=u.time-rX.now()}function A(){c>0&&!ng.skipAnimation?(o.delayed=!0,u=rX.setTimeout(f,c),o.pauseQueue.add(d),o.timeouts.add(u)):f()}function f(){o.delayed&&(o.delayed=!1),o.pauseQueue.delete(d),o.timeouts.delete(u),e<=(o.cancelId||0)&&(h=!0);try{a.start(iF({},n,{callId:e,cancel:h}),t)}catch(e){s(e)}}})}let iZ=(e,t)=>1==t.length?t[0]:t.some(e=>e.cancelled)?i1(e.get()):t.every(e=>e.noop)?i$(e.get()):i0(e.get(),t.every(e=>e.finished)),i$=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),i0=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{value:e,finished:t,cancelled:r}},i1=e=>({value:e,cancelled:!0,finished:!1});function i2(e,t,r,n){let{callId:i,parentId:o,onRest:a}=t,{asyncTo:s,promise:l}=r;return o||e!==s||t.reset?r.promise=(async()=>{let c,u,h;r.asyncId=i,r.asyncTo=e;let d=iG(t,(e,t)=>"onRest"===t?void 0:e),A=new Promise((e,t)=>(c=e,u=t)),f=e=>{let t=i<=(r.cancelId||0)&&i1(n)||i!==r.asyncId&&i0(n,!1);if(t)throw e.result=t,u(e),e},p=(e,t)=>{let o=new i4,a=new i5;return(async()=>{if(ng.skipAnimation)throw i3(r),a.result=i0(n,!1),u(a),a;f(o);let s=na.obj(e)?iF({},e):iF({},t,{to:e});s.parentId=i,nc(d,(e,t)=>{na.und(s[t])&&(s[t]=e)});let l=await n.start(s);return f(o),r.paused&&await new Promise(e=>{r.resumeQueue.add(e)}),l})()};if(ng.skipAnimation)return i3(r),i0(n,!1);try{let t;t=na.arr(e)?(async e=>{for(let t of e)await p(t)})(e):Promise.resolve(e(p,n.stop.bind(n))),await Promise.all([t.then(c),A]),h=i0(n.get(),!0,!1)}catch(e){if(e instanceof i4)h=e.result;else if(e instanceof i5)h=e.result;else throw e}finally{i==r.asyncId&&(r.asyncId=o,r.asyncTo=o?s:void 0,r.promise=o?l:void 0)}return na.fun(a)&&rX.batchedUpdates(()=>{a(h,n,n.item)}),h})():l}function i3(e,t){nh(e.timeouts,e=>e.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}class i4 extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class i5 extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}let i9=e=>e instanceof i8,i6=1;class i8 extends n${get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){let e=iv(this);return e&&e.getValue()}to(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ng.to(this,t)}interpolate(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ia("".concat(ii,'The "interpolate" function is deprecated in v9 (use "to" instead)')),ng.to(this,t)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];nZ(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||nw.sort(this),nZ(this,{type:"priority",parent:this,priority:e})}constructor(...e){super(...e),this.id=i6++,this.key=void 0,this._priority=0}}let i7=Symbol.for("SpringPhase"),oe=e=>(1&e[i7])>0,ot=e=>(2&e[i7])>0,or=e=>(4&e[i7])>0,on=(e,t)=>t?e[i7]|=3:e[i7]&=-3,oi=(e,t)=>t?e[i7]|=4:e[i7]&=-5;class oo extends i8{get idle(){return!(ot(this)||this._state.asyncTo)||or(this)}get goal(){return nK(this.animation.to)}get velocity(){let e=iv(this);return e instanceof iw?e.lastVelocity||0:e.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return oe(this)}get isAnimating(){return ot(this)}get isPaused(){return or(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,r=!1,n=this.animation,{config:i,toValues:o}=n,a=iE(n.to);!a&&nq(n.to)&&(o=nu(nK(n.to))),n.values.forEach((s,l)=>{if(s.done)return;let c=s.constructor==iB?1:a?a[l].lastPosition:o[l],u=n.immediate,h=c;if(!u){let t;if(h=s.lastPosition,i.tension<=0){s.done=!0;return}let r=s.elapsedTime+=e,o=n.fromValues[l],a=null!=s.v0?s.v0:s.v0=na.arr(i.velocity)?i.velocity[l]:i.velocity,d=i.precision||(o==c?.005:Math.min(1,.001*Math.abs(c-o)));if(na.und(i.duration)){if(i.decay){let e=!0===i.decay?.998:i.decay,n=Math.exp(-(1-e)*r);h=o+a/(1-e)*(1-n),u=Math.abs(s.lastPosition-h)<=d,t=a*n}else{t=null==s.lastVelocity?a:s.lastVelocity;let r=i.restVelocity||d/10,n=i.clamp?0:i.bounce,l=!na.und(n),A=o==c?s.v0>0:o<c,f=Math.ceil(e/1);for(let e=0;e<f&&!(!(Math.abs(t)>r)&&(u=Math.abs(c-h)<=d));++e){l&&(h==c||h>c==A)&&(t=-t*n,h=c);let e=(-(1e-6*i.tension)*(h-c)+-(.001*i.friction)*t)/i.mass;t+=1*e,h+=1*t}}}else{let n=1;i.duration>0&&(this._memoizedDuration!==i.duration&&(this._memoizedDuration=i.duration,s.durationProgress>0&&(s.elapsedTime=i.duration*s.durationProgress,r=s.elapsedTime+=e)),n=(n=(i.progress||0)+r/this._memoizedDuration)>1?1:n<0?0:n,s.durationProgress=n),t=((h=o+i.easing(n)*(c-o))-s.lastPosition)/e,u=1==n}s.lastVelocity=t,Number.isNaN(h)&&(console.warn("Got NaN while animating:",this),u=!0)}a&&!a[l].done&&(u=!1),u?s.done=!0:t=!1,s.setValue(h,i.round)&&(r=!0)});let s=iv(this),l=s.getValue();if(t){let e=nK(n.to);(l!==e||r)&&!i.decay?(s.setValue(e),this._onChange(e)):r&&i.decay&&this._onChange(l),this._stop()}else r&&this._onChange(l)}set(e){return rX.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(ot(this)){let{to:e,config:t}=this.animation;rX.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let r;return na.und(e)?(r=this.queue||[],this.queue=[]):r=[na.obj(e)?e:iF({},t,{to:e})],Promise.all(r.map(e=>this._update(e))).then(e=>iZ(this,e))}stop(e){let{to:t}=this.animation;return this._focus(this.get()),i3(this._state,e&&this._lastCallId),rX.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){let t=this.key||"",{to:r,from:n}=e;(null==(r=na.obj(r)?r[t]:r)||ij(r))&&(r=void 0),null==(n=na.obj(n)?n[t]:n)&&(n=void 0);let i={to:r,from:n};return oe(this)||(e.reverse&&([r,n]=[n,r]),n=nK(n),na.und(n)?iv(this)||this._set(r):this._set(n)),i}_update(e,t){let r=iF({},e),{key:n,defaultProps:i}=this;r.default&&Object.assign(i,iG(r,(e,t)=>/^on/.test(t)?iL(e,n):e)),oh(this,r,"onProps"),od(this,"onProps",r,this);let o=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let a=this._state;return iX(++this._lastCallId,{key:n,props:r,defaultProps:i,state:a,actions:{pause:()=>{or(this)||(oi(this,!0),nd(a.pauseQueue),od(this,"onPause",i0(this,oa(this,this.animation.to)),this))},resume:()=>{or(this)&&(oi(this,!1),ot(this)&&this._resume(),nd(a.resumeQueue),od(this,"onResume",i0(this,oa(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then(e=>{if(r.loop&&e.finished&&!(t&&e.noop)){let e=os(r);if(e)return this._update(e,!0)}return e})}_merge(e,t,r){if(t.cancel)return this.stop(!0),r(i1(this));let n=!na.und(e.to),i=!na.und(e.from);if(n||i){if(!(t.callId>this._lastToId))return r(i1(this));this._lastToId=t.callId}let{key:o,defaultProps:a,animation:s}=this,{to:l,from:c}=s,{to:u=l,from:h=c}=e;i&&!n&&(!t.default||na.und(u))&&(u=h),t.reverse&&([u,h]=[h,u]);let d=!ns(h,c);d&&(s.from=h),h=nK(h);let A=!ns(u,l);A&&this._focus(u);let f=ij(t.to),{config:p}=s,{decay:m,velocity:g}=p;(n||i)&&(p.velocity=0),t.config&&!f&&function(e,t,r){for(let n in r&&(iW(r=iF({},r),t),t=iF({},r,t)),iW(e,t),Object.assign(e,t),iJ)null==e[n]&&(e[n]=iJ[n]);let{mass:n,frequency:i,damping:o}=e;na.und(i)||(i<.01&&(i=.01),o<0&&(o=0),e.tension=Math.pow(2*Math.PI/i,2)*n,e.friction=4*Math.PI*o*n/i)}(p,iQ(t.config,o),t.config!==a.config?iQ(a.config,o):void 0);let v=iv(this);if(!v||na.und(u))return r(i0(this,!0));let y=na.und(t.reset)?i&&!t.default:!na.und(h)&&iO(t.reset,o),E=y?h:this.get(),C=iV(u),w=na.num(C)||na.arr(C)||il(C),B=!f&&(!w||iO(a.immediate||t.immediate,o));if(A){let e=iM(u);if(e!==v.constructor){if(B)v=this._set(C);else throw Error("Cannot animate between ".concat(v.constructor.name," and ").concat(e.name,', as the "to" prop suggests'))}}let x=v.constructor,I=nq(u),b=!1;if(!I){let e=y||!oe(this)&&d;(A||e)&&(I=!(b=ns(iV(E),C))),(ns(s.immediate,B)||B)&&ns(p.decay,m)&&ns(p.velocity,g)||(I=!0)}if(b&&ot(this)&&(s.changed&&!y?I=!0:I||this._stop(l)),!f&&((I||nq(l))&&(s.values=v.getPayload(),s.toValues=nq(u)?null:x==iB?[1]:nu(C)),s.immediate==B||(s.immediate=B,B||y||this._set(l)),I)){let{onRest:e}=s;nl(ou,e=>oh(this,t,e));let n=i0(this,oa(this,l));nd(this._pendingCalls,n),this._pendingCalls.add(r),s.changed&&rX.batchedUpdates(()=>{s.changed=!y,null==e||e(n,this),y?iQ(a.onRest,n):null==s.onStart||s.onStart(n,this)})}y&&this._set(E),f?r(i2(t.to,t,this._state,this)):I?this._start():ot(this)&&!A?this._pendingCalls.add(r):r(i$(E))}_focus(e){let t=this.animation;e!==t.to&&(nX(this)&&this._detach(),t.to=e,nX(this)&&this._attach())}_attach(){let e=0,{to:t}=this.animation;nq(t)&&(n1(t,this),i9(t)&&(e=t.priority+1)),this.priority=e}_detach(){let{to:e}=this.animation;nq(e)&&n2(e,this)}_set(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=nK(e);if(!na.und(r)){let e=iv(this);if(!e||!ns(r,e.getValue())){let n=iM(r);e&&e.constructor==n?e.setValue(r):iy(this,n.create(r)),e&&rX.batchedUpdates(()=>{this._onChange(r,t)})}}return iv(this)}_onStart(){let e=this.animation;e.changed||(e.changed=!0,od(this,"onStart",i0(this,oa(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),iQ(this.animation.onChange,e,this)),iQ(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){let e=this.animation;iv(this).reset(nK(e.to)),e.immediate||(e.fromValues=e.values.map(e=>e.lastPosition)),ot(this)||(on(this,!0),or(this)||this._resume())}_resume(){ng.skipAnimation?this.finish():nw.start(this)}_stop(e,t){if(ot(this)){on(this,!1);let r=this.animation;nl(r.values,e=>{e.done=!0}),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),nZ(this,{type:"idle",parent:this});let n=t?i1(this.get()):i0(this.get(),oa(this,null!=e?e:r.to));nd(this._pendingCalls,n),r.changed&&(r.changed=!1,od(this,"onRest",n,this))}}constructor(e,t){if(super(),this.key=void 0,this.animation=new iK,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!na.und(e)||!na.und(t)){let r=na.obj(e)?iF({},e):iF({},t,{from:e});na.und(r.default)&&(r.default=!0),this.start(r)}}}function oa(e,t){let r=iV(t);return ns(iV(e.get()),r)}function os(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.loop,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.to,n=iQ(t);if(n){let i=!0!==n&&iH(n),o=(i||e).reverse,a=!i||i.reset;return ol(iF({},e,{loop:t,default:!1,pause:void 0,to:!o||ij(r)?r:void 0,from:a?e.from:void 0,reset:a},i))}}function ol(e){let{to:t,from:r}=e=iH(e),n=new Set;return na.obj(t)&&oc(t,n),na.obj(r)&&oc(r,n),e.keys=n.size?Array.from(n):null,e}function oc(e,t){nc(e,(e,r)=>null!=e&&t.add(r))}let ou=["onStart","onRest","onChange","onPause","onResume"];function oh(e,t,r){e.animation[r]=t[r]!==ik(t,r)?iL(t[r],e.key):void 0}function od(e,t){for(var r,n,i,o,a=arguments.length,s=Array(a>2?a-2:0),l=2;l<a;l++)s[l-2]=arguments[l];null==(r=(n=e.animation)[t])||r.call(n,...s),null==(i=(o=e.defaultProps)[t])||i.call(o,...s)}let oA=["onStart","onChange","onRest"],of=1;class op{get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){let e={};return this.each((t,r)=>e[r]=t.get()),e}set(e){for(let t in e){let r=e[t];na.und(r)||this.springs[t].set(r)}}update(e){return e&&this.queue.push(ol(e)),this}start(e){let{queue:t}=this;return(e?t=nu(e).map(ol):this.queue=[],this._flush)?this._flush(this,t):(ow(this,t),om(this,t))}stop(e,t){if(!!e!==e&&(t=e),t){let r=this.springs;nl(nu(t),t=>r[t].stop(!!e))}else i3(this._state,this._lastAsyncId),this.each(t=>t.stop(!!e));return this}pause(e){if(na.und(e))this.start({pause:!0});else{let t=this.springs;nl(nu(e),e=>t[e].pause())}return this}resume(e){if(na.und(e))this.start({pause:!1});else{let t=this.springs;nl(nu(e),e=>t[e].resume())}return this}each(e){nc(this.springs,e)}_onFrame(){let{onStart:e,onChange:t,onRest:r}=this._events,n=this._active.size>0,i=this._changed.size>0;(n&&!this._started||i&&!this._started)&&(this._started=!0,nh(e,e=>{let[t,r]=e;r.value=this.get(),t(r,this,this._item)}));let o=!n&&this._started,a=i||o&&r.size?this.get():null;i&&t.size&&nh(t,e=>{let[t,r]=e;r.value=a,t(r,this,this._item)}),o&&(this._started=!1,nh(r,e=>{let[t,r]=e;r.value=a,t(r,this,this._item)}))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}rX.onFrame(this._onFrame)}constructor(e,t){this.id=of++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start(iF({default:!0},e))}}function om(e,t){return Promise.all(t.map(t=>og(e,t))).then(t=>iZ(e,t))}async function og(e,t,r){let{keys:n,to:i,from:o,loop:a,onRest:s,onResolve:l}=t,c=na.obj(t.default)&&t.default;a&&(t.loop=!1),!1===i&&(t.to=null),!1===o&&(t.from=null);let u=na.arr(i)||na.fun(i)?i:void 0;u?(t.to=void 0,t.onRest=void 0,c&&(c.onRest=void 0)):nl(oA,r=>{let n=t[r];if(na.fun(n)){let i=e._events[r];t[r]=e=>{let{finished:t,cancelled:r}=e,o=i.get(n);o?(t||(o.finished=!1),r&&(o.cancelled=!0)):i.set(n,{value:null,finished:t||!1,cancelled:r||!1})},c&&(c[r]=t[r])}});let h=e._state;!h.paused===t.pause?(h.paused=t.pause,nd(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);let d=(n||Object.keys(e.springs)).map(r=>e.springs[r].start(t)),A=!0===t.cancel||!0===ik(t,"cancel");(u||A&&h.asyncId)&&d.push(iX(++e._lastAsyncId,{props:t,state:h,actions:{pause:ni,resume:ni,start(t,r){A?(i3(h,e._lastAsyncId),r(i1(e))):(t.onRest=s,r(i2(u,t,h,e)))}}})),h.paused&&await new Promise(e=>{h.resumeQueue.add(e)});let f=iZ(e,await Promise.all(d));if(a&&f.finished&&!(r&&f.noop)){let r=os(t,a,i);if(r)return ow(e,[r]),og(e,r,!0)}return l&&rX.batchedUpdates(()=>l(f,e,e.item)),f}function ov(e,t){let r=iF({},e.springs);return t&&nl(nu(t),e=>{na.und(e.keys)&&(e=ol(e)),na.obj(e.to)||(e=iF({},e,{to:void 0})),oC(r,e,e=>oE(e))}),oy(e,r),r}function oy(e,t){nc(t,(t,r)=>{e.springs[r]||(e.springs[r]=t,n1(t,e))})}function oE(e,t){let r=new oo;return r.key=e,t&&n1(r,t),r}function oC(e,t,r){t.keys&&nl(t.keys,n=>{(e[n]||(e[n]=r(n)))._prepareNode(t)})}function ow(e,t){nl(t,t=>{oC(e.springs,t,t=>oE(t,e))})}let oB=["children"],ox=e=>{let{children:t}=e,r=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,oB),n=(0,eT.useContext)(oI),i=r.pause||!!n.pause,o=r.immediate||!!n.immediate;r=function(e,t){let[r]=(0,eT.useState)(()=>({inputs:t,result:e()})),n=(0,eT.useRef)(),i=n.current,o=i;return o?t&&o.inputs&&function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(t,o.inputs)||(o={inputs:t,result:e()}):o=r,(0,eT.useEffect)(()=>{n.current=o,i==r&&(r.inputs=r.result=void 0)},[o]),o.result}(()=>({pause:i,immediate:o}),[i,o]);let{Provider:a}=oI;return eT.createElement(a,{value:r},t)},oI=(Object.assign(ox,eT.createContext({})),ox.Provider._context=ox,ox.Consumer._context=ox,ox);ox.Provider=oI.Provider,ox.Consumer=oI.Consumer;let ob=()=>{let e=[],t=function(t){is("".concat(ii,'Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions'));let n=[];return nl(e,(e,i)=>{if(na.und(t))n.push(e.start());else{let o=r(t,e,i);o&&n.push(e.start(o))}}),n};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){let r=e.indexOf(t);~r&&e.splice(r,1)},t.pause=function(){return nl(e,e=>e.pause(...arguments)),this},t.resume=function(){return nl(e,e=>e.resume(...arguments)),this},t.set=function(t){nl(e,e=>e.set(t))},t.start=function(t){let r=[];return nl(e,(e,n)=>{if(na.und(t))r.push(e.start());else{let i=this._getProps(t,e,n);i&&r.push(e.start(i))}}),r},t.stop=function(){return nl(e,e=>e.stop(...arguments)),this},t.update=function(t){return nl(e,(e,r)=>e.update(this._getProps(t,e,r))),this};let r=function(e,t,r){return na.fun(e)?e(r,t):e};return t._getProps=r,t};(K=a||(a={})).MOUNT="mount",K.ENTER="enter",K.UPDATE="update",K.LEAVE="leave";class o_ extends i8{advance(e){let t=this._get();ns(t,this.get())||(iv(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&oS(this._active)&&oT(this)}_get(){let e=na.arr(this.source)?this.source.map(nK):nu(nK(this.source));return this.calc(...e)}_start(){this.idle&&!oS(this._active)&&(this.idle=!1,nl(iE(this),e=>{e.done=!1}),ng.skipAnimation?(rX.batchedUpdates(()=>this.advance()),oT(this)):nw.start(this))}_attach(){let e=1;nl(nu(this.source),t=>{nq(t)&&n1(t,this),i9(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){nl(nu(this.source),e=>{nq(e)&&n2(e,this)}),this._active.clear(),oT(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=nu(this.source).reduce((e,t)=>Math.max(e,(i9(t)?t.priority:0)+1),0))}constructor(e,t){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=nj(...t);let r=this._get();iy(this,iM(r).create(r))}}function oM(e){return!1!==e.idle}function oS(e){return!e.size||Array.from(e).every(oM)}function oT(e){e.idle||(e.idle=!0,nl(iE(e),e=>{e.done=!0}),nZ(e,{type:"idle",parent:e}))}ng.assign({createStringInterpolator:ir,to:(e,t)=>new o_(e,t)}),nw.advance;let oD=["primitive"].concat(Object.keys(eR).filter(e=>/^[A-Z]/.test(e)).map(e=>e[0].toLowerCase()+e.slice(1)));ng.assign({createStringInterpolator:ir,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},frameLoop:"demand"}),(0,eP.n)(()=>{rX.advance()});let oR=function(e){let{applyAnimatedValues:t=()=>!1,createAnimatedStyle:r=e=>new iI(e),getComponentProps:n=e=>e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={applyAnimatedValues:t,createAnimatedStyle:r,getComponentProps:n},o=e=>{let t=iP(e)||"Anonymous";return(e=na.str(e)?o[e]||(o[e]=iT(e,i)):e[iR]||(e[iR]=iT(e,i))).displayName="Animated(".concat(t,")"),e};return nc(e,(t,r)=>{na.arr(e)&&(r=iP(t)),o[r]=o(t)}),{animated:o}}(oD,{applyAnimatedValues:eP.j}).animated;function oP(e){let{enabled:t=!0,snap:r,global:n,domElement:i,cursor:o=!0,children:a,speed:s=1,rotation:l=[0,0,0],zoom:c=1,polar:u=[0,Math.PI/2],azimuth:h=[-1/0,1/0],config:d={mass:1,tension:170,friction:26}}=e,A=(0,eP.A)(e=>e.events),f=(0,eP.A)(e=>e.gl),p=i||A.connected||f.domElement,{size:m}=(0,eP.A)(),g=eT.useMemo(()=>[l[0]+u[0],l[0]+u[1]],[l[0],u[0],u[1]]),v=eT.useMemo(()=>[l[1]+h[0],l[1]+h[1]],[l[1],h[0],h[1]]),y=eT.useMemo(()=>[eR.MathUtils.clamp(l[0],...g),eR.MathUtils.clamp(l[1],...v),l[2]],[l[0],l[1],l[2],g,v]),[E,C]=function(e,t){let r=na.fun(e),[[n],i]=function(e,t,r){let n=na.fun(t)&&t;n&&!r&&(r=[]);let i=(0,eT.useMemo)(()=>n||3==arguments.length?ob():void 0,[]),o=(0,eT.useRef)(0),a=ih(),s=(0,eT.useMemo)(()=>({ctrls:[],queue:[],flush(e,t){let r=ov(e,t);return!(o.current>0)||s.queue.length||Object.keys(r).some(t=>!e.springs[t])?new Promise(n=>{oy(e,r),s.queue.push(()=>{n(om(e,t))}),a()}):om(e,t)}}),[]),l=(0,eT.useRef)([...s.ctrls]),c=[],u=ip(e)||0;function h(e,r){for(let i=e;i<r;i++){let e=l.current[i]||(l.current[i]=new op(null,s.flush)),r=n?n(i,e):t[i];r&&(c[i]=function(e){let t=ol(e);return na.und(t.default)&&(t.default=iG(t)),t}(r))}}(0,eT.useMemo)(()=>{nl(l.current.slice(e,u),e=>{var t;null==(t=e.ref)||t.delete(e),null==i||i.delete(e),e.stop(!0)}),l.current.length=e,h(u,e)},[e]),(0,eT.useMemo)(()=>{h(0,Math.min(u,e))},r);let d=l.current.map((e,t)=>ov(e,c[t])),A=(0,eT.useContext)(ox),f=ip(A),p=A!==f&&function(e){for(let t in e)return!0;return!1}(A);ic(()=>{o.current++,s.ctrls=l.current;let{queue:e}=s;e.length&&(s.queue=[],nl(e,e=>e())),nl(l.current,(e,t)=>{null==i||i.add(e),p&&e.start({default:A});let r=c[t];r&&(function(e,t){if(t&&e.ref!==t){var r;null==(r=e.ref)||r.delete(e),t.add(e),e.ref=t}}(e,r.ref),e.ref?e.queue.push(r):e.start(r))})}),id(()=>()=>{nl(s.ctrls,e=>e.stop(!0))});let m=d.map(e=>iF({},e));return i?[m,i]:m}(1,r?e:[e],r?t||[]:t);return r||2==arguments.length?[n,i]:n}(()=>({scale:1,rotation:y,config:d}));eT.useEffect(()=>void C.start({scale:1,rotation:y,config:d}),[y]),eT.useEffect(()=>{if(n&&o&&t)return p.style.cursor="grab",f.domElement.style.cursor="",()=>{p.style.cursor="default",f.domElement.style.cursor="default"}},[n,o,p,t]);let w=tK({onHover:e=>{let{last:r}=e;o&&!n&&t&&(p.style.cursor=r?"auto":"grab")},onDrag:e=>{let{down:n,delta:[i,a],memo:[l,u]=E.rotation.animation.to||y}=e;if(!t)return[a,i];o&&(p.style.cursor=n?"grabbing":"grab"),i=eR.MathUtils.clamp(u+i/m.width*Math.PI*s,...v),a=eR.MathUtils.clamp(l+a/m.height*Math.PI*s,...g);let h=r&&!n&&"boolean"!=typeof r?r:d;return C.start({scale:n&&a>g[1]/2?c:1,rotation:r&&!n?y:[a,i,0],config:e=>"scale"===e?{...h,friction:3*h.friction}:h}),[a,i]}},{target:n?p:void 0});return eT.createElement(oR.group,(0,eS.Z)({},null==w?void 0:w(),E),a)}Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let oF=e=>(t,r,n)=>{let i=n.subscribe;return n.subscribe=(e,t,r)=>{let o=e;if(t){let i=(null==r?void 0:r.equalityFn)||Object.is,a=e(n.getState());o=r=>{let n=e(r);if(!i(a,n)){let e=a;t(a=n,e)}},(null==r?void 0:r.fireImmediately)&&t(a,a)}return i(o)},e(t,r,n)};Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let oQ=eT.createContext(null);function oO(e){let{map:t,children:r,onChange:n,domElement:i}=e,o=t.map(e=>e.name+e.keys).join("-"),a=eT.useMemo(()=>(0,eJ.Z)(oF(()=>t.reduce((e,t)=>({...e,[t.name]:!1}),{}))),[o]),s=eT.useMemo(()=>[a.subscribe,a.getState,a],[o]),l=a.setState;return eT.useEffect(()=>{let e=t.map(e=>{let{name:t,keys:r,up:i}=e;return{keys:r,up:i,fn:e=>{l({[t]:e}),n&&n(t,e,s[1]())}}}).reduce((e,t)=>{let{keys:r,fn:n,up:i=!0}=t;return r.forEach(t=>e[t]={fn:n,pressed:!1,up:i}),e},{}),r=t=>{let{key:r,code:n}=t,i=e[r]||e[n];if(!i)return;let{fn:o,pressed:a,up:s}=i;i.pressed=!0,(s||!a)&&o(!0)},o=t=>{let{key:r,code:n}=t,i=e[r]||e[n];if(!i)return;let{fn:o,up:a}=i;i.pressed=!1,a&&o(!1)},a=i||window;return a.addEventListener("keydown",r,{passive:!0}),a.addEventListener("keyup",o,{passive:!0}),()=>{a.removeEventListener("keydown",r),a.removeEventListener("keyup",o)}},[i,o]),eT.createElement(oQ.Provider,{value:s,children:r})}function oL(e){let[t,r,n]=eT.useContext(oQ);return e?n(e):[t,r]}let ok=new eR.Frustum,oU=new eR.Vector3,oG=new eR.Vector3,oN=new eR.Vector3,oz=new eR.Vector3,oH=new eR.Vector3,oV=new eR.Vector3,oj=new eR.Vector3,oJ=new eR.Vector3,oY=new eR.Vector3,oW=new eR.Vector3,oq=new eR.Vector3,oK=new eR.Vector3,oX=new eR.Vector3,oZ=new eR.Vector3;class o${select(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(ok,this.scene),this.collection}updateFrustum(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){oG.copy(e),oG.x=Math.min(e.x,t.x),oG.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),oN.setFromMatrixPosition(this.camera.matrixWorld),oz.copy(oG),oH.set(t.x,oG.y,0),oV.copy(t),oj.set(oG.x,t.y,0),oz.unproject(this.camera),oH.unproject(this.camera),oV.unproject(this.camera),oj.unproject(this.camera),oK.copy(oz).sub(oN),oX.copy(oH).sub(oN),oZ.copy(oV).sub(oN),oK.normalize(),oX.normalize(),oZ.normalize(),oK.multiplyScalar(this.deep),oX.multiplyScalar(this.deep),oZ.multiplyScalar(this.deep),oK.add(oN),oX.add(oN),oZ.add(oN);var r=ok.planes;r[0].setFromCoplanarPoints(oN,oz,oH),r[1].setFromCoplanarPoints(oN,oH,oV),r[2].setFromCoplanarPoints(oV,oj,oN),r[3].setFromCoplanarPoints(oj,oz,oN),r[4].setFromCoplanarPoints(oH,oV,oj),r[5].setFromCoplanarPoints(oZ,oX,oK),r[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){let n=Math.min(e.x,t.x),i=Math.max(e.y,t.y),o=Math.max(e.x,t.x),a=Math.min(e.y,t.y);oz.set(n,i,-1),oH.set(o,i,-1),oV.set(o,a,-1),oj.set(n,a,-1),oJ.set(n,i,1),oY.set(o,i,1),oW.set(o,a,1),oq.set(n,a,1),oz.unproject(this.camera),oH.unproject(this.camera),oV.unproject(this.camera),oj.unproject(this.camera),oJ.unproject(this.camera),oY.unproject(this.camera),oW.unproject(this.camera),oq.unproject(this.camera);var r=ok.planes;r[0].setFromCoplanarPoints(oz,oJ,oY),r[1].setFromCoplanarPoints(oH,oY,oW),r[2].setFromCoplanarPoints(oW,oq,oj),r[3].setFromCoplanarPoints(oq,oJ,oz),r[4].setFromCoplanarPoints(oH,oV,oj),r[5].setFromCoplanarPoints(oW,oY,oJ),r[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,t){if((t.isMesh||t.isLine||t.isPoints)&&void 0!==t.material&&(null===t.geometry.boundingSphere&&t.geometry.computeBoundingSphere(),oU.copy(t.geometry.boundingSphere.center),oU.applyMatrix4(t.matrixWorld),e.containsPoint(oU)&&this.collection.push(t)),t.children.length>0)for(let r=0;r<t.children.length;r++)this.searchChildInFrustum(e,t.children[r])}constructor(e,t,r){this.camera=e,this.scene=t,this.startPoint=new eR.Vector3,this.endPoint=new eR.Vector3,this.collection=[],this.deep=r||Number.MAX_VALUE}}let o0=eT.createContext([]);function o1(e){let{box:t,multiple:r,children:n,onChange:i,onChangePointerUp:o,border:a="1px solid #55aaff",backgroundColor:s="rgba(75, 160, 255, 0.1)",filter:l=e=>e,...c}=e,[u,h]=eT.useState(!1),{setEvents:d,camera:A,raycaster:f,gl:p,controls:m,size:g,get:v}=(0,eP.A)(),[y,E]=eT.useState(!1),[C,w]=eT.useReducer((e,t)=>{let{object:r,shift:n}=t;return void 0===r?[]:Array.isArray(r)?r:n?e.includes(r)?e.filter(e=>e!==r):[r,...e]:e[0]===r?[]:[r]},[]);eT.useEffect(()=>{u?null==i||i(C):null==o||o(C)},[C,u]);let B=eT.useCallback(e=>{e.stopPropagation(),w({object:l([e.object])[0],shift:r&&e.shiftKey})},[]),x=eT.useCallback(e=>!y&&w({}),[y]),I=eT.useRef(null);return eT.useEffect(()=>{if(!t||!r)return;let e=new o$(A,I.current),n=document.createElement("div");n.style.pointerEvents="none",n.style.border=a,n.style.backgroundColor=s,n.style.position="fixed";let i=new eR.Vector2,o=new eR.Vector2,c=new eR.Vector2,u=v().events.enabled,f=null==m?void 0:m.enabled,y=!1;function E(e,t){let{offsetX:r,offsetY:n}=e,{width:i,height:o}=g;t.set(r/i*2-1,-(n/o*2)+1)}function C(t){if(t.shiftKey){var r;m&&(m.enabled=!1),d({enabled:!1}),h(y=!0),null==(r=p.domElement.parentElement)||r.appendChild(n),n.style.left="".concat(t.clientX,"px"),n.style.top="".concat(t.clientY,"px"),n.style.width="0px",n.style.height="0px",i.x=t.clientX,i.y=t.clientY,E(t,e.startPoint)}}let B=[];function x(t){if(y){c.x=Math.max(i.x,t.clientX),c.y=Math.max(i.y,t.clientY),o.x=Math.min(i.x,t.clientX),o.y=Math.min(i.y,t.clientY),n.style.left="".concat(o.x,"px"),n.style.top="".concat(o.y,"px"),n.style.width="".concat(c.x-o.x,"px"),n.style.height="".concat(c.y-o.y,"px"),E(t,e.endPoint);let r=e.select().sort(e=>e.uuid).filter(e=>e.isMesh);!function(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;let r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!Object.is(e[r[n]],t[r[n]]))return!1;return!0}(r,B)&&(B=r,w({object:l(r)}))}}function b(e){y&&function(){if(y){var e;m&&(m.enabled=f),d({enabled:u}),h(y=!1),null==(e=n.parentElement)||e.removeChild(n)}}()}return document.addEventListener("pointerdown",C,{passive:!0}),document.addEventListener("pointermove",x,{passive:!0,capture:!0}),document.addEventListener("pointerup",b,{passive:!0}),()=>{document.removeEventListener("pointerdown",C),document.removeEventListener("pointermove",x,!0),document.removeEventListener("pointerup",b)}},[g.width,g.height,f,A,m,p]),eT.createElement("group",(0,eS.Z)({ref:I,onClick:B,onPointerOver:()=>E(!0),onPointerOut:()=>E(!1),onPointerMissed:x},c),eT.createElement(o0.Provider,{value:C},n))}function o2(){return eT.useContext(o0)}let o3=eT.forwardRef(function(e,t){let{children:r,follow:n=!0,lockX:i=!1,lockY:o=!1,lockZ:a=!1,...s}=e,l=eT.useRef(null),c=eT.useRef(null),u=new eR.Quaternion;return(0,eP.C)(e=>{let{camera:t}=e;if(!n||!c.current)return;let r=c.current.rotation.clone();c.current.updateMatrix(),c.current.updateWorldMatrix(!1,!1),c.current.getWorldQuaternion(u),t.getWorldQuaternion(l.current.quaternion).premultiply(u.invert()),i&&(c.current.rotation.x=r.x),o&&(c.current.rotation.y=r.y),a&&(c.current.rotation.z=r.z)}),eT.useImperativeHandle(t,()=>c.current,[]),eT.createElement("group",(0,eS.Z)({ref:c,matrixAutoUpdate:!1,matrixWorldAutoUpdate:!1},s),eT.createElement("group",{ref:l},r))}),o4=eT.forwardRef((e,t)=>{let{children:r,depth:n=-1,...i}=e,o=eT.useRef(null);return eT.useImperativeHandle(t,()=>o.current,[]),(0,eP.C)(e=>{let{camera:t}=e;o.current.quaternion.copy(t.quaternion),o.current.position.copy(t.position)}),eT.createElement("group",(0,eS.Z)({ref:o},i),eT.createElement("group",{"position-z":-n},r))}),o5=new eR.Vector3,o9=new eR.Vector3,o6=new eR.Vector3,o8=(e,t,r)=>{let n=r.width/2,i=r.height/2;t.updateMatrixWorld(!1);let o=e.project(t);return o.x=o.x*n+n,o.y=-(o.y*i)+i,o},o7=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=o5.set(e.x/r.width*2-1,-(e.y/r.height*2)+1,n);return i.unproject(t),i},ae=(e,t,r,n)=>{let i=o8(o6.copy(e),r,n),o=0;for(let a=0;a<2;++a){let s=o9.copy(i).setComponent(a,i.getComponent(a)+t),l=o7(s,r,n,s.z);o=Math.max(o,e.distanceTo(l))}return o},at=new eR.Vector3,ar=(0,eT.forwardRef)((e,t)=>{let{scale:r=1,...n}=e,i=(0,eT.useRef)(null);return eT.useImperativeHandle(t,()=>i.current,[]),(0,eP.C)(e=>{let t=i.current;if(!t)return;let n=ae(t.getWorldPosition(at),r,e.camera,e.size);t.scale.setScalar(n*r)}),eT.createElement("object3D",(0,eS.Z)({ref:i},n))});var an=r(8323);let ai=new eR.Vector3,ao=eT.forwardRef(function(e,t){let{start:r=[0,0,0],end:n=[0,0,0],mid:i,segments:o=20,...a}=e,s=eT.useRef(null);eT.useImperativeHandle(t,()=>s.current);let[l]=eT.useState(()=>new eR.QuadraticBezierCurve3(void 0,void 0,void 0)),c=eT.useCallback(function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20;return e instanceof eR.Vector3?l.v0.copy(e):l.v0.set(...e),t instanceof eR.Vector3?l.v2.copy(t):l.v2.set(...t),r instanceof eR.Vector3?l.v1.copy(r):Array.isArray(r)?l.v1.set(...r):l.v1.copy(l.v0.clone().add(l.v2.clone().sub(l.v0)).add(ai.set(0,l.v0.y-l.v2.y,0))),l.getPoints(n)},[]);eT.useLayoutEffect(()=>{s.current.setPoints=(e,t,r)=>{let n=c(e,t,r);s.current.geometry&&s.current.geometry.setPositions(n.map(e=>e.toArray()).flat())}},[]);let u=eT.useMemo(()=>c(r,n,i,o),[r,n,i,o]);return eT.createElement(an.x,(0,eS.Z)({ref:s,points:u},a))}),aa=eT.forwardRef(function(e,t){let{start:r,end:n,midA:i,midB:o,segments:a=20,...s}=e,l=eT.useMemo(()=>{let e=r instanceof eR.Vector3?r:new eR.Vector3(...r),t=n instanceof eR.Vector3?n:new eR.Vector3(...n),s=i instanceof eR.Vector3?i:new eR.Vector3(...i),l=o instanceof eR.Vector3?o:new eR.Vector3(...o);return new eR.CubicBezierCurve3(e,s,l,t).getPoints(a)},[r,n,i,o,a]);return eT.createElement(an.x,(0,eS.Z)({ref:t,points:l},s))}),as=eT.forwardRef(function(e,t){let{points:r,closed:n=!1,curveType:i="centripetal",tension:o=.5,segments:a=20,vertexColors:s,...l}=e,c=eT.useMemo(()=>{let e=r.map(e=>e instanceof eR.Vector3?e:new eR.Vector3(...e));return new eR.CatmullRomCurve3(e,n,i,o)},[r,n,i,o]),u=eT.useMemo(()=>c.getPoints(a),[c,a]),h=eT.useMemo(()=>{if(!s||s.length<2)return;if(s.length===a+1)return s;let e=s.map(e=>e instanceof eR.Color?e:new eR.Color(...e));n&&e.push(e[0].clone());let t=[e[0]],r=a/(e.length-1);for(let n=1;n<a;n++){let i=n%r/r,o=Math.floor(n/r);t.push(e[o].clone().lerp(e[o+1],i))}return t.push(e[e.length-1]),t},[s,a]);return eT.createElement(an.x,(0,eS.Z)({ref:t,points:u,vertexColors:h},l))}),al=eT.forwardRef((e,t)=>{let{url:r,distance:n=1,loop:i=!0,autoplay:o,...a}=e,s=eT.useRef(null);eT.useImperativeHandle(t,()=>s.current,[]);let l=(0,eP.A)(e=>{let{camera:t}=e;return t}),[c]=eT.useState(()=>new eR.AudioListener),u=(0,eP.F)(eR.AudioLoader,r);return eT.useEffect(()=>{let e=s.current;e&&(e.setBuffer(u),e.setRefDistance(n),e.setLoop(i),o&&!e.isPlaying&&e.play())},[u,l,n,i]),eT.useEffect(()=>{let e=s.current;return l.add(c),()=>{l.remove(c),e&&(e.isPlaying&&e.stop(),e.source&&e.source._connected&&e.disconnect())}},[]),eT.createElement("positionalAudio",(0,eS.Z)({ref:s,args:[c]},a))});var ac=r(589),au=r(5736);let ah=eT.forwardRef((e,t)=>{let{sdfGlyphSize:r=64,anchorX:n="center",anchorY:i="middle",font:o,fontSize:a=1,children:s,characters:l,onSync:c,...u}=e,h=(0,eP.A)(e=>{let{invalidate:t}=e;return t}),[d]=eT.useState(()=>new ac.xv),[A,f]=eT.useMemo(()=>{let e=[],t="";return eT.Children.forEach(s,r=>{"string"==typeof r||"number"==typeof r?t+=r:e.push(r)}),[e,t]},[s]);return(0,au.Rq)(()=>new Promise(e=>(0,ac.C5)({font:o,characters:l},e)),["troika-text",o,l]),eT.useLayoutEffect(()=>void d.sync(()=>{h(),c&&c(d)})),eT.useEffect(()=>()=>d.dispose(),[d]),eT.createElement("primitive",(0,eS.Z)({object:d,ref:t,font:o,text:f,anchorX:n,anchorY:i,fontSize:a,sdfGlyphSize:r},u),A)});class ad extends eR.ExtrudeGeometry{constructor(e,t={}){let{bevelEnabled:r=!1,bevelSize:n=8,bevelThickness:i=10,font:o,height:a=50,size:s=100,lineHeight:l=1,letterSpacing:c=0,...u}=t;void 0===o?super():super(o.generateShapes(e,s,{lineHeight:l,letterSpacing:c}),{...u,bevelEnabled:r,bevelSize:n,bevelThickness:i,depth:a}),this.type="TextGeometry"}}function aA(e,t){if(t===eR.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==eR.TriangleFanDrawMode&&t!==eR.TriangleStripDrawMode)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let n=r.count-2,i=[];if(r){if(t===eR.TriangleFanDrawMode)for(let e=1;e<=n;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)))}i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let o=e.clone();return o.setIndex(i),o.clearGroups(),o}}function af(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI/3,r=Math.cos(t),n=(1+1e-10)*100,i=[new eR.Vector3,new eR.Vector3,new eR.Vector3],o=new eR.Vector3,a=new eR.Vector3,s=new eR.Vector3,l=new eR.Vector3;function c(e){let t=~~(e.x*n),r=~~(e.y*n),i=~~(e.z*n);return"".concat(t,",").concat(r,",").concat(i)}let u=e.index?e.toNonIndexed():e,h=u.attributes.position,d={};for(let e=0,t=h.count/3;e<t;e++){let t=3*e,r=i[0].fromBufferAttribute(h,t+0),n=i[1].fromBufferAttribute(h,t+1),s=i[2].fromBufferAttribute(h,t+2);o.subVectors(s,n),a.subVectors(r,n);let l=new eR.Vector3().crossVectors(o,a).normalize();for(let e=0;e<3;e++){let t=c(i[e]);t in d||(d[t]=[]),d[t].push(l)}}let A=new Float32Array(3*h.count),f=new eR.BufferAttribute(A,3,!1);for(let e=0,t=h.count/3;e<t;e++){let t=3*e,n=i[0].fromBufferAttribute(h,t+0),u=i[1].fromBufferAttribute(h,t+1),A=i[2].fromBufferAttribute(h,t+2);o.subVectors(A,u),a.subVectors(n,u),s.crossVectors(o,a).normalize();for(let e=0;e<3;e++){let n=d[c(i[e])];l.set(0,0,0);for(let e=0,t=n.length;e<t;e++){let t=n[e];s.dot(t)>r&&l.add(t)}l.normalize(),f.setXYZ(t+e,l.x,l.y,l.z)}}return u.setAttribute("normal",f),u}var ap=Object.defineProperty,am=(e,t,r)=>t in e?ap(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ag=(e,t,r)=>(am(e,"symbol"!=typeof t?t+"":t,r),r);class av extends eR.Loader{load(e,t,r,n){let i=new eR.FileLoader(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,e=>{if("string"!=typeof e)throw Error("unsupported data type");let r=JSON.parse(e),n=this.parse(r);t&&t(n)},r,n)}loadAsync(e,t){return super.loadAsync(e,t)}parse(e){return new ay(e)}constructor(e){super(e)}}class ay{generateShapes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=arguments.length>2?arguments[2]:void 0,n=[],i={letterSpacing:0,lineHeight:1,...r},o=function(e,t,r,n){let i=Array.from(e),o=t/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,s=[],l=0,c=0;for(let e=0;e<i.length;e++){let t=i[e];if("\n"===t)l=0,c-=a*n.lineHeight;else{let e=function(e,t,r,n,i){let o,a,s,l,c,u,h,d;let A=i.glyphs[e]||i.glyphs["?"];if(!A){console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".");return}let f=new eR.ShapePath;if(A.o){let e=A._cachedOutline||(A._cachedOutline=A.o.split(" "));for(let i=0,A=e.length;i<A;)switch(e[i++]){case"m":o=parseInt(e[i++])*t+r,a=parseInt(e[i++])*t+n,f.moveTo(o,a);break;case"l":o=parseInt(e[i++])*t+r,a=parseInt(e[i++])*t+n,f.lineTo(o,a);break;case"q":s=parseInt(e[i++])*t+r,l=parseInt(e[i++])*t+n,c=parseInt(e[i++])*t+r,u=parseInt(e[i++])*t+n,f.quadraticCurveTo(c,u,s,l);break;case"b":s=parseInt(e[i++])*t+r,l=parseInt(e[i++])*t+n,c=parseInt(e[i++])*t+r,u=parseInt(e[i++])*t+n,h=parseInt(e[i++])*t+r,d=parseInt(e[i++])*t+n,f.bezierCurveTo(c,u,h,d,s,l)}}return{offsetX:A.ha*t,path:f}}(t,o,l,c,r);e&&(l+=e.offsetX+n.letterSpacing,s.push(e.path))}}return s}(e,t,this.data,i);for(let e=0,t=o.length;e<t;e++)Array.prototype.push.apply(n,o[e].toShapes(!1));return n}constructor(e){ag(this,"data"),this.data=e}}ag(ay,"isFont"),ag(ay,"type");let aE=null;async function aC(e){return"string"==typeof e?await (await fetch(e)).json():e}async function aw(e){var t;return t=await aC(e),aE||(aE=new av),aE.parse(t)}function aB(e){return(0,au.Rq)(aw,[e])}aB.preload=e=>(0,au.MA)(aw,[e]),aB.clear=e=>(0,au.ZH)([e]);let ax=["string","number"],aI=e=>{let t="",r=[];return eT.Children.forEach(e,e=>{ax.includes(typeof e)?t+=e+"":r.push(e)}),[t,...r]},ab=eT.forwardRef((e,t)=>{let{font:r,letterSpacing:n=0,lineHeight:i=1,size:o=1,height:a=.2,bevelThickness:s=.1,bevelSize:l=.01,bevelEnabled:c=!1,bevelOffset:u=0,bevelSegments:h=4,curveSegments:d=8,smooth:A,children:f,...p}=e;eT.useMemo(()=>(0,eP.e)({RenamedTextGeometry:ad}),[]);let m=eT.useRef(null),g=aB(r),v=(0,eT.useMemo)(()=>({font:g,size:o,height:a,bevelThickness:s,bevelSize:l,bevelEnabled:c,bevelSegments:h,bevelOffset:u,curveSegments:d,letterSpacing:n,lineHeight:i}),[g,o,a,s,l,c,h,u,d,n,i]),[y,...E]=(0,eT.useMemo)(()=>aI(f),[f]),C=eT.useMemo(()=>[y,v],[y,v]);return eT.useLayoutEffect(()=>{A&&(m.current.geometry=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);let r={},n=e.getIndex(),i=e.getAttribute("position"),o=n?n.count:i.count,a=0,s=Object.keys(e.attributes),l={},c={},u=[],h=["getX","getY","getZ","getW"];for(let t=0,r=s.length;t<r;t++){let r=s[t];l[r]=[];let n=e.morphAttributes[r];n&&(c[r]=Array(n.length).fill(0).map(()=>[]))}let d=Math.pow(10,Math.log10(1/t));for(let t=0;t<o;t++){let i=n?n.getX(t):t,o="";for(let t=0,r=s.length;t<r;t++){let r=s[t],n=e.getAttribute(r),a=n.itemSize;for(let e=0;e<a;e++)o+="".concat(~~(n[h[e]](i)*d),",")}if(o in r)u.push(r[o]);else{for(let t=0,r=s.length;t<r;t++){let r=s[t],n=e.getAttribute(r),o=e.morphAttributes[r],a=n.itemSize,u=l[r],d=c[r];for(let e=0;e<a;e++){let t=h[e];if(u.push(n[t](i)),o)for(let e=0,r=o.length;e<r;e++)d[e].push(o[e][t](i))}}r[o]=a,u.push(a),a++}}let A=e.clone();for(let t=0,r=s.length;t<r;t++){let r=s[t],n=e.getAttribute(r),i=new n.array.constructor(l[r]),o=new eR.BufferAttribute(i,n.itemSize,n.normalized);if(A.setAttribute(r,o),r in c)for(let t=0;t<c[r].length;t++){let n=e.morphAttributes[r][t],i=new n.array.constructor(c[r][t]),o=new eR.BufferAttribute(i,n.itemSize,n.normalized);A.morphAttributes[r][t]=o}}return A.setIndex(u),A}(m.current.geometry,A),m.current.geometry.computeVertexNormals())},[C,A]),eT.useImperativeHandle(t,()=>m.current,[]),eT.createElement("mesh",(0,eS.Z)({},p,{ref:m}),eT.createElement("renamedTextGeometry",{args:C}),E)}),a_={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\n	vUv = uv;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texel = texture2D( tDiffuse, vUv );\n	gl_FragColor = opacity * texel;\n}"};var aM=Object.defineProperty,aS=(e,t,r)=>t in e?aM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aT=(e,t,r)=>(aS(e,"symbol"!=typeof t?t+"":t,r),r);class aD{setSize(e,t){}render(e,t,r,n,i){console.error("THREE.Pass: .render() must be implemented in derived pass.")}constructor(){aT(this,"enabled",!0),aT(this,"needsSwap",!0),aT(this,"clear",!1),aT(this,"renderToScreen",!1)}}class aR{get material(){return this.mesh.material}set material(e){this.mesh.material=e}dispose(){this.mesh.geometry.dispose()}render(e){e.render(this.mesh,this.camera)}constructor(e){aT(this,"camera",new eR.OrthographicCamera(-1,1,1,-1,0,1)),aT(this,"geometry",new eR.PlaneGeometry(2,2)),aT(this,"mesh"),this.mesh=new eR.Mesh(this.geometry,e)}}var aP=Object.defineProperty,aF=(e,t,r)=>t in e?aP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aQ=(e,t,r)=>(aF(e,"symbol"!=typeof t?t+"":t,r),r);class aO extends aD{render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}constructor(e,t="tDiffuse"){super(),aQ(this,"textureID"),aQ(this,"uniforms"),aQ(this,"material"),aQ(this,"fsQuad"),this.textureID=t,e instanceof eR.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):(this.uniforms=eR.UniformsUtils.clone(e.uniforms),this.material=new eR.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new aR(this.material)}}var aL=Object.defineProperty,ak=(e,t,r)=>t in e?aL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aU=(e,t,r)=>(ak(e,"symbol"!=typeof t?t+"":t,r),r);class aG extends aD{render(e,t,r){let n,i;let o=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(n=0,i=1):(n=1,i=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),a.buffers.stencil.setFunc(o.ALWAYS,n,4294967295),a.buffers.stencil.setClear(i),a.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(o.EQUAL,1,4294967295),a.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),a.buffers.stencil.setLocked(!0)}constructor(e,t){super(),aU(this,"scene"),aU(this,"camera"),aU(this,"inverse"),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}}class aN extends aD{render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}constructor(){super(),this.needsSwap=!1}}var az=Object.defineProperty,aH=(e,t,r)=>t in e?az(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aV=(e,t,r)=>(aH(e,"symbol"!=typeof t?t+"":t,r),r);class aj{swapBuffers(){let e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){let t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());let t=this.renderer.getRenderTarget(),r=!1,n=this.passes.length;for(let t=0;t<n;t++){let n=this.passes[t];if(!1!==n.enabled){if(n.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),n.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),n.needsSwap){if(r){let t=this.renderer.getContext(),r=this.renderer.state.buffers.stencil;r.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),r.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==aG&&(n instanceof aG?r=!0:n instanceof aN&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){let t=this.renderer.getSize(new eR.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;let r=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(r,n),this.renderTarget2.setSize(r,n);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(r,n)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}constructor(e,t){if(aV(this,"renderer"),aV(this,"_pixelRatio"),aV(this,"_width"),aV(this,"_height"),aV(this,"renderTarget1"),aV(this,"renderTarget2"),aV(this,"writeBuffer"),aV(this,"readBuffer"),aV(this,"renderToScreen"),aV(this,"passes",[]),aV(this,"copyPass"),aV(this,"clock"),this.renderer=e,void 0===t){let r={minFilter:eR.LinearFilter,magFilter:eR.LinearFilter,format:eR.RGBAFormat},n=e.getSize(new eR.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new eR.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,r)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,void 0===a_&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===aO&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new aO(a_),this.copyPass.material.blending=eR.NoBlending,this.clock=new eR.Clock}}var aJ=Object.defineProperty,aY=(e,t,r)=>t in e?aJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,aW=(e,t,r)=>(aY(e,"symbol"!=typeof t?t+"":t,r),r);class aq extends aD{render(e,t,r){let n,i=e.autoClear;e.autoClear=!1;let o=null;void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),n=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,n),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=i}constructor(e,t,r,n,i=0){super(),aW(this,"scene"),aW(this,"camera"),aW(this,"overrideMaterial"),aW(this,"clearColor"),aW(this,"clearAlpha"),aW(this,"clearDepth",!1),aW(this,"_oldClearColor",new eR.Color),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=n,this.clearAlpha=i,this.clear=!0,this.needsSwap=!1}}let aK={uniforms:{tDiffuse:{value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\n	vUv = uv;\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\n	vec4 tex = texture2D( tDiffuse, vUv );\n	gl_FragColor = LinearTosRGB( tex );\n}"},aX=()=>{try{var e=document.createElement("canvas");return!!(window.WebGL2RenderingContext&&e.getContext("webgl2"))}catch(e){return!1}},aZ=eT.forwardRef((e,t)=>{let{children:r,multisamping:n=8,renderIndex:i=1,disableRender:o,disableGamma:a,disableRenderPass:s,depthBuffer:l=!0,stencilBuffer:c=!1,anisotropy:u=1,encoding:h,type:d,...A}=e;eT.useMemo(()=>(0,eP.e)({EffectComposer:aj,RenderPass:aq,ShaderPass:aO}),[]);let f=eT.useRef(null);eT.useImperativeHandle(t,()=>f.current,[]);let{scene:p,camera:m,gl:g,size:v,viewport:y}=(0,eP.A)(),[E]=eT.useState(()=>{let e=new eR.WebGLRenderTarget(v.width,v.height,{type:d||eR.HalfFloatType,format:eR.RGBAFormat,depthBuffer:l,stencilBuffer:c,anisotropy:u});return d===eR.UnsignedByteType&&null!=h&&("colorSpace"in e?e.texture.colorSpace=h:e.texture.encoding=h),e.samples=n,e});eT.useEffect(()=>{var e,t;null==(e=f.current)||e.setSize(v.width,v.height),null==(t=f.current)||t.setPixelRatio(y.dpr)},[g,v,y.dpr]),(0,eP.C)(()=>{var e;o||null==(e=f.current)||e.render()},i);let C=[];return s||C.push(eT.createElement("renderPass",{key:"renderpass",attach:"passes-".concat(C.length),args:[p,m]})),a||C.push(eT.createElement("shaderPass",{attach:"passes-".concat(C.length),key:"gammapass",args:[aK]})),eT.Children.forEach(r,e=>{e&&C.push(eT.cloneElement(e,{key:C.length,attach:"passes-".concat(C.length)}))}),eT.createElement("effectComposer",(0,eS.Z)({ref:f,args:[g,E]},A),C)}),a$=((X={}).Linear="linear",X.Radial="radial",X);function a0(e){let{stops:t,colors:r,size:n=1024,width:i=16,type:o=a$.Linear,innerCircleRadius:a=0,outerCircleRadius:s="auto",...l}=e,c=(0,eP.A)(e=>e.gl),u=eT.useMemo(()=>{let e;let l=document.createElement("canvas"),c=l.getContext("2d");if(l.width=i,l.height=n,o===a$.Linear)e=c.createLinearGradient(0,0,0,n);else{let t=l.width/2,r=l.height/2,n="auto"!==s?Math.abs(Number(s)):Math.sqrt(t**2+r**2);e=c.createRadialGradient(t,r,Math.abs(a),t,r,n)}let u=new eR.Color,h=t.length;for(;h--;)e.addColorStop(t[h],u.set(r[h]).getStyle());return c.save(),c.fillStyle=e,c.fillRect(0,0,i,n),c.restore(),l},[t]);return eT.createElement("canvasTexture",(0,eS.Z)({colorSpace:c.outputColorSpace,args:[u],attach:"map"},l))}function a1(e,t,r,n){let i=class extends eR.ShaderMaterial{constructor(i={}){let o=Object.entries(e);super({uniforms:o.reduce((e,t)=>{let[r,n]=t,i=eR.UniformsUtils.clone({[r]:{value:n}});return{...e,...i}},{}),vertexShader:t,fragmentShader:r}),this.key="",o.forEach(e=>{let[t]=e;return Object.defineProperty(this,t,{get:()=>this.uniforms[t].value,set:e=>this.uniforms[t].value=e})}),Object.assign(this,i),n&&n(this)}};return i.key=eR.MathUtils.generateUUID(),i}let a2=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function a3(e,t){let r=(0,eP.A)(e=>e.gl),n=(0,eP.F)(eR.TextureLoader,a2(e)?Object.values(e):e);return(0,eT.useLayoutEffect)(()=>{null==t||t(n)},[t]),(0,eT.useEffect)(()=>{if("initTexture"in r){let e=[];Array.isArray(n)?e=n:n instanceof eR.Texture?e=[n]:a2(n)&&(e=Object.values(n)),e.forEach(e=>{e instanceof eR.Texture&&r.initTexture(e)})}},[r,n]),(0,eT.useMemo)(()=>{if(!a2(e))return n;{let t={},r=0;for(let i in e)t[i]=n[r++];return t}},[e,n])}a3.preload=e=>eP.F.preload(eR.TextureLoader,e),a3.clear=e=>eP.F.clear(eR.TextureLoader,e);let a4=e=>{let{children:t,input:r,onLoad:n}=e,i=a3(r,n);return eT.createElement(eT.Fragment,null,null==t?void 0:t(i))},a5=parseInt(eR.REVISION.replace(/\D+/g,"")),a9=a1({color:new eR.Color("white"),scale:new eR.Vector2(1,1),imageBounds:new eR.Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},"\n  varying vec2 vUv;\n  varying vec2 vPos;\n  void main() {\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n    vUv = uv;\n    vPos = position.xy;\n  }\n","\n  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n  varying vec2 vUv;\n  varying vec2 vPos;\n  uniform vec2 scale;\n  uniform vec2 imageBounds;\n  uniform float resolution;\n  uniform vec3 color;\n  uniform sampler2D map;\n  uniform float radius;\n  uniform float zoom;\n  uniform float grayscale;\n  uniform float opacity;\n  const vec3 luma = vec3(.299, 0.587, 0.114);\n  vec4 toGrayscale(vec4 color, float intensity) {\n    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n  }\n  vec2 aspect(vec2 size) {\n    return size / min(size.x, size.y);\n  }\n  \n  const float PI = 3.14159265;\n    \n  // from https://iquilezles.org/articles/distfunctions\n  float udRoundBox( vec2 p, vec2 b, float r ) {\n    return length(max(abs(p)-b+r,0.0))-r;\n  }\n\n  void main() {\n    vec2 s = aspect(scale);\n    vec2 i = aspect(imageBounds);\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 uv = vUv * s / new + offset;\n    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n\n    vec2 res = vec2(scale * resolution);\n    vec2 halfRes = 0.5 * res;\n    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n	  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n    \n    #include <tonemapping_fragment>\n    #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n  }\n")),a6=eT.forwardRef((e,t)=>{let{children:r,color:n,segments:i=1,scale:o=1,zoom:a=1,grayscale:s=0,opacity:l=1,radius:c=0,texture:u,toneMapped:h,transparent:d,side:A,...f}=e;(0,eP.e)({ImageMaterial:a9});let p=eT.useRef(null),m=(0,eP.A)(e=>e.size),g=Array.isArray(o)?[o[0],o[1]]:[o,o],v=[u.image.width,u.image.height],y=Math.max(m.width,m.height);return eT.useImperativeHandle(t,()=>p.current,[]),eT.useLayoutEffect(()=>{p.current.geometry.parameters&&p.current.material.scale.set(g[0]*p.current.geometry.parameters.width,g[1]*p.current.geometry.parameters.height)},[]),eT.createElement("mesh",(0,eS.Z)({ref:p,scale:Array.isArray(o)?[...o,1]:o},f),eT.createElement("planeGeometry",{args:[1,1,i,i]}),eT.createElement("imageMaterial",{color:n,map:u,zoom:a,grayscale:s,opacity:l,scale:g,imageBounds:v,resolution:y,radius:c,toneMapped:h,transparent:d,side:A,key:a9.key}),r)}),a8=eT.forwardRef((e,t)=>{let{url:r,...n}=e,i=a3(r);return eT.createElement(a6,(0,eS.Z)({},n,{texture:i,ref:t}))}),a7=eT.forwardRef((e,t)=>{let{url:r,...n}=e;return eT.createElement(a6,(0,eS.Z)({},n,{ref:t}))}),se=eT.forwardRef((e,t)=>{if(e.url)return eT.createElement(a8,(0,eS.Z)({},e,{ref:t}));if(e.texture)return eT.createElement(a7,(0,eS.Z)({},e,{ref:t}));throw Error("<Image /> requires a url or texture")}),st=eT.forwardRef((e,t)=>{let{threshold:r=15,geometry:n,...i}=e,o=eT.useRef(null);eT.useImperativeHandle(t,()=>o.current,[]);let a=eT.useMemo(()=>[0,0,0,1,0,0],[]),s=eT.useRef(),l=eT.useRef();return eT.useLayoutEffect(()=>{let e=o.current.parent,t=null!=n?n:null==e?void 0:e.geometry;if(!t||s.current===t&&l.current===r)return;s.current=t,l.current=r;let i=new eR.EdgesGeometry(t,r).attributes.position.array;o.current.geometry.setPositions(i),o.current.geometry.attributes.instanceStart.needsUpdate=!0,o.current.geometry.attributes.instanceEnd.needsUpdate=!0,o.current.computeLineDistances()}),eT.createElement(an.x,(0,eS.Z)({segments:!0,points:a,ref:o,raycast:()=>null},i))}),sr=a1({screenspace:!1,color:new eR.Color("black"),opacity:1,thickness:.05,size:new eR.Vector2},"#include <common>\n   #include <morphtarget_pars_vertex>\n   #include <skinning_pars_vertex>\n   uniform float thickness;\n   uniform float screenspace;\n   uniform vec2 size;\n   void main() {\n     #if defined (USE_SKINNING)\n	     #include <beginnormal_vertex>\n       #include <morphnormal_vertex>\n       #include <skinbase_vertex>\n       #include <skinnormal_vertex>\n       #include <defaultnormal_vertex>\n     #endif\n     #include <begin_vertex>\n	   #include <morphtarget_vertex>\n	   #include <skinning_vertex>\n     #include <project_vertex>\n     vec4 tNormal = vec4(normal, 0.0);\n     vec4 tPosition = vec4(transformed, 1.0);\n     #ifdef USE_INSTANCING\n       tNormal = instanceMatrix * tNormal;\n       tPosition = instanceMatrix * tPosition;\n     #endif\n     if (screenspace == 0.0) {\n       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;\n       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); \n     } else {\n       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;\n       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;\n       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;\n       clipPosition.xy += offset;\n       gl_Position = clipPosition;\n     }\n   }","uniform vec3 color;\n   uniform float opacity;\n   void main(){\n     gl_FragColor = vec4(color, opacity);\n     #include <tonemapping_fragment>\n     #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n   }"));function sn(e){let{color:t="black",opacity:r=1,transparent:n=!1,screenspace:i=!1,toneMapped:o=!0,polygonOffset:a=!1,polygonOffsetFactor:s=0,renderOrder:l=0,thickness:c=.05,angle:u=Math.PI,...h}=e,d=eT.useRef(),[A]=eT.useState(()=>new sr({side:eR.BackSide})),{gl:f}=(0,eP.A)(),p=f.getDrawingBufferSize(new eR.Vector2);eT.useMemo(()=>(0,eP.e)({OutlinesMaterial:sr}),[]);let m=eT.useRef(0),g=eT.useRef();return eT.useLayoutEffect(()=>{let e=d.current;if(!e)return;let t=e.parent;if(t&&t.geometry&&(m.current!==u||g.current!==t.geometry)){var r;m.current=u,g.current=t.geometry;let n=null==(r=e.children)?void 0:r[0];n&&(u&&n.geometry.dispose(),e.remove(n)),t.skeleton?((n=new eR.SkinnedMesh).material=A,n.bind(t.skeleton,t.bindMatrix)):t.isInstancedMesh?(n=new eR.InstancedMesh(t.geometry,A,t.count)).instanceMatrix=t.instanceMatrix:(n=new eR.Mesh).material=A,e.add(n),n.geometry=u?af(t.geometry,u):t.geometry}}),eT.useLayoutEffect(()=>{let e=d.current;if(!e)return;let u=e.children[0];u&&(u.renderOrder=l,(0,eP.j)(u.material,{transparent:n,thickness:c,color:t,opacity:r,size:p,screenspace:i,toneMapped:o,polygonOffset:a,polygonOffsetFactor:s}))}),eT.useEffect(()=>()=>{let e=d.current;if(!e)return;let t=e.children[0];t&&(u&&t.geometry.dispose(),e.remove(t))},[]),eT.createElement("group",(0,eS.Z)({ref:d},h))}var si=Object.defineProperty,so=(e,t,r)=>t in e?si(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sa=(e,t,r)=>(so(e,"symbol"!=typeof t?t+"":t,r),r);function ss(e,t,r,n,i){let o;if(e=e.subarray||e.slice?e:e.buffer,r=r.subarray||r.slice?r:r.buffer,e=t?e.subarray?e.subarray(t,i&&t+i):e.slice(t,i&&t+i):e,r.set)r.set(e,n);else for(o=0;o<e.length;o++)r[o+n]=e[o];return r}class sl extends eR.BufferGeometry{setMatrixWorld(e){this.matrixWorld=e}setPoints(e,t){var r;if(e=(r=e)instanceof Float32Array?r:r instanceof eR.BufferGeometry?r.getAttribute("position").array:r.map(e=>{let t=Array.isArray(e);return e instanceof eR.Vector3?[e.x,e.y,e.z]:e instanceof eR.Vector2?[e.x,e.y,0]:t&&3===e.length?[e[0],e[1],e[2]]:t&&2===e.length?[e[0],e[1],0]:e}).flat(),this._points=e,this.widthCallback=null!=t?t:null,this.positions=[],this.counters=[],e.length&&e[0]instanceof eR.Vector3)for(let t=0;t<e.length;t++){let r=e[t],n=t/(e.length-1);this.positions.push(r.x,r.y,r.z),this.positions.push(r.x,r.y,r.z),this.counters.push(n),this.counters.push(n)}else for(let t=0;t<e.length;t+=3){let r=t/(e.length-1);this.positions.push(e[t],e[t+1],e[t+2]),this.positions.push(e[t],e[t+1],e[t+2]),this.counters.push(r),this.counters.push(r)}this.process()}compareV3(e,t){let r=6*e,n=6*t;return this.positions[r]===this.positions[n]&&this.positions[r+1]===this.positions[n+1]&&this.positions[r+2]===this.positions[n+2]}copyV3(e){let t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]}process(){let e,t;let r=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],t=this.compareV3(0,r-1)?this.copyV3(r-2):this.copyV3(0),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);for(let n=0;n<r;n++){if(this.side.push(1),this.side.push(-1),e=this.widthCallback?this.widthCallback(n/(r-1)):1,this.width.push(e),this.width.push(e),this.uvs.push(n/(r-1),0),this.uvs.push(n/(r-1),1),n<r-1){t=this.copyV3(n),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);let e=2*n;this.indices_array.push(e,e+1,e+2),this.indices_array.push(e+2,e+1,e+3)}n>0&&(t=this.copyV3(n),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]))}t=this.compareV3(r-1,0)?this.copyV3(1):this.copyV3(r-1),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]),this._attributes&&this._attributes.position.count===this.counters.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new eR.BufferAttribute(new Float32Array(this.positions),3),previous:new eR.BufferAttribute(new Float32Array(this.previous),3),next:new eR.BufferAttribute(new Float32Array(this.next),3),side:new eR.BufferAttribute(new Float32Array(this.side),1),width:new eR.BufferAttribute(new Float32Array(this.width),1),uv:new eR.BufferAttribute(new Float32Array(this.uvs),2),index:new eR.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new eR.BufferAttribute(new Float32Array(this.counters),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()}advance(e){let{x:t,y:r,z:n}=e,i=this._attributes.position.array,o=this._attributes.previous.array,a=this._attributes.next.array,s=i.length;ss(i,0,o,0,s),ss(i,6,i,0,s-6),i[s-6]=t,i[s-5]=r,i[s-4]=n,i[s-3]=t,i[s-2]=r,i[s-1]=n,ss(i,6,a,0,s-6),a[s-6]=t,a[s-5]=r,a[s-4]=n,a[s-3]=t,a[s-2]=r,a[s-1]=n,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0}constructor(){super(),sa(this,"type","MeshLine"),sa(this,"isMeshLine",!0),sa(this,"positions",[]),sa(this,"previous",[]),sa(this,"next",[]),sa(this,"side",[]),sa(this,"width",[]),sa(this,"indices_array",[]),sa(this,"uvs",[]),sa(this,"counters",[]),sa(this,"widthCallback",null),sa(this,"_attributes"),sa(this,"_points",[]),sa(this,"points"),sa(this,"matrixWorld",new eR.Matrix4),Object.defineProperties(this,{points:{enumerable:!0,get(){return this._points},set(e){this.setPoints(e,this.widthCallback)}}})}}let sc=parseInt(eR.REVISION.replace(/\D+/g,"")),su="\n  #include <fog_pars_fragment>\n  #include <logdepthbuf_pars_fragment>\n  #include <clipping_planes_pars_fragment>\n  \n  uniform sampler2D map;\n  uniform sampler2D alphaMap;\n  uniform float useGradient;\n  uniform float useMap;\n  uniform float useAlphaMap;\n  uniform float useDash;\n  uniform float dashArray;\n  uniform float dashOffset;\n  uniform float dashRatio;\n  uniform float visibility;\n  uniform float alphaTest;\n  uniform vec2 repeat;\n  uniform vec3 gradient[2];\n  \n  varying vec2 vUV;\n  varying vec4 vColor;\n  varying float vCounters;\n  \n  void main() {\n    #include <logdepthbuf_fragment>\n    vec4 diffuseColor = vColor;\n    if (useGradient == 1.) diffuseColor = vec4(mix(gradient[0], gradient[1], vCounters), 1.0);\n    if (useMap == 1.) diffuseColor *= texture2D(map, vUV * repeat);\n    if (useAlphaMap == 1.) diffuseColor.a *= texture2D(alphaMap, vUV * repeat).a;\n    if (diffuseColor.a < alphaTest) discard;\n    if (useDash == 1.) diffuseColor.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));\n    diffuseColor.a *= step(vCounters, visibility);\n    #include <clipping_planes_fragment>\n    gl_FragColor = diffuseColor;     \n    #include <fog_fragment>\n    #include <tonemapping_fragment>\n    #include <".concat(sc>=154?"colorspace_fragment":"encodings_fragment",">\n  }\n");class sh extends eR.ShaderMaterial{copy(e){return super.copy(e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.gradient=e.gradient,this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray=e.dashArray,this.dashOffset=e.dashOffset,this.dashRatio=e.dashRatio,this.useDash=e.useDash,this.useGradient=e.useGradient,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this}constructor(e){super({uniforms:{...eR.UniformsLib.fog,lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new eR.Color(16777215)},gradient:{value:[new eR.Color(16711680),new eR.Color(65280)]},opacity:{value:1},resolution:{value:new eR.Vector2(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},useGradient:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new eR.Vector2(1,1)}},vertexShader:"\n  #include <common>\n  #include <logdepthbuf_pars_vertex>\n  #include <fog_pars_vertex>\n  #include <clipping_planes_pars_vertex>\n\n  attribute vec3 previous;\n  attribute vec3 next;\n  attribute float side;\n  attribute float width;\n  attribute float counters;\n  \n  uniform vec2 resolution;\n  uniform float lineWidth;\n  uniform vec3 color;\n  uniform float opacity;\n  uniform float sizeAttenuation;\n  \n  varying vec2 vUV;\n  varying vec4 vColor;\n  varying float vCounters;\n  \n  vec2 fix(vec4 i, float aspect) {\n    vec2 res = i.xy / i.w;\n    res.x *= aspect;\n    return res;\n  }\n  \n  void main() {\n    float aspect = resolution.x / resolution.y;\n    vColor = vec4(color, opacity);\n    vUV = uv;\n    vCounters = counters;\n  \n    mat4 m = projectionMatrix * modelViewMatrix;\n    vec4 finalPosition = m * vec4(position, 1.0) * aspect;\n    vec4 prevPos = m * vec4(previous, 1.0);\n    vec4 nextPos = m * vec4(next, 1.0);\n  \n    vec2 currentP = fix(finalPosition, aspect);\n    vec2 prevP = fix(prevPos, aspect);\n    vec2 nextP = fix(nextPos, aspect);\n  \n    float w = lineWidth * width;\n  \n    vec2 dir;\n    if (nextP == currentP) dir = normalize(currentP - prevP);\n    else if (prevP == currentP) dir = normalize(nextP - currentP);\n    else {\n      vec2 dir1 = normalize(currentP - prevP);\n      vec2 dir2 = normalize(nextP - currentP);\n      dir = normalize(dir1 + dir2);\n  \n      vec2 perp = vec2(-dir1.y, dir1.x);\n      vec2 miter = vec2(-dir.y, dir.x);\n      //w = clamp(w / dot(miter, perp), 0., 4. * lineWidth * width);\n    }\n  \n    //vec2 normal = (cross(vec3(dir, 0.), vec3(0., 0., 1.))).xy;\n    vec4 normal = vec4(-dir.y, dir.x, 0., 1.);\n    normal.xy *= .5 * w;\n    //normal *= projectionMatrix;\n    if (sizeAttenuation == 0.) {\n      normal.xy *= finalPosition.w;\n      normal.xy /= (vec4(resolution, 0., 1.) * projectionMatrix).xy * aspect;\n    }\n  \n    finalPosition.xy += normal.xy * side;\n    gl_Position = finalPosition;\n    #include <logdepthbuf_vertex>\n    #include <fog_vertex>\n    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n    #include <clipping_planes_vertex>\n    #include <fog_vertex>\n  }\n",fragmentShader:su}),sa(this,"lineWidth"),sa(this,"map"),sa(this,"useMap"),sa(this,"alphaMap"),sa(this,"useAlphaMap"),sa(this,"color"),sa(this,"gradient"),sa(this,"resolution"),sa(this,"sizeAttenuation"),sa(this,"dashArray"),sa(this,"dashOffset"),sa(this,"dashRatio"),sa(this,"useDash"),sa(this,"useGradient"),sa(this,"visibility"),sa(this,"repeat"),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get(){return this.uniforms.lineWidth.value},set(e){this.uniforms.lineWidth.value=e}},map:{enumerable:!0,get(){return this.uniforms.map.value},set(e){this.uniforms.map.value=e}},useMap:{enumerable:!0,get(){return this.uniforms.useMap.value},set(e){this.uniforms.useMap.value=e}},alphaMap:{enumerable:!0,get(){return this.uniforms.alphaMap.value},set(e){this.uniforms.alphaMap.value=e}},useAlphaMap:{enumerable:!0,get(){return this.uniforms.useAlphaMap.value},set(e){this.uniforms.useAlphaMap.value=e}},color:{enumerable:!0,get(){return this.uniforms.color.value},set(e){this.uniforms.color.value=e}},gradient:{enumerable:!0,get(){return this.uniforms.gradient.value},set(e){this.uniforms.gradient.value=e}},opacity:{enumerable:!0,get(){return this.uniforms.opacity.value},set(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get(){return this.uniforms.resolution.value},set(e){this.uniforms.resolution.value.copy(e)}},sizeAttenuation:{enumerable:!0,get(){return this.uniforms.sizeAttenuation.value},set(e){this.uniforms.sizeAttenuation.value=e}},dashArray:{enumerable:!0,get(){return this.uniforms.dashArray.value},set(e){this.uniforms.dashArray.value=e,this.useDash=0!==e?1:0}},dashOffset:{enumerable:!0,get(){return this.uniforms.dashOffset.value},set(e){this.uniforms.dashOffset.value=e}},dashRatio:{enumerable:!0,get(){return this.uniforms.dashRatio.value},set(e){this.uniforms.dashRatio.value=e}},useDash:{enumerable:!0,get(){return this.uniforms.useDash.value},set(e){this.uniforms.useDash.value=e}},useGradient:{enumerable:!0,get(){return this.uniforms.useGradient.value},set(e){this.uniforms.useGradient.value=e}},visibility:{enumerable:!0,get(){return this.uniforms.visibility.value},set(e){this.uniforms.visibility.value=e}},alphaTest:{enumerable:!0,get(){return this.uniforms.alphaTest.value},set(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get(){return this.uniforms.repeat.value},set(e){this.uniforms.repeat.value.copy(e)}}}),this.setValues(e)}}let sd={width:.2,length:1,decay:1,local:!1,stride:0,interval:1},sA=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.set(e.subarray(t)),e.fill(-1/0,-t),e};function sf(e,t){let{length:r,local:n,decay:i,interval:o,stride:a}={...sd,...t},s=eT.useRef(),[l]=eT.useState(()=>new eR.Vector3);eT.useLayoutEffect(()=>{e&&(s.current=Float32Array.from({length:30*r},(t,r)=>e.position.getComponent(r%3)))},[r,e]);let c=eT.useRef(new eR.Vector3),u=eT.useRef(0);return(0,eP.C)(()=>{if(e&&s.current){if(0===u.current){let t;n?t=e.position:(e.getWorldPosition(l),t=l);let r=1*i;for(let e=0;e<r;e++)t.distanceTo(c.current)<a||(sA(s.current,3),s.current.set(t.toArray(),s.current.length-3));c.current.copy(t)}u.current++,u.current=u.current%o}}),s}let sp=eT.forwardRef((e,t)=>{let{children:r}=e,{width:n,length:i,decay:o,local:a,stride:s,interval:l}={...sd,...e},{color:c="hotpink",attenuation:u,target:h}=e,d=(0,eP.A)(e=>e.size),A=(0,eP.A)(e=>e.scene),f=eT.useRef(null),[p,m]=eT.useState(null),g=sf(p,{length:i,decay:o,local:a,stride:s,interval:l});eT.useEffect(()=>{let e=(null==h?void 0:h.current)||f.current.children.find(e=>e instanceof eR.Object3D);e&&m(e)},[g,h]);let v=eT.useMemo(()=>new sl,[]),y=eT.useMemo(()=>{var e;let t;let i=new sh({lineWidth:.1*n,color:c,sizeAttenuation:1,resolution:new eR.Vector2(d.width,d.height)});return r&&(Array.isArray(r)?t=r.find(e=>"string"==typeof e.type&&"meshLineMaterial"===e.type):"string"==typeof r.type&&"meshLineMaterial"===r.type&&(t=r)),"object"==typeof(null==(e=t)?void 0:e.props)&&i.setValues(t.props),i},[n,c,d,r]);return eT.useEffect(()=>{y.uniforms.resolution.value.set(d.width,d.height)},[d]),(0,eP.C)(()=>{g.current&&v.setPoints(g.current,u)}),eT.createElement("group",null,(0,eP.g)(eT.createElement("mesh",{ref:t,geometry:v,material:y}),A),eT.createElement("group",{ref:f},r))}),sm=new eR.Triangle,sg=new eR.Vector3;class sv{setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let i=1;t&&(i=t.getX(n)+t.getX(n+1)+t.getX(n+2)),sm.a.fromBufferAttribute(e,n),sm.b.fromBufferAttribute(e,n+1),sm.c.fromBufferAttribute(e,n+2),i*=sm.getArea(),r[n/3]=i}this.distribution=new Float32Array(e.count/3);let n=0;for(let e=0;e<r.length;e++)n+=r[e],this.distribution[e]=n;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let n=this.sampleFaceIndex();return this.sampleFace(n,e,t,r)}sampleFaceIndex(){let e=this.distribution[this.distribution.length-1];return this.binarySearch(this.randomFunction()*e)}binarySearch(e){let t=this.distribution,r=0,n=t.length-1,i=-1;for(;r<=n;){let o=Math.ceil((r+n)/2);if(0===o||t[o-1]<=e&&t[o]>e){i=o;break}e<t[o]?n=o-1:r=o+1}return i}sampleFace(e,t,r,n){let i=this.randomFunction(),o=this.randomFunction();return i+o>1&&(i=1-i,o=1-o),sm.a.fromBufferAttribute(this.positionAttribute,3*e),sm.b.fromBufferAttribute(this.positionAttribute,3*e+1),sm.c.fromBufferAttribute(this.positionAttribute,3*e+2),t.set(0,0,0).addScaledVector(sm.a,i).addScaledVector(sm.b,o).addScaledVector(sm.c,1-(i+o)),void 0!==r&&sm.getNormal(r),void 0!==n&&void 0!==this.colorAttribute&&(sm.a.fromBufferAttribute(this.colorAttribute,3*e),sm.b.fromBufferAttribute(this.colorAttribute,3*e+1),sm.c.fromBufferAttribute(this.colorAttribute,3*e+2),sg.set(0,0,0).addScaledVector(sm.a,i).addScaledVector(sm.b,o).addScaledVector(sm.c,1-(i+o)),n.r=sg.x,n.g=sg.y,n.b=sg.z),this}constructor(e){let t=e.geometry;t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}}function sy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,[o,a]=eT.useState(()=>{let e=Array.from({length:t},()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]).flat();return new eR.InstancedBufferAttribute(Float32Array.from(e),16)});return eT.useLayoutEffect(()=>{if(void 0===e.current)return;let s=new sv(e.current);n&&s.setWeightAttribute(n),s.build();let l=new eR.Vector3,c=new eR.Vector3,u=new eR.Color,h=new eR.Object3D;e.current.updateMatrixWorld(!0);for(let n=0;n<t;n++)s.sample(l,c,u),"function"==typeof r?r({dummy:h,sampledMesh:e.current,position:l,normal:c,color:u},n):h.position.copy(l),h.updateMatrix(),null!=i&&i.current&&i.current.setMatrixAt(n,h.matrix),h.matrix.toArray(o.array,16*n);null!=i&&i.current&&(i.current.instanceMatrix.needsUpdate=!0),o.needsUpdate=!0,a(new eR.InstancedBufferAttribute(o.array,o.itemSize).copy(o))},[e,i,n,t,r]),o}function sE(e){let{children:t,weight:r,transform:n,instances:i,mesh:o,count:a=16,...s}=e,l=eT.useRef(null),c=eT.useRef(null),u=eT.useRef(null);return eT.useLayoutEffect(()=>{var e,t;c.current=null!==(e=null==i?void 0:i.current)&&void 0!==e?e:l.current.children.find(e=>e.hasOwnProperty("instanceMatrix")),u.current=null!==(t=null==o?void 0:o.current)&&void 0!==t?t:l.current.children.find(e=>"Mesh"===e.type)},[t,null==o?void 0:o.current,null==i?void 0:i.current]),sy(u,a,n,r,c),eT.createElement("group",(0,eS.Z)({ref:l},s),t)}let sC=e=>{let{compute:t,name:r,...n}=e,[i]=eT.useState(()=>new eR.BufferAttribute(new Float32Array(0),1)),o=eT.useRef(null);return eT.useLayoutEffect(()=>{if(o.current){var e;let r=t(null!==(e=o.current.parent)&&void 0!==e?e:o.current.__r3f.parent);o.current.copy(r)}},[t]),eT.createElement("primitive",(0,eS.Z)({ref:o,object:i,attach:"attributes-".concat(r)},n))};function sw(e,t){let r,n,i,o,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=new eR.Vector3,c=new eR.Quaternion,u=new eR.Vector3,h=new eR.Matrix4,d=new eR.Matrix4,A=new eR.Matrix4;s.preserveMatrix=void 0===s.preserveMatrix||s.preserveMatrix,s.preservePosition=void 0===s.preservePosition||s.preservePosition,s.preserveHipPosition=void 0!==s.preserveHipPosition&&s.preserveHipPosition,s.useTargetMatrix=void 0!==s.useTargetMatrix&&s.useTargetMatrix,s.hip=void 0!==s.hip?s.hip:"hip",s.names=s.names||{};let f=t.isObject3D?t.skeleton.bones:sx(t),p=e.isObject3D?e.skeleton.bones:sx(e);if(e.isObject3D?e.skeleton.pose():(s.useTargetMatrix=!0,s.preserveMatrix=!1),s.preservePosition){a=[];for(let e=0;e<p.length;e++)a.push(p[e].position.clone())}if(s.preserveMatrix){e.updateMatrixWorld(),e.matrixWorld.identity();for(let t=0;t<e.children.length;++t)e.children[t].updateMatrixWorld(!0)}if(s.offsets){r=[];for(let e=0;e<p.length;++e)n=p[e],i=s.names[n.name]||n.name,s.offsets[i]&&(n.matrix.multiply(s.offsets[i]),n.matrix.decompose(n.position,n.quaternion,n.scale),n.updateMatrixWorld()),r.push(n.matrixWorld.clone())}for(let t=0;t<p.length;++t){if(n=p[t],o=sB(i=s.names[n.name]||n.name,f),A.copy(n.matrixWorld),o){if(o.updateMatrixWorld(),s.useTargetMatrix?d.copy(o.matrixWorld):(d.copy(e.matrixWorld).invert(),d.multiply(o.matrixWorld)),u.setFromMatrixScale(d),d.scale(u.set(1/u.x,1/u.y,1/u.z)),A.makeRotationFromQuaternion(c.setFromRotationMatrix(d)),e.isObject3D){let t=p.indexOf(n),i=r?r[t]:h.copy(e.skeleton.boneInverses[t]).invert();A.multiply(i)}A.copyPosition(d)}n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(A)):n.matrix.copy(A),s.preserveHipPosition&&i===s.hip&&n.matrix.setPosition(l.set(0,n.position.y,0)),n.matrix.decompose(n.position,n.quaternion,n.scale),n.updateMatrixWorld()}if(s.preservePosition)for(let e=0;e<p.length;++e)n=p[e],(i=s.names[n.name]||n.name)!==s.hip&&n.position.copy(a[e]);s.preserveMatrix&&e.updateMatrixWorld(!0)}function sB(e,t){for(let r=0,n=sx(t);r<n.length;r++)if(e===n[r].name)return n[r]}function sx(e){return Array.isArray(e)?e:e.bones}let sI={retarget:sw,retargetClip:function(e,t,r){let n,i,o,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};s.useFirstFramePosition=void 0!==s.useFirstFramePosition&&s.useFirstFramePosition,s.fps=void 0!==s.fps?s.fps:30,s.names=s.names||[],t.isObject3D||(t=function(e){let t=new eR.SkeletonHelper(e.bones[0]);return t.skeleton=e,t}(t));let l=Math.round(r.duration*(s.fps/1e3)*1e3),c=1/s.fps,u=[],h=new eR.AnimationMixer(t),d=sx(e.skeleton),A=[];h.clipAction(r).play(),h.update(0),t.updateMatrixWorld();for(let r=0;r<l;++r){let u=r*c;sw(e,t,s);for(let e=0;e<d.length;++e)sB(a=s.names[d[e].name]||d[e].name,t.skeleton)&&(i=d[e],o=A[e]=A[e]||{bone:i},s.hip===a&&(o.pos||(o.pos={times:new Float32Array(l),values:new Float32Array(3*l)}),s.useFirstFramePosition&&(0===r&&(n=i.position.clone()),i.position.sub(n)),o.pos.times[r]=u,i.position.toArray(o.pos.values,3*r)),o.quat||(o.quat={times:new Float32Array(l),values:new Float32Array(4*l)}),o.quat.times[r]=u,i.quaternion.toArray(o.quat.values,4*r));h.update(c),t.updateMatrixWorld()}for(let e=0;e<A.length;++e)(o=A[e])&&(o.pos&&u.push(new eR.VectorKeyframeTrack(".bones["+o.bone.name+"].position",o.pos.times,o.pos.values)),u.push(new eR.QuaternionKeyframeTrack(".bones["+o.bone.name+"].quaternion",o.quat.times,o.quat.values)));return h.uncacheAction(r),new eR.AnimationClip(r.name,-1,u)},clone:function(e){let t=new Map,r=new Map,n=e.clone();return function e(t,r,n){n(t,r);for(let i=0;i<t.children.length;i++)e(t.children[i],r.children[i],n)}(e,n,function(e,n){t.set(n,e),r.set(e,n)}),n.traverse(function(e){if(!e.isSkinnedMesh)return;let n=t.get(e),i=n.skeleton.bones;e.skeleton=n.skeleton.clone(),e.bindMatrix.copy(n.bindMatrix),e.skeleton.bones=i.map(function(e){return r.get(e)}),e.bind(e.skeleton,e.bindMatrix)}),n}},sb=eT.forwardRef((e,t)=>{let{isChild:r=!1,object:n,children:i,deep:o,castShadow:a,receiveShadow:s,inject:l,keys:c,...u}=e,h={keys:c,deep:o,inject:l,castShadow:a,receiveShadow:s};if(Array.isArray(n=eT.useMemo(()=>{if(!1===r&&!Array.isArray(n)){let e=!1;if(n.traverse(t=>{t.isSkinnedMesh&&(e=!0)}),e)return sI.clone(n)}return n},[n,r])))return eT.createElement("group",(0,eS.Z)({},u,{ref:t}),n.map(e=>eT.createElement(sb,(0,eS.Z)({key:e.uuid,object:e},h))),i);let{children:d,...A}=function(e,t){let{keys:r=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:n,inject:i,castShadow:o,receiveShadow:a}=t,s={};for(let t of r)s[t]=e[t];return n&&(s.geometry&&"materialsOnly"!==n&&(s.geometry=s.geometry.clone()),s.material&&"geometriesOnly"!==n&&(s.material=s.material.clone())),i&&(s="function"==typeof i?{...s,children:i(e)}:eT.isValidElement(i)?{...s,children:i}:{...s,...i}),e instanceof eR.Mesh&&(o&&(s.castShadow=!0),a&&(s.receiveShadow=!0)),s}(n,h),f=n.type[0].toLowerCase()+n.type.slice(1);return eT.createElement(f,(0,eS.Z)({},A,u,{ref:t}),n.children.map(e=>"Bone"===e.type?eT.createElement("primitive",(0,eS.Z)({key:e.uuid,object:e},h)):eT.createElement(sb,(0,eS.Z)({key:e.uuid,object:e},h,{isChild:!0}))),i,d)});class s_ extends eR.Mesh{constructor(e,t,r=!1,n=!1,i=1e4){let o=new eR.BufferGeometry;super(o,t),this.isMarchingCubes=!0;let a=this,s=new Float32Array(36),l=new Float32Array(36),c=new Float32Array(36);function u(e,t,r,n,i,o,u,h,d,A){var f,p,m,g,v,y;let E=(r-u)/(h-u),C=a.normal_cache;s[t+0]=n+E*a.delta,s[t+1]=i,s[t+2]=o,l[t+0]=(f=C[e+0])+(C[e+3]-f)*E,l[t+1]=(p=C[e+1])+(C[e+4]-p)*E,l[t+2]=(m=C[e+2])+(C[e+5]-m)*E,c[t+0]=(g=a.palette[3*d+0])+(a.palette[3*A+0]-g)*E,c[t+1]=(v=a.palette[3*d+1])+(a.palette[3*A+1]-v)*E,c[t+2]=(y=a.palette[3*d+2])+(a.palette[3*A+2]-y)*E}function h(e,t,r,n,i,o,u,h,d,A){var f,p,m,g,v,y;let E=(r-u)/(h-u),C=a.normal_cache;s[t+0]=n,s[t+1]=i+E*a.delta,s[t+2]=o;let w=e+3*a.yd;l[t+0]=(f=C[e+0])+(C[w+0]-f)*E,l[t+1]=(p=C[e+1])+(C[w+1]-p)*E,l[t+2]=(m=C[e+2])+(C[w+2]-m)*E,c[t+0]=(g=a.palette[3*d+0])+(a.palette[3*A+0]-g)*E,c[t+1]=(v=a.palette[3*d+1])+(a.palette[3*A+1]-v)*E,c[t+2]=(y=a.palette[3*d+2])+(a.palette[3*A+2]-y)*E}function d(e,t,r,n,i,o,u,h,d,A){var f,p,m,g,v,y;let E=(r-u)/(h-u),C=a.normal_cache;s[t+0]=n,s[t+1]=i,s[t+2]=o+E*a.delta;let w=e+3*a.zd;l[t+0]=(f=C[e+0])+(C[w+0]-f)*E,l[t+1]=(p=C[e+1])+(C[w+1]-p)*E,l[t+2]=(m=C[e+2])+(C[w+2]-m)*E,c[t+0]=(g=a.palette[3*d+0])+(a.palette[3*A+0]-g)*E,c[t+1]=(v=a.palette[3*d+1])+(a.palette[3*A+1]-v)*E,c[t+2]=(y=a.palette[3*d+2])+(a.palette[3*A+2]-y)*E}function A(e){let t=3*e;0===a.normal_cache[t]&&(a.normal_cache[t+0]=a.field[e-1]-a.field[e+1],a.normal_cache[t+1]=a.field[e-a.yd]-a.field[e+a.yd],a.normal_cache[t+2]=a.field[e-a.zd]-a.field[e+a.zd])}this.enableUvs=r,this.enableColors=n,this.init=function(e){this.resolution=e,this.isolation=80,this.size=e,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.palette=new Float32Array(3*this.size3),this.count=0;let t=3*i;this.positionArray=new Float32Array(3*t);let r=new eR.BufferAttribute(this.positionArray,3);r.setUsage(eR.DynamicDrawUsage),o.setAttribute("position",r),this.normalArray=new Float32Array(3*t);let n=new eR.BufferAttribute(this.normalArray,3);if(n.setUsage(eR.DynamicDrawUsage),o.setAttribute("normal",n),this.enableUvs){this.uvArray=new Float32Array(2*t);let e=new eR.BufferAttribute(this.uvArray,2);e.setUsage(eR.DynamicDrawUsage),o.setAttribute("uv",e)}if(this.enableColors){this.colorArray=new Float32Array(3*t);let e=new eR.BufferAttribute(this.colorArray,3);e.setUsage(eR.DynamicDrawUsage),o.setAttribute("color",e)}o.boundingSphere=new eR.Sphere(new eR.Vector3,1)},this.addBall=function(e,t,r,n,i,o){let a,s,l,c,u,h,d,A,f,p,m;let g=Math.sign(n);n=Math.abs(n);let v=null!=o,y=new eR.Color(e,t,r);if(v)try{y=o instanceof eR.Color?o:Array.isArray(o)?new eR.Color(Math.min(Math.abs(o[0]),1),Math.min(Math.abs(o[1]),1),Math.min(Math.abs(o[2]),1)):new eR.Color(o)}catch(n){y=new eR.Color(e,t,r)}let E=this.size*Math.sqrt(n/i),C=r*this.size,w=t*this.size,B=e*this.size,x=Math.floor(C-E);x<1&&(x=1);let I=Math.floor(C+E);I>this.size-1&&(I=this.size-1);let b=Math.floor(w-E);b<1&&(b=1);let _=Math.floor(w+E);_>this.size-1&&(_=this.size-1);let M=Math.floor(B-E);M<1&&(M=1);let S=Math.floor(B+E);for(S>this.size-1&&(S=this.size-1),l=x;l<I;l++)for(u=this.size2*l,f=(A=l/this.size-r)*A,s=b;s<_;s++)for(c=u+this.size*s,p=(d=s/this.size-t)*d,a=M;a<S;a++)if((m=n/(1e-6+(h=a/this.size-e)*h+p+f)-i)>0){this.field[c+a]+=m*g;let e=Math.sqrt((a-B)*(a-B)+(s-w)*(s-w)+(l-C)*(l-C))/E,t=1-e*e*e*(e*(6*e-15)+10);this.palette[(c+a)*3+0]+=y.r*t,this.palette[(c+a)*3+1]+=y.g*t,this.palette[(c+a)*3+2]+=y.b*t}},this.addPlaneX=function(e,t){let r=this.size,n=this.yd,i=this.zd,o=this.field,a,s,l,c,u,h,d=r*Math.sqrt(e/t);for(d>r&&(d=r),a=0;a<d;a++)if((c=e/(1e-4+(u=a/r)*u)-t)>0)for(s=0;s<r;s++)for(l=0,h=a+s*n;l<r;l++)o[i*l+h]+=c},this.addPlaneY=function(e,t){let r=this.size,n=this.yd,i=this.zd,o=this.field,a,s,l,c,u,h,d,A=r*Math.sqrt(e/t);for(A>r&&(A=r),s=0;s<A;s++)if((c=e/(1e-4+(u=s/r)*u)-t)>0)for(a=0,h=s*n;a<r;a++)for(l=0,d=h+a;l<r;l++)o[i*l+d]+=c},this.addPlaneZ=function(e,t){let r=this.size,n=this.yd,i=this.zd,o=this.field,a,s,l,c,u,h,d,A=r*Math.sqrt(e/t);for(A>r&&(A=r),l=0;l<A;l++)if((c=e/(1e-4+(u=l/r)*u)-t)>0)for(s=0,h=i*l;s<r;s++)for(a=0,d=h+s*n;a<r;a++)o[d+a]+=c},this.setCell=function(e,t,r,n){let i=this.size2*r+this.size*t+e;this.field[i]=n},this.getCell=function(e,t,r){let n=this.size2*r+this.size*t+e;return this.field[n]},this.blur=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.field,r=t.slice(),n=this.size,i=this.size2;for(let o=0;o<n;o++)for(let a=0;a<n;a++)for(let s=0;s<n;s++){let l=i*s+n*a+o,c=r[l],u=1;for(let t=-1;t<=1;t+=2){let l=t+o;if(!(l<0)&&!(l>=n))for(let t=-1;t<=1;t+=2){let o=t+a;if(!(o<0)&&!(o>=n))for(let t=-1;t<=1;t+=2){let a=t+s;if(a<0||a>=n)continue;let h=r[i*a+n*o+l];u++,c+=e*(h-c)/u}}}t[l]=c}},this.reset=function(){for(let e=0;e<this.size3;e++)this.normal_cache[3*e]=0,this.field[e]=0,this.palette[3*e]=this.palette[3*e+1]=this.palette[3*e+2]=0},this.update=function(){this.count=0;let e=this.size-2;for(let t=1;t<e;t++){let r=this.size2*t,n=(t-this.halfsize)/this.halfsize;for(let t=1;t<e;t++){let i=r+this.size*t,o=(t-this.halfsize)/this.halfsize;for(let t=1;t<e;t++)!function(e,t,r,n,i){let o=n+1,f=n+a.yd,p=n+a.zd,m=o+a.yd,g=o+a.zd,v=n+a.yd+a.zd,y=o+a.yd+a.zd,E=0,C=a.field[n],w=a.field[o],B=a.field[f],x=a.field[m],I=a.field[p],b=a.field[g],_=a.field[v],M=a.field[y];C<i&&(E|=1),w<i&&(E|=2),B<i&&(E|=8),x<i&&(E|=4),I<i&&(E|=16),b<i&&(E|=32),_<i&&(E|=128),M<i&&(E|=64);let S=sM[E];if(0===S)return;let T=a.delta,D=e+T,R=t+T,P=r+T;1&S&&(A(n),A(o),u(3*n,0,i,e,t,r,C,w,n,o)),2&S&&(A(o),A(m),h(3*o,3,i,D,t,r,w,x,o,m)),4&S&&(A(f),A(m),u(3*f,6,i,e,R,r,B,x,f,m)),8&S&&(A(n),A(f),h(3*n,9,i,e,t,r,C,B,n,f)),16&S&&(A(p),A(g),u(3*p,12,i,e,t,P,I,b,p,g)),32&S&&(A(g),A(y),h(3*g,15,i,D,t,P,b,M,g,y)),64&S&&(A(v),A(y),u(3*v,18,i,e,R,P,_,M,v,y)),128&S&&(A(p),A(v),h(3*p,21,i,e,t,P,I,_,p,v)),256&S&&(A(n),A(p),d(3*n,24,i,e,t,r,C,I,n,p)),512&S&&(A(o),A(g),d(3*o,27,i,D,t,r,w,b,o,g)),1024&S&&(A(m),A(y),d(3*m,30,i,D,R,r,x,M,m,y)),2048&S&&(A(f),A(v),d(3*f,33,i,e,R,r,B,_,f,v)),E<<=4;let F,Q,O,L=0;for(;-1!=sS[E+L];)Q=(F=E+L)+1,O=F+2,function(e,t,r,n,i,o){let s=3*a.count;if(a.positionArray[s+0]=e[n],a.positionArray[s+1]=e[n+1],a.positionArray[s+2]=e[n+2],a.positionArray[s+3]=e[i],a.positionArray[s+4]=e[i+1],a.positionArray[s+5]=e[i+2],a.positionArray[s+6]=e[o],a.positionArray[s+7]=e[o+1],a.positionArray[s+8]=e[o+2],!0===a.material.flatShading){let e=(t[n+0]+t[i+0]+t[o+0])/3,r=(t[n+1]+t[i+1]+t[o+1])/3,l=(t[n+2]+t[i+2]+t[o+2])/3;a.normalArray[s+0]=e,a.normalArray[s+1]=r,a.normalArray[s+2]=l,a.normalArray[s+3]=e,a.normalArray[s+4]=r,a.normalArray[s+5]=l,a.normalArray[s+6]=e,a.normalArray[s+7]=r,a.normalArray[s+8]=l}else a.normalArray[s+0]=t[n+0],a.normalArray[s+1]=t[n+1],a.normalArray[s+2]=t[n+2],a.normalArray[s+3]=t[i+0],a.normalArray[s+4]=t[i+1],a.normalArray[s+5]=t[i+2],a.normalArray[s+6]=t[o+0],a.normalArray[s+7]=t[o+1],a.normalArray[s+8]=t[o+2];if(a.enableUvs){let t=2*a.count;a.uvArray[t+0]=e[n+0],a.uvArray[t+1]=e[n+2],a.uvArray[t+2]=e[i+0],a.uvArray[t+3]=e[i+2],a.uvArray[t+4]=e[o+0],a.uvArray[t+5]=e[o+2]}a.enableColors&&(a.colorArray[s+0]=r[n+0],a.colorArray[s+1]=r[n+1],a.colorArray[s+2]=r[n+2],a.colorArray[s+3]=r[i+0],a.colorArray[s+4]=r[i+1],a.colorArray[s+5]=r[i+2],a.colorArray[s+6]=r[o+0],a.colorArray[s+7]=r[o+1],a.colorArray[s+8]=r[o+2]),a.count+=3}(s,l,c,3*sS[F],3*sS[Q],3*sS[O]),L+=3}((t-this.halfsize)/this.halfsize,o,n,i+t,this.isolation)}}this.geometry.setDrawRange(0,this.count),o.getAttribute("position").needsUpdate=!0,o.getAttribute("normal").needsUpdate=!0,this.enableUvs&&(o.getAttribute("uv").needsUpdate=!0),this.enableColors&&(o.getAttribute("color").needsUpdate=!0),this.count/3>i&&console.warn("THREE.MarchingCubes: Geometry buffers too small for rendering. Please create an instance with a higher poly count.")},this.init(e)}}let sM=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),sS=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),sT=eT.createContext(null),sD=eT.forwardRef((e,t)=>{let{resolution:r=28,maxPolyCount:n=1e4,enableUvs:i=!1,enableColors:o=!1,children:a,...s}=e,l=eT.useRef(null);eT.useImperativeHandle(t,()=>l.current,[]);let c=eT.useMemo(()=>new s_(r,null,i,o,n),[r,n,i,o]),u=eT.useMemo(()=>({getParent:()=>l}),[]);return(0,eP.C)(()=>{c.update(),c.reset()},-1),eT.createElement(eT.Fragment,null,eT.createElement("primitive",(0,eS.Z)({object:c,ref:l},s),eT.createElement(sT.Provider,{value:u},a)))}),sR=eT.forwardRef((e,t)=>{let{strength:r=.5,subtract:n=12,color:i,...o}=e,{getParent:a}=eT.useContext(sT),s=eT.useMemo(()=>a(),[a]),l=eT.useRef(null);eT.useImperativeHandle(t,()=>l.current,[]);let c=new eR.Vector3;return(0,eP.C)(e=>{s.current&&l.current&&(l.current.getWorldPosition(c),s.current.addBall(.5+.5*c.x,.5+.5*c.y,.5+.5*c.z,r,n,i))}),eT.createElement("group",(0,eS.Z)({ref:l},o))}),sP=eT.forwardRef((e,t)=>{let{planeType:r="x",strength:n=.5,subtract:i=12,...o}=e,{getParent:a}=eT.useContext(sT),s=eT.useMemo(()=>a(),[a]),l=eT.useRef(null);eT.useImperativeHandle(t,()=>l.current,[]);let c=eT.useMemo(()=>"x"===r?"addPlaneX":"y"===r?"addPlaneY":"addPlaneZ",[r]);return(0,eP.C)(()=>{s.current&&l.current&&s.current[c](n,i)}),eT.createElement("group",(0,eS.Z)({ref:l},o))});class sF extends eR.BufferGeometry{constructor(e,t,r,n){super();let i=[],o=[],a=[],s=new eR.Vector3,l=new eR.Matrix4;l.makeRotationFromEuler(r),l.setPosition(t);let c=new eR.Matrix4;function u(t,r,n){r.applyMatrix4(e.matrixWorld),r.applyMatrix4(c),n.transformDirection(e.matrixWorld),t.push(new sQ(r.clone(),n.clone()))}function h(e,t){let r=[],i=.5*Math.abs(n.dot(t));for(let n=0;n<e.length;n+=3){let o,a,s,l,c,u,h;let A=e[n+0].position.dot(t)-i,f=e[n+1].position.dot(t)-i,p=e[n+2].position.dot(t)-i;switch(((c=A>0)?1:0)+((u=f>0)?1:0)+((h=p>0)?1:0)){case 0:r.push(e[n]),r.push(e[n+1]),r.push(e[n+2]);break;case 1:if(c&&(o=e[n+1],a=e[n+2],s=d(e[n],o,t,i),l=d(e[n],a,t,i)),u){o=e[n],a=e[n+2],s=d(e[n+1],o,t,i),l=d(e[n+1],a,t,i),r.push(s),r.push(a.clone()),r.push(o.clone()),r.push(a.clone()),r.push(s.clone()),r.push(l);break}h&&(o=e[n],a=e[n+1],s=d(e[n+2],o,t,i),l=d(e[n+2],a,t,i)),r.push(o.clone()),r.push(a.clone()),r.push(s),r.push(l),r.push(s.clone()),r.push(a.clone());break;case 2:c||(a=d(o=e[n].clone(),e[n+1],t,i),s=d(o,e[n+2],t,i),r.push(o),r.push(a),r.push(s)),u||(a=d(o=e[n+1].clone(),e[n+2],t,i),s=d(o,e[n],t,i),r.push(o),r.push(a),r.push(s)),h||(a=d(o=e[n+2].clone(),e[n],t,i),s=d(o,e[n+1],t,i),r.push(o),r.push(a),r.push(s))}}return r}function d(e,t,r,n){let i=e.position.dot(r)-n,o=i/(i-(t.position.dot(r)-n));return new sQ(new eR.Vector3(e.position.x+o*(t.position.x-e.position.x),e.position.y+o*(t.position.y-e.position.y),e.position.z+o*(t.position.z-e.position.z)),new eR.Vector3(e.normal.x+o*(t.normal.x-e.normal.x),e.normal.y+o*(t.normal.y-e.normal.y),e.normal.z+o*(t.normal.z-e.normal.z)))}c.copy(l).invert(),function(){let t;let r=[],c=new eR.Vector3,d=new eR.Vector3;if(!0===e.geometry.isGeometry){console.error("THREE.DecalGeometry no longer supports THREE.Geometry. Use BufferGeometry instead.");return}let A=e.geometry,f=A.attributes.position,p=A.attributes.normal;if(null!==A.index){let e=A.index;for(t=0;t<e.count;t++)c.fromBufferAttribute(f,e.getX(t)),d.fromBufferAttribute(p,e.getX(t)),u(r,c,d)}else for(t=0;t<f.count;t++)c.fromBufferAttribute(f,t),d.fromBufferAttribute(p,t),u(r,c,d);for(t=0,r=h(r,s.set(1,0,0)),r=h(r,s.set(-1,0,0)),r=h(r,s.set(0,1,0)),r=h(r,s.set(0,-1,0)),r=h(r,s.set(0,0,1)),r=h(r,s.set(0,0,-1));t<r.length;t++){let e=r[t];a.push(.5+e.position.x/n.x,.5+e.position.y/n.y),e.position.applyMatrix4(l),i.push(e.position.x,e.position.y,e.position.z),o.push(e.normal.x,e.normal.y,e.normal.z)}}(),this.setAttribute("position",new eR.Float32BufferAttribute(i,3)),this.setAttribute("normal",new eR.Float32BufferAttribute(o,3)),this.setAttribute("uv",new eR.Float32BufferAttribute(a,2))}}class sQ{clone(){return new this.constructor(this.position.clone(),this.normal.clone())}constructor(e,t){this.position=e,this.normal=t}}function sO(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0];return Array.isArray(e)?e:e instanceof eR.Vector3||e instanceof eR.Euler?[e.x,e.y,e.z]:[e,e,e]}let sL=eT.forwardRef(function(e,t){let{debug:r,depthTest:n=!1,polygonOffsetFactor:i=-10,map:o,mesh:a,children:s,position:l,rotation:c,scale:u,...h}=e,d=eT.useRef(null);eT.useImperativeHandle(t,()=>d.current);let A=eT.useRef(null);return eT.useLayoutEffect(()=>{let e=(null==a?void 0:a.current)||d.current.parent,t=d.current;if(!(e instanceof eR.Mesh))throw Error('Decal must have a Mesh as parent or specify its "mesh" prop');let r={position:new eR.Vector3,rotation:new eR.Euler,scale:new eR.Vector3(1,1,1)};if(e){(0,eP.j)(r,{position:l,scale:u});let n=e.matrixWorld.clone();if(e.matrixWorld.identity(),c&&"number"!=typeof c)(0,eP.j)(r,{rotation:c});else{let t=new eR.Object3D;t.position.copy(r.position),t.lookAt(e.position),"number"==typeof c&&t.rotateZ(c),(0,eP.j)(r,{rotation:t.rotation})}return t.geometry=new sF(e,r.position,r.rotation,r.scale),A.current&&((0,eP.j)(A.current,r),A.current.traverse(e=>e.raycast=()=>null)),e.matrixWorld=n,()=>{t.geometry.dispose()}}},[a,...sO(l),...sO(u),...sO(c)]),eT.createElement("mesh",(0,eS.Z)({ref:d,"material-transparent":!0,"material-polygonOffset":!0,"material-polygonOffsetFactor":i,"material-depthTest":n,"material-map":o},h),s,r&&eT.createElement("mesh",{ref:A},eT.createElement("boxGeometry",null),eT.createElement("meshNormalMaterial",{wireframe:!0}),eT.createElement("axesHelper",null)))});class sk extends eR.Loader{load(e,t,r,n){let i=this,o=new eR.FileLoader(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(e,function(r){try{t(i.parse(r))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t=this;function r(e,t,r,i,o,a,s,l){if(0==t||0==r){e.lineTo(l.x,l.y);return}i=i*Math.PI/180,t=Math.abs(t),r=Math.abs(r);let c=(s.x-l.x)/2,u=(s.y-l.y)/2,h=Math.cos(i)*c+Math.sin(i)*u,d=-Math.sin(i)*c+Math.cos(i)*u,A=t*t,f=r*r,p=h*h,m=d*d,g=p/A+m/f;if(g>1){let e=Math.sqrt(g);t*=e,r*=e,A=t*t,f=r*r}let v=A*m+f*p,y=Math.sqrt(Math.max(0,(A*f-v)/v));o===a&&(y=-y);let E=y*t*d/r,C=-y*r*h/t,w=Math.cos(i)*E-Math.sin(i)*C+(s.x+l.x)/2,B=Math.sin(i)*E+Math.cos(i)*C+(s.y+l.y)/2,x=n(1,0,(h-E)/t,(d-C)/r),I=n((h-E)/t,(d-C)/r,(-h-E)/t,(-d-C)/r)%(2*Math.PI);e.currentPath.absellipse(w,B,t,r,x,x+I,0===a,i)}function n(e,t,r,n){let i=Math.acos(Math.max(-1,Math.min(1,(e*r+t*n)/(Math.sqrt(e*e+t*t)*Math.sqrt(r*r+n*n)))));return e*n-t*r<0&&(i=-i),i}function i(e,t){t=Object.assign({},t);let r={};if(e.hasAttribute("class")){let t=e.getAttribute("class").split(/\s/).filter(Boolean).map(e=>e.trim());for(let e=0;e<t.length;e++)r=Object.assign(r,A["."+t[e]])}function n(n,i,o){void 0===o&&(o=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(n)&&(t[i]=o(e.getAttribute(n))),r[n]&&(t[i]=o(r[n])),e.style&&""!==e.style[n]&&(t[i]=o(e.style[n]))}function i(e){return Math.max(0,Math.min(1,l(e)))}function o(e){return Math.max(0,l(e))}return e.hasAttribute("id")&&(r=Object.assign(r,A["#"+e.getAttribute("id")])),n("fill","fill"),n("fill-opacity","fillOpacity",i),n("fill-rule","fillRule"),n("opacity","opacity",i),n("stroke","stroke"),n("stroke-opacity","strokeOpacity",i),n("stroke-width","strokeWidth",o),n("stroke-linejoin","strokeLineJoin"),n("stroke-linecap","strokeLineCap"),n("stroke-miterlimit","strokeMiterLimit",o),n("visibility","visibility"),t}function o(e,t,r){let n;if("string"!=typeof e)throw TypeError("Invalid input: "+typeof e);let i={WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},o=0,a=!0,s="",l="",c=[];function u(e,t,r){let n=SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw n.partial=r,n}function h(){""!==s&&(""===l?c.push(Number(s)):c.push(Number(s)*Math.pow(10,Number(l)))),s="",l=""}let d=e.length;for(let A=0;A<d;A++){if(n=e[A],Array.isArray(t)&&t.includes(c.length%r)&&i.FLAGS.test(n)){o=1,s=n,h();continue}if(0===o){if(i.WHITESPACE.test(n))continue;if(i.DIGIT.test(n)||i.SIGN.test(n)){o=1,s=n;continue}if(i.POINT.test(n)){o=2,s=n;continue}i.COMMA.test(n)&&(a&&u(n,A,c),a=!0)}if(1===o){if(i.DIGIT.test(n)){s+=n;continue}if(i.POINT.test(n)){s+=n,o=2;continue}if(i.EXP.test(n)){o=3;continue}i.SIGN.test(n)&&1===s.length&&i.SIGN.test(s[0])&&u(n,A,c)}if(2===o){if(i.DIGIT.test(n)){s+=n;continue}if(i.EXP.test(n)){o=3;continue}i.POINT.test(n)&&"."===s[s.length-1]&&u(n,A,c)}if(3===o){if(i.DIGIT.test(n)){l+=n;continue}if(i.SIGN.test(n)){if(""===l){l+=n;continue}1===l.length&&i.SIGN.test(l)&&u(n,A,c)}}i.WHITESPACE.test(n)?(h(),o=0,a=!1):i.COMMA.test(n)?(h(),o=0,a=!0):i.SIGN.test(n)?(h(),o=1,s=n):i.POINT.test(n)?(h(),o=2,s=n):u(n,A,c)}return h(),c}let a=["mm","cm","in","pt","pc","px"],s={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function l(e){let r,n="px";if("string"==typeof e||e instanceof String)for(let t=0,r=a.length;t<r;t++){let r=a[t];if(e.endsWith(r)){n=r,e=e.substring(0,e.length-r.length);break}}return"px"===n&&"px"!==t.defaultUnit?r=s.in[t.defaultUnit]/t.defaultDPI:(r=s[n][t.defaultUnit])<0&&(r=s[n].in*t.defaultDPI),r*parseFloat(e)}function c(e){let t=e.elements;return t[0]*t[4]-t[1]*t[3]<0}function u(e){let t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function h(e){let t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}let d=[],A={},f=[],p=new eR.Matrix3,m=new eR.Matrix3,g=new eR.Matrix3,v=new eR.Matrix3,y=new eR.Vector2,E=new eR.Vector3,C=new eR.Matrix3,w=new DOMParser().parseFromString(e,"image/svg+xml");return!function e(t,n){if(1!==t.nodeType)return;let a=function(e){if(!(e.hasAttribute("transform")||"use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))))return null;let t=function(e){let t=new eR.Matrix3;if("use"===e.nodeName&&(e.hasAttribute("x")||e.hasAttribute("y"))){let r=l(e.getAttribute("x")),n=l(e.getAttribute("y"));t.translate(r,n)}if(e.hasAttribute("transform")){let r=e.getAttribute("transform").split(")");for(let e=r.length-1;e>=0;e--){let n=r[e].trim();if(""===n)continue;let i=n.indexOf("("),a=n.length;if(i>0&&i<a){let e=n.slice(0,i),t=o(n.slice(i+1));switch(p.identity(),e){case"translate":if(t.length>=1){let e=t[0],r=0;t.length>=2&&(r=t[1]),p.translate(e,r)}break;case"rotate":if(t.length>=1){let e=0,r=0,n=0;e=t[0]*Math.PI/180,t.length>=3&&(r=t[1],n=t[2]),m.makeTranslation(-r,-n),g.makeRotation(e),v.multiplyMatrices(g,m),m.makeTranslation(r,n),p.multiplyMatrices(m,v)}break;case"scale":if(t.length>=1){let e=t[0],r=e;t.length>=2&&(r=t[1]),p.scale(e,r)}break;case"skewX":1===t.length&&p.set(1,Math.tan(t[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===t.length&&p.set(1,0,0,Math.tan(t[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===t.length&&p.set(t[0],t[2],t[4],t[1],t[3],t[5],0,0,1)}}t.premultiply(p)}}return t}(e);return f.length>0&&t.premultiply(f[f.length-1]),C.copy(t),f.push(t),t}(t),s=!1,w=null;switch(t.nodeName){case"svg":case"g":n=i(t,n);break;case"style":(function(e){if(e.sheet&&e.sheet.cssRules&&e.sheet.cssRules.length)for(let t=0;t<e.sheet.cssRules.length;t++){let r=e.sheet.cssRules[t];if(1!==r.type)continue;let n=r.selectorText.split(/,/gm).filter(Boolean).map(e=>e.trim());for(let e=0;e<n.length;e++){let t=Object.fromEntries(Object.entries(r.style).filter(e=>{let[,t]=e;return""!==t}));A[n[e]]=Object.assign(A[n[e]]||{},t)}}})(t);break;case"path":n=i(t,n),t.hasAttribute("d")&&(w=function(e){let t=new eR.ShapePath,n=new eR.Vector2,i=new eR.Vector2,a=new eR.Vector2,s=!0,l=!1,c=e.getAttribute("d");if(""===c||"none"===c)return null;let u=c.match(/[a-df-z][^a-df-z]*/gi);for(let e=0,c=u.length;e<c;e++){var h,d,A,f,p,m,g,v;let c;let y=u[e],E=y.charAt(0),C=y.slice(1).trim();switch(!0===s&&(l=!0,s=!1),E){case"M":c=o(C);for(let e=0,r=c.length;e<r;e+=2)n.x=c[e+0],n.y=c[e+1],i.x=n.x,i.y=n.y,0===e?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y),0===e&&a.copy(n);break;case"H":c=o(C);for(let e=0,r=c.length;e<r;e++)n.x=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&a.copy(n);break;case"V":c=o(C);for(let e=0,r=c.length;e<r;e++)n.y=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&a.copy(n);break;case"L":c=o(C);for(let e=0,r=c.length;e<r;e+=2)n.x=c[e+0],n.y=c[e+1],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&a.copy(n);break;case"C":c=o(C);for(let e=0,r=c.length;e<r;e+=6)t.bezierCurveTo(c[e+0],c[e+1],c[e+2],c[e+3],c[e+4],c[e+5]),i.x=c[e+2],i.y=c[e+3],n.x=c[e+4],n.y=c[e+5],0===e&&!0===l&&a.copy(n);break;case"S":c=o(C);for(let e=0,r=c.length;e<r;e+=4)t.bezierCurveTo((h=n.x)-(i.x-h),(d=n.y)-(i.y-d),c[e+0],c[e+1],c[e+2],c[e+3]),i.x=c[e+0],i.y=c[e+1],n.x=c[e+2],n.y=c[e+3],0===e&&!0===l&&a.copy(n);break;case"Q":c=o(C);for(let e=0,r=c.length;e<r;e+=4)t.quadraticCurveTo(c[e+0],c[e+1],c[e+2],c[e+3]),i.x=c[e+0],i.y=c[e+1],n.x=c[e+2],n.y=c[e+3],0===e&&!0===l&&a.copy(n);break;case"T":c=o(C);for(let e=0,r=c.length;e<r;e+=2){let r=(A=n.x)-(i.x-A),o=(f=n.y)-(i.y-f);t.quadraticCurveTo(r,o,c[e+0],c[e+1]),i.x=r,i.y=o,n.x=c[e+0],n.y=c[e+1],0===e&&!0===l&&a.copy(n)}break;case"A":c=o(C,[3,4],7);for(let e=0,o=c.length;e<o;e+=7){if(c[e+5]==n.x&&c[e+6]==n.y)continue;let o=n.clone();n.x=c[e+5],n.y=c[e+6],i.x=n.x,i.y=n.y,r(t,c[e],c[e+1],c[e+2],c[e+3],c[e+4],o,n),0===e&&!0===l&&a.copy(n)}break;case"m":c=o(C);for(let e=0,r=c.length;e<r;e+=2)n.x+=c[e+0],n.y+=c[e+1],i.x=n.x,i.y=n.y,0===e?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y),0===e&&a.copy(n);break;case"h":c=o(C);for(let e=0,r=c.length;e<r;e++)n.x+=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&a.copy(n);break;case"v":c=o(C);for(let e=0,r=c.length;e<r;e++)n.y+=c[e],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&a.copy(n);break;case"l":c=o(C);for(let e=0,r=c.length;e<r;e+=2)n.x+=c[e+0],n.y+=c[e+1],i.x=n.x,i.y=n.y,t.lineTo(n.x,n.y),0===e&&!0===l&&a.copy(n);break;case"c":c=o(C);for(let e=0,r=c.length;e<r;e+=6)t.bezierCurveTo(n.x+c[e+0],n.y+c[e+1],n.x+c[e+2],n.y+c[e+3],n.x+c[e+4],n.y+c[e+5]),i.x=n.x+c[e+2],i.y=n.y+c[e+3],n.x+=c[e+4],n.y+=c[e+5],0===e&&!0===l&&a.copy(n);break;case"s":c=o(C);for(let e=0,r=c.length;e<r;e+=4)t.bezierCurveTo((p=n.x)-(i.x-p),(m=n.y)-(i.y-m),n.x+c[e+0],n.y+c[e+1],n.x+c[e+2],n.y+c[e+3]),i.x=n.x+c[e+0],i.y=n.y+c[e+1],n.x+=c[e+2],n.y+=c[e+3],0===e&&!0===l&&a.copy(n);break;case"q":c=o(C);for(let e=0,r=c.length;e<r;e+=4)t.quadraticCurveTo(n.x+c[e+0],n.y+c[e+1],n.x+c[e+2],n.y+c[e+3]),i.x=n.x+c[e+0],i.y=n.y+c[e+1],n.x+=c[e+2],n.y+=c[e+3],0===e&&!0===l&&a.copy(n);break;case"t":c=o(C);for(let e=0,r=c.length;e<r;e+=2){let r=(g=n.x)-(i.x-g),o=(v=n.y)-(i.y-v);t.quadraticCurveTo(r,o,n.x+c[e+0],n.y+c[e+1]),i.x=r,i.y=o,n.x=n.x+c[e+0],n.y=n.y+c[e+1],0===e&&!0===l&&a.copy(n)}break;case"a":c=o(C,[3,4],7);for(let e=0,o=c.length;e<o;e+=7){if(0==c[e+5]&&0==c[e+6])continue;let o=n.clone();n.x+=c[e+5],n.y+=c[e+6],i.x=n.x,i.y=n.y,r(t,c[e],c[e+1],c[e+2],c[e+3],c[e+4],o,n),0===e&&!0===l&&a.copy(n)}break;case"Z":case"z":t.currentPath.autoClose=!0,t.currentPath.curves.length>0&&(n.copy(a),t.currentPath.currentPoint.copy(n),s=!0);break;default:console.warn(y)}l=!1}return t}(t));break;case"rect":n=i(t,n),w=function(e){let t=l(e.getAttribute("x")||0),r=l(e.getAttribute("y")||0),n=l(e.getAttribute("rx")||e.getAttribute("ry")||0),i=l(e.getAttribute("ry")||e.getAttribute("rx")||0),o=l(e.getAttribute("width")),a=l(e.getAttribute("height")),s=new eR.ShapePath;return s.moveTo(t+n,r),s.lineTo(t+o-n,r),(0!==n||0!==i)&&s.bezierCurveTo(t+o-.448084975506*n,r,t+o,r+.448084975506*i,t+o,r+i),s.lineTo(t+o,r+a-i),(0!==n||0!==i)&&s.bezierCurveTo(t+o,r+a-.448084975506*i,t+o-.448084975506*n,r+a,t+o-n,r+a),s.lineTo(t+n,r+a),(0!==n||0!==i)&&s.bezierCurveTo(t+.448084975506*n,r+a,t,r+a-.448084975506*i,t,r+a-i),s.lineTo(t,r+i),(0!==n||0!==i)&&s.bezierCurveTo(t,r+.448084975506*i,t+.448084975506*n,r,t+n,r),s}(t);break;case"polygon":n=i(t,n),w=function(e){let t=new eR.ShapePath,r=0;return e.getAttribute("points").replace(/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,function(e,n,i){let o=l(n),a=l(i);0===r?t.moveTo(o,a):t.lineTo(o,a),r++}),t.currentPath.autoClose=!0,t}(t);break;case"polyline":n=i(t,n),w=function(e){let t=new eR.ShapePath,r=0;return e.getAttribute("points").replace(/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,function(e,n,i){let o=l(n),a=l(i);0===r?t.moveTo(o,a):t.lineTo(o,a),r++}),t.currentPath.autoClose=!1,t}(t);break;case"circle":n=i(t,n),w=function(e){let t=l(e.getAttribute("cx")||0),r=l(e.getAttribute("cy")||0),n=l(e.getAttribute("r")||0),i=new eR.Path;i.absarc(t,r,n,0,2*Math.PI);let o=new eR.ShapePath;return o.subPaths.push(i),o}(t);break;case"ellipse":n=i(t,n),w=function(e){let t=l(e.getAttribute("cx")||0),r=l(e.getAttribute("cy")||0),n=l(e.getAttribute("rx")||0),i=l(e.getAttribute("ry")||0),o=new eR.Path;o.absellipse(t,r,n,i,0,2*Math.PI);let a=new eR.ShapePath;return a.subPaths.push(o),a}(t);break;case"line":n=i(t,n),w=function(e){let t=l(e.getAttribute("x1")||0),r=l(e.getAttribute("y1")||0),n=l(e.getAttribute("x2")||0),i=l(e.getAttribute("y2")||0),o=new eR.ShapePath;return o.moveTo(t,r),o.lineTo(n,i),o.currentPath.autoClose=!1,o}(t);break;case"defs":s=!0;break;case"use":n=i(t,n);let B=(t.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),x=t.viewportElement.getElementById(B);x?e(x,n):console.warn("SVGLoader: 'use node' references non-existent node id: "+B)}w&&(void 0!==n.fill&&"none"!==n.fill&&w.color.setStyle(n.fill,"srgb"),function(e,t){function r(e){E.set(e.x,e.y,1).applyMatrix3(t),e.set(E.x,E.y)}let n=e.subPaths;for(let e=0,i=n.length;e<i;e++){let i=n[e].curves;for(let e=0;e<i.length;e++){let n=i[e];n.isLineCurve?(r(n.v1),r(n.v2)):n.isCubicBezierCurve?(r(n.v0),r(n.v1),r(n.v2),r(n.v3)):n.isQuadraticBezierCurve?(r(n.v0),r(n.v1),r(n.v2)):n.isEllipseCurve&&(y.set(n.aX,n.aY),r(y),n.aX=y.x,n.aY=y.y,function(e){let t=e.elements,r=t[0]*t[3]+t[1]*t[4];return 0!==r&&Math.abs(r/(u(e)*h(e)))>Number.EPSILON}(t)?function(e){let r=e.xRadius,n=e.yRadius,i=Math.cos(e.aRotation),o=Math.sin(e.aRotation),a=new eR.Vector3(r*i,r*o,0),s=new eR.Vector3(-n*o,n*i,0),l=a.applyMatrix3(t),u=s.applyMatrix3(t),h=p.set(l.x,u.x,0,l.y,u.y,0,0,0,1),d=m.copy(h).invert(),A=g.copy(d).transpose().multiply(d).elements,f=function(e,t,r){let n,i,o,a,s;let l=e+r,c=e-r,u=Math.sqrt(c*c+4*t*t);return l>0?i=e*(s=1/(n=.5*(l+u)))*r-t*s*t:l<0?i=.5*(l-u):(n=.5*u,i=-.5*u),Math.abs(o=c>0?c+u:c-u)>2*Math.abs(t)?(a=1/Math.sqrt(1+(s=-2*t/o)*s),o=s*a):0===Math.abs(t)?(o=1,a=0):(o=1/Math.sqrt(1+(s=-.5*o/t)*s),a=s*o),c>0&&(s=o,o=-a,a=s),{rt1:n,rt2:i,cs:o,sn:a}}(A[0],A[1],A[4]),v=Math.sqrt(f.rt1),y=Math.sqrt(f.rt2);if(e.xRadius=1/v,e.yRadius=1/y,e.aRotation=Math.atan2(f.sn,f.cs),!((e.aEndAngle-e.aStartAngle)%(2*Math.PI)<Number.EPSILON)){let r=m.set(v,0,0,0,y,0,0,0,1),n=g.set(f.cs,f.sn,0,-f.sn,f.cs,0,0,0,1),i=r.multiply(n).multiply(h),o=e=>{let{x:t,y:r}=new eR.Vector3(Math.cos(e),Math.sin(e),0).applyMatrix3(i);return Math.atan2(r,t)};e.aStartAngle=o(e.aStartAngle),e.aEndAngle=o(e.aEndAngle),c(t)&&(e.aClockwise=!e.aClockwise)}}(n):function(e){let r=u(t),n=h(t);e.xRadius*=r,e.yRadius*=n;let i=r>Number.EPSILON?Math.atan2(t.elements[1],t.elements[0]):Math.atan2(-t.elements[3],t.elements[4]);e.aRotation+=i,c(t)&&(e.aStartAngle*=-1,e.aEndAngle*=-1,e.aClockwise=!e.aClockwise)}(n))}}}(w,C),d.push(w),w.userData={node:t,style:n});let I=t.childNodes;for(let t=0;t<I.length;t++){let r=I[t];s&&"style"!==r.nodeName&&"defs"!==r.nodeName||e(r,n)}a&&(f.pop(),f.length>0?C.copy(f[f.length-1]):C.identity())}(w.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:d,xml:w.documentElement}}static createShapes(e){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},r={loc:t.ORIGIN,t:0};function n(e,n,i){let o=i.x-n.x,a=i.y-n.y,s=e.x-n.x,l=e.y-n.y,c=o*l-s*a;if(e.x===n.x&&e.y===n.y){r.loc=t.ORIGIN,r.t=0;return}if(e.x===i.x&&e.y===i.y){r.loc=t.DESTINATION,r.t=1;return}if(c<-Number.EPSILON){r.loc=t.LEFT;return}if(c>Number.EPSILON){r.loc=t.RIGHT;return}if(o*s<0||a*l<0){r.loc=t.BEHIND;return}if(Math.sqrt(o*o+a*a)<Math.sqrt(s*s+l*l)){r.loc=t.BEYOND;return}r.loc=t.BETWEEN,r.t=0!==o?s/o:l/a}let i=999999999,o=-999999999,a=e.subPaths.map(e=>{let t=e.getPoints(),r=-999999999,n=999999999,a=-999999999,s=999999999;for(let e=0;e<t.length;e++){let i=t[e];i.y>r&&(r=i.y),i.y<n&&(n=i.y),i.x>a&&(a=i.x),i.x<s&&(s=i.x)}return o<=a&&(o=a+1),i>=s&&(i=s-1),{curves:e.curves,points:t,isCW:eR.ShapeUtils.isClockWise(t),identifier:-1,boundingBox:new eR.Box2(new eR.Vector2(s,n),new eR.Vector2(a,r))}});a=a.filter(e=>e.points.length>1);for(let e=0;e<a.length;e++)a[e].identifier=e;let s=a.map(s=>(function(e,i,o,a,s){(null==s||""===s)&&(s="nonzero");let l=new eR.Vector2;e.boundingBox.getCenter(l);let c=function(e,i,o){let a=new eR.Vector2;i.getCenter(a);let s=[];return o.forEach(i=>{i.boundingBox.containsPoint(a)&&(function(e,i){let o=[],a=[];for(let s=1;s<e.length;s++){let l=e[s-1],c=e[s];for(let e=1;e<i.length;e++){let s=function(e,i,o,a){let s=e.x,l=i.x,c=o.x,u=a.x,h=e.y,d=i.y,A=o.y,f=a.y,p=(u-c)*(h-A)-(f-A)*(s-c),m=(f-A)*(l-s)-(u-c)*(d-h),g=p/m,v=((l-s)*(h-A)-(d-h)*(s-c))/m;if(0===m&&0!==p||g<=0||g>=1||v<0||v>1)return null;if(0===p&&0===m){for(let c=0;c<2;c++){if(n(0===c?o:a,e,i),r.loc==t.ORIGIN){let e=0===c?o:a;return{x:e.x,y:e.y,t:r.t}}if(r.loc==t.BETWEEN)return{x:+(s+r.t*(l-s)).toPrecision(10),y:+(h+r.t*(d-h)).toPrecision(10),t:r.t}}return null}for(let s=0;s<2;s++)if(n(0===s?o:a,e,i),r.loc==t.ORIGIN){let e=0===s?o:a;return{x:e.x,y:e.y,t:r.t}}return{x:+(s+g*(l-s)).toPrecision(10),y:+(h+g*(d-h)).toPrecision(10),t:g}}(l,c,i[e-1],i[e]);null!==s&&void 0===o.find(e=>e.t<=s.t+Number.EPSILON&&e.t>=s.t-Number.EPSILON)&&(o.push(s),a.push(new eR.Vector2(s.x,s.y)))}}return a})(e,i.points).forEach(e=>{s.push({identifier:i.identifier,isCW:i.isCW,point:e})})}),s.sort((e,t)=>e.point.x-t.point.x),s}([new eR.Vector2(o,l.y),new eR.Vector2(a,l.y)],e.boundingBox,i);c.sort((e,t)=>e.point.x-t.point.x);let u=[],h=[];c.forEach(t=>{t.identifier===e.identifier?u.push(t):h.push(t)});let d=u[0].point.x,A=[],f=0;for(;f<h.length&&h[f].point.x<d;)A.length>0&&A[A.length-1]===h[f].identifier?A.pop():A.push(h[f].identifier),f++;if(A.push(e.identifier),"evenodd"===s){let t=A.length%2==0,r=A[A.length-2];return{identifier:e.identifier,isHole:t,for:r}}if("nonzero"===s){let t=!0,r=null,n=null;for(let e=0;e<A.length;e++){let o=A[e];t?(n=i[o].isCW,t=!1,r=o):n!==i[o].isCW&&(n=i[o].isCW,t=!0)}return{identifier:e.identifier,isHole:t,for:r}}console.warn('fill-rule: "'+s+'" is currently not implemented.')})(s,a,i,o,e.userData?e.userData.style.fillRule:void 0)),l=[];return a.forEach(e=>{if(!s[e.identifier].isHole){let t=new eR.Shape;t.curves=e.curves,s.filter(t=>t.isHole&&t.for===e.identifier).forEach(e=>{let r=a[e.identifier],n=new eR.Path;n.curves=r.curves,t.holes.push(n)}),l.push(t)}}),l}static getStrokeStyle(e,t,r,n,i){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:r=void 0!==r?r:"miter",strokeLineCap:n=void 0!==n?n:"butt",strokeMiterLimit:i=void 0!==i?i:4}}static pointsToStroke(e,t,r,n){let i=[],o=[],a=[];if(0===sk.pointsToStrokeWithBuffers(e,t,r,n,i,o,a))return null;let s=new eR.BufferGeometry;return s.setAttribute("position",new eR.Float32BufferAttribute(i,3)),s.setAttribute("normal",new eR.Float32BufferAttribute(o,3)),s.setAttribute("uv",new eR.Float32BufferAttribute(a,2)),s}static pointsToStrokeWithBuffers(e,t,r,n,i,o,a,s){let l,c,u,h,d;let A=new eR.Vector2,f=new eR.Vector2,p=new eR.Vector2,m=new eR.Vector2,g=new eR.Vector2,v=new eR.Vector2,y=new eR.Vector2,E=new eR.Vector2,C=new eR.Vector2,w=new eR.Vector2,B=new eR.Vector2,x=new eR.Vector2,I=new eR.Vector2,b=new eR.Vector2,_=new eR.Vector2,M=new eR.Vector2,S=new eR.Vector2;r=void 0!==r?r:12,n=void 0!==n?n:.001,s=void 0!==s?s:0;let T=(e=function(e){let t=!1;for(let r=1,i=e.length-1;r<i;r++)if(e[r].distanceTo(e[r+1])<n){t=!0;break}if(!t)return e;let r=[];r.push(e[0]);for(let t=1,i=e.length-1;t<i;t++)e[t].distanceTo(e[t+1])>=n&&r.push(e[t]);return r.push(e[e.length-1]),r}(e)).length;if(T<2)return 0;let D=e[0].equals(e[T-1]),R=e[0],P=t.strokeWidth/2,F=1/(T-1),Q=0,O,L=!1,k=0,U=3*s,G=2*s;N(e[0],e[1],A).multiplyScalar(P),E.copy(e[0]).sub(A),C.copy(e[0]).add(A),w.copy(E),B.copy(C);for(let r=1;r<T;r++){if(l=e[r],c=r===T-1?D?e[1]:void 0:e[r+1],N(R,l,A),p.copy(A).multiplyScalar(P),x.copy(l).sub(p),I.copy(l).add(p),O=Q+F,u=!1,void 0!==c){N(l,c,f),p.copy(f).multiplyScalar(P),b.copy(l).sub(p),_.copy(l).add(p),h=!0,p.subVectors(c,R),0>A.dot(p)&&(h=!1),1===r&&(L=h),p.subVectors(c,l),p.normalize();let e=Math.abs(A.dot(p));if(e>Number.EPSILON){let r=P/e;p.multiplyScalar(-r),m.subVectors(l,R),g.copy(m).setLength(r).add(p),M.copy(g).negate();let n=g.length(),i=m.length();m.divideScalar(i),v.subVectors(c,l);let o=v.length();switch(v.divideScalar(o),m.dot(M)<i&&v.dot(M)<o&&(u=!0),S.copy(g).add(l),M.add(l),d=!1,u?h?(_.copy(M),I.copy(M)):(b.copy(M),x.copy(M)):V(),t.strokeLineJoin){case"bevel":j(h,u,O);break;case"round":J(h,u),h?H(l,x,b,O,0):H(l,_,I,O,1);break;default:let a=P*t.strokeMiterLimit/n;a<1?"miter-clip"!==t.strokeLineJoin?j(h,u,O):(J(h,u),h?(v.subVectors(S,x).multiplyScalar(a).add(x),y.subVectors(S,b).multiplyScalar(a).add(b),z(x,O,0),z(v,O,0),z(l,O,.5),z(l,O,.5),z(v,O,0),z(y,O,0),z(l,O,.5),z(y,O,0),z(b,O,0)):(v.subVectors(S,I).multiplyScalar(a).add(I),y.subVectors(S,_).multiplyScalar(a).add(_),z(I,O,1),z(v,O,1),z(l,O,.5),z(l,O,.5),z(v,O,1),z(y,O,1),z(l,O,.5),z(y,O,1),z(_,O,1))):(u?(h?(z(C,Q,1),z(E,Q,0),z(S,O,0),z(C,Q,1),z(S,O,0),z(M,O,1)):(z(C,Q,1),z(E,Q,0),z(S,O,1),z(E,Q,0),z(M,O,0),z(S,O,1)),h?b.copy(S):_.copy(S)):h?(z(x,O,0),z(S,O,0),z(l,O,.5),z(l,O,.5),z(S,O,0),z(b,O,0)):(z(I,O,1),z(S,O,1),z(l,O,.5),z(l,O,.5),z(S,O,1),z(_,O,1)),d=!0)}}else V()}else V();D||r!==T-1||Y(e[0],w,B,h,!0,Q),Q=O,R=l,E.copy(b),C.copy(_)}if(D){if(u&&i){let e=S,t=M;L!==h&&(e=M,t=S),h?(d||L)&&(t.toArray(i,0),t.toArray(i,9),d&&e.toArray(i,3)):(d||!L)&&(t.toArray(i,3),t.toArray(i,9),d&&e.toArray(i,0))}}else Y(l,x,I,h,!1,O);return k;function N(e,t,r){return r.subVectors(t,e),r.set(-r.y,r.x).normalize()}function z(e,t,r){i&&(i[U]=e.x,i[U+1]=e.y,i[U+2]=0,o&&(o[U]=0,o[U+1]=0,o[U+2]=1),U+=3,a&&(a[G]=t,a[G+1]=r,G+=2)),k+=3}function H(e,t,n,i,o){A.copy(t).sub(e).normalize(),f.copy(n).sub(e).normalize();let a=Math.PI,s=A.dot(f);1>Math.abs(s)&&(a=Math.abs(Math.acos(s))),a/=r,p.copy(t);for(let t=0,n=r-1;t<n;t++)m.copy(p).rotateAround(e,a),z(p,i,o),z(m,i,o),z(e,i,.5),p.copy(m);z(m,i,o),z(n,i,o),z(e,i,.5)}function V(){z(C,Q,1),z(E,Q,0),z(x,O,0),z(C,Q,1),z(x,O,0),z(I,O,1)}function j(e,t,r){t?e?(z(C,Q,1),z(E,Q,0),z(x,O,0),z(C,Q,1),z(x,O,0),z(M,O,1),z(x,r,0),z(b,r,0),z(M,r,.5)):(z(C,Q,1),z(E,Q,0),z(I,O,1),z(E,Q,0),z(M,O,0),z(I,O,1),z(I,r,1),z(M,r,0),z(_,r,1)):(e?(z(x,r,0),z(b,r,0)):(z(I,r,1),z(_,r,0)),z(l,r,.5))}function J(e,t){t&&(e?(z(C,Q,1),z(E,Q,0),z(x,O,0),z(C,Q,1),z(x,O,0),z(M,O,1),z(x,Q,0),z(l,O,.5),z(M,O,1),z(l,O,.5),z(b,Q,0),z(M,O,1)):(z(C,Q,1),z(E,Q,0),z(I,O,1),z(E,Q,0),z(M,O,0),z(I,O,1),z(I,Q,1),z(M,O,0),z(l,O,.5),z(l,O,.5),z(M,O,0),z(_,Q,1)))}function Y(e,r,n,o,s,l){switch(t.strokeLineCap){case"round":s?H(e,n,r,l,.5):H(e,r,n,l,.5);break;case"square":if(s)A.subVectors(r,e),f.set(A.y,-A.x),p.addVectors(A,f).add(e),m.subVectors(f,A).add(e),o?(p.toArray(i,3),m.toArray(i,0),m.toArray(i,9)):(p.toArray(i,3),1===a[7]?m.toArray(i,9):p.toArray(i,9),m.toArray(i,0));else{A.subVectors(n,e),f.set(A.y,-A.x),p.addVectors(A,f).add(e),m.subVectors(f,A).add(e);let t=i.length;o?(p.toArray(i,t-3),m.toArray(i,t-6)):(m.toArray(i,t-6),p.toArray(i,t-3)),m.toArray(i,t-12)}}}}constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}}let sU=(0,eT.forwardRef)(function(e,t){let{src:r,skipFill:n,skipStrokes:i,fillMaterial:o,strokeMaterial:a,fillMeshProps:s,strokeMeshProps:l,...c}=e,u=(0,eP.F)(sk,r.startsWith("<svg")?"data:image/svg+xml;utf8,".concat(r):r),h=(0,eT.useMemo)(()=>i?[]:u.paths.map(e=>{var t;return(null==(t=e.userData)?void 0:t.style.stroke)===void 0||"none"===e.userData.style.stroke?null:e.subPaths.map(t=>sk.pointsToStroke(t.getPoints(),e.userData.style))}),[u,i]);return(0,eT.useEffect)(()=>()=>h.forEach(e=>e&&e.map(e=>e.dispose())),[h]),eT.createElement("object3D",(0,eS.Z)({ref:t},c),eT.createElement("object3D",{scale:[1,-1,1]},u.paths.map((e,t)=>{var r,c;return eT.createElement(eT.Fragment,{key:t},!n&&(null==(r=e.userData)?void 0:r.style.fill)!==void 0&&"none"!==e.userData.style.fill&&sk.createShapes(e).map((t,r)=>eT.createElement("mesh",(0,eS.Z)({key:r},s),eT.createElement("shapeGeometry",{args:[t]}),eT.createElement("meshBasicMaterial",(0,eS.Z)({color:e.userData.style.fill,opacity:e.userData.style.fillOpacity,transparent:!0,side:eR.DoubleSide,depthWrite:!1},o)))),!i&&(null==(c=e.userData)?void 0:c.style.stroke)!==void 0&&"none"!==e.userData.style.stroke&&e.subPaths.map((r,n)=>eT.createElement("mesh",(0,eS.Z)({key:n,geometry:h[t][n]},l),eT.createElement("meshBasicMaterial",(0,eS.Z)({color:e.userData.style.stroke,opacity:e.userData.style.strokeOpacity,transparent:!0,side:eR.DoubleSide,depthWrite:!1},a)))))})))}),sG=new WeakMap;class sN extends eR.Loader{setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,n){let i=new eR.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,e=>{let r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,r).then(t).catch(n)},r,n)}decodeDracoFile(e,t,r,n){let i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)}decodeGeometry(e,t){let r;for(let e in t.attributeTypes){let r=t.attributeTypes[e];void 0!==r.BYTES_PER_ELEMENT&&(t.attributeTypes[e]=r.name)}let n=JSON.stringify(t);if(sG.has(e)){let t=sG.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(i,o).then(n=>(r=n,new Promise((n,o)=>{r._callbacks[i]={resolve:n,reject:o},r.postMessage({type:"decode",id:i,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return a.catch(()=>!0).then(()=>{r&&i&&this._releaseTask(r,i)}),sG.set(e,{key:n,promise:a}),a}_createGeometry(e){let t=new eR.BufferGeometry;e.index&&t.setIndex(new eR.BufferAttribute(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let n=e.attributes[r],i=n.name,o=n.array,a=n.itemSize;t.setAttribute(i,new eR.BufferAttribute(o,a))}return t}_loadLibrary(e,t){let r=new eR.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((t,n)=>{r.load(e,t,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{let r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);let n=sz.toString(),i=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){let r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort(function(e,t){return e._taskLoad>t._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}}function sz(){let e,t;onmessage=function(r){let n=r.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise(function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)});break;case"decode":let i=n.buffer,o=n.taskConfig;t.then(e=>{let t=e.draco,r=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(i),i.byteLength);try{let e=function(e,t,r,n){let i,o;let a=n.attributeIDs,s=n.attributeTypes,l=t.GetEncodedGeometryType(r);if(l===e.TRIANGULAR_MESH)i=new e.Mesh,o=t.DecodeBufferToMesh(r,i);else if(l===e.POINT_CLOUD)i=new e.PointCloud,o=t.DecodeBufferToPointCloud(r,i);else throw Error("THREE.DRACOLoader: Unexpected geometry type.");if(!o.ok()||0===i.ptr)throw Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());let c={index:null,attributes:[]};for(let r in a){let o,l;let u=self[s[r]];if(n.useUniqueIDs)l=a[r],o=t.GetAttributeByUniqueId(i,l);else{if(-1===(l=t.GetAttributeId(i,e[a[r]])))continue;o=t.GetAttribute(i,l)}c.attributes.push(function(e,t,r,n,i,o){let a=o.num_components(),s=r.num_points()*a,l=s*i.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),u=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,o,c,l,u);let h=new i(e.HEAPF32.buffer,u,s).slice();return e._free(u),{name:n,array:h,itemSize:a}}(e,t,i,r,u,o))}return l===e.TRIANGULAR_MESH&&(c.index=function(e,t,r){let n=3*r.num_faces(),i=4*n,o=e._malloc(i);t.GetTrianglesUInt32Array(r,i,o);let a=new Uint32Array(e.HEAPF32.buffer,o,n).slice();return e._free(o),{array:a,itemSize:1}}(e,t,i)),e.destroy(i),c}(t,r,a,o),i=e.attributes.map(e=>e.array.buffer);e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},i)}catch(e){console.error(e),self.postMessage({type:"error",id:n.id,error:e.message})}finally{t.destroy(a),t.destroy(r)}})}}}let sH=()=>{let e;if(s)return s;let t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};let n="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";WebAssembly.validate(t)&&(n="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");let i=WebAssembly.instantiate(function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;++r){let n=e.charCodeAt(r);t[r]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let n=0;for(let i=0;i<e.length;++i)t[n++]=t[i]<60?r[t[i]]:(t[i]-60)*64+t[++i];return t.buffer.slice(0,n)}(n),{}).then(t=>{(e=t.instance).exports.__wasm_call_ctors()});function o(t,r,n,i,o,a){let s=e.exports.sbrk,l=n+3&-4,c=s(l*i),u=s(o.length),h=new Uint8Array(e.exports.memory.buffer);h.set(o,u);let d=t(c,n,i,u,o.length);if(0===d&&a&&a(c,l,i),r.set(h.subarray(c,c+n*i)),s(c-s(0)),0!==d)throw Error("Malformed buffer data: ".concat(d))}let a={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},l={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return s={ready:i,supported:!0,decodeVertexBuffer(t,r,n,i,s){o(e.exports.meshopt_decodeVertexBuffer,t,r,n,i,e.exports[a[s]])},decodeIndexBuffer(t,r,n,i){o(e.exports.meshopt_decodeIndexBuffer,t,r,n,i)},decodeIndexSequence(t,r,n,i){o(e.exports.meshopt_decodeIndexSequence,t,r,n,i)},decodeGltfBuffer(t,r,n,i,s,c){o(e.exports[l[s]],t,r,n,i,e.exports[a[c]])}}},sV=parseInt(eR.REVISION.replace(/\D+/g,""));function sj(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}let sJ="srgb",sY="srgb-linear";class sW extends eR.Loader{load(e,t,r,n){let i;let o=this;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){let t=eR.LoaderUtils.extractUrlBase(e);i=eR.LoaderUtils.resolveURL(t,this.path)}else i=eR.LoaderUtils.extractUrlBase(e);this.manager.itemStart(e);let a=function(t){n?n(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},s=new eR.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(r){try{o.parse(r,i,function(r){t(r),o.manager.itemEnd(e)},a)}catch(e){a(e)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let i;let o={},a={};if("string"==typeof e)i=JSON.parse(e);else if(e instanceof ArrayBuffer){if(sj(new Uint8Array(e.slice(0,4)))===lo){try{o[sK.KHR_BINARY_GLTF]=new ls(e)}catch(e){n&&n(e);return}i=JSON.parse(o[sK.KHR_BINARY_GLTF].content)}else i=JSON.parse(sj(new Uint8Array(e)))}else i=e;if(void 0===i.asset||i.asset.version[0]<2){n&&n(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let s=new lM(i,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});s.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](s);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[t.name]=t,o[t.name]=!0}if(i.extensionsUsed)for(let e=0;e<i.extensionsUsed.length;++e){let t=i.extensionsUsed[e],r=i.extensionsRequired||[];switch(t){case sK.KHR_MATERIALS_UNLIT:o[t]=new sZ;break;case sK.KHR_DRACO_MESH_COMPRESSION:o[t]=new ll(i,this.dracoLoader);break;case sK.KHR_TEXTURE_TRANSFORM:o[t]=new lc;break;case sK.KHR_MESH_QUANTIZATION:o[t]=new lu;break;default:r.indexOf(t)>=0&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}s.setExtensions(o),s.setPlugins(a),s.parse(r,n)}parseAsync(e,t){let r=this;return new Promise(function(n,i){r.parse(e,t,n,i)})}constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new s0(e)}),this.register(function(e){return new s1(e)}),this.register(function(e){return new le(e)}),this.register(function(e){return new lt(e)}),this.register(function(e){return new lr(e)}),this.register(function(e){return new s3(e)}),this.register(function(e){return new s4(e)}),this.register(function(e){return new s5(e)}),this.register(function(e){return new s9(e)}),this.register(function(e){return new s$(e)}),this.register(function(e){return new s6(e)}),this.register(function(e){return new s2(e)}),this.register(function(e){return new s7(e)}),this.register(function(e){return new s8(e)}),this.register(function(e){return new sX(e)}),this.register(function(e){return new ln(e)}),this.register(function(e){return new li(e)})}}function sq(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let sK={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class sX{_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){let t;let r=this.parser,n="light:"+e,i=r.cache.get(n);if(i)return i;let o=r.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],s=new eR.Color(16777215);void 0!==a.color&&s.setRGB(a.color[0],a.color[1],a.color[2],sY);let l=void 0!==a.range?a.range:0;switch(a.type){case"directional":(t=new eR.DirectionalLight(s)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new eR.PointLight(s)).distance=l;break;case"spot":(t=new eR.SpotLight(s)).distance=l,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,t.angle=a.spot.outerConeAngle,t.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return t.position.set(0,0,0),t.decay=2,lx(t,a),void 0!==a.intensity&&(t.intensity=a.intensity),t.name=r.createUniqueName(a.name||"light_"+e),i=Promise.resolve(t),r.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,n=r.json.nodes[e],i=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then(function(e){return r._getNodeRef(t.cache,i,e)})}constructor(e){this.parser=e,this.name=sK.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}}class sZ{getMaterialType(){return eR.MeshBasicMaterial}extendParams(e,t,r){let n=[];e.color=new eR.Color(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let t=i.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],sY),e.opacity=t[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture,sJ))}return Promise.all(n)}constructor(){this.name=sK.KHR_MATERIALS_UNLIT}}class s${extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_EMISSIVE_STRENGTH}}class s0{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],o=n.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&i.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(i.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){let e=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new eR.Vector2(e,e)}return Promise.all(i)}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_CLEARCOAT}}class s1{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return t.dispersion=void 0!==n.dispersion?n.dispersion:0,Promise.resolve()}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_DISPERSION}}class s2{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],o=n.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&i.push(r.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&i.push(r.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(i)}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_IRIDESCENCE}}class s3{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[];t.sheenColor=new eR.Color(0,0,0),t.sheenRoughness=0,t.sheen=1;let o=n.extensions[this.name];if(void 0!==o.sheenColorFactor){let e=o.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],sY)}return void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&i.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,sJ)),void 0!==o.sheenRoughnessTexture&&i.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(i)}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_SHEEN}}class s4{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],o=n.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&i.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(i)}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_TRANSMISSION}}class s5{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],o=n.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&i.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;let a=o.attenuationColor||[1,1,1];return t.attenuationColor=new eR.Color().setRGB(a[0],a[1],a[2],sY),Promise.all(i)}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_VOLUME}}class s9{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_IOR}}class s6{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],o=n.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&i.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));let a=o.specularColorFactor||[1,1,1];return t.specularColor=new eR.Color().setRGB(a[0],a[1],a[2],sY),void 0!==o.specularColorTexture&&i.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,sJ)),Promise.all(i)}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_SPECULAR}}class s8{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],o=n.extensions[this.name];return t.bumpScale=void 0!==o.bumpFactor?o.bumpFactor:1,void 0!==o.bumpTexture&&i.push(r.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(i)}constructor(e){this.parser=e,this.name=sK.EXT_MATERIALS_BUMP}}class s7{getMaterialType(e){let t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?eR.MeshPhysicalMaterial:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],o=n.extensions[this.name];return void 0!==o.anisotropyStrength&&(t.anisotropy=o.anisotropyStrength),void 0!==o.anisotropyRotation&&(t.anisotropyRotation=o.anisotropyRotation),void 0!==o.anisotropyTexture&&i.push(r.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(i)}constructor(e){this.parser=e,this.name=sK.KHR_MATERIALS_ANISOTROPY}}class le{loadTexture(e){let t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let i=n.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,i.source,o)}constructor(e){this.parser=e,this.name=sK.KHR_TEXTURE_BASISU}}class lt{loadTexture(e){let t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;let o=i.extensions[t],a=n.images[o.source],s=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(s=e)}return this.detectSupport().then(function(i){if(i)return r.loadTextureImage(e,o.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}constructor(e){this.parser=e,this.name=sK.EXT_TEXTURE_WEBP,this.isSupported=null}}class lr{loadTexture(e){let t=this.name,r=this.parser,n=r.json,i=n.textures[e];if(!i.extensions||!i.extensions[t])return null;let o=i.extensions[t],a=n.images[o.source],s=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(s=e)}return this.detectSupport().then(function(i){if(i)return r.loadTextureImage(e,o.source,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}constructor(e){this.parser=e,this.name=sK.EXT_TEXTURE_AVIF,this.isSupported=null}}class ln{loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return n.then(function(t){let r=e.byteOffset||0,n=e.byteLength||0,o=e.count,a=e.byteStride,s=new Uint8Array(t,r,n);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(o,a,s,e.mode,e.filter).then(function(e){return e.buffer}):i.ready.then(function(){let t=new ArrayBuffer(o*a);return i.decodeGltfBuffer(new Uint8Array(t),o,a,s,e.mode,e.filter),t})})}}constructor(e){this.name=sK.EXT_MESHOPT_COMPRESSION,this.parser=e}}class li{createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of t.meshes[r.mesh].primitives)if(e.mode!==lf.TRIANGLES&&e.mode!==lf.TRIANGLE_STRIP&&e.mode!==lf.TRIANGLE_FAN&&void 0!==e.mode)return null;let n=r.extensions[this.name].attributes,i=[],o={};for(let e in n)i.push(this.parser.getDependency("accessor",n[e]).then(t=>(o[e]=t,o[e])));return i.length<1?null:(i.push(this.parser.createNodeMesh(e)),Promise.all(i).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],n=e[0].count,i=[];for(let e of r){let t=new eR.Matrix4,r=new eR.Vector3,a=new eR.Quaternion,s=new eR.Vector3(1,1,1),l=new eR.InstancedMesh(e.geometry,e.material,n);for(let e=0;e<n;e++)o.TRANSLATION&&r.fromBufferAttribute(o.TRANSLATION,e),o.ROTATION&&a.fromBufferAttribute(o.ROTATION,e),o.SCALE&&s.fromBufferAttribute(o.SCALE,e),l.setMatrixAt(e,t.compose(r,a,s));for(let t in o)if("_COLOR_0"===t){let e=o[t];l.instanceColor=new eR.InstancedBufferAttribute(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,o[t]);eR.Object3D.prototype.copy.call(l,e),this.parser.assignFinalMaterial(l),i.push(l)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]}))}constructor(e){this.name=sK.EXT_MESH_GPU_INSTANCING,this.parser=e}}let lo="glTF",la={JSON:1313821514,BIN:5130562};class ls{constructor(e){this.name=sK.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12);if(this.header={magic:sj(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==lo)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-12,n=new DataView(e,12),i=0;for(;i<r;){let t=n.getUint32(i,!0);i+=4;let r=n.getUint32(i,!0);if(i+=4,r===la.JSON){let r=new Uint8Array(e,12+i,t);this.content=sj(r)}else if(r===la.BIN){let r=12+i;this.body=e.slice(r,r+t)}i+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}}class ll{decodePrimitive(e,t){let r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},s={},l={};for(let e in o)a[ly[e]||e.toLowerCase()]=o[e];for(let t in e.attributes){let n=ly[t]||t.toLowerCase();if(void 0!==o[t]){let i=r.accessors[e.attributes[t]],o=lp[i.componentType];l[n]=o.name,s[n]=!0===i.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t,r){n.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],n=s[t];void 0!==n&&(r.normalized=n)}t(e)},a,l,sY,r)})})}constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=sK.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}}class lc{extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}constructor(){this.name=sK.KHR_TEXTURE_TRANSFORM}}class lu{constructor(){this.name=sK.KHR_MESH_QUANTIZATION}}class lh extends eR.Interpolant{copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n*3+n;for(let e=0;e!==n;e++)t[e]=r[i+e];return t}interpolate_(e,t,r,n){let i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,c=n-t,u=(r-t)/c,h=u*u,d=h*u,A=e*l,f=A-l,p=-2*d+3*h,m=d-h,g=1-p,v=m-h+u;for(let e=0;e!==a;e++){let t=o[f+e+a],r=o[f+e+s]*c,n=o[A+e+a],l=o[A+e]*c;i[e]=g*t+v*r+p*n+m*l}return i}constructor(e,t,r,n){super(e,t,r,n)}}let ld=new eR.Quaternion;class lA extends lh{interpolate_(e,t,r,n){let i=super.interpolate_(e,t,r,n);return ld.fromArray(i).normalize().toArray(i),i}}let lf={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},lp={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},lm={9728:eR.NearestFilter,9729:eR.LinearFilter,9984:eR.NearestMipmapNearestFilter,9985:eR.LinearMipmapNearestFilter,9986:eR.NearestMipmapLinearFilter,9987:eR.LinearMipmapLinearFilter},lg={33071:eR.ClampToEdgeWrapping,33648:eR.MirroredRepeatWrapping,10497:eR.RepeatWrapping},lv={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ly={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...sV>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},lE={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},lC={CUBICSPLINE:void 0,LINEAR:eR.InterpolateLinear,STEP:eR.InterpolateDiscrete},lw={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function lB(e,t,r){for(let n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function lx(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function lI(e){let t="",r=Object.keys(e).sort();for(let n=0,i=r.length;n<i;n++)t+=r[n]+":"+e[r[n]]+";";return t}function lb(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let l_=new eR.Matrix4;class lM{setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,n=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};return lB(i,o,n),lx(o,n),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(o)})).then(function(){for(let e of o.scenes)e.updateMatrixWorld();e(o)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,n=t.length;r<n;r++){let n=t[r].joints;for(let t=0,r=n.length;t<r;t++)e[n[t]].isBone=!0}for(let t=0,n=e.length;t<n;t++){let n=e[t];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(r[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let n=r.clone(),i=(e,t)=>{let r=this.associations.get(e);for(let[n,o]of(null!=r&&this.associations.set(t,r),e.children.entries()))i(o,t.children[n])};return i(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let n=e(t[r]);if(n)return n}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let n=0;n<t.length;n++){let i=e(t[n]);i&&r.push(i)}return r}getDependency(e,t){let r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":n=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(!(n=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[sK.KHR_BINARY_GLTF].body);let n=this.options;return new Promise(function(e,i){r.load(eR.LoaderUtils.resolveURL(t.uri,n.path),e,void 0,function(){i(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})}loadAccessor(e){let t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){let e=lv[n.type],t=lp[n.componentType],r=!0===n.normalized,i=new t(n.count*e);return Promise.resolve(new eR.BufferAttribute(i,e,r))}let i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){let i,o;let a=e[0],s=lv[n.type],l=lp[n.componentType],c=l.BYTES_PER_ELEMENT,u=c*s,h=n.byteOffset||0,d=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,A=!0===n.normalized;if(d&&d!==u){let e=Math.floor(h/d),r="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count,u=t.cache.get(r);u||(i=new l(a,e*d,n.count*d/c),u=new eR.InterleavedBuffer(i,d/c),t.cache.add(r,u)),o=new eR.InterleavedBufferAttribute(u,s,h%d/c,A)}else i=null===a?new l(n.count*s):new l(a,h,n.count*s),o=new eR.BufferAttribute(i,s,A);if(void 0!==n.sparse){let t=lv.SCALAR,r=lp[n.sparse.indices.componentType],i=n.sparse.indices.byteOffset||0,c=n.sparse.values.byteOffset||0,u=new r(e[1],i,n.sparse.count*t),h=new l(e[2],c,n.sparse.count*s);null!==a&&(o=new eR.BufferAttribute(o.array.slice(),o.itemSize,o.normalized));for(let e=0,t=u.length;e<t;e++){let t=u[e];if(o.setX(t,h[e*s]),s>=2&&o.setY(t,h[e*s+1]),s>=3&&o.setZ(t,h[e*s+2]),s>=4&&o.setW(t,h[e*s+3]),s>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o})}loadTexture(e){let t=this.json,r=this.options,n=t.textures[e].source,i=t.images[n],o=this.textureLoader;if(i.uri){let e=r.manager.getHandler(i.uri);null!==e&&(o=e)}return this.loadTextureImage(e,n,o)}loadTextureImage(e,t,r){let n=this,i=this.json,o=i.textures[e],a=i.images[t],s=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[s])return this.textureCache[s];let l=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=o.name||a.name||"",""===t.name&&"string"==typeof a.uri&&!1===a.uri.startsWith("data:image/")&&(t.name=a.uri);let r=(i.samplers||{})[o.sampler]||{};return t.magFilter=lm[r.magFilter]||eR.LinearFilter,t.minFilter=lm[r.minFilter]||eR.LinearMipmapLinearFilter,t.wrapS=lg[r.wrapS]||eR.RepeatWrapping,t.wrapT=lg[r.wrapT]||eR.RepeatWrapping,n.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[s]=l,l}loadImageSource(e,t){let r=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let i=r.images[e],o=self.URL||self.webkitURL,a=i.uri||"",s=!1;if(void 0!==i.bufferView)a=this.getDependency("bufferView",i.bufferView).then(function(e){s=!0;let t=new Blob([e],{type:i.mimeType});return a=o.createObjectURL(t)});else if(void 0===i.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let l=Promise.resolve(a).then(function(e){return new Promise(function(r,i){let o=r;!0===t.isImageBitmapLoader&&(o=function(e){let t=new eR.Texture(e);t.needsUpdate=!0,r(t)}),t.load(eR.LoaderUtils.resolveURL(e,n.path),o,void 0,i)})}).then(function(e){var t;return!0===s&&o.revokeObjectURL(a),lx(e,i),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),e});return this.sourceCache[e]=l,l}assignTexture(e,t,r,n){let i=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((o=o.clone()).channel=r.texCoord),i.extensions[sK.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[sK.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=i.associations.get(o);o=i.extensions[sK.KHR_TEXTURE_TRANSFORM].extendTexture(o,e),i.associations.set(o,t)}}return void 0!==n&&("number"==typeof n&&(n=3001===n?sJ:sY),"colorSpace"in o?o.colorSpace=n:o.encoding=n===sJ?3001:3e3),e[t]=o,o})}assignFinalMaterial(e){let t=e.geometry,r=e.material,n=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new eR.PointsMaterial,eR.Material.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new eR.LineBasicMaterial,eR.Material.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(n||i||o){let e="ClonedMaterial:"+r.uuid+":";n&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),o&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),i&&(t.vertexColors=!0),o&&(t.flatShading=!0),n&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return eR.MeshStandardMaterial}loadMaterial(e){let t;let r=this,n=this.json,i=this.extensions,o=n.materials[e],a={},s=o.extensions||{},l=[];if(s[sK.KHR_MATERIALS_UNLIT]){let e=i[sK.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),l.push(e.extendParams(a,o,r))}else{let n=o.pbrMetallicRoughness||{};if(a.color=new eR.Color(1,1,1),a.opacity=1,Array.isArray(n.baseColorFactor)){let e=n.baseColorFactor;a.color.setRGB(e[0],e[1],e[2],sY),a.opacity=e[3]}void 0!==n.baseColorTexture&&l.push(r.assignTexture(a,"map",n.baseColorTexture,sJ)),a.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,a.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(l.push(r.assignTexture(a,"metalnessMap",n.metallicRoughnessTexture)),l.push(r.assignTexture(a,"roughnessMap",n.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,a)})))}!0===o.doubleSided&&(a.side=eR.DoubleSide);let c=o.alphaMode||lw.OPAQUE;if(c===lw.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,c===lw.MASK&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==eR.MeshBasicMaterial&&(l.push(r.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new eR.Vector2(1,1),void 0!==o.normalTexture.scale)){let e=o.normalTexture.scale;a.normalScale.set(e,e)}if(void 0!==o.occlusionTexture&&t!==eR.MeshBasicMaterial&&(l.push(r.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==eR.MeshBasicMaterial){let e=o.emissiveFactor;a.emissive=new eR.Color().setRGB(e[0],e[1],e[2],sY)}return void 0!==o.emissiveTexture&&t!==eR.MeshBasicMaterial&&l.push(r.assignTexture(a,"emissiveMap",o.emissiveTexture,sJ)),Promise.all(l).then(function(){let n=new t(a);return o.name&&(n.name=o.name),lx(n,o),r.associations.set(n,{materials:e}),o.extensions&&lB(i,n,o),n})}createUniqueName(e){let t=eR.PropertyBinding.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,n=this.primitiveCache,i=[];for(let o=0,a=e.length;o<a;o++){let a=e[o],s=function(e){let t;let r=e.extensions&&e.extensions[sK.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+lI(r.attributes):e.indices+":"+lI(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,n=e.targets.length;r<n;r++)t+=":"+lI(e.targets[r]);return t}(a),l=n[s];if(l)i.push(l.promise);else{let e;e=a.extensions&&a.extensions[sK.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[sK.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return lS(r,e,t)})}(a):lS(new eR.BufferGeometry,a,t),n[s]={primitive:a,promise:e},i.push(e)}}return Promise.all(i)}loadMesh(e){let t=this,r=this.json,n=this.extensions,i=r.meshes[e],o=i.primitives,a=[];for(let e=0,t=o.length;e<t;e++){var s;let t=void 0===o[e].material?(void 0===(s=this.cache).DefaultMaterial&&(s.DefaultMaterial=new eR.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:eR.FrontSide})),s.DefaultMaterial):this.getDependency("material",o[e].material);a.push(t)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(r){let a=r.slice(0,r.length-1),s=r[r.length-1],l=[];for(let r=0,c=s.length;r<c;r++){let c;let u=s[r],h=o[r],d=a[r];if(h.mode===lf.TRIANGLES||h.mode===lf.TRIANGLE_STRIP||h.mode===lf.TRIANGLE_FAN||void 0===h.mode)!0===(c=!0===i.isSkinnedMesh?new eR.SkinnedMesh(u,d):new eR.Mesh(u,d)).isSkinnedMesh&&c.normalizeSkinWeights(),h.mode===lf.TRIANGLE_STRIP?c.geometry=aA(c.geometry,eR.TriangleStripDrawMode):h.mode===lf.TRIANGLE_FAN&&(c.geometry=aA(c.geometry,eR.TriangleFanDrawMode));else if(h.mode===lf.LINES)c=new eR.LineSegments(u,d);else if(h.mode===lf.LINE_STRIP)c=new eR.Line(u,d);else if(h.mode===lf.LINE_LOOP)c=new eR.LineLoop(u,d);else if(h.mode===lf.POINTS)c=new eR.Points(u,d);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);Object.keys(c.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,n=r.length;t<n;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(c,i),c.name=t.createUniqueName(i.name||"mesh_"+e),lx(c,i),h.extensions&&lB(n,c,h),t.assignFinalMaterial(c),l.push(c)}for(let r=0,n=l.length;r<n;r++)t.associations.set(l[r],{meshes:e,primitives:r});if(1===l.length)return i.extensions&&lB(n,l[0],i),l[0];let c=new eR.Group;i.extensions&&lB(n,c,i),t.associations.set(c,{meshes:e});for(let e=0,t=l.length;e<t;e++)c.add(l[e]);return c})}loadCamera(e){let t;let r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new eR.PerspectiveCamera(eR.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new eR.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),lx(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,n=t.joints.length;e<n;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),n=[],i=[];for(let o=0,a=e.length;o<a;o++){let a=e[o];if(a){n.push(a);let e=new eR.Matrix4;null!==r&&e.fromArray(r.array,16*o),i.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new eR.Skeleton(n,i)})}loadAnimation(e){let t=this.json,r=this,n=t.animations[e],i=n.name?n.name:"animation_"+e,o=[],a=[],s=[],l=[],c=[];for(let e=0,t=n.channels.length;e<t;e++){let t=n.channels[e],r=n.samplers[t.sampler],i=t.target,u=i.node,h=void 0!==n.parameters?n.parameters[r.input]:r.input,d=void 0!==n.parameters?n.parameters[r.output]:r.output;void 0!==i.node&&(o.push(this.getDependency("node",u)),a.push(this.getDependency("accessor",h)),s.push(this.getDependency("accessor",d)),l.push(r),c.push(i))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(s),Promise.all(l),Promise.all(c)]).then(function(e){let t=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=[];for(let e=0,i=t.length;e<i;e++){let i=t[e],c=n[e],u=o[e],h=a[e],d=s[e];if(void 0===i)continue;i.updateMatrix&&i.updateMatrix();let A=r._createAnimationTracks(i,c,u,h,d);if(A)for(let e=0;e<A.length;e++)l.push(A[e])}return new eR.AnimationClip(i,void 0,l)})}createNodeMesh(e){let t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]}),t})}loadNode(e){let t=this.json.nodes[e],r=this._loadNodeShallow(e),n=[],i=t.children||[];for(let e=0,t=i.length;e<t;e++)n.push(this.getDependency("node",i[e]));let o=void 0===t.skin?Promise.resolve(null):this.getDependency("skin",t.skin);return Promise.all([r,Promise.all(n),o]).then(function(e){let t=e[0],r=e[1],n=e[2];null!==n&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(n,l_)});for(let e=0,n=r.length;e<n;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let i=t.nodes[e],o=i.name?n.createUniqueName(i.name):"",a=[],s=n._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return s&&a.push(s),void 0!==i.camera&&a.push(n.getDependency("camera",i.camera).then(function(e){return n._getNodeRef(n.cameraCache,i.camera,e)})),n._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){a.push(e)}),this.nodeCache[e]=Promise.all(a).then(function(t){let a;if((a=!0===i.isBone?new eR.Bone:t.length>1?new eR.Group:1===t.length?t[0]:new eR.Object3D)!==t[0])for(let e=0,r=t.length;e<r;e++)a.add(t[e]);if(i.name&&(a.userData.name=i.name,a.name=o),lx(a,i),i.extensions&&lB(r,a,i),void 0!==i.matrix){let e=new eR.Matrix4;e.fromArray(i.matrix),a.applyMatrix4(e)}else void 0!==i.translation&&a.position.fromArray(i.translation),void 0!==i.rotation&&a.quaternion.fromArray(i.rotation),void 0!==i.scale&&a.scale.fromArray(i.scale);return n.associations.has(a)||n.associations.set(a,{}),n.associations.get(a).nodes=e,a}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],n=this,i=new eR.Group;r.name&&(i.name=n.createUniqueName(r.name)),lx(i,r),r.extensions&&lB(t,i,r);let o=r.nodes||[],a=[];for(let e=0,t=o.length;e<t;e++)a.push(n.getDependency("node",o[e]));return Promise.all(a).then(function(e){for(let t=0,r=e.length;t<r;t++)i.add(e[t]);return n.associations=(e=>{let t=new Map;for(let[e,r]of n.associations)(e instanceof eR.Material||e instanceof eR.Texture)&&t.set(e,r);return e.traverse(e=>{let r=n.associations.get(e);null!=r&&t.set(e,r)}),t})(i),i})}_createAnimationTracks(e,t,r,n,i){let o;let a=[],s=e.name?e.name:e.uuid,l=[];switch(lE[i.path]===lE.weights?e.traverse(function(e){e.morphTargetInfluences&&l.push(e.name?e.name:e.uuid)}):l.push(s),lE[i.path]){case lE.weights:o=eR.NumberKeyframeTrack;break;case lE.rotation:o=eR.QuaternionKeyframeTrack;break;case lE.position:case lE.scale:o=eR.VectorKeyframeTrack;break;default:o=1===r.itemSize?eR.NumberKeyframeTrack:eR.VectorKeyframeTrack}let c=void 0!==n.interpolation?lC[n.interpolation]:eR.InterpolateLinear,u=this._getArrayFromAccessor(r);for(let e=0,r=l.length;e<r;e++){let r=new o(l[e]+"."+lE[i.path],t.array,u,c);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(r),a.push(r)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=lb(t.constructor),r=new Float32Array(t.length);for(let n=0,i=t.length;n<i;n++)r[n]=t[n]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof eR.QuaternionKeyframeTrack?lA:lh)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new sq,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,n=!1,i=-1;"undefined"!=typeof navigator&&void 0!==navigator.userAgent&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=(n=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||n&&i<98?this.textureLoader=new eR.TextureLoader(this.options.manager):this.textureLoader=new eR.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new eR.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}}function lS(e,t,r){let n=t.attributes,i=[];for(let t in n){let o=ly[t]||t.toLowerCase();o in e.attributes||i.push(function(t,n){return r.getDependency("accessor",t).then(function(t){e.setAttribute(n,t)})}(n[t],o))}if(void 0!==t.indices&&!e.index){let n=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(n)}return lx(e,t),!function(e,t,r){let n=t.attributes,i=new eR.Box3;if(void 0===n.POSITION)return;{let e=r.json.accessors[n.POSITION],t=e.min,o=e.max;if(void 0!==t&&void 0!==o){if(i.set(new eR.Vector3(t[0],t[1],t[2]),new eR.Vector3(o[0],o[1],o[2])),e.normalized){let t=lb(lp[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let o=t.targets;if(void 0!==o){let e=new eR.Vector3,t=new eR.Vector3;for(let n=0,i=o.length;n<i;n++){let i=o[n];if(void 0!==i.POSITION){let n=r.json.accessors[i.POSITION],o=n.min,a=n.max;if(void 0!==o&&void 0!==a){if(t.setX(Math.max(Math.abs(o[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(o[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(o[2]),Math.abs(a[2]))),n.normalized){let e=lb(lp[n.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;let a=new eR.Sphere;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=a}(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){let n=!1,i=!1,o=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(i=!0),void 0!==r.COLOR_0&&(o=!0),n&&i&&o)break}if(!n&&!i&&!o)return Promise.resolve(e);let a=[],s=[],l=[];for(let c=0,u=t.length;c<u;c++){let u=t[c];if(n){let t=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;a.push(t)}if(i){let t=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal;s.push(t)}if(o){let t=void 0!==u.COLOR_0?r.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(s),Promise.all(l)]).then(function(t){let r=t[0],a=t[1],s=t[2];return n&&(e.morphAttributes.position=r),i&&(e.morphAttributes.normal=a),o&&(e.morphAttributes.color=s),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}let lT=null,lD="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function lR(e,t,r){return n=>{r&&r(n),e&&(lT||(lT=new sN),lT.setDecoderPath("string"==typeof e?e:lD),n.setDRACOLoader(lT)),t&&n.setMeshoptDecoder("function"==typeof sH?sH():sH)}}function lP(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=arguments.length>3?arguments[3]:void 0;return(0,eP.F)(sW,e,lR(t,r,n))}lP.preload=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=arguments.length>3?arguments[3]:void 0;return eP.F.preload(sW,e,lR(t,r,n))},lP.clear=e=>eP.F.clear(sW,e),lP.setDecoderPath=e=>{lD=e};let lF=eT.forwardRef((e,t)=>{let{src:r,useDraco:n,useMeshOpt:i,extendLoader:o,...a}=e,{scene:s}=lP(r,n,i,o);return eT.createElement(sb,(0,eS.Z)({ref:t},a,{object:s}))});class lQ{constructor(e,t=" .:-=+*#%@",r={}){let n,i,o,a,s;let l=r.resolution||.15,c=r.scale||1,u=r.color||!1,h=r.alpha||!1,d=r.block||!1,A=r.invert||!1,f=r.strResolution||"low",p=document.createElement("div");p.style.cursor="default";let m=document.createElement("table");p.appendChild(m),this.setSize=function(t,r){n=t,i=r,e.setSize(t,r),function(){o=Math.floor(n*l),a=Math.floor(i*l),y.width=o,y.height=a,(s=e.domElement).style.backgroundColor&&(m.rows[0].cells[0].style.backgroundColor=s.style.backgroundColor,m.rows[0].cells[0].style.color=s.style.color),m.cellSpacing=0,m.cellPadding=0;let t=m.style;t.whiteSpace="pre",t.margin="0px",t.padding="0px",t.letterSpacing=x+"px",t.fontFamily=g,t.fontSize=w+"px",t.lineHeight=B+"px",t.textAlign="left",t.textDecoration="none"}()},this.render=function(t,r){e.render(t,r),function(e){E.clearRect(0,0,o,a),E.drawImage(v,0,0,o,a);let t=E.getImageData(0,0,o,a).data,r="";for(let e=0;e<a;e+=2){for(let n=0;n<o;n++){let i,a;let s=(e*o+n)*4,l=t[s],c=t[s+1],f=t[s+2],p=t[s+3];a=(.3*l+.59*c+.11*f)/255,0==p&&(a=1),i=Math.floor((1-a)*(C.length-1)),A&&(i=C.length-i-1);let m=C[i];(void 0===m||" "==m)&&(m="&nbsp;"),u?r+="<span style='color:rgb("+l+","+c+","+f+");"+(d?"background-color:rgb("+l+","+c+","+f+");":"")+(h?"opacity:"+p/255+";":"")+"'>"+m+"</span>":r+=m}r+="<br/>"}e.innerHTML='<tr><td style="display:block;width:'.concat(n,"px;height:").concat(i,'px;overflow:hidden">').concat(r,"</td></tr>")}(m)},this.domElement=p;let g="courier new, monospace",v=e.domElement,y=document.createElement("canvas");if(!y.getContext)return;let E=y.getContext("2d");if(!E.getImageData)return;let C=u?" CGO08@".split(""):" .,:;i1tfLCG08@".split("");t&&(C=t);let w=2/l*c,B=2/l*c,x=0;if("low"==f)switch(c){case 1:x=-1;break;case 2:case 3:x=-2.1;break;case 4:x=-3.1;break;case 5:x=-4.15}if("medium"==f)switch(c){case 1:x=0;break;case 2:x=-1;break;case 3:x=-1.04;break;case 4:case 5:x=-2.1}if("high"==f)switch(c){case 1:case 2:x=0;break;case 3:case 4:case 5:x=-1}}}function lO(e){let{renderIndex:t=1,bgColor:r="black",fgColor:n="white",characters:i=" .:-+*=%@#",invert:o=!0,color:a=!1,resolution:s=.15}=e,{size:l,gl:c,scene:u,camera:h}=(0,eP.A)(),d=eT.useMemo(()=>{let e=new lQ(c,i,{invert:o,color:a,resolution:s});return e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.left="0px",e.domElement.style.pointerEvents="none",e},[i,o,a,s]);return eT.useLayoutEffect(()=>{d.domElement.style.color=n,d.domElement.style.backgroundColor=r},[n,r]),eT.useEffect(()=>(c.domElement.style.opacity="0",c.domElement.parentNode.appendChild(d.domElement),()=>{c.domElement.style.opacity="1",c.domElement.parentNode.removeChild(d.domElement)}),[d]),eT.useEffect(()=>{d.setSize(l.width,l.height)},[d,l]),(0,eP.C)(e=>{d.render(u,h)},t),eT.createElement(eT.Fragment,null)}let lL=a1({alphaTest:0,viewport:new eR.Vector2(1980,1080),focal:1e3,centerAndScaleTexture:null,covAndColorTexture:null},"\n    precision highp sampler2D;\n    precision highp usampler2D;\n    out vec4 vColor;\n    out vec3 vPosition;\n    uniform vec2 resolution;\n    uniform vec2 viewport;\n    uniform float focal;\n    attribute uint splatIndex;\n    uniform sampler2D centerAndScaleTexture;\n    uniform usampler2D covAndColorTexture;    \n\n    vec2 unpackInt16(in uint value) {\n      int v = int(value);\n      int v0 = v >> 16;\n      int v1 = (v & 0xFFFF);\n      if((v & 0x8000) != 0)\n        v1 |= 0xFFFF0000;\n      return vec2(float(v1), float(v0));\n    }\n\n    void main () {\n      ivec2 texSize = textureSize(centerAndScaleTexture, 0);\n      ivec2 texPos = ivec2(splatIndex%uint(texSize.x), splatIndex/uint(texSize.x));\n      vec4 centerAndScaleData = texelFetch(centerAndScaleTexture, texPos, 0);\n      vec4 center = vec4(centerAndScaleData.xyz, 1);\n      vec4 camspace = modelViewMatrix * center;\n      vec4 pos2d = projectionMatrix * camspace;\n\n      float bounds = 1.2 * pos2d.w;\n      if (pos2d.z < -pos2d.w || pos2d.x < -bounds || pos2d.x > bounds\n        || pos2d.y < -bounds || pos2d.y > bounds) {\n        gl_Position = vec4(0.0, 0.0, 2.0, 1.0);\n        return;\n      }\n\n      uvec4 covAndColorData = texelFetch(covAndColorTexture, texPos, 0);\n      vec2 cov3D_M11_M12 = unpackInt16(covAndColorData.x) * centerAndScaleData.w;\n      vec2 cov3D_M13_M22 = unpackInt16(covAndColorData.y) * centerAndScaleData.w;\n      vec2 cov3D_M23_M33 = unpackInt16(covAndColorData.z) * centerAndScaleData.w;\n      mat3 Vrk = mat3(\n        cov3D_M11_M12.x, cov3D_M11_M12.y, cov3D_M13_M22.x,\n        cov3D_M11_M12.y, cov3D_M13_M22.y, cov3D_M23_M33.x,\n        cov3D_M13_M22.x, cov3D_M23_M33.x, cov3D_M23_M33.y\n      );\n\n      mat3 J = mat3(\n        focal / camspace.z, 0., -(focal * camspace.x) / (camspace.z * camspace.z),\n        0., focal / camspace.z, -(focal * camspace.y) / (camspace.z * camspace.z),\n        0., 0., 0.\n      );\n\n      mat3 W = transpose(mat3(modelViewMatrix));\n      mat3 T = W * J;\n      mat3 cov = transpose(T) * Vrk * T;\n      vec2 vCenter = vec2(pos2d) / pos2d.w;\n      float diagonal1 = cov[0][0] + 0.3;\n      float offDiagonal = cov[0][1];\n      float diagonal2 = cov[1][1] + 0.3;\n      float mid = 0.5 * (diagonal1 + diagonal2);\n      float radius = length(vec2((diagonal1 - diagonal2) / 2.0, offDiagonal));\n      float lambda1 = mid + radius;\n      float lambda2 = max(mid - radius, 0.1);\n      vec2 diagonalVector = normalize(vec2(offDiagonal, lambda1 - diagonal1));\n      vec2 v1 = min(sqrt(2.0 * lambda1), 1024.0) * diagonalVector;\n      vec2 v2 = min(sqrt(2.0 * lambda2), 1024.0) * vec2(diagonalVector.y, -diagonalVector.x);\n      uint colorUint = covAndColorData.w;\n      vColor = vec4(\n        float(colorUint & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(8)) & uint(0xFF)) / 255.0,\n        float((colorUint >> uint(16)) & uint(0xFF)) / 255.0,\n        float(colorUint >> uint(24)) / 255.0\n      );\n      vPosition = position;\n\n      gl_Position = vec4(\n        vCenter \n          + position.x * v2 / viewport * 2.0 \n          + position.y * v1 / viewport * 2.0, pos2d.z / pos2d.w, 1.0);\n    }\n    ","\n    #include <alphatest_pars_fragment>\n    #include <alphahash_pars_fragment>\n    in vec4 vColor;\n    in vec3 vPosition;\n    void main () {\n      float A = -dot(vPosition.xy, vPosition.xy);\n      if (A < -4.0) discard;\n      float B = exp(A) * vColor.a;\n      vec4 diffuseColor = vec4(vColor.rgb, B);\n      #include <alphatest_fragment>\n      #include <alphahash_fragment>\n      gl_FragColor = diffuseColor;\n      #include <tonemapping_fragment>\n      #include <".concat(parseInt(eR.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment",">\n    }\n  "));function lk(e){let t=null,r=0;e.onmessage=n=>{if("push"==n.data.method){0===r&&(t=new Float32Array(n.data.length));let e=new Float32Array(n.data.matrices);t.set(e,r),r+=e.length}else if("sort"==n.data.method&&null!==t){let r=function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.length/16,i=-1/0,o=1/0,a=new Float32Array(n),s=new Int32Array(a.buffer),l=new Int32Array(n),c=0;for(let s=0;s<n;s++){let n=e[0]*t[16*s+12]+e[1]*t[16*s+13]+e[2]*t[16*s+14]+e[3];(r||n<0&&t[16*s+15]>-.0001*n)&&(a[c]=n,l[c]=s,c++,n>i&&(i=n),n<o&&(o=n))}let u=65535/(i-o),h=new Uint32Array(65536);for(let e=0;e<c;e++)s[e]=(a[e]-o)*u|0,h[s[e]]++;let d=new Uint32Array(65536);for(let e=1;e<65536;e++)d[e]=d[e-1]+h[e-1];let A=new Uint32Array(c);for(let e=0;e<c;e++)A[d[s[e]]++]=l[e];return A}(new Float32Array(n.data.view),n.data.hashed);e.postMessage({indices:r,key:n.data.key},[r.buffer])}}}class lU extends eR.Loader{load(e,t,r,n){let i={gl:this.gl,url:this.manager.resolveURL(e),worker:new Worker(URL.createObjectURL(new Blob(["(",lk.toString(),")(self)"],{type:"application/javascript"}))),manager:this.manager,update:(e,t,r)=>(function(e,t,r,n){if(e.updateMatrixWorld(),t.gl.getCurrentViewport(r.viewport),r.material.viewport.x=r.viewport.z,r.material.viewport.y=r.viewport.w,r.material.focal=r.viewport.w/2*Math.abs(e.projectionMatrix.elements[5]),r.ready){if(n&&r.sorted)return;r.ready=!1;let e=new Float32Array([r.modelViewMatrix.elements[2],-r.modelViewMatrix.elements[6],r.modelViewMatrix.elements[10],r.modelViewMatrix.elements[14]]);t.worker.postMessage({method:"sort",src:t.url,key:r.uuid,view:e.buffer,hashed:n},[e.buffer]),n&&t.loaded&&(r.sorted=!0)}})(t,i,e,r),connect:e=>(function(e,t){e.loading||lN(e),t.ready=!1,t.pm=new eR.Matrix4,t.vm1=new eR.Matrix4,t.vm2=new eR.Matrix4,t.viewport=new eR.Vector4;let r=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight),n=new eR.InstancedBufferAttribute(r,1,!1);n.setUsage(eR.DynamicDrawUsage);let i=t.geometry=new eR.InstancedBufferGeometry,o=new Float32Array(18),a=new eR.BufferAttribute(o,3);function s(e){if(t&&e.data.key===t.uuid){let r=new Uint32Array(e.data.indices);i.attributes.splatIndex.set(r),i.attributes.splatIndex.needsUpdate=!0,i.instanceCount=r.length,t.ready=!0}}return i.setAttribute("position",a),a.setXYZ(2,-2,2,0),a.setXYZ(1,2,2,0),a.setXYZ(0,-2,-2,0),a.setXYZ(5,-2,-2,0),a.setXYZ(4,2,2,0),a.setXYZ(3,2,-2,0),a.needsUpdate=!0,i.setAttribute("splatIndex",n),i.instanceCount=1,e.worker.addEventListener("message",s),async function(){for(;;){let t=e.gl.properties.get(e.centerAndScaleTexture),r=e.gl.properties.get(e.covAndColorTexture);if(null!=t&&t.__webglTexture&&null!=r&&r.__webglTexture&&e.loadedVertexCount>0)break;await new Promise(e=>setTimeout(e,10))}t.ready=!0}(),()=>e.worker.removeEventListener("message",s)})(i,e),loading:!1,loaded:!1,loadedVertexCount:0,chunkSize:this.chunkSize,totalDownloadBytes:0,numVertices:0,rowLength:32,maxVertexes:0,bufferTextureWidth:0,bufferTextureHeight:0,stream:null,centerAndScaleData:null,covAndColorData:null,covAndColorTexture:null,centerAndScaleTexture:null,onProgress:r};lG(i).then(t).catch(e=>{null==n||n(e),i.manager.itemError(i.url)})}constructor(...e){super(...e),this.gl=null,this.chunkSize=25e3}}async function lG(e){e.manager.itemStart(e.url);let t=await fetch(e.url);if(null===t.body)throw"Failed to fetch file";let r=t.headers.get("Content-Length"),n=r?parseInt(r):void 0;if(void 0==n)throw"Failed to get content length";e.stream=t.body.getReader(),e.totalDownloadBytes=n,e.numVertices=Math.floor(e.totalDownloadBytes/e.rowLength);let i=e.gl.getContext(),o=i.getParameter(i.MAX_TEXTURE_SIZE);return e.maxVertexes=o*o,e.numVertices>e.maxVertexes&&(e.numVertices=e.maxVertexes),e.bufferTextureWidth=o,e.bufferTextureHeight=Math.floor((e.numVertices-1)/o)+1,e.centerAndScaleData=new Float32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.covAndColorData=new Uint32Array(e.bufferTextureWidth*e.bufferTextureHeight*4),e.centerAndScaleTexture=new eR.DataTexture(e.centerAndScaleData,e.bufferTextureWidth,e.bufferTextureHeight,eR.RGBAFormat,eR.FloatType),e.centerAndScaleTexture.needsUpdate=!0,e.covAndColorTexture=new eR.DataTexture(e.covAndColorData,e.bufferTextureWidth,e.bufferTextureHeight,eR.RGBAIntegerFormat,eR.UnsignedIntType),e.covAndColorTexture.internalFormat="RGBA32UI",e.covAndColorTexture.needsUpdate=!0,e}async function lN(e){e.loading=!0;let t=0,r=0,n=[],i=0,o=0!==e.totalDownloadBytes;for(;;)try{let{value:a,done:s}=await e.stream.read();if(s)break;if(t+=a.length,void 0!=e.totalDownloadBytes){let r=t/e.totalDownloadBytes*100;if(e.onProgress&&r-i>1){let n=new ProgressEvent("progress",{lengthComputable:o,loaded:t,total:e.totalDownloadBytes});e.onProgress(n),i=r}}n.push(a);let l=t-r;if(void 0!=e.totalDownloadBytes&&l>e.rowLength*e.chunkSize){let t=Math.floor(l/e.rowLength),i=new Uint8Array(l),a=0;for(let e of n)i.set(e,a),a+=e.length;if(n.length=0,l>t*e.rowLength){let r=new Uint8Array(l-t*e.rowLength);r.set(i.subarray(l-r.length,l),0),n.push(r)}let s=new Uint8Array(t*e.rowLength);s.set(i.subarray(0,s.byteLength),0);let c=lz(e,s.buffer,t);if(e.worker.postMessage({method:"push",src:e.url,length:16*e.numVertices,matrices:c.buffer},[c.buffer]),r+=t*e.rowLength,e.onProgress){let t=new ProgressEvent("progress",{lengthComputable:o,loaded:e.totalDownloadBytes,total:e.totalDownloadBytes});e.onProgress(t)}}}catch(e){console.error(e);break}if(t-r>0){let t=new Uint8Array(n.reduce((e,t)=>e+t.length,0)),r=0;for(let e of n)t.set(e,r),r+=e.length;let i=Math.floor(t.byteLength/e.rowLength),o=lz(e,t.buffer,i);e.worker.postMessage({method:"push",src:e.url,length:16*i,matrices:o.buffer},[o.buffer])}e.loaded=!0,e.manager.itemEnd(e.url)}function lz(e,t,r){let n=e.gl.getContext();if(e.loadedVertexCount+r>e.maxVertexes&&(r=e.maxVertexes-e.loadedVertexCount),r<=0)throw"Failed to parse file";let i=new Uint8Array(t),o=new Float32Array(t),a=new Float32Array(16*r),s=new Uint8Array(e.covAndColorData.buffer),l=new Int16Array(e.covAndColorData.buffer);for(let t=0;t<r;t++){let r=new eR.Quaternion(-(i[32*t+28+1]-128)/128,(i[32*t+28+2]-128)/128,(i[32*t+28+3]-128)/128,-(i[32*t+28+0]-128)/128);r.invert();let n=new eR.Vector3(o[8*t+0],o[8*t+1],-o[8*t+2]),c=new eR.Vector3(o[8*t+3+0],o[8*t+3+1],o[8*t+3+2]),u=new eR.Matrix4;u.makeRotationFromQuaternion(r),u.transpose(),u.scale(c);let h=u.clone();u.transpose(),u.premultiply(h),u.setPosition(n);let d=[0,1,2,5,6,10],A=0;for(let e=0;e<d.length;e++)Math.abs(u.elements[d[e]])>A&&(A=Math.abs(u.elements[d[e]]));let f=4*e.loadedVertexCount+4*t;e.centerAndScaleData[f+0]=n.x,e.centerAndScaleData[f+1]=-n.y,e.centerAndScaleData[f+2]=n.z,e.centerAndScaleData[f+3]=A/32767,f=8*e.loadedVertexCount+8*t;for(let e=0;e<d.length;e++)l[f+e]=32767*u.elements[d[e]]/A;f=16*e.loadedVertexCount+(4*t+3)*4;let p=new eR.Color(i[32*t+24+0]/255,i[32*t+24+1]/255,i[32*t+24+2]/255);p.convertSRGBToLinear(),s[f+0]=255*p.r,s[f+1]=255*p.g,s[f+2]=255*p.b,s[f+3]=i[32*t+24+3],u.elements[15]=Math.max(c.x,c.y,c.z)*i[32*t+24+3]/255;for(let e=0;e<16;e++)a[16*t+e]=u.elements[e]}for(;r>0;){let t=0,i=0,o=e.loadedVertexCount%e.bufferTextureWidth,a=Math.floor(e.loadedVertexCount/e.bufferTextureWidth);e.loadedVertexCount%e.bufferTextureWidth!=0?(t=Math.min(e.bufferTextureWidth,o+r)-o,i=1):Math.floor(r/e.bufferTextureWidth)>0?(t=e.bufferTextureWidth,i=Math.floor(r/e.bufferTextureWidth)):(t=r%e.bufferTextureWidth,i=1);let s=e.gl.properties.get(e.centerAndScaleTexture);n.bindTexture(n.TEXTURE_2D,s.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,o,a,t,i,n.RGBA,n.FLOAT,e.centerAndScaleData,4*e.loadedVertexCount);let l=e.gl.properties.get(e.covAndColorTexture);n.bindTexture(n.TEXTURE_2D,l.__webglTexture),n.texSubImage2D(n.TEXTURE_2D,0,o,a,t,i,n.RGBA_INTEGER,n.UNSIGNED_INT,e.covAndColorData,4*e.loadedVertexCount),e.gl.resetState(),e.loadedVertexCount+=t*i,r-=t*i}return a}function lH(e){let{src:t,toneMapped:r=!1,alphaTest:n=0,alphaHash:i=!1,chunkSize:o=25e3,...a}=e;(0,eP.e)({SplatMaterial:lL});let s=eT.useRef(null),l=(0,eP.A)(e=>e.gl),c=(0,eP.A)(e=>e.camera),u=(0,eP.F)(lU,t,e=>{e.gl=l,e.chunkSize=o});return eT.useLayoutEffect(()=>u.connect(s.current),[t]),(0,eP.C)(()=>u.update(s.current,c,i)),eT.createElement("mesh",(0,eS.Z)({ref:s,frustumCulled:!1},a),eT.createElement("splatMaterial",{key:"".concat(t,"/").concat(n,"/").concat(i).concat(lL.key),transparent:!i,depthTest:!0,alphaTest:i?0:n,centerAndScaleTexture:u.centerAndScaleTexture,covAndColorTexture:u.covAndColorTexture,depthWrite:!!i||n>0,blending:i?eR.NormalBlending:eR.CustomBlending,blendSrcAlpha:eR.OneFactor,alphaHash:!!i,toneMapped:r}))}function lV(e,t,r){let n=(0,eP.A)(e=>e.size),i=(0,eP.A)(e=>e.viewport),o="number"==typeof e?e:n.width*i.dpr,a="number"==typeof t?t:n.height*i.dpr,{samples:s=0,depth:l,...c}=("number"==typeof e?r:e)||{},u=eT.useMemo(()=>{let e=new eR.WebGLRenderTarget(o,a,{minFilter:eR.LinearFilter,magFilter:eR.LinearFilter,type:eR.HalfFloatType,...c});return l&&(e.depthTexture=new eR.DepthTexture(o,a,eR.FloatType)),e.samples=s,e},[]);return eT.useLayoutEffect(()=>{u.setSize(o,a),s&&(u.samples=s)},[s,u,o,a]),eT.useEffect(()=>()=>u.dispose(),[]),u}let lj=e=>{let{children:t,width:r,height:n,...i}=e,o=lV(r,n,i);return eT.createElement(eT.Fragment,null,null==t?void 0:t(o))},lJ=e=>"function"==typeof e,lY=eT.forwardRef((e,t)=>{let{envMap:r,resolution:n=256,frames:i=1/0,children:o,makeDefault:a,...s}=e,l=(0,eP.A)(e=>{let{set:t}=e;return t}),c=(0,eP.A)(e=>{let{camera:t}=e;return t}),u=(0,eP.A)(e=>{let{size:t}=e;return t}),h=eT.useRef(null);eT.useImperativeHandle(t,()=>h.current,[]);let d=eT.useRef(null),A=lV(n);eT.useLayoutEffect(()=>{s.manual||h.current.updateProjectionMatrix()},[u,s]),eT.useLayoutEffect(()=>{h.current.updateProjectionMatrix()}),eT.useLayoutEffect(()=>{if(a)return l(()=>({camera:h.current})),()=>l(()=>({camera:c}))},[h,a,l]);let f=0,p=null,m=lJ(o);return(0,eP.C)(e=>{m&&(i===1/0||f<i)&&(d.current.visible=!1,e.gl.setRenderTarget(A),p=e.scene.background,r&&(e.scene.background=r),e.gl.render(e.scene,h.current),e.scene.background=p,e.gl.setRenderTarget(null),d.current.visible=!0,f++)}),eT.createElement(eT.Fragment,null,eT.createElement("orthographicCamera",(0,eS.Z)({left:-(u.width/2),right:u.width/2,top:u.height/2,bottom:-(u.height/2),ref:h},s),!m&&o),eT.createElement("group",{ref:d},m&&o(A.texture)))}),lW=e=>"function"==typeof e,lq=eT.forwardRef((e,t)=>{let{envMap:r,resolution:n=256,frames:i=1/0,makeDefault:o,children:a,...s}=e,l=(0,eP.A)(e=>{let{set:t}=e;return t}),c=(0,eP.A)(e=>{let{camera:t}=e;return t}),u=(0,eP.A)(e=>{let{size:t}=e;return t}),h=eT.useRef(null);eT.useImperativeHandle(t,()=>h.current,[]);let d=eT.useRef(null),A=lV(n);eT.useLayoutEffect(()=>{s.manual||(h.current.aspect=u.width/u.height)},[u,s]),eT.useLayoutEffect(()=>{h.current.updateProjectionMatrix()});let f=0,p=null,m=lW(a);return(0,eP.C)(e=>{m&&(i===1/0||f<i)&&(d.current.visible=!1,e.gl.setRenderTarget(A),p=e.scene.background,r&&(e.scene.background=r),e.gl.render(e.scene,h.current),e.scene.background=p,e.gl.setRenderTarget(null),d.current.visible=!0,f++)}),eT.useLayoutEffect(()=>{if(o)return l(()=>({camera:h.current})),()=>l(()=>({camera:c}))},[h,o,l]),eT.createElement(eT.Fragment,null,eT.createElement("perspectiveCamera",(0,eS.Z)({ref:h},s),!m&&a),eT.createElement("group",{ref:d},m&&a(A.texture)))});function lK(){let e,t,{resolution:r=256,near:n=.1,far:i=1e3,envMap:o,fog:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,eP.A)(e=>{let{gl:t}=e;return t}),l=(0,eP.A)(e=>{let{scene:t}=e;return t}),c=(0,eT.useMemo)(()=>{let e=new eR.WebGLCubeRenderTarget(r);return e.texture.type=eR.HalfFloatType,e},[r]);(0,eT.useEffect)(()=>()=>{c.dispose()},[c]);let u=(0,eT.useMemo)(()=>new eR.CubeCamera(n,i,c),[n,i,c]),h=eT.useCallback(()=>{e=l.fog,t=l.background,l.background=o||t,l.fog=a||e,u.update(s,l),l.fog=e,l.background=t},[s,l,u]);return{fbo:c,camera:u,update:h}}function lX(e){let{children:t,frames:r=1/0,resolution:n,near:i,far:o,envMap:a,fog:s,...l}=e,c=eT.useRef(null),{fbo:u,camera:h,update:d}=lK({resolution:n,near:i,far:o,envMap:a,fog:s}),A=0;return(0,eP.C)(()=>{c.current&&(r===1/0||A<r)&&(c.current.visible=!1,d(),c.current.visible=!0,A++)}),eT.createElement("group",l,eT.createElement("primitive",{object:h}),eT.createElement("group",{ref:c},null==t?void 0:t(u.texture)))}var lZ=Object.defineProperty,l$=(e,t,r)=>t in e?lZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l0=(e,t,r)=>(l$(e,"symbol"!=typeof t?t+"":t,r),r);class l1 extends eR.EventDispatcher{constructor(e){super(),l0(this,"object"),l0(this,"changeEvent",{type:"change"}),l0(this,"EPS",1e-6),l0(this,"enabled",!0),l0(this,"deviceOrientation",{alpha:0,beta:0,gamma:0}),l0(this,"screenOrientation",0),l0(this,"alphaOffset",0),l0(this,"onDeviceOrientationChangeEvent",e=>{this.deviceOrientation=e}),l0(this,"onScreenOrientationChangeEvent",()=>{this.screenOrientation=window.orientation||0}),l0(this,"zee",new eR.Vector3(0,0,1)),l0(this,"euler",new eR.Euler),l0(this,"q0",new eR.Quaternion),l0(this,"q1",new eR.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5))),l0(this,"setObjectQuaternion",(e,t,r,n,i)=>{this.euler.set(r,t,-n,"YXZ"),e.setFromEuler(this.euler),e.multiply(this.q1),e.multiply(this.q0.setFromAxisAngle(this.zee,-i))}),l0(this,"connect",()=>{this.onScreenOrientationChangeEvent(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then(e=>{"granted"==e&&(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent))}).catch(e=>{console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)}):(window.addEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent)),this.enabled=!0}),l0(this,"disconnect",()=>{window.removeEventListener("orientationchange",this.onScreenOrientationChangeEvent),window.removeEventListener("deviceorientation",this.onDeviceOrientationChangeEvent),this.enabled=!1}),l0(this,"lastQuaternion",new eR.Quaternion),l0(this,"update",()=>{if(!1===this.enabled)return;let e=this.deviceOrientation;if(e){let t=e.alpha?eR.MathUtils.degToRad(e.alpha)+this.alphaOffset:0,r=e.beta?eR.MathUtils.degToRad(e.beta):0,n=e.gamma?eR.MathUtils.degToRad(e.gamma):0,i=this.screenOrientation?eR.MathUtils.degToRad(this.screenOrientation):0;this.setObjectQuaternion(this.object.quaternion,t,r,n,i),8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS&&(this.lastQuaternion.copy(this.object.quaternion),this.dispatchEvent(this.changeEvent))}}),l0(this,"dispose",()=>this.disconnect()),this.object=e,this.object.rotation.reorder("YXZ"),this.connect()}}let l2=eT.forwardRef((e,t)=>{let{camera:r,onChange:n,makeDefault:i,...o}=e,a=(0,eP.A)(e=>e.camera),s=(0,eP.A)(e=>e.invalidate),l=(0,eP.A)(e=>e.get),c=(0,eP.A)(e=>e.set),u=r||a,h=eT.useMemo(()=>new l1(u),[u]);return eT.useEffect(()=>{let e=e=>{s(),n&&n(e)};return null==h||null==h.addEventListener||h.addEventListener("change",e),()=>null==h||null==h.removeEventListener?void 0:h.removeEventListener("change",e)},[n,h,s]),(0,eP.C)(()=>null==h?void 0:h.update(),-1),eT.useEffect(()=>(null==h||h.connect(),()=>null==h?void 0:h.dispose()),[h]),eT.useEffect(()=>{if(i){let e=l().controls;return c({controls:h}),()=>c({controls:e})}},[i,h]),h?eT.createElement("primitive",(0,eS.Z)({ref:t,object:h},o)):null});var l3=Object.defineProperty,l4=(e,t,r)=>t in e?l3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l5=(e,t,r)=>(l4(e,"symbol"!=typeof t?t+"":t,r),r);function l9(e){e.preventDefault()}class l6 extends eR.EventDispatcher{constructor(e,t){super(),l5(this,"object"),l5(this,"domElement",null),l5(this,"movementSpeed",1),l5(this,"rollSpeed",.005),l5(this,"dragToLook",!1),l5(this,"autoForward",!1),l5(this,"changeEvent",{type:"change"}),l5(this,"EPS",1e-6),l5(this,"tmpQuaternion",new eR.Quaternion),l5(this,"mouseStatus",0),l5(this,"movementSpeedMultiplier",1),l5(this,"moveState",{up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0}),l5(this,"moveVector",new eR.Vector3(0,0,0)),l5(this,"rotationVector",new eR.Vector3(0,0,0)),l5(this,"keydown",e=>{if(!e.altKey){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}}),l5(this,"keyup",e=>{switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()}),l5(this,"pointerdown",e=>{if(this.dragToLook)this.mouseStatus++;else{switch(e.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}}),l5(this,"pointermove",e=>{if(!this.dragToLook||this.mouseStatus>0){let t=this.getContainerDimensions(),r=t.size[0]/2,n=t.size[1]/2;this.moveState.yawLeft=-(e.pageX-t.offset[0]-r)/r,this.moveState.pitchDown=(e.pageY-t.offset[1]-n)/n,this.updateRotationVector()}}),l5(this,"pointerup",e=>{if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(e.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()}),l5(this,"lastQuaternion",new eR.Quaternion),l5(this,"lastPosition",new eR.Vector3),l5(this,"update",e=>{let t=e*this.movementSpeed,r=e*this.rollSpeed;this.object.translateX(this.moveVector.x*t),this.object.translateY(this.moveVector.y*t),this.object.translateZ(this.moveVector.z*t),this.tmpQuaternion.set(this.rotationVector.x*r,this.rotationVector.y*r,this.rotationVector.z*r,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),(this.lastPosition.distanceToSquared(this.object.position)>this.EPS||8*(1-this.lastQuaternion.dot(this.object.quaternion))>this.EPS)&&(this.dispatchEvent(this.changeEvent),this.lastQuaternion.copy(this.object.quaternion),this.lastPosition.copy(this.object.position))}),l5(this,"updateMovementVector",()=>{let e=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-e+this.moveState.back}),l5(this,"updateRotationVector",()=>{this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft}),l5(this,"getContainerDimensions",()=>this.domElement==document||this.domElement instanceof Document?{size:[window.innerWidth,window.innerHeight],offset:[0,0]}:{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}),l5(this,"connect",e=>{this.domElement=e,e instanceof Document||e.setAttribute("tabindex",-1),this.domElement.addEventListener("contextmenu",l9),this.domElement.addEventListener("pointermove",this.pointermove),this.domElement.addEventListener("pointerdown",this.pointerdown),this.domElement.addEventListener("pointerup",this.pointerup),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup)}),l5(this,"dispose",()=>{this.domElement.removeEventListener("contextmenu",l9),this.domElement.removeEventListener("pointermove",this.pointermove),this.domElement.removeEventListener("pointerdown",this.pointerdown),this.domElement.removeEventListener("pointerup",this.pointerup),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup)}),this.object=e,void 0!==t&&this.connect(t),this.updateMovementVector(),this.updateRotationVector()}}let l8=eT.forwardRef((e,t)=>{let{domElement:r,...n}=e,{onChange:i,makeDefault:o,...a}=n,s=(0,eP.A)(e=>e.invalidate),l=(0,eP.A)(e=>e.camera),c=(0,eP.A)(e=>e.gl),u=(0,eP.A)(e=>e.events),h=(0,eP.A)(e=>e.get),d=(0,eP.A)(e=>e.set),A=r||u.connected||c.domElement,f=eT.useMemo(()=>new l6(l),[l]);return eT.useEffect(()=>(f.connect(A),()=>void f.dispose()),[A,f,s]),eT.useEffect(()=>{let e=e=>{s(),i&&i(e)};return null==f.addEventListener||f.addEventListener("change",e),()=>null==f.removeEventListener?void 0:f.removeEventListener("change",e)},[i,s]),eT.useEffect(()=>{if(o){let e=h().controls;return d({controls:f}),()=>d({controls:e})}},[o,f]),(0,eP.C)((e,t)=>f.update(t)),eT.createElement("primitive",(0,eS.Z)({ref:t,object:f,args:[l,A]},a))});var l7=Object.defineProperty,ce=(e,t,r)=>t in e?l7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ct=(e,t,r)=>(ce(e,"symbol"!=typeof t?t+"":t,r),r);let cr=new eR.Ray,cn=new eR.Plane,ci=Math.cos(Math.PI/180*70),co=(e,t)=>(e%t+t)%t;class ca extends eR.EventDispatcher{constructor(e,t){super(),ct(this,"object"),ct(this,"domElement"),ct(this,"enabled",!0),ct(this,"target",new eR.Vector3),ct(this,"minDistance",0),ct(this,"maxDistance",1/0),ct(this,"minZoom",0),ct(this,"maxZoom",1/0),ct(this,"minPolarAngle",0),ct(this,"maxPolarAngle",Math.PI),ct(this,"minAzimuthAngle",-1/0),ct(this,"maxAzimuthAngle",1/0),ct(this,"enableDamping",!1),ct(this,"dampingFactor",.05),ct(this,"enableZoom",!0),ct(this,"zoomSpeed",1),ct(this,"enableRotate",!0),ct(this,"rotateSpeed",1),ct(this,"enablePan",!0),ct(this,"panSpeed",1),ct(this,"screenSpacePanning",!0),ct(this,"keyPanSpeed",7),ct(this,"zoomToCursor",!1),ct(this,"autoRotate",!1),ct(this,"autoRotateSpeed",2),ct(this,"reverseOrbit",!1),ct(this,"reverseHorizontalOrbit",!1),ct(this,"reverseVerticalOrbit",!1),ct(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),ct(this,"mouseButtons",{LEFT:eR.MOUSE.ROTATE,MIDDLE:eR.MOUSE.DOLLY,RIGHT:eR.MOUSE.PAN}),ct(this,"touches",{ONE:eR.TOUCH.ROTATE,TWO:eR.TOUCH.DOLLY_PAN}),ct(this,"target0"),ct(this,"position0"),ct(this,"zoom0"),ct(this,"_domElementKeyEvents",null),ct(this,"getPolarAngle"),ct(this,"getAzimuthalAngle"),ct(this,"setPolarAngle"),ct(this,"setAzimuthalAngle"),ct(this,"getDistance"),ct(this,"listenToKeyEvents"),ct(this,"stopListenToKeyEvents"),ct(this,"saveState"),ct(this,"reset"),ct(this,"update"),ct(this,"connect"),ct(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=co(e,2*Math.PI),n=c.phi;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-n);2*Math.PI-i<i&&(t<n?t+=2*Math.PI:n+=2*Math.PI),u.phi=t-n,r.update()},this.setAzimuthalAngle=e=>{let t=co(e,2*Math.PI),n=c.theta;n<0&&(n+=2*Math.PI),t<0&&(t+=2*Math.PI);let i=Math.abs(t-n);2*Math.PI-i<i&&(t<n?t+=2*Math.PI:n+=2*Math.PI),u.theta=t-n,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",q),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",q),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),s=a.NONE},this.update=(()=>{let t=new eR.Vector3,i=new eR.Vector3(0,1,0),o=new eR.Quaternion().setFromUnitVectors(e.up,i),A=o.clone().invert(),f=new eR.Vector3,p=new eR.Quaternion,m=2*Math.PI;return function(){let g=r.object.position;o.setFromUnitVectors(e.up,i),A.copy(o).invert(),t.copy(g).sub(r.target),t.applyQuaternion(o),c.setFromVector3(t),r.autoRotate&&s===a.NONE&&M(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(c.theta+=u.theta*r.dampingFactor,c.phi+=u.phi*r.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let v=r.minAzimuthAngle,y=r.maxAzimuthAngle;isFinite(v)&&isFinite(y)&&(v<-Math.PI?v+=m:v>Math.PI&&(v-=m),y<-Math.PI?y+=m:y>Math.PI&&(y-=m),v<=y?c.theta=Math.max(v,Math.min(y,c.theta)):c.theta=c.theta>(v+y)/2?Math.max(v,c.theta):Math.min(y,c.theta)),c.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,c.phi)),c.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(d,r.dampingFactor):r.target.add(d),r.zoomToCursor&&x||r.object.isOrthographicCamera?c.radius=O(c.radius):c.radius=O(c.radius*h),t.setFromSpherical(c),t.applyQuaternion(A),g.copy(r.target).add(t),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),!0===r.enableDamping?(u.theta*=1-r.dampingFactor,u.phi*=1-r.dampingFactor,d.multiplyScalar(1-r.dampingFactor)):(u.set(0,0,0),d.set(0,0,0));let E=!1;if(r.zoomToCursor&&x){let n=null;if(r.object instanceof eR.PerspectiveCamera&&r.object.isPerspectiveCamera){let e=t.length();n=O(e*h);let i=e-n;r.object.position.addScaledVector(w,i),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){let e=new eR.Vector3(B.x,B.y,0);e.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix(),E=!0;let i=new eR.Vector3(B.x,B.y,0);i.unproject(r.object),r.object.position.sub(i).add(e),r.object.updateMatrixWorld(),n=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==n&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(n).add(r.object.position):(cr.origin.copy(r.object.position),cr.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(cr.direction))<ci?e.lookAt(r.target):(cn.setFromNormalAndCoplanarPoint(r.object.up,r.target),cr.intersectPlane(cn,r.target))))}else r.object instanceof eR.OrthographicCamera&&r.object.isOrthographicCamera&&(E=1!==h)&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix());return h=1,x=!1,!!(E||f.distanceToSquared(r.object.position)>l||8*(1-p.dot(r.object.quaternion))>l)&&(r.dispatchEvent(n),f.copy(r.object.position),p.copy(r.object.quaternion),E=!1,!0)}})(),this.connect=e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),r.domElement=e,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",K),r.domElement.addEventListener("pointerdown",j),r.domElement.addEventListener("pointercancel",Y),r.domElement.addEventListener("wheel",W)},this.dispose=()=>{var e,t,n,i,o,a;r.domElement&&(r.domElement.style.touchAction="auto"),null==(e=r.domElement)||e.removeEventListener("contextmenu",K),null==(t=r.domElement)||t.removeEventListener("pointerdown",j),null==(n=r.domElement)||n.removeEventListener("pointercancel",Y),null==(i=r.domElement)||i.removeEventListener("wheel",W),null==(o=r.domElement)||o.ownerDocument.removeEventListener("pointermove",J),null==(a=r.domElement)||a.ownerDocument.removeEventListener("pointerup",Y),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",q)};let r=this,n={type:"change"},i={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},s=a.NONE,l=1e-6,c=new eR.Spherical,u=new eR.Spherical,h=1,d=new eR.Vector3,A=new eR.Vector2,f=new eR.Vector2,p=new eR.Vector2,m=new eR.Vector2,g=new eR.Vector2,v=new eR.Vector2,y=new eR.Vector2,E=new eR.Vector2,C=new eR.Vector2,w=new eR.Vector3,B=new eR.Vector2,x=!1,I=[],b={};function _(){return Math.pow(.95,r.zoomSpeed)}function M(e){r.reverseOrbit||r.reverseHorizontalOrbit?u.theta+=e:u.theta-=e}function S(e){r.reverseOrbit||r.reverseVerticalOrbit?u.phi+=e:u.phi-=e}let T=(()=>{let e=new eR.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),d.add(e)}})(),D=(()=>{let e=new eR.Vector3;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),d.add(e)}})(),R=(()=>{let e=new eR.Vector3;return function(t,n){let i=r.domElement;if(i&&r.object instanceof eR.PerspectiveCamera&&r.object.isPerspectiveCamera){let o=r.object.position;e.copy(o).sub(r.target);let a=e.length();T(2*t*(a*=Math.tan(r.object.fov/2*Math.PI/180))/i.clientHeight,r.object.matrix),D(2*n*a/i.clientHeight,r.object.matrix)}else i&&r.object instanceof eR.OrthographicCamera&&r.object.isOrthographicCamera?(T(t*(r.object.right-r.object.left)/r.object.zoom/i.clientWidth,r.object.matrix),D(n*(r.object.top-r.object.bottom)/r.object.zoom/i.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function P(e){r.object instanceof eR.PerspectiveCamera&&r.object.isPerspectiveCamera||r.object instanceof eR.OrthographicCamera&&r.object.isOrthographicCamera?h/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function F(e){r.object instanceof eR.PerspectiveCamera&&r.object.isPerspectiveCamera||r.object instanceof eR.OrthographicCamera&&r.object.isOrthographicCamera?h*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function Q(e){if(!r.zoomToCursor||!r.domElement)return;x=!0;let t=r.domElement.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,o=t.width,a=t.height;B.x=n/o*2-1,B.y=-(i/a*2)+1,w.set(B.x,B.y,1).unproject(r.object).sub(r.object.position).normalize()}function O(e){return Math.max(r.minDistance,Math.min(r.maxDistance,e))}function L(e){A.set(e.clientX,e.clientY)}function k(e){m.set(e.clientX,e.clientY)}function U(){if(1==I.length)A.set(I[0].pageX,I[0].pageY);else{let e=.5*(I[0].pageX+I[1].pageX),t=.5*(I[0].pageY+I[1].pageY);A.set(e,t)}}function G(){if(1==I.length)m.set(I[0].pageX,I[0].pageY);else{let e=.5*(I[0].pageX+I[1].pageX),t=.5*(I[0].pageY+I[1].pageY);m.set(e,t)}}function N(){let e=I[0].pageX-I[1].pageX,t=I[0].pageY-I[1].pageY;y.set(0,Math.sqrt(e*e+t*t))}function z(e){if(1==I.length)f.set(e.pageX,e.pageY);else{let t=Z(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);f.set(r,n)}p.subVectors(f,A).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(M(2*Math.PI*p.x/t.clientHeight),S(2*Math.PI*p.y/t.clientHeight)),A.copy(f)}function H(e){if(1==I.length)g.set(e.pageX,e.pageY);else{let t=Z(e),r=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);g.set(r,n)}v.subVectors(g,m).multiplyScalar(r.panSpeed),R(v.x,v.y),m.copy(g)}function V(e){let t=Z(e),n=e.pageX-t.x,i=e.pageY-t.y;E.set(0,Math.sqrt(n*n+i*i)),C.set(0,Math.pow(E.y/y.y,r.zoomSpeed)),P(C.y),y.copy(E)}function j(e){var t,n;!1!==r.enabled&&(0===I.length&&(null==(t=r.domElement)||t.ownerDocument.addEventListener("pointermove",J),null==(n=r.domElement)||n.ownerDocument.addEventListener("pointerup",Y)),I.push(e),"touch"===e.pointerType?function(e){switch(X(e),I.length){case 1:switch(r.touches.ONE){case eR.TOUCH.ROTATE:if(!1===r.enableRotate)return;U(),s=a.TOUCH_ROTATE;break;case eR.TOUCH.PAN:if(!1===r.enablePan)return;G(),s=a.TOUCH_PAN;break;default:s=a.NONE}break;case 2:switch(r.touches.TWO){case eR.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&N(),r.enablePan&&G(),s=a.TOUCH_DOLLY_PAN;break;case eR.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&N(),r.enableRotate&&U(),s=a.TOUCH_DOLLY_ROTATE;break;default:s=a.NONE}break;default:s=a.NONE}s!==a.NONE&&r.dispatchEvent(i)}(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case eR.MOUSE.DOLLY:if(!1===r.enableZoom)return;Q(e),y.set(e.clientX,e.clientY),s=a.DOLLY;break;case eR.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;k(e),s=a.PAN}else{if(!1===r.enableRotate)return;L(e),s=a.ROTATE}break;case eR.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;L(e),s=a.ROTATE}else{if(!1===r.enablePan)return;k(e),s=a.PAN}break;default:s=a.NONE}s!==a.NONE&&r.dispatchEvent(i)}(e))}function J(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(X(e),s){case a.TOUCH_ROTATE:if(!1===r.enableRotate)return;z(e),r.update();break;case a.TOUCH_PAN:if(!1===r.enablePan)return;H(e),r.update();break;case a.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&V(e),r.enablePan&&H(e),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&V(e),r.enableRotate&&z(e),r.update();break;default:s=a.NONE}}(e):function(e){if(!1!==r.enabled)switch(s){case a.ROTATE:if(!1===r.enableRotate)return;!function(e){f.set(e.clientX,e.clientY),p.subVectors(f,A).multiplyScalar(r.rotateSpeed);let t=r.domElement;t&&(M(2*Math.PI*p.x/t.clientHeight),S(2*Math.PI*p.y/t.clientHeight)),A.copy(f),r.update()}(e);break;case a.DOLLY:if(!1===r.enableZoom)return;E.set(e.clientX,e.clientY),C.subVectors(E,y),C.y>0?P(_()):C.y<0&&F(_()),y.copy(E),r.update();break;case a.PAN:if(!1===r.enablePan)return;g.set(e.clientX,e.clientY),v.subVectors(g,m).multiplyScalar(r.panSpeed),R(v.x,v.y),m.copy(g),r.update()}}(e))}function Y(e){var t,n,i;(function(e){delete b[e.pointerId];for(let t=0;t<I.length;t++)if(I[t].pointerId==e.pointerId){I.splice(t,1);return}})(e),0===I.length&&(null==(t=r.domElement)||t.releasePointerCapture(e.pointerId),null==(n=r.domElement)||n.ownerDocument.removeEventListener("pointermove",J),null==(i=r.domElement)||i.ownerDocument.removeEventListener("pointerup",Y)),r.dispatchEvent(o),s=a.NONE}function W(e){!1!==r.enabled&&!1!==r.enableZoom&&(s===a.NONE||s===a.ROTATE)&&(e.preventDefault(),r.dispatchEvent(i),Q(e),e.deltaY<0?F(_()):e.deltaY>0&&P(_()),r.update(),r.dispatchEvent(o))}function q(e){!1!==r.enabled&&!1!==r.enablePan&&function(e){let t=!1;switch(e.code){case r.keys.UP:R(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:R(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:R(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:R(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function K(e){!1!==r.enabled&&e.preventDefault()}function X(e){let t=b[e.pointerId];void 0===t&&(t=new eR.Vector2,b[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Z(e){return b[(e.pointerId===I[0].pointerId?I[1]:I[0]).pointerId]}void 0!==t&&this.connect(t),this.update()}}class cs extends ca{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=eR.MOUSE.PAN,this.mouseButtons.RIGHT=eR.MOUSE.ROTATE,this.touches.ONE=eR.TOUCH.PAN,this.touches.TWO=eR.TOUCH.DOLLY_ROTATE}}let cl=eT.forwardRef(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enableDamping:!0},t=arguments.length>1?arguments[1]:void 0,{domElement:r,camera:n,makeDefault:i,onChange:o,onStart:a,onEnd:s,...l}=e,c=(0,eP.A)(e=>e.invalidate),u=(0,eP.A)(e=>e.camera),h=(0,eP.A)(e=>e.gl),d=(0,eP.A)(e=>e.events),A=(0,eP.A)(e=>e.set),f=(0,eP.A)(e=>e.get),p=r||d.connected||h.domElement,m=n||u,g=eT.useMemo(()=>new cs(m),[m]);return eT.useEffect(()=>{g.connect(p);let e=e=>{c(),o&&o(e)};return g.addEventListener("change",e),a&&g.addEventListener("start",a),s&&g.addEventListener("end",s),()=>{g.dispose(),g.removeEventListener("change",e),a&&g.removeEventListener("start",a),s&&g.removeEventListener("end",s)}},[o,a,s,g,c,p]),eT.useEffect(()=>{if(i){let e=f().controls;return A({controls:g}),()=>A({controls:e})}},[i,g]),(0,eP.C)(()=>g.update(),-1),eT.createElement("primitive",(0,eS.Z)({ref:t,object:g,enableDamping:!0},l))}),cc=eT.forwardRef((e,t)=>{let{makeDefault:r,camera:n,regress:i,domElement:o,enableDamping:a=!0,keyEvents:s=!1,onChange:l,onStart:c,onEnd:u,...h}=e,d=(0,eP.A)(e=>e.invalidate),A=(0,eP.A)(e=>e.camera),f=(0,eP.A)(e=>e.gl),p=(0,eP.A)(e=>e.events),m=(0,eP.A)(e=>e.setEvents),g=(0,eP.A)(e=>e.set),v=(0,eP.A)(e=>e.get),y=(0,eP.A)(e=>e.performance),E=n||A,C=o||p.connected||f.domElement,w=eT.useMemo(()=>new ca(E),[E]);return(0,eP.C)(()=>{w.enabled&&w.update()},-1),eT.useEffect(()=>(s&&w.connect(!0===s?C:s),w.connect(C),()=>void w.dispose()),[s,C,i,w,d]),eT.useEffect(()=>{let e=e=>{d(),i&&y.regress(),l&&l(e)},t=e=>{c&&c(e)},r=e=>{u&&u(e)};return w.addEventListener("change",e),w.addEventListener("start",t),w.addEventListener("end",r),()=>{w.removeEventListener("start",t),w.removeEventListener("end",r),w.removeEventListener("change",e)}},[l,c,u,w,d,m]),eT.useEffect(()=>{if(r){let e=v().controls;return g({controls:w}),()=>g({controls:e})}},[r,w]),eT.createElement("primitive",(0,eS.Z)({ref:t,object:w,enableDamping:a},h))});var cu=Object.defineProperty,ch=(e,t,r)=>t in e?cu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cd=(e,t,r)=>(ch(e,"symbol"!=typeof t?t+"":t,r),r);class cA extends eR.EventDispatcher{constructor(e,t){super(),cd(this,"enabled",!0),cd(this,"screen",{left:0,top:0,width:0,height:0}),cd(this,"rotateSpeed",1),cd(this,"zoomSpeed",1.2),cd(this,"panSpeed",.3),cd(this,"noRotate",!1),cd(this,"noZoom",!1),cd(this,"noPan",!1),cd(this,"staticMoving",!1),cd(this,"dynamicDampingFactor",.2),cd(this,"minDistance",0),cd(this,"maxDistance",1/0),cd(this,"keys",["KeyA","KeyS","KeyD"]),cd(this,"mouseButtons",{LEFT:eR.MOUSE.ROTATE,MIDDLE:eR.MOUSE.DOLLY,RIGHT:eR.MOUSE.PAN}),cd(this,"object"),cd(this,"domElement"),cd(this,"cursorZoom",!1),cd(this,"target",new eR.Vector3),cd(this,"mousePosition",new eR.Vector2),cd(this,"STATE",{NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4}),cd(this,"EPS",1e-6),cd(this,"lastZoom",1),cd(this,"lastPosition",new eR.Vector3),cd(this,"cursorVector",new eR.Vector3),cd(this,"targetVector",new eR.Vector3),cd(this,"_state",this.STATE.NONE),cd(this,"_keyState",this.STATE.NONE),cd(this,"_eye",new eR.Vector3),cd(this,"_movePrev",new eR.Vector2),cd(this,"_moveCurr",new eR.Vector2),cd(this,"_lastAxis",new eR.Vector3),cd(this,"_lastAngle",0),cd(this,"_zoomStart",new eR.Vector2),cd(this,"_zoomEnd",new eR.Vector2),cd(this,"_touchZoomDistanceStart",0),cd(this,"_touchZoomDistanceEnd",0),cd(this,"_panStart",new eR.Vector2),cd(this,"_panEnd",new eR.Vector2),cd(this,"target0"),cd(this,"position0"),cd(this,"up0"),cd(this,"zoom0"),cd(this,"changeEvent",{type:"change"}),cd(this,"startEvent",{type:"start"}),cd(this,"endEvent",{type:"end"}),cd(this,"onScreenVector",new eR.Vector2),cd(this,"getMouseOnScreen",(e,t)=>(this.onScreenVector.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),this.onScreenVector)),cd(this,"onCircleVector",new eR.Vector2),cd(this,"getMouseOnCircle",(e,t)=>(this.onCircleVector.set((e-.5*this.screen.width-this.screen.left)/(.5*this.screen.width),(this.screen.height+2*(this.screen.top-t))/this.screen.width),this.onCircleVector)),cd(this,"axis",new eR.Vector3),cd(this,"quaternion",new eR.Quaternion),cd(this,"eyeDirection",new eR.Vector3),cd(this,"objectUpDirection",new eR.Vector3),cd(this,"objectSidewaysDirection",new eR.Vector3),cd(this,"moveDirection",new eR.Vector3),cd(this,"angle",0),cd(this,"rotateCamera",()=>{this.moveDirection.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0),this.angle=this.moveDirection.length(),this.angle?(this._eye.copy(this.object.position).sub(this.target),this.eyeDirection.copy(this._eye).normalize(),this.objectUpDirection.copy(this.object.up).normalize(),this.objectSidewaysDirection.crossVectors(this.objectUpDirection,this.eyeDirection).normalize(),this.objectUpDirection.setLength(this._moveCurr.y-this._movePrev.y),this.objectSidewaysDirection.setLength(this._moveCurr.x-this._movePrev.x),this.moveDirection.copy(this.objectUpDirection.add(this.objectSidewaysDirection)),this.axis.crossVectors(this.moveDirection,this._eye).normalize(),this.angle*=this.rotateSpeed,this.quaternion.setFromAxisAngle(this.axis,this.angle),this._eye.applyQuaternion(this.quaternion),this.object.up.applyQuaternion(this.quaternion),this._lastAxis.copy(this.axis),this._lastAngle=this.angle):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),this.quaternion.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(this.quaternion),this.object.up.applyQuaternion(this.quaternion)),this._movePrev.copy(this._moveCurr)}),cd(this,"zoomCamera",()=>{let e;if(this._state===this.STATE.TOUCH_ZOOM_PAN)e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom/=e,this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type");else{if(Math.abs((e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed)-1)>this.EPS&&e>0&&(this.object.isPerspectiveCamera?(e>1&&this._eye.length()>=this.maxDistance-this.EPS&&(e=1),this._eye.multiplyScalar(e)):this.object.isOrthographicCamera?(e>1&&this.object.zoom<this.maxDistance*this.maxDistance&&(e=1),this.object.zoom/=e):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor,this.cursorZoom){this.targetVector.copy(this.target).project(this.object);let t=this.cursorVector.set(this.mousePosition.x,this.mousePosition.y,this.targetVector.z).unproject(this.object);this.target.lerpVectors(t,this.target,e)}this.object.isOrthographicCamera&&this.object.updateProjectionMatrix()}}),cd(this,"mouseChange",new eR.Vector2),cd(this,"objectUp",new eR.Vector3),cd(this,"pan",new eR.Vector3),cd(this,"panCamera",()=>{if(this.domElement&&(this.mouseChange.copy(this._panEnd).sub(this._panStart),this.mouseChange.lengthSq()>this.EPS)){if(this.object.isOrthographicCamera){let e=this.object,t=(e.right-e.left)/this.object.zoom,r=(e.top-e.bottom)/this.object.zoom;this.mouseChange.x*=t,this.mouseChange.y*=r}else this.mouseChange.multiplyScalar(this._eye.length()*this.panSpeed);this.pan.copy(this._eye).cross(this.object.up).setLength(this.mouseChange.x),this.pan.add(this.objectUp.copy(this.object.up).setLength(this.mouseChange.y)),this.object.position.add(this.pan),this.target.add(this.pan),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(this.mouseChange.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}),cd(this,"checkDistances",()=>{this.noZoom&&this.noPan||(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}),cd(this,"handleResize",()=>{if(!this.domElement)return;let e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}),cd(this,"update",()=>{this._eye.subVectors(this.object.position,this.target),this.noRotate||this.rotateCamera(),this.noZoom||this.zoomCamera(),this.noPan||this.panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this.checkDistances(),this.object.lookAt(this.target),this.lastPosition.distanceToSquared(this.object.position)>this.EPS&&(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this.lastPosition.distanceToSquared(this.object.position)>this.EPS||this.lastZoom!==this.object.zoom)&&(this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position),this.lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")}),cd(this,"reset",()=>{this._state=this.STATE.NONE,this._keyState=this.STATE.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.up.copy(this.up0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(this.changeEvent),this.lastPosition.copy(this.object.position),this.lastZoom=this.object.zoom}),cd(this,"keydown",e=>{!1!==this.enabled&&(window.removeEventListener("keydown",this.keydown),this._keyState===this.STATE.NONE&&(e.code!==this.keys[this.STATE.ROTATE]||this.noRotate?e.code!==this.keys[this.STATE.ZOOM]||this.noZoom?e.code!==this.keys[this.STATE.PAN]||this.noPan||(this._keyState=this.STATE.PAN):this._keyState=this.STATE.ZOOM:this._keyState=this.STATE.ROTATE))}),cd(this,"onPointerDown",e=>{if(!1!==this.enabled)switch(e.pointerType){case"mouse":case"pen":this.onMouseDown(e)}}),cd(this,"onPointerMove",e=>{if(!1!==this.enabled)switch(e.pointerType){case"mouse":case"pen":this.onMouseMove(e)}}),cd(this,"onPointerUp",e=>{if(!1!==this.enabled)switch(e.pointerType){case"mouse":case"pen":this.onMouseUp()}}),cd(this,"keyup",()=>{!1!==this.enabled&&(this._keyState=this.STATE.NONE,window.addEventListener("keydown",this.keydown))}),cd(this,"onMouseDown",e=>{if(!this.domElement)return;if(this._state===this.STATE.NONE)switch(e.button){case this.mouseButtons.LEFT:this._state=this.STATE.ROTATE;break;case this.mouseButtons.MIDDLE:this._state=this.STATE.ZOOM;break;case this.mouseButtons.RIGHT:this._state=this.STATE.PAN}let t=this._keyState!==this.STATE.NONE?this._keyState:this._state;t!==this.STATE.ROTATE||this.noRotate?t!==this.STATE.ZOOM||this.noZoom?t!==this.STATE.PAN||this.noPan||(this._panStart.copy(this.getMouseOnScreen(e.pageX,e.pageY)),this._panEnd.copy(this._panStart)):(this._zoomStart.copy(this.getMouseOnScreen(e.pageX,e.pageY)),this._zoomEnd.copy(this._zoomStart)):(this._moveCurr.copy(this.getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr)),this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.dispatchEvent(this.startEvent)}),cd(this,"onMouseMove",e=>{if(!1===this.enabled)return;let t=this._keyState!==this.STATE.NONE?this._keyState:this._state;t!==this.STATE.ROTATE||this.noRotate?t!==this.STATE.ZOOM||this.noZoom?t!==this.STATE.PAN||this.noPan||this._panEnd.copy(this.getMouseOnScreen(e.pageX,e.pageY)):this._zoomEnd.copy(this.getMouseOnScreen(e.pageX,e.pageY)):(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this.getMouseOnCircle(e.pageX,e.pageY)))}),cd(this,"onMouseUp",()=>{this.domElement&&!1!==this.enabled&&(this._state=this.STATE.NONE,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),this.dispatchEvent(this.endEvent))}),cd(this,"mousewheel",e=>{if(!1!==this.enabled&&!0!==this.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:this._zoomStart.y-=.025*e.deltaY;break;case 1:this._zoomStart.y-=.01*e.deltaY;break;default:this._zoomStart.y-=25e-5*e.deltaY}this.mousePosition.x=e.offsetX/this.screen.width*2-1,this.mousePosition.y=-(e.offsetY/this.screen.height*2)+1,this.dispatchEvent(this.startEvent),this.dispatchEvent(this.endEvent)}}),cd(this,"touchstart",e=>{if(!1!==this.enabled){if(e.preventDefault(),1===e.touches.length)this._state=this.STATE.TOUCH_ROTATE,this._moveCurr.copy(this.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),this._movePrev.copy(this._moveCurr);else{this._state=this.STATE.TOUCH_ZOOM_PAN;let t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(t*t+r*r);let n=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;this._panStart.copy(this.getMouseOnScreen(n,i)),this._panEnd.copy(this._panStart)}this.dispatchEvent(this.startEvent)}}),cd(this,"touchmove",e=>{if(!1!==this.enabled){if(e.preventDefault(),1===e.touches.length)this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY));else{let t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;this._touchZoomDistanceEnd=Math.sqrt(t*t+r*r);let n=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;this._panEnd.copy(this.getMouseOnScreen(n,i))}}}),cd(this,"touchend",e=>{if(!1!==this.enabled){switch(e.touches.length){case 0:this._state=this.STATE.NONE;break;case 1:this._state=this.STATE.TOUCH_ROTATE,this._moveCurr.copy(this.getMouseOnCircle(e.touches[0].pageX,e.touches[0].pageY)),this._movePrev.copy(this._moveCurr)}this.dispatchEvent(this.endEvent)}}),cd(this,"contextmenu",e=>{!1!==this.enabled&&e.preventDefault()}),cd(this,"connect",e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.addEventListener("contextmenu",this.contextmenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.mousewheel),this.domElement.addEventListener("touchstart",this.touchstart),this.domElement.addEventListener("touchend",this.touchend),this.domElement.addEventListener("touchmove",this.touchmove),this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.handleResize()}),cd(this,"dispose",()=>{this.domElement&&(this.domElement.removeEventListener("contextmenu",this.contextmenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.mousewheel),this.domElement.removeEventListener("touchstart",this.touchstart),this.domElement.removeEventListener("touchend",this.touchend),this.domElement.removeEventListener("touchmove",this.touchmove),this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup))}),this.object=e,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,void 0!==t&&this.connect(t),this.update()}}let cf=eT.forwardRef((e,t)=>{let{makeDefault:r,camera:n,domElement:i,regress:o,onChange:a,onStart:s,onEnd:l,...c}=e,{invalidate:u,camera:h,gl:d,events:A,set:f,get:p,performance:m,viewport:g}=(0,eP.A)(),v=n||h,y=i||A.connected||d.domElement,E=eT.useMemo(()=>new cA(v),[v]);return(0,eP.C)(()=>{E.enabled&&E.update()},-1),eT.useEffect(()=>(E.connect(y),()=>void E.dispose()),[y,o,E,u]),eT.useEffect(()=>{let e=e=>{u(),o&&m.regress(),a&&a(e)};return E.addEventListener("change",e),s&&E.addEventListener("start",s),l&&E.addEventListener("end",l),()=>{s&&E.removeEventListener("start",s),l&&E.removeEventListener("end",l),E.removeEventListener("change",e)}},[a,s,l,E,u]),eT.useEffect(()=>{E.handleResize()},[g]),eT.useEffect(()=>{if(r){let e=p().controls;return f({controls:E}),()=>f({controls:e})}},[r,E]),eT.createElement("primitive",(0,eS.Z)({ref:t,object:E},c))});var cp=Object.defineProperty,cm=(e,t,r)=>t in e?cp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cg=(e,t,r)=>(cm(e,"symbol"!=typeof t?t+"":t,r),r);let cv={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},cy={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},cE={x:0,y:0},cC={camera:new eR.Matrix4,gizmos:new eR.Matrix4},cw={type:"change"},cB={type:"start"},cx={type:"end"};class cI extends eR.EventDispatcher{applyTransformMatrix(e){if((null==e?void 0:e.camera)&&this.camera&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==cv.ROTATE||this._state==cv.ZROTATE||this._state==cv.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),(null==e?void 0:e.gizmos)&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),(this._state==cv.SCALE||this._state==cv.FOCUS||this._state==cv.ANIMATION_FOCUS)&&this.camera){let e=this.calculateTbRadius(this.camera);if(void 0!==e&&(this._tbRadius=e),this.adjustNearFar){let e=this.camera.position.distanceTo(this._gizmos.position),t=new eR.Box3;t.setFromObject(this._gizmos);let r=new eR.Sphere;t.getBoundingSphere(r);let n=Math.max(this._nearPos0,r.radius+r.center.length()),i=e-this._initialNear;this.camera.near=e-Math.min(n,i);let o=Math.min(this._farPos0,-r.radius+r.center.length()),a=e-this._initialFar;this.camera.far=e-Math.min(o,a),this.camera.updateProjectionMatrix()}else{let e=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,e=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,e=!0),e&&this.camera.updateProjectionMatrix()}}}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(cw)}setTransformationMatrices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?cC.camera?cC.camera.copy(e):cC.camera=e.clone():cC.camera=null,t?cC.gizmos?cC.gizmos.copy(t):cC.gizmos=t.clone():cC.gizmos=null}constructor(e,t=null,r=null){var n;super(),n=this,cg(this,"camera"),cg(this,"domElement"),cg(this,"scene"),cg(this,"mouseActions"),cg(this,"_mouseOp"),cg(this,"_v2_1"),cg(this,"_v3_1"),cg(this,"_v3_2"),cg(this,"_m4_1"),cg(this,"_m4_2"),cg(this,"_quat"),cg(this,"_translationMatrix"),cg(this,"_rotationMatrix"),cg(this,"_scaleMatrix"),cg(this,"_rotationAxis"),cg(this,"_cameraMatrixState"),cg(this,"_cameraProjectionState"),cg(this,"_fovState"),cg(this,"_upState"),cg(this,"_zoomState"),cg(this,"_nearPos"),cg(this,"_farPos"),cg(this,"_gizmoMatrixState"),cg(this,"_up0"),cg(this,"_zoom0"),cg(this,"_fov0"),cg(this,"_initialNear"),cg(this,"_nearPos0"),cg(this,"_initialFar"),cg(this,"_farPos0"),cg(this,"_cameraMatrixState0"),cg(this,"_gizmoMatrixState0"),cg(this,"_button"),cg(this,"_touchStart"),cg(this,"_touchCurrent"),cg(this,"_input"),cg(this,"_switchSensibility"),cg(this,"_startFingerDistance"),cg(this,"_currentFingerDistance"),cg(this,"_startFingerRotation"),cg(this,"_currentFingerRotation"),cg(this,"_devPxRatio"),cg(this,"_downValid"),cg(this,"_nclicks"),cg(this,"_downEvents"),cg(this,"_clickStart"),cg(this,"_maxDownTime"),cg(this,"_maxInterval"),cg(this,"_posThreshold"),cg(this,"_movementThreshold"),cg(this,"_currentCursorPosition"),cg(this,"_startCursorPosition"),cg(this,"_grid"),cg(this,"_gridPosition"),cg(this,"_gizmos"),cg(this,"_curvePts"),cg(this,"_timeStart"),cg(this,"_animationId"),cg(this,"focusAnimationTime"),cg(this,"_timePrev"),cg(this,"_timeCurrent"),cg(this,"_anglePrev"),cg(this,"_angleCurrent"),cg(this,"_cursorPosPrev"),cg(this,"_cursorPosCurr"),cg(this,"_wPrev"),cg(this,"_wCurr"),cg(this,"adjustNearFar"),cg(this,"scaleFactor"),cg(this,"dampingFactor"),cg(this,"wMax"),cg(this,"enableAnimations"),cg(this,"enableGrid"),cg(this,"cursorZoom"),cg(this,"minFov"),cg(this,"maxFov"),cg(this,"enabled"),cg(this,"enablePan"),cg(this,"enableRotate"),cg(this,"enableZoom"),cg(this,"minDistance"),cg(this,"maxDistance"),cg(this,"minZoom"),cg(this,"maxZoom"),cg(this,"target"),cg(this,"_currentTarget"),cg(this,"_tbRadius"),cg(this,"_state"),cg(this,"onWindowResize",()=>{let e=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;if(this.camera){let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e)}let t=this._tbRadius/e,r=new eR.EllipseCurve(0,0,t,t).getPoints(this._curvePts),n=new eR.BufferGeometry().setFromPoints(r);for(let e in this._gizmos.children)this._gizmos.children[e].geometry=n;this.dispatchEvent(cw)}),cg(this,"onContextMenu",e=>{if(this.enabled){for(let t=0;t<this.mouseActions.length;t++)if(2==this.mouseActions[t].mouse){e.preventDefault();break}}}),cg(this,"onPointerCancel",()=>{this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=cy.NONE}),cg(this,"onPointerDown",e=>{if(0==e.button&&e.isPrimary?(this._downValid=!0,this._downEvents.push(e)):this._downValid=!1,"touch"==e.pointerType&&this._input!=cy.CURSOR)switch(this._touchStart.push(e),this._touchCurrent.push(e),this._input){case cy.NONE:this._input=cy.ONE_FINGER,this.onSinglePanStart(e,"ROTATE"),window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp);break;case cy.ONE_FINGER:case cy.ONE_FINGER_SWITCHED:this._input=cy.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case cy.TWO_FINGER:this._input=cy.MULT_FINGER,this.onTriplePanStart()}else if("touch"!=e.pointerType&&this._input==cy.NONE){let t=null;e.ctrlKey||e.metaKey?t="CTRL":e.shiftKey&&(t="SHIFT"),this._mouseOp=this.getOpFromAction(e.button,t),this._mouseOp&&(window.addEventListener("pointermove",this.onPointerMove),window.addEventListener("pointerup",this.onPointerUp),this._input=cy.CURSOR,this._button=e.button,this.onSinglePanStart(e,this._mouseOp))}}),cg(this,"onPointerMove",e=>{if("touch"==e.pointerType&&this._input!=cy.CURSOR)switch(this._input){case cy.ONE_FINGER:this.updateTouchEvent(e),this.onSinglePanMove(e,cv.ROTATE);break;case cy.ONE_FINGER_SWITCHED:this.calculatePointersDistance(this._touchCurrent[0],e)*this._devPxRatio>=this._switchSensibility&&(this._input=cy.ONE_FINGER,this.updateTouchEvent(e),this.onSinglePanStart(e,"ROTATE"));break;case cy.TWO_FINGER:this.updateTouchEvent(e),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case cy.MULT_FINGER:this.updateTouchEvent(e),this.onTriplePanMove()}else if("touch"!=e.pointerType&&this._input==cy.CURSOR){let t=null;e.ctrlKey||e.metaKey?t="CTRL":e.shiftKey&&(t="SHIFT");let r=this.getOpStateFromAction(this._button,t);r&&this.onSinglePanMove(e,r)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],e)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}),cg(this,"onPointerUp",e=>{if("touch"==e.pointerType&&this._input!=cy.CURSOR){let t=this._touchCurrent.length;for(let r=0;r<t;r++)if(this._touchCurrent[r].pointerId==e.pointerId){this._touchCurrent.splice(r,1),this._touchStart.splice(r,1);break}switch(this._input){case cy.ONE_FINGER:case cy.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=cy.NONE,this.onSinglePanEnd();break;case cy.TWO_FINGER:this.onDoublePanEnd(),this.onPinchEnd(),this.onRotateEnd(),this._input=cy.ONE_FINGER_SWITCHED;break;case cy.MULT_FINGER:0==this._touchCurrent.length&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=cy.NONE,this.onTriplePanEnd())}}else"touch"!=e.pointerType&&this._input==cy.CURSOR&&(window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),this._input=cy.NONE,this.onSinglePanEnd(),this._button=-1);if(e.isPrimary){if(this._downValid){if(e.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime){if(0==this._nclicks)this._nclicks=1,this._clickStart=performance.now();else{let t=e.timeStamp-this._clickStart,r=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;t<=this._maxInterval&&r<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(e)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}}),cg(this,"onWheel",e=>{var t,r;if(this.enabled&&this.enableZoom&&this.domElement){let n=null;e.ctrlKey||e.metaKey?n="CTRL":e.shiftKey&&(n="SHIFT");let i=this.getOpFromAction("WHEEL",n);if(i){e.preventDefault(),this.dispatchEvent(cB);let n=e.deltaY/125,o=1;switch(n>0?o=1/this.scaleFactor:n<0&&(o=this.scaleFactor),i){case"ZOOM":if(this.updateTbState(cv.SCALE,!0),n>0?o=1/Math.pow(this.scaleFactor,n):n<0&&(o=Math.pow(this.scaleFactor,-n)),this.cursorZoom&&this.enablePan){let n;this.camera instanceof eR.OrthographicCamera&&(n=null==(t=this.unprojectOnTbPlane(this.camera,e.clientX,e.clientY,this.domElement))?void 0:t.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position)),this.camera instanceof eR.PerspectiveCamera&&(n=null==(r=this.unprojectOnTbPlane(this.camera,e.clientX,e.clientY,this.domElement))?void 0:r.applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),void 0!==n&&this.applyTransformMatrix(this.applyScale(o,n))}else this.applyTransformMatrix(this.applyScale(o,this._gizmos.position));this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cw),this.dispatchEvent(cx);break;case"FOV":if(this.camera instanceof eR.PerspectiveCamera){this.updateTbState(cv.FOV,!0),0!=e.deltaX&&(n=e.deltaX/125,o=1,n>0?o=1/Math.pow(this.scaleFactor,n):n<0&&(o=Math.pow(this.scaleFactor,-n))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let t=this._v3_1.distanceTo(this._gizmos.position),r=t/o;r=eR.MathUtils.clamp(r,this.minDistance,this.maxDistance);let i=t*Math.tan(eR.MathUtils.DEG2RAD*this.camera.fov*.5),a=eR.MathUtils.RAD2DEG*(2*Math.atan(i/r));a>this.maxFov?a=this.maxFov:a<this.minFov&&(a=this.minFov),o=t/(i/Math.tan(eR.MathUtils.DEG2RAD*(a/2))),this.setFov(a),this.applyTransformMatrix(this.applyScale(o,this._gizmos.position,!1))}this._grid&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cw),this.dispatchEvent(cx)}}}}),cg(this,"onSinglePanStart",(e,t)=>{if(this.enabled&&this.domElement)switch(this.dispatchEvent(cB),this.setCenter(e.clientX,e.clientY),t){case"PAN":if(!this.enablePan)return;if(-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cw)),this.camera){this.updateTbState(cv.PAN,!0);let e=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement);void 0!==e&&this._startCursorPosition.copy(e),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(cw))}break;case"ROTATE":if(!this.enableRotate)return;if(-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.camera){this.updateTbState(cv.ROTATE,!0);let e=this.unprojectOnTbSurface(this.camera,cE.x,cE.y,this.domElement,this._tbRadius);void 0!==e&&this._startCursorPosition.copy(e),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr)}this.dispatchEvent(cw);break;case"FOV":if(!this.enableZoom)return;this.camera instanceof eR.PerspectiveCamera&&(-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cw)),this.updateTbState(cv.FOV,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition));break;case"ZOOM":if(!this.enableZoom)return;-1!=this._animationId&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(cw)),this.updateTbState(cv.SCALE,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),cg(this,"onSinglePanMove",(e,t)=>{if(this.enabled&&this.domElement){let r=t!=this._state;switch(this.setCenter(e.clientX,e.clientY),t){case cv.PAN:if(this.enablePan&&this.camera){if(r){this.dispatchEvent(cx),this.dispatchEvent(cB),this.updateTbState(t,!0);let e=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement);void 0!==e&&this._startCursorPosition.copy(e),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)}else{let e=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement);void 0!==e&&this._currentCursorPosition.copy(e),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))}}break;case cv.ROTATE:if(this.enableRotate&&this.camera){if(r){this.dispatchEvent(cx),this.dispatchEvent(cB),this.updateTbState(t,!0);let e=this.unprojectOnTbSurface(this.camera,cE.x,cE.y,this.domElement,this._tbRadius);void 0!==e&&this._startCursorPosition.copy(e),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0)}else{let e=this.unprojectOnTbSurface(this.camera,cE.x,cE.y,this.domElement,this._tbRadius);void 0!==e&&this._currentCursorPosition.copy(e);let t=this._startCursorPosition.distanceTo(this._currentCursorPosition),r=this._startCursorPosition.angleTo(this._currentCursorPosition),n=Math.max(t/this._tbRadius,r);this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),n)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=n,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}}break;case cv.SCALE:if(this.enableZoom){if(r)this.dispatchEvent(cx),this.dispatchEvent(cB),this.updateTbState(t,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y);let e=this._currentCursorPosition.y-this._startCursorPosition.y,t=1;e<0?t=1/Math.pow(this.scaleFactor,-(8*e)):e>0&&(t=Math.pow(this.scaleFactor,8*e)),this.applyTransformMatrix(this.applyScale(t,this._gizmos.position))}}break;case cv.FOV:if(this.enableZoom&&this.camera instanceof eR.PerspectiveCamera){if(r)this.dispatchEvent(cx),this.dispatchEvent(cB),this.updateTbState(t,!0),this._startCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y);let e=this._currentCursorPosition.y-this._startCursorPosition.y,t=1;e<0?t=1/Math.pow(this.scaleFactor,-(8*e)):e>0&&(t=Math.pow(this.scaleFactor,8*e)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let r=this._v3_1.distanceTo(this._gizmos.position),n=r/t;n=eR.MathUtils.clamp(n,this.minDistance,this.maxDistance);let i=r*Math.tan(eR.MathUtils.DEG2RAD*this._fovState*.5),o=eR.MathUtils.RAD2DEG*(2*Math.atan(i/n));o=eR.MathUtils.clamp(o,this.minFov,this.maxFov);let a=i/Math.tan(eR.MathUtils.DEG2RAD*(o/2));t=r/a,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(o),this.applyTransformMatrix(this.applyScale(t,this._v3_2,!1));let s=this._gizmos.position.clone().sub(this.camera.position).normalize().multiplyScalar(a/r);this._m4_1.makeTranslation(s.x,s.y,s.z)}}}this.dispatchEvent(cw)}}),cg(this,"onSinglePanEnd",()=>{if(this._state==cv.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations){if(performance.now()-this._timeCurrent<120){let e=Math.abs((this._wPrev+this._wCurr)/2),t=this;this._animationId=window.requestAnimationFrame(function(r){t.updateTbState(cv.ANIMATION_ROTATE,!0);let n=t.calculateRotationAxis(t._cursorPosPrev,t._cursorPosCurr);t.onRotationAnim(r,n,Math.min(e,t.wMax))})}else this.updateTbState(cv.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cw)}else this.updateTbState(cv.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cw)}else(this._state==cv.PAN||this._state==cv.IDLE)&&(this.updateTbState(cv.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(cw));this.dispatchEvent(cx)}),cg(this,"onDoubleTap",e=>{if(this.enabled&&this.enablePan&&this.scene&&this.camera&&this.domElement){this.dispatchEvent(cB),this.setCenter(e.clientX,e.clientY);let t=this.unprojectOnObj(this.getCursorNDC(cE.x,cE.y,this.domElement),this.camera);if(t&&this.enableAnimations){let e=this;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(r){e.updateTbState(cv.ANIMATION_FOCUS,!0),e.onFocusAnim(r,t,e._cameraMatrixState,e._gizmoMatrixState)})}else t&&!this.enableAnimations&&(this.updateTbState(cv.FOCUS,!0),this.focus(t,this.scaleFactor),this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cw))}this.dispatchEvent(cx)}),cg(this,"onDoublePanStart",()=>{if(this.enabled&&this.enablePan&&this.camera&&this.domElement){this.dispatchEvent(cB),this.updateTbState(cv.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);let e=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement,!0);void 0!==e&&this._startCursorPosition.copy(e),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1)}}),cg(this,"onDoublePanMove",()=>{if(this.enabled&&this.enablePan&&this.camera&&this.domElement){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=cv.PAN&&(this.updateTbState(cv.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition));let e=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement,!0);void 0!==e&&this._currentCursorPosition.copy(e),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(cw)}}),cg(this,"onDoublePanEnd",()=>{this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cx)}),cg(this,"onRotateStart",()=>{var e;this.enabled&&this.enableRotate&&(this.dispatchEvent(cB),this.updateTbState(cv.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,null==(e=this.camera)||e.getWorldDirection(this._rotationAxis),this.enablePan||this.enableZoom||this.activateGizmos(!0))}),cg(this,"onRotateMove",()=>{var e;if(this.enabled&&this.enableRotate&&this.camera&&this.domElement){let t;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=cv.ZROTATE&&(this.updateTbState(cv.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?this.camera&&(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),t=null==(e=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement))?void 0:e.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):t=new eR.Vector3().setFromMatrixPosition(this._gizmoMatrixState);let r=eR.MathUtils.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation);void 0!==t&&this.applyTransformMatrix(this.zRotate(t,r)),this.dispatchEvent(cw)}}),cg(this,"onRotateEnd",()=>{this.updateTbState(cv.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cx)}),cg(this,"onPinchStart",()=>{this.enabled&&this.enableZoom&&(this.dispatchEvent(cB),this.updateTbState(cv.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}),cg(this,"onPinchMove",()=>{var e,t;if(this.enabled&&this.enableZoom&&this.domElement){let r;this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=cv.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(cv.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),12*this._devPxRatio);let n=this._currentFingerDistance/this._startFingerDistance;this.enablePan?this.camera instanceof eR.OrthographicCamera?r=null==(e=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement))?void 0:e.applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera instanceof eR.PerspectiveCamera&&(r=null==(t=this.unprojectOnTbPlane(this.camera,cE.x,cE.y,this.domElement))?void 0:t.applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):r=this._gizmos.position,void 0!==r&&this.applyTransformMatrix(this.applyScale(n,r)),this.dispatchEvent(cw)}}),cg(this,"onPinchEnd",()=>{this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cx)}),cg(this,"onTriplePanStart",()=>{if(this.enabled&&this.enableZoom&&this.domElement){this.dispatchEvent(cB),this.updateTbState(cv.SCALE,!0);let e=0,t=0,r=this._touchCurrent.length;for(let n=0;n<r;n++)e+=this._touchCurrent[n].clientX,t+=this._touchCurrent[n].clientY;this.setCenter(e/r,t/r),this._startCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y),this._currentCursorPosition.copy(this._startCursorPosition)}}),cg(this,"onTriplePanMove",()=>{if(this.enabled&&this.enableZoom&&this.camera&&this.domElement){let e=0,t=0,r=this._touchCurrent.length;for(let n=0;n<r;n++)e+=this._touchCurrent[n].clientX,t+=this._touchCurrent[n].clientY;this.setCenter(e/r,t/r),this._currentCursorPosition.setY(.5*this.getCursorNDC(cE.x,cE.y,this.domElement).y);let n=this._currentCursorPosition.y-this._startCursorPosition.y,i=1;n<0?i=1/Math.pow(this.scaleFactor,-(8*n)):n>0&&(i=Math.pow(this.scaleFactor,8*n)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let o=this._v3_1.distanceTo(this._gizmos.position),a=o/i;a=eR.MathUtils.clamp(a,this.minDistance,this.maxDistance);let s=o*Math.tan(eR.MathUtils.DEG2RAD*this._fovState*.5),l=eR.MathUtils.RAD2DEG*(2*Math.atan(s/a));l=eR.MathUtils.clamp(l,this.minFov,this.maxFov);let c=s/Math.tan(eR.MathUtils.DEG2RAD*(l/2));i=o/c,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(l),this.applyTransformMatrix(this.applyScale(i,this._v3_2,!1));let u=this._gizmos.position.clone().sub(this.camera.position).normalize().multiplyScalar(c/o);this._m4_1.makeTranslation(u.x,u.y,u.z),this.dispatchEvent(cw)}}),cg(this,"onTriplePanEnd",()=>{this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cx)}),cg(this,"setCenter",(e,t)=>{cE.x=e,cE.y=t}),cg(this,"initializeMouseActions",()=>{this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}),cg(this,"setMouseAction",function(e,t){let r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!["PAN","ROTATE","ZOOM","FOV"].includes(e)||![0,1,2,"WHEEL"].includes(t)||!["CTRL","SHIFT",null].includes(i)||"WHEEL"==t&&"ZOOM"!=e&&"FOV"!=e)return!1;switch(e){case"PAN":r=cv.PAN;break;case"ROTATE":r=cv.ROTATE;break;case"ZOOM":r=cv.SCALE;break;case"FOV":r=cv.FOV}let o={operation:e,mouse:t,key:i,state:r};for(let e=0;e<n.mouseActions.length;e++)if(n.mouseActions[e].mouse==o.mouse&&n.mouseActions[e].key==o.key)return n.mouseActions.splice(e,1,o),!0;return n.mouseActions.push(o),!0}),cg(this,"getOpFromAction",(e,t)=>{let r;for(let n=0;n<this.mouseActions.length;n++)if((r=this.mouseActions[n]).mouse==e&&r.key==t)return r.operation;if(t){for(let t=0;t<this.mouseActions.length;t++)if((r=this.mouseActions[t]).mouse==e&&null==r.key)return r.operation}return null}),cg(this,"getOpStateFromAction",(e,t)=>{let r;for(let n=0;n<this.mouseActions.length;n++)if((r=this.mouseActions[n]).mouse==e&&r.key==t)return r.state;if(t){for(let t=0;t<this.mouseActions.length;t++)if((r=this.mouseActions[t]).mouse==e&&null==r.key)return r.state}return null}),cg(this,"getAngle",(e,t)=>180*Math.atan2(t.clientY-e.clientY,t.clientX-e.clientX)/Math.PI),cg(this,"updateTouchEvent",e=>{for(let t=0;t<this._touchCurrent.length;t++)if(this._touchCurrent[t].pointerId==e.pointerId){this._touchCurrent.splice(t,1,e);break}}),cg(this,"calculateAngularSpeed",(e,t,r,n)=>{let i=(n-r)/1e3;return 0==i?0:(t-e)/i}),cg(this,"calculatePointersDistance",(e,t)=>Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))),cg(this,"calculateRotationAxis",(e,t)=>(this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(e,t).applyQuaternion(this._quat),this._rotationAxis.normalize().clone())),cg(this,"calculateTbRadius",e=>{let t=e.position.distanceTo(this._gizmos.position);if(e instanceof eR.PerspectiveCamera){let r=eR.MathUtils.DEG2RAD*e.fov*.5,n=Math.atan(e.aspect*Math.tan(r));return Math.tan(Math.min(r,n))*t*.67}if(e instanceof eR.OrthographicCamera)return .67*Math.min(e.top,e.right)}),cg(this,"focus",function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(n.camera){let i=e.clone();i.sub(n._gizmos.position).multiplyScalar(r),n._translationMatrix.makeTranslation(i.x,i.y,i.z);let o=n._gizmoMatrixState.clone();n._gizmoMatrixState.premultiply(n._translationMatrix),n._gizmoMatrixState.decompose(n._gizmos.position,n._gizmos.quaternion,n._gizmos.scale);let a=n._cameraMatrixState.clone();n._cameraMatrixState.premultiply(n._translationMatrix),n._cameraMatrixState.decompose(n.camera.position,n.camera.quaternion,n.camera.scale),n.enableZoom&&n.applyTransformMatrix(n.applyScale(t,n._gizmos.position)),n._gizmoMatrixState.copy(o),n._cameraMatrixState.copy(a)}}),cg(this,"drawGrid",()=>{if(this.scene){let e,t,r,n;if(this.camera instanceof eR.OrthographicCamera)n=(r=Math.max(this.camera.right-this.camera.left,this.camera.bottom-this.camera.top))/20,t=(e=r/this.camera.zoom*3)/n*this.camera.zoom;else if(this.camera instanceof eR.PerspectiveCamera){let i=this.camera.position.distanceTo(this._gizmos.position),o=eR.MathUtils.DEG2RAD*this.camera.fov*.5,a=Math.atan(this.camera.aspect*Math.tan(o));n=(r=Math.tan(Math.max(o,a))*i*2)/20,t=(e=3*r)/n}null==this._grid&&this.camera&&(this._grid=new eR.GridHelper(e,t,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(.5*Math.PI),this.scene.add(this._grid))}}),cg(this,"connect",e=>{e===document&&console.error('THREE.ArcballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.style.touchAction="none",this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onWheel)}),cg(this,"dispose",()=>{var e,t,r,n,i;-1!=this._animationId&&window.cancelAnimationFrame(this._animationId),null==(e=this.domElement)||e.removeEventListener("pointerdown",this.onPointerDown),null==(t=this.domElement)||t.removeEventListener("pointercancel",this.onPointerCancel),null==(r=this.domElement)||r.removeEventListener("wheel",this.onWheel),null==(n=this.domElement)||n.removeEventListener("contextmenu",this.onContextMenu),window.removeEventListener("pointermove",this.onPointerMove),window.removeEventListener("pointerup",this.onPointerUp),window.removeEventListener("resize",this.onWindowResize),null==(i=this.scene)||i.remove(this._gizmos),this.disposeGrid()}),cg(this,"disposeGrid",()=>{this._grid&&this.scene&&(this.scene.remove(this._grid),this._grid=null)}),cg(this,"easeOutCubic",e=>1-Math.pow(1-e,3)),cg(this,"activateGizmos",e=>{for(let t of this._gizmos.children)t.material.setValues({opacity:e?1:.6})}),cg(this,"getCursorNDC",(e,t,r)=>{let n=r.getBoundingClientRect();return this._v2_1.setX((e-n.left)/n.width*2-1),this._v2_1.setY((n.bottom-t)/n.height*2-1),this._v2_1.clone()}),cg(this,"getCursorPosition",(e,t,r)=>(this._v2_1.copy(this.getCursorNDC(e,t,r)),this.camera instanceof eR.OrthographicCamera&&(this._v2_1.x*=(this.camera.right-this.camera.left)*.5,this._v2_1.y*=(this.camera.top-this.camera.bottom)*.5),this._v2_1.clone())),cg(this,"setCamera",e=>{if(e){e.lookAt(this.target),e.updateMatrix(),e instanceof eR.PerspectiveCamera&&(this._fov0=e.fov,this._fovState=e.fov),this._cameraMatrixState0.copy(e.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(e.projectionMatrix),this._zoom0=e.zoom,this._zoomState=this._zoom0,this._initialNear=e.near,this._nearPos0=e.position.distanceTo(this.target)-e.near,this._nearPos=this._initialNear,this._initialFar=e.far,this._farPos0=e.position.distanceTo(this.target)-e.far,this._farPos=this._initialFar,this._up0.copy(e.up),this._upState.copy(e.up),this.camera=e,this.camera.updateProjectionMatrix();let t=this.calculateTbRadius(e);void 0!==t&&(this._tbRadius=t),this.makeGizmos(this.target,this._tbRadius)}}),cg(this,"makeGizmos",(e,t)=>{let r=new eR.EllipseCurve(0,0,t,t).getPoints(this._curvePts),n=new eR.BufferGeometry().setFromPoints(r),i=new eR.LineBasicMaterial({color:16744576,fog:!1,transparent:!0,opacity:.6}),o=new eR.LineBasicMaterial({color:8454016,fog:!1,transparent:!0,opacity:.6}),a=new eR.LineBasicMaterial({color:8421631,fog:!1,transparent:!0,opacity:.6}),s=new eR.Line(n,i),l=new eR.Line(n,o),c=new eR.Line(n,a),u=.5*Math.PI;if(s.rotation.x=u,l.rotation.y=u,this._gizmoMatrixState0.identity().setPosition(e),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this.camera&&1!=this.camera.zoom){let t=1/this.camera.zoom;this._scaleMatrix.makeScale(t,t,t),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(e.x,e.y,e.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.clear(),this._gizmos.add(s),this._gizmos.add(l),this._gizmos.add(c)}),cg(this,"onFocusAnim",(e,t,r,n)=>{if(-1==this._timeStart&&(this._timeStart=e),this._state==cv.ANIMATION_FOCUS){let i=(e-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(n),i>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,this.scaleFactor),this._timeStart=-1,this.updateTbState(cv.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cw);else{let e=this.easeOutCubic(i),o=1-e+this.scaleFactor*e;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,o,e),this.dispatchEvent(cw);let a=this;this._animationId=window.requestAnimationFrame(function(e){a.onFocusAnim(e,t,r,n.clone())})}}else this._animationId=-1,this._timeStart=-1}),cg(this,"onRotationAnim",(e,t,r)=>{if(-1==this._timeStart&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=e),this._state==cv.ANIMATION_ROTATE){let n=(e-this._timeStart)/1e3;if(r+-this.dampingFactor*n>0){this._angleCurrent=-(.5*this.dampingFactor)*Math.pow(n,2)+r*n+0,this.applyTransformMatrix(this.rotate(t,this._angleCurrent)),this.dispatchEvent(cw);let e=this;this._animationId=window.requestAnimationFrame(function(n){e.onRotationAnim(n,t,r)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(cv.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(cw)}else this._animationId=-1,this._timeStart=-1,this._state!=cv.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(cw))}),cg(this,"pan",function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n.camera){let i=e.clone().sub(t);if(n.camera instanceof eR.OrthographicCamera&&i.multiplyScalar(1/n.camera.zoom),n.camera instanceof eR.PerspectiveCamera&&r){n._v3_1.setFromMatrixPosition(n._cameraMatrixState0),n._v3_2.setFromMatrixPosition(n._gizmoMatrixState0);let e=n._v3_1.distanceTo(n._v3_2)/n.camera.position.distanceTo(n._gizmos.position);i.multiplyScalar(1/e)}n._v3_1.set(i.x,i.y,0).applyQuaternion(n.camera.quaternion),n._m4_1.makeTranslation(n._v3_1.x,n._v3_1.y,n._v3_1.z),n.setTransformationMatrices(n._m4_1,n._m4_1)}return cC}),cg(this,"reset",()=>{if(this.camera){this.camera.zoom=this._zoom0,this.camera instanceof eR.PerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix();let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cw)}}),cg(this,"rotate",(e,t)=>{let r=this._gizmos.position;return this._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),this._rotationMatrix.makeRotationAxis(e,-t),this._m4_1.makeTranslation(r.x,r.y,r.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),cC}),cg(this,"copyState",()=>{if(this.camera){let e=JSON.stringify(this.camera instanceof eR.OrthographicCamera?{arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}:{arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}});navigator.clipboard.writeText(e)}}),cg(this,"pasteState",()=>{let e=this;navigator.clipboard.readText().then(function(t){e.setStateFromJSON(t)})}),cg(this,"saveState",()=>{this.camera&&(this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera instanceof eR.PerspectiveCamera&&(this._fov0=this.camera.fov))}),cg(this,"applyScale",function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(!n.camera)return;let i=t.clone(),o=1/e;if(n.camera instanceof eR.OrthographicCamera){n.camera.zoom=n._zoomState,n.camera.zoom*=e,n.camera.zoom>n.maxZoom?(n.camera.zoom=n.maxZoom,o=n._zoomState/n.maxZoom):n.camera.zoom<n.minZoom&&(n.camera.zoom=n.minZoom,o=n._zoomState/n.minZoom),n.camera.updateProjectionMatrix(),n._v3_1.setFromMatrixPosition(n._gizmoMatrixState),n._scaleMatrix.makeScale(o,o,o),n._translationMatrix.makeTranslation(-n._v3_1.x,-n._v3_1.y,-n._v3_1.z),n._m4_2.makeTranslation(n._v3_1.x,n._v3_1.y,n._v3_1.z).multiply(n._scaleMatrix),n._m4_2.multiply(n._translationMatrix),i.sub(n._v3_1);let t=i.clone().multiplyScalar(o);return i.sub(t),n._m4_1.makeTranslation(i.x,i.y,i.z),n._m4_2.premultiply(n._m4_1),n.setTransformationMatrices(n._m4_1,n._m4_2),cC}if(n.camera instanceof eR.PerspectiveCamera){n._v3_1.setFromMatrixPosition(n._cameraMatrixState),n._v3_2.setFromMatrixPosition(n._gizmoMatrixState);let e=n._v3_1.distanceTo(i),t=e-e*o,a=e-t;a<n.minDistance?(o=n.minDistance/e,t=e-e*o):a>n.maxDistance&&(o=n.maxDistance/e,t=e-e*o);let s=i.clone().sub(n._v3_1).normalize().multiplyScalar(t);if(n._m4_1.makeTranslation(s.x,s.y,s.z),r){let r=n._v3_2;t=(e=r.distanceTo(i))-e*o,s=i.clone().sub(n._v3_2).normalize().multiplyScalar(t),n._translationMatrix.makeTranslation(r.x,r.y,r.z),n._scaleMatrix.makeScale(o,o,o),n._m4_2.makeTranslation(s.x,s.y,s.z).multiply(n._translationMatrix),n._m4_2.multiply(n._scaleMatrix),n._translationMatrix.makeTranslation(-r.x,-r.y,-r.z),n._m4_2.multiply(n._translationMatrix),n.setTransformationMatrices(n._m4_1,n._m4_2)}else n.setTransformationMatrices(n._m4_1);return cC}}),cg(this,"setFov",e=>{this.camera instanceof eR.PerspectiveCamera&&(this.camera.fov=eR.MathUtils.clamp(e,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}),cg(this,"setTarget",(e,t,r)=>{if(this.camera){this.target.set(e,t,r),this._gizmos.position.set(e,t,r);let n=this.calculateTbRadius(this.camera);void 0!==n&&(this._tbRadius=n),this.makeGizmos(this.target,this._tbRadius),this.camera.lookAt(this.target)}}),cg(this,"zRotate",(e,t)=>(this._rotationMatrix.makeRotationAxis(this._rotationAxis,t),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._m4_1.makeTranslation(e.x,e.y,e.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(e),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,t),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),cC)),cg(this,"unprojectOnObj",(e,t)=>{if(!this.scene)return null;let r=new eR.Raycaster;r.near=t.near,r.far=t.far,r.setFromCamera(e,t);let n=r.intersectObjects(this.scene.children,!0);for(let e=0;e<n.length;e++)if(n[e].object.uuid!=this._gizmos.uuid&&n[e].face)return n[e].point.clone();return null}),cg(this,"unprojectOnTbSurface",(e,t,r,n,i)=>{if(e instanceof eR.OrthographicCamera){this._v2_1.copy(this.getCursorPosition(t,r,n)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);let e=Math.pow(this._v2_1.x,2),i=Math.pow(this._v2_1.y,2),o=Math.pow(this._tbRadius,2);return e+i<=.5*o?this._v3_1.setZ(Math.sqrt(o-(e+i))):this._v3_1.setZ(.5*o/Math.sqrt(e+i)),this._v3_1}if(e instanceof eR.PerspectiveCamera){this._v2_1.copy(this.getCursorNDC(t,r,n)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);let o=this._v3_1.clone().normalize(),a=e.position.distanceTo(this._gizmos.position),s=Math.pow(i,2),l=this._v3_1.z,c=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(0==c)return o.set(this._v3_1.x,this._v3_1.y,i),o;let u=l/c,h=Math.pow(u,2)+1,d=2*u*a,A=Math.pow(a,2)-s,f=Math.pow(d,2)-4*h*A;if(f>=0&&(this._v2_1.setX((-d-Math.sqrt(f))/(2*h)),this._v2_1.setY(u*this._v2_1.x+a),eR.MathUtils.RAD2DEG*this._v2_1.angle()>=45)){let e=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return o.multiplyScalar(e),o.z+=a,o}h=u,f=Math.pow(d=a,2)-4*h*(A=-(.5*s)),this._v2_1.setX((-d-Math.sqrt(f))/(2*h)),this._v2_1.setY(u*this._v2_1.x+a);let p=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return o.multiplyScalar(p),o.z+=a,o}}),cg(this,"unprojectOnTbPlane",function(e,t,r,i){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(e instanceof eR.OrthographicCamera)return n._v2_1.copy(n.getCursorPosition(t,r,i)),n._v3_1.set(n._v2_1.x,n._v2_1.y,0),n._v3_1.clone();if(e instanceof eR.PerspectiveCamera){let a;n._v2_1.copy(n.getCursorNDC(t,r,i)),n._v3_1.set(n._v2_1.x,n._v2_1.y,-1),n._v3_1.applyMatrix4(e.projectionMatrixInverse);let s=n._v3_1.clone().normalize(),l=n._v3_1.z,c=Math.sqrt(Math.pow(n._v3_1.x,2)+Math.pow(n._v3_1.y,2));return(a=o?n._v3_1.setFromMatrixPosition(n._cameraMatrixState0).distanceTo(n._v3_2.setFromMatrixPosition(n._gizmoMatrixState0)):e.position.distanceTo(n._gizmos.position),0==c)?s.set(0,0,0):(s.multiplyScalar(Math.sqrt(Math.pow(a,2)+Math.pow(-a/(l/c),2))),s.z=0),s}}),cg(this,"updateMatrixState",()=>{this.camera&&(this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera instanceof eR.OrthographicCamera&&(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom),this.camera instanceof eR.PerspectiveCamera&&(this._fovState=this.camera.fov))}),cg(this,"updateTbState",(e,t)=>{this._state=e,t&&this.updateMatrixState()}),cg(this,"update",()=>{if(!this.target.equals(this._currentTarget)&&this.camera){this._gizmos.position.set(this.target.x,this.target.y,this.target.z);let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)}if(this.camera){if(this.camera instanceof eR.OrthographicCamera&&(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom)){let e=eR.MathUtils.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.applyScale(e/this.camera.zoom,this._gizmos.position,!0))}if(this.camera instanceof eR.PerspectiveCamera){let e=this.camera.position.distanceTo(this._gizmos.position);if(e>this.maxDistance+1e-6||e<this.minDistance-1e-6){let t=eR.MathUtils.clamp(e,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.applyScale(t/e,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=eR.MathUtils.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());let t=this._tbRadius,r=this.calculateTbRadius(this.camera);if(void 0!==r&&(this._tbRadius=r),t<this._tbRadius-1e-6||t>this._tbRadius+1e-6){let e=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3,t=this._tbRadius/e,r=new eR.EllipseCurve(0,0,t,t).getPoints(this._curvePts),n=new eR.BufferGeometry().setFromPoints(r);for(let e in this._gizmos.children)this._gizmos.children[e].geometry=n}}this.camera.lookAt(this._gizmos.position)}}),cg(this,"setStateFromJSON",e=>{let t=JSON.parse(e);if(t.arcballState&&this.camera){this._cameraMatrixState.fromArray(t.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(t.arcballState.cameraUp),this.camera.near=t.arcballState.cameraNear,this.camera.far=t.arcballState.cameraFar,this.camera.zoom=t.arcballState.cameraZoom,this.camera instanceof eR.PerspectiveCamera&&(this.camera.fov=t.arcballState.cameraFov),this._gizmoMatrixState.fromArray(t.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix();let e=this.calculateTbRadius(this.camera);void 0!==e&&(this._tbRadius=e);let r=new eR.Matrix4().copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(r),this.camera.lookAt(this._gizmos.position),this.updateTbState(cv.IDLE,!1),this.dispatchEvent(cw)}}),this.camera=null,this.domElement=t,this.scene=r,this.mouseActions=[],this._mouseOp=null,this._v2_1=new eR.Vector2,this._v3_1=new eR.Vector3,this._v3_2=new eR.Vector3,this._m4_1=new eR.Matrix4,this._m4_2=new eR.Matrix4,this._quat=new eR.Quaternion,this._translationMatrix=new eR.Matrix4,this._rotationMatrix=new eR.Matrix4,this._scaleMatrix=new eR.Matrix4,this._rotationAxis=new eR.Vector3,this._cameraMatrixState=new eR.Matrix4,this._cameraProjectionState=new eR.Matrix4,this._fovState=1,this._upState=new eR.Vector3,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new eR.Matrix4,this._up0=new eR.Vector3,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new eR.Matrix4,this._gizmoMatrixState0=new eR.Matrix4,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=cy.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new eR.Vector3,this._startCursorPosition=new eR.Vector3,this._grid=null,this._gridPosition=new eR.Vector3,this._gizmos=new eR.Group,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new eR.Vector3,this._cursorPosCurr=new eR.Vector3,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.target=new eR.Vector3(0,0,0),this._currentTarget=new eR.Vector3(0,0,0),this._tbRadius=1,this._state=cv.IDLE,this.setCamera(e),this.scene&&this.scene.add(this._gizmos),this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this.domElement&&this.connect(this.domElement),window.addEventListener("resize",this.onWindowResize)}}let cb=(0,eT.forwardRef)((e,t)=>{let{camera:r,makeDefault:n,regress:i,domElement:o,onChange:a,onStart:s,onEnd:l,...c}=e,u=(0,eP.A)(e=>e.invalidate),h=(0,eP.A)(e=>e.camera),d=(0,eP.A)(e=>e.gl),A=(0,eP.A)(e=>e.events),f=(0,eP.A)(e=>e.set),p=(0,eP.A)(e=>e.get),m=(0,eP.A)(e=>e.performance),g=r||h,v=o||A.connected||d.domElement,y=(0,eT.useMemo)(()=>new cI(g),[g]);return(0,eP.C)(()=>{y.enabled&&y.update()},-1),(0,eT.useEffect)(()=>(y.connect(v),()=>void y.dispose()),[v,i,y,u]),(0,eT.useEffect)(()=>{let e=e=>{u(),i&&m.regress(),a&&a(e)};return y.addEventListener("change",e),s&&y.addEventListener("start",s),l&&y.addEventListener("end",l),()=>{y.removeEventListener("change",e),s&&y.removeEventListener("start",s),l&&y.removeEventListener("end",l)}},[a,s,l]),(0,eT.useEffect)(()=>{if(n){let e=p().controls;return f({controls:y}),()=>f({controls:e})}},[n,y]),eT.createElement("primitive",(0,eS.Z)({ref:t,object:y},c))});var c_=Object.defineProperty,cM=(e,t,r)=>t in e?c_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cS=(e,t,r)=>(cM(e,"symbol"!=typeof t?t+"":t,r),r);class cT extends eR.Object3D{constructor(e,t){super(),cS(this,"isTransformControls",!0),cS(this,"visible",!1),cS(this,"domElement"),cS(this,"raycaster",new eR.Raycaster),cS(this,"gizmo"),cS(this,"plane"),cS(this,"tempVector",new eR.Vector3),cS(this,"tempVector2",new eR.Vector3),cS(this,"tempQuaternion",new eR.Quaternion),cS(this,"unit",{X:new eR.Vector3(1,0,0),Y:new eR.Vector3(0,1,0),Z:new eR.Vector3(0,0,1)}),cS(this,"pointStart",new eR.Vector3),cS(this,"pointEnd",new eR.Vector3),cS(this,"offset",new eR.Vector3),cS(this,"rotationAxis",new eR.Vector3),cS(this,"startNorm",new eR.Vector3),cS(this,"endNorm",new eR.Vector3),cS(this,"rotationAngle",0),cS(this,"cameraPosition",new eR.Vector3),cS(this,"cameraQuaternion",new eR.Quaternion),cS(this,"cameraScale",new eR.Vector3),cS(this,"parentPosition",new eR.Vector3),cS(this,"parentQuaternion",new eR.Quaternion),cS(this,"parentQuaternionInv",new eR.Quaternion),cS(this,"parentScale",new eR.Vector3),cS(this,"worldPositionStart",new eR.Vector3),cS(this,"worldQuaternionStart",new eR.Quaternion),cS(this,"worldScaleStart",new eR.Vector3),cS(this,"worldPosition",new eR.Vector3),cS(this,"worldQuaternion",new eR.Quaternion),cS(this,"worldQuaternionInv",new eR.Quaternion),cS(this,"worldScale",new eR.Vector3),cS(this,"eye",new eR.Vector3),cS(this,"positionStart",new eR.Vector3),cS(this,"quaternionStart",new eR.Quaternion),cS(this,"scaleStart",new eR.Vector3),cS(this,"camera"),cS(this,"object"),cS(this,"enabled",!0),cS(this,"axis",null),cS(this,"mode","translate"),cS(this,"translationSnap",null),cS(this,"rotationSnap",null),cS(this,"scaleSnap",null),cS(this,"space","world"),cS(this,"size",1),cS(this,"dragging",!1),cS(this,"showX",!0),cS(this,"showY",!0),cS(this,"showZ",!0),cS(this,"changeEvent",{type:"change"}),cS(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),cS(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),cS(this,"objectChangeEvent",{type:"objectChange"}),cS(this,"intersectObjectWithRay",(e,t,r)=>{let n=t.intersectObject(e,!0);for(let e=0;e<n.length;e++)if(n[e].object.visible||r)return n[e];return!1}),cS(this,"attach",e=>(this.object=e,this.visible=!0,this)),cS(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),cS(this,"reset",()=>(this.enabled&&this.dragging&&void 0!==this.object&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this)),cS(this,"updateMatrixWorld",()=>{void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),cS(this,"pointerHover",e=>{if(void 0===this.object||!0===this.dragging)return;this.raycaster.setFromCamera(e,this.camera);let t=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);t?this.axis=t.object.name:this.axis=null}),cS(this,"pointerDown",e=>{if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){this.raycaster.setFromCamera(e,this.camera);let t=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(t){let e=this.space;if("scale"===this.mode?e="local":("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)&&(e="world"),"local"===e&&"rotate"===this.mode){let e=this.rotationSnap;"X"===this.axis&&e&&(this.object.rotation.x=Math.round(this.object.rotation.x/e)*e),"Y"===this.axis&&e&&(this.object.rotation.y=Math.round(this.object.rotation.y/e)*e),"Z"===this.axis&&e&&(this.object.rotation.z=Math.round(this.object.rotation.z/e)*e)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),cS(this,"pointerMove",e=>{let t=this.axis,r=this.mode,n=this.object,i=this.space;if("scale"===r?i="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(i="world"),void 0===n||null===t||!1===this.dragging||-1!==e.button)return;this.raycaster.setFromCamera(e,this.camera);let o=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(o){if(this.pointEnd.copy(o.point).sub(this.worldPositionStart),"translate"===r)this.offset.copy(this.pointEnd).sub(this.pointStart),"local"===i&&"XYZ"!==t&&this.offset.applyQuaternion(this.worldQuaternionInv),-1===t.indexOf("X")&&(this.offset.x=0),-1===t.indexOf("Y")&&(this.offset.y=0),-1===t.indexOf("Z")&&(this.offset.z=0),"local"===i&&"XYZ"!==t?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),n.position.copy(this.offset).add(this.positionStart),this.translationSnap&&("local"===i&&(n.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),-1!==t.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.position.applyQuaternion(this.quaternionStart)),"world"===i&&(n.parent&&n.position.add(this.tempVector.setFromMatrixPosition(n.parent.matrixWorld)),-1!==t.search("X")&&(n.position.x=Math.round(n.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(n.position.y=Math.round(n.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(n.position.z=Math.round(n.position.z/this.translationSnap)*this.translationSnap),n.parent&&n.position.sub(this.tempVector.setFromMatrixPosition(n.parent.matrixWorld))));else if("scale"===r){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();0>this.pointEnd.dot(this.pointStart)&&(e*=-1),this.tempVector2.set(e,e,e)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),-1===t.search("X")&&(this.tempVector2.x=1),-1===t.search("Y")&&(this.tempVector2.y=1),-1===t.search("Z")&&(this.tempVector2.z=1);n.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(-1!==t.search("X")&&(this.object.scale.x=Math.round(n.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(n.scale.y=Math.round(n.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(n.scale.z=Math.round(n.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===r){this.offset.copy(this.pointEnd).sub(this.pointStart);let e=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=0>this.endNorm.cross(this.startNorm).dot(this.eye)?1:-1):"XYZE"===t?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(this.unit[t]),this.tempVector.copy(this.unit[t]),"local"===i&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===i&&"E"!==t&&"XYZE"!==t?(n.quaternion.copy(this.quaternionStart),n.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),n.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),n.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),cS(this,"pointerUp",e=>{0===e.button&&(this.dragging&&null!==this.axis&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),cS(this,"getPointer",e=>{var t;if(this.domElement&&(null==(t=this.domElement.ownerDocument)?void 0:t.pointerLockElement))return{x:0,y:0,button:e.button};{let t=e.changedTouches?e.changedTouches[0]:e,r=this.domElement.getBoundingClientRect();return{x:(t.clientX-r.left)/r.width*2-1,y:-(t.clientY-r.top)/r.height*2+1,button:e.button}}}),cS(this,"onPointerHover",e=>{if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(e))}}),cS(this,"onPointerDown",e=>{this.enabled&&this.domElement&&(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(e)),this.pointerDown(this.getPointer(e)))}),cS(this,"onPointerMove",e=>{this.enabled&&this.pointerMove(this.getPointer(e))}),cS(this,"onPointerUp",e=>{this.enabled&&this.domElement&&(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(e)))}),cS(this,"getMode",()=>this.mode),cS(this,"setMode",e=>{this.mode=e}),cS(this,"setTranslationSnap",e=>{this.translationSnap=e}),cS(this,"setRotationSnap",e=>{this.rotationSnap=e}),cS(this,"setScaleSnap",e=>{this.scaleSnap=e}),cS(this,"setSize",e=>{this.size=e}),cS(this,"setSpace",e=>{this.space=e}),cS(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),cS(this,"connect",e=>{e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=e,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),cS(this,"dispose",()=>{var e,t,r,n,i,o;null==(e=this.domElement)||e.removeEventListener("pointerdown",this.onPointerDown),null==(t=this.domElement)||t.removeEventListener("pointermove",this.onPointerHover),null==(n=null==(r=this.domElement)?void 0:r.ownerDocument)||n.removeEventListener("pointermove",this.onPointerMove),null==(o=null==(i=this.domElement)?void 0:i.ownerDocument)||o.removeEventListener("pointerup",this.onPointerUp),this.traverse(e=>{e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}),this.domElement=t,this.camera=e,this.gizmo=new cD,this.add(this.gizmo),this.plane=new cR,this.add(this.plane);let r=(e,t)=>{let r=t;Object.defineProperty(this,e,{get:function(){return void 0!==r?r:t},set:function(t){r!==t&&(r=t,this.plane[e]=t,this.gizmo[e]=t,this.dispatchEvent({type:e+"-changed",value:t}),this.dispatchEvent(this.changeEvent))}}),this[e]=t,this.plane[e]=t,this.gizmo[e]=t};r("camera",this.camera),r("object",this.object),r("enabled",this.enabled),r("axis",this.axis),r("mode",this.mode),r("translationSnap",this.translationSnap),r("rotationSnap",this.rotationSnap),r("scaleSnap",this.scaleSnap),r("space",this.space),r("size",this.size),r("dragging",this.dragging),r("showX",this.showX),r("showY",this.showY),r("showZ",this.showZ),r("worldPosition",this.worldPosition),r("worldPositionStart",this.worldPositionStart),r("worldQuaternion",this.worldQuaternion),r("worldQuaternionStart",this.worldQuaternionStart),r("cameraPosition",this.cameraPosition),r("cameraQuaternion",this.cameraQuaternion),r("pointStart",this.pointStart),r("pointEnd",this.pointEnd),r("rotationAxis",this.rotationAxis),r("rotationAngle",this.rotationAngle),r("eye",this.eye),void 0!==t&&this.connect(t)}}class cD extends eR.Object3D{constructor(){super(),cS(this,"isTransformControlsGizmo",!0),cS(this,"type","TransformControlsGizmo"),cS(this,"tempVector",new eR.Vector3(0,0,0)),cS(this,"tempEuler",new eR.Euler),cS(this,"alignVector",new eR.Vector3(0,1,0)),cS(this,"zeroVector",new eR.Vector3(0,0,0)),cS(this,"lookAtMatrix",new eR.Matrix4),cS(this,"tempQuaternion",new eR.Quaternion),cS(this,"tempQuaternion2",new eR.Quaternion),cS(this,"identityQuaternion",new eR.Quaternion),cS(this,"unitX",new eR.Vector3(1,0,0)),cS(this,"unitY",new eR.Vector3(0,1,0)),cS(this,"unitZ",new eR.Vector3(0,0,1)),cS(this,"gizmo"),cS(this,"picker"),cS(this,"helper"),cS(this,"rotationAxis",new eR.Vector3),cS(this,"cameraPosition",new eR.Vector3),cS(this,"worldPositionStart",new eR.Vector3),cS(this,"worldQuaternionStart",new eR.Quaternion),cS(this,"worldPosition",new eR.Vector3),cS(this,"worldQuaternion",new eR.Quaternion),cS(this,"eye",new eR.Vector3),cS(this,"camera",null),cS(this,"enabled",!0),cS(this,"axis",null),cS(this,"mode","translate"),cS(this,"space","world"),cS(this,"size",1),cS(this,"dragging",!1),cS(this,"showX",!0),cS(this,"showY",!0),cS(this,"showZ",!0),cS(this,"updateMatrixWorld",()=>{let e=this.space;"scale"===this.mode&&(e="local");let t="local"===e?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=(r=(r=r.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(let e=0;e<r.length;e++){let n;let i=r[e];if(i.visible=!0,i.rotation.set(0,0,0),i.position.copy(this.worldPosition),n=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),i.scale.set(1,1,1).multiplyScalar(n*this.size/7),"helper"===i.tag){i.visible=!1,"AXIS"===i.name?(i.position.copy(this.worldPositionStart),i.visible=!!this.axis,"X"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),i.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Y"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),i.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"Z"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),i.quaternion.copy(t).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.9&&(i.visible=!1)),"XYZE"===this.axis&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),i.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),i.quaternion.multiply(this.tempQuaternion),i.visible=this.dragging),"E"===this.axis&&(i.visible=!1)):"START"===i.name?(i.position.copy(this.worldPositionStart),i.visible=this.dragging):"END"===i.name?(i.position.copy(this.worldPosition),i.visible=this.dragging):"DELTA"===i.name?(i.position.copy(this.worldPositionStart),i.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),i.scale.copy(this.tempVector),i.visible=this.dragging):(i.quaternion.copy(t),this.dragging?i.position.copy(this.worldPositionStart):i.position.copy(this.worldPosition),this.axis&&(i.visible=-1!==this.axis.search(i.name)));continue}i.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?(("X"===i.name||"XYZX"===i.name)&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),("Y"===i.name||"XYZY"===i.name)&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),("Z"===i.name||"XYZZ"===i.name)&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XY"===i.name&&.2>Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye))&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"YZ"===i.name&&.2>Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye))&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),"XZ"===i.name&&.2>Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye))&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),-1!==i.name.search("X")&&(0>this.alignVector.copy(this.unitX).applyQuaternion(t).dot(this.eye)?"fwd"===i.tag?i.visible=!1:i.scale.x*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Y")&&(0>this.alignVector.copy(this.unitY).applyQuaternion(t).dot(this.eye)?"fwd"===i.tag?i.visible=!1:i.scale.y*=-1:"bwd"===i.tag&&(i.visible=!1)),-1!==i.name.search("Z")&&(0>this.alignVector.copy(this.unitZ).applyQuaternion(t).dot(this.eye)?"fwd"===i.tag?i.visible=!1:i.scale.z*=-1:"bwd"===i.tag&&(i.visible=!1))):"rotate"===this.mode&&(this.tempQuaternion2.copy(t),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(t).invert()),-1!==i.name.search("E")&&i.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),"X"===i.name&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),i.quaternion.copy(this.tempQuaternion)),"Y"===i.name&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),i.quaternion.copy(this.tempQuaternion)),"Z"===i.name&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),i.quaternion.copy(this.tempQuaternion))),i.visible=i.visible&&(-1===i.name.indexOf("X")||this.showX),i.visible=i.visible&&(-1===i.name.indexOf("Y")||this.showY),i.visible=i.visible&&(-1===i.name.indexOf("Z")||this.showZ),i.visible=i.visible&&(-1===i.name.indexOf("E")||this.showX&&this.showY&&this.showZ),i.material.tempOpacity=i.material.tempOpacity||i.material.opacity,i.material.tempColor=i.material.tempColor||i.material.color.clone(),i.material.color.copy(i.material.tempColor),i.material.opacity=i.material.tempOpacity,this.enabled?this.axis&&(i.name===this.axis?i.material.opacity=1:this.axis.split("").some(function(e){return i.name===e})?i.material.opacity=1:i.material.opacity*=.25,i.material.color.lerp(new eR.Color(1,1,1),.5)):(i.material.opacity*=.5,i.material.color.lerp(new eR.Color(1,1,1),.5))}super.updateMatrixWorld()});let e=new eR.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:eR.DoubleSide,fog:!1,toneMapped:!1}),t=new eR.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),r=e.clone();r.opacity=.15;let n=e.clone();n.opacity=.33;let i=e.clone();i.color.set(16711680);let o=e.clone();o.color.set(65280);let a=e.clone();a.color.set(255);let s=e.clone();s.opacity=.25;let l=s.clone();l.color.set(16776960);let c=s.clone();c.color.set(65535);let u=s.clone();u.color.set(16711935),e.clone().color.set(16776960);let h=t.clone();h.color.set(16711680);let d=t.clone();d.color.set(65280);let A=t.clone();A.color.set(255);let f=t.clone();f.color.set(65535);let p=t.clone();p.color.set(16711935);let m=t.clone();m.color.set(16776960);let g=t.clone();g.color.set(7895160);let v=m.clone();v.opacity=.25;let y=new eR.CylinderGeometry(0,.05,.2,12,1,!1),E=new eR.BoxGeometry(.125,.125,.125),C=new eR.BufferGeometry;C.setAttribute("position",new eR.Float32BufferAttribute([0,0,0,1,0,0],3));let w=(e,t)=>{let r=new eR.BufferGeometry,n=[];for(let r=0;r<=64*t;++r)n.push(0,Math.cos(r/32*Math.PI)*e,Math.sin(r/32*Math.PI)*e);return r.setAttribute("position",new eR.Float32BufferAttribute(n,3)),r},B={X:[[new eR.Mesh(y,i),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new eR.Mesh(y,i),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new eR.Line(C,h)]],Y:[[new eR.Mesh(y,o),[0,1,0],null,null,"fwd"],[new eR.Mesh(y,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new eR.Line(C,d),null,[0,0,Math.PI/2]]],Z:[[new eR.Mesh(y,a),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new eR.Mesh(y,a),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new eR.Line(C,A),null,[0,-Math.PI/2,0]]],XYZ:[[new eR.Mesh(new eR.OctahedronGeometry(.1,0),s.clone()),[0,0,0],[0,0,0]]],XY:[[new eR.Mesh(new eR.PlaneGeometry(.295,.295),l.clone()),[.15,.15,0]],[new eR.Line(C,m),[.18,.3,0],null,[.125,1,1]],[new eR.Line(C,m),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new eR.Mesh(new eR.PlaneGeometry(.295,.295),c.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new eR.Line(C,f),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new eR.Line(C,f),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new eR.Mesh(new eR.PlaneGeometry(.295,.295),u.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new eR.Line(C,p),[.18,0,.3],null,[.125,1,1]],[new eR.Line(C,p),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},x={X:[[new eR.Mesh(new eR.CylinderGeometry(.2,0,1,4,1,!1),r),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new eR.Mesh(new eR.CylinderGeometry(.2,0,1,4,1,!1),r),[0,.6,0]]],Z:[[new eR.Mesh(new eR.CylinderGeometry(.2,0,1,4,1,!1),r),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new eR.Mesh(new eR.OctahedronGeometry(.2,0),r)]],XY:[[new eR.Mesh(new eR.PlaneGeometry(.4,.4),r),[.2,.2,0]]],YZ:[[new eR.Mesh(new eR.PlaneGeometry(.4,.4),r),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new eR.Mesh(new eR.PlaneGeometry(.4,.4),r),[.2,0,.2],[-Math.PI/2,0,0]]]},I={START:[[new eR.Mesh(new eR.OctahedronGeometry(.01,2),n),null,null,null,"helper"]],END:[[new eR.Mesh(new eR.OctahedronGeometry(.01,2),n),null,null,null,"helper"]],DELTA:[[new eR.Line((()=>{let e=new eR.BufferGeometry;return e.setAttribute("position",new eR.Float32BufferAttribute([0,0,0,1,1,1],3)),e})(),n),null,null,null,"helper"]],X:[[new eR.Line(C,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new eR.Line(C,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new eR.Line(C,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},b={X:[[new eR.Line(w(1,.5),h)],[new eR.Mesh(new eR.OctahedronGeometry(.04,0),i),[0,0,.99],null,[1,3,1]]],Y:[[new eR.Line(w(1,.5),d),null,[0,0,-Math.PI/2]],[new eR.Mesh(new eR.OctahedronGeometry(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new eR.Line(w(1,.5),A),null,[0,Math.PI/2,0]],[new eR.Mesh(new eR.OctahedronGeometry(.04,0),a),[.99,0,0],null,[1,3,1]]],E:[[new eR.Line(w(1.25,1),v),null,[0,Math.PI/2,0]],[new eR.Mesh(new eR.CylinderGeometry(.03,0,.15,4,1,!1),v),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new eR.Mesh(new eR.CylinderGeometry(.03,0,.15,4,1,!1),v),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new eR.Mesh(new eR.CylinderGeometry(.03,0,.15,4,1,!1),v),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new eR.Mesh(new eR.CylinderGeometry(.03,0,.15,4,1,!1),v),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new eR.Line(w(1,1),g),null,[0,Math.PI/2,0]]]},_={AXIS:[[new eR.Line(C,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},M={X:[[new eR.Mesh(new eR.TorusGeometry(1,.1,4,24),r),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new eR.Mesh(new eR.TorusGeometry(1,.1,4,24),r),[0,0,0],[Math.PI/2,0,0]]],Z:[[new eR.Mesh(new eR.TorusGeometry(1,.1,4,24),r),[0,0,0],[0,0,-Math.PI/2]]],E:[[new eR.Mesh(new eR.TorusGeometry(1.25,.1,2,24),r)]],XYZE:[[new eR.Mesh(new eR.SphereGeometry(.7,10,8),r)]]},S={X:[[new eR.Mesh(E,i),[.8,0,0],[0,0,-Math.PI/2]],[new eR.Line(C,h),null,null,[.8,1,1]]],Y:[[new eR.Mesh(E,o),[0,.8,0]],[new eR.Line(C,d),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new eR.Mesh(E,a),[0,0,.8],[Math.PI/2,0,0]],[new eR.Line(C,A),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new eR.Mesh(E,l),[.85,.85,0],null,[2,2,.2]],[new eR.Line(C,m),[.855,.98,0],null,[.125,1,1]],[new eR.Line(C,m),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new eR.Mesh(E,c),[0,.85,.85],null,[.2,2,2]],[new eR.Line(C,f),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new eR.Line(C,f),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new eR.Mesh(E,u),[.85,0,.85],null,[2,.2,2]],[new eR.Line(C,p),[.855,0,.98],null,[.125,1,1]],[new eR.Line(C,p),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new eR.Mesh(new eR.BoxGeometry(.125,.125,.125),s.clone()),[1.1,0,0]]],XYZY:[[new eR.Mesh(new eR.BoxGeometry(.125,.125,.125),s.clone()),[0,1.1,0]]],XYZZ:[[new eR.Mesh(new eR.BoxGeometry(.125,.125,.125),s.clone()),[0,0,1.1]]]},T={X:[[new eR.Mesh(new eR.CylinderGeometry(.2,0,.8,4,1,!1),r),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new eR.Mesh(new eR.CylinderGeometry(.2,0,.8,4,1,!1),r),[0,.5,0]]],Z:[[new eR.Mesh(new eR.CylinderGeometry(.2,0,.8,4,1,!1),r),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new eR.Mesh(E,r),[.85,.85,0],null,[3,3,.2]]],YZ:[[new eR.Mesh(E,r),[0,.85,.85],null,[.2,3,3]]],XZ:[[new eR.Mesh(E,r),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new eR.Mesh(new eR.BoxGeometry(.2,.2,.2),r),[1.1,0,0]]],XYZY:[[new eR.Mesh(new eR.BoxGeometry(.2,.2,.2),r),[0,1.1,0]]],XYZZ:[[new eR.Mesh(new eR.BoxGeometry(.2,.2,.2),r),[0,0,1.1]]]},D={X:[[new eR.Line(C,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new eR.Line(C,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new eR.Line(C,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},R=e=>{let t=new eR.Object3D;for(let r in e)for(let n=e[r].length;n--;){let i=e[r][n][0].clone(),o=e[r][n][1],a=e[r][n][2],s=e[r][n][3],l=e[r][n][4];i.name=r,i.tag=l,o&&i.position.set(o[0],o[1],o[2]),a&&i.rotation.set(a[0],a[1],a[2]),s&&i.scale.set(s[0],s[1],s[2]),i.updateMatrix();let c=i.geometry.clone();c.applyMatrix4(i.matrix),i.geometry=c,i.renderOrder=1/0,i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1),t.add(i)}return t};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=R(B)),this.add(this.gizmo.rotate=R(b)),this.add(this.gizmo.scale=R(S)),this.add(this.picker.translate=R(x)),this.add(this.picker.rotate=R(M)),this.add(this.picker.scale=R(T)),this.add(this.helper.translate=R(I)),this.add(this.helper.rotate=R(_)),this.add(this.helper.scale=R(D)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class cR extends eR.Mesh{constructor(){super(new eR.PlaneGeometry(1e5,1e5,2,2),new eR.MeshBasicMaterial({visible:!1,wireframe:!0,side:eR.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),cS(this,"isTransformControlsPlane",!0),cS(this,"type","TransformControlsPlane"),cS(this,"unitX",new eR.Vector3(1,0,0)),cS(this,"unitY",new eR.Vector3(0,1,0)),cS(this,"unitZ",new eR.Vector3(0,0,1)),cS(this,"tempVector",new eR.Vector3),cS(this,"dirVector",new eR.Vector3),cS(this,"alignVector",new eR.Vector3),cS(this,"tempMatrix",new eR.Matrix4),cS(this,"identityQuaternion",new eR.Quaternion),cS(this,"cameraQuaternion",new eR.Quaternion),cS(this,"worldPosition",new eR.Vector3),cS(this,"worldQuaternion",new eR.Quaternion),cS(this,"eye",new eR.Vector3),cS(this,"axis",null),cS(this,"mode","translate"),cS(this,"space","world"),cS(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(e="local"),this.unitX.set(1,0,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion("local"===e?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0)}break;default:this.dirVector.set(0,0,0)}0===this.dirVector.length()?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}let cP=eT.forwardRef((e,t)=>{let{children:r,domElement:n,onChange:i,onMouseDown:o,onMouseUp:a,onObjectChange:s,object:l,makeDefault:c,camera:u,enabled:h,axis:d,mode:A,translationSnap:f,rotationSnap:p,scaleSnap:m,space:g,size:v,showX:y,showY:E,showZ:C,...w}=e,B=(0,eP.A)(e=>e.controls),x=(0,eP.A)(e=>e.gl),I=(0,eP.A)(e=>e.events),b=(0,eP.A)(e=>e.camera),_=(0,eP.A)(e=>e.invalidate),M=(0,eP.A)(e=>e.get),S=(0,eP.A)(e=>e.set),T=u||b,D=n||I.connected||x.domElement,R=eT.useMemo(()=>new cT(T,D),[T,D]),P=eT.useRef(null);eT.useLayoutEffect(()=>(l?R.attach(l instanceof eR.Object3D?l:l.current):P.current instanceof eR.Object3D&&R.attach(P.current),()=>void R.detach()),[l,r,R]),eT.useEffect(()=>{if(B){let e=e=>B.enabled=!e.value;return R.addEventListener("dragging-changed",e),()=>R.removeEventListener("dragging-changed",e)}},[R,B]);let F=eT.useRef(),Q=eT.useRef(),O=eT.useRef(),L=eT.useRef();return eT.useLayoutEffect(()=>void(F.current=i),[i]),eT.useLayoutEffect(()=>void(Q.current=o),[o]),eT.useLayoutEffect(()=>void(O.current=a),[a]),eT.useLayoutEffect(()=>void(L.current=s),[s]),eT.useEffect(()=>{let e=e=>{_(),null==F.current||F.current(e)},t=e=>null==Q.current?void 0:Q.current(e),r=e=>null==O.current?void 0:O.current(e),n=e=>null==L.current?void 0:L.current(e);return R.addEventListener("change",e),R.addEventListener("mouseDown",t),R.addEventListener("mouseUp",r),R.addEventListener("objectChange",n),()=>{R.removeEventListener("change",e),R.removeEventListener("mouseDown",t),R.removeEventListener("mouseUp",r),R.removeEventListener("objectChange",n)}},[_,R]),eT.useEffect(()=>{if(c){let e=M().controls;return S({controls:R}),()=>S({controls:e})}},[c,R]),eT.createElement(eT.Fragment,null,eT.createElement("primitive",{ref:t,object:R,enabled:h,axis:d,mode:A,translationSnap:f,rotationSnap:p,scaleSnap:m,space:g,size:v,showX:y,showY:E,showZ:C}),eT.createElement("group",(0,eS.Z)({ref:P},w),r))});var cF=Object.defineProperty,cQ=(e,t,r)=>t in e?cF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cO=(e,t,r)=>(cQ(e,"symbol"!=typeof t?t+"":t,r),r);let cL=new eR.Euler(0,0,0,"YXZ"),ck=new eR.Vector3,cU={type:"change"},cG={type:"lock"},cN={type:"unlock"},cz=Math.PI/2;class cH extends eR.EventDispatcher{constructor(e,t){super(),cO(this,"camera"),cO(this,"domElement"),cO(this,"isLocked"),cO(this,"minPolarAngle"),cO(this,"maxPolarAngle"),cO(this,"pointerSpeed"),cO(this,"onMouseMove",e=>{if(!this.domElement||!1===this.isLocked)return;let t=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;cL.setFromQuaternion(this.camera.quaternion),cL.y-=.002*t*this.pointerSpeed,cL.x-=.002*r*this.pointerSpeed,cL.x=Math.max(cz-this.maxPolarAngle,Math.min(cz-this.minPolarAngle,cL.x)),this.camera.quaternion.setFromEuler(cL),this.dispatchEvent(cU)}),cO(this,"onPointerlockChange",()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(cG),this.isLocked=!0):(this.dispatchEvent(cN),this.isLocked=!1))}),cO(this,"onPointerlockError",()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}),cO(this,"connect",e=>{this.domElement=e||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))}),cO(this,"disconnect",()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))}),cO(this,"dispose",()=>{this.disconnect()}),cO(this,"getObject",()=>this.camera),cO(this,"direction",new eR.Vector3(0,0,-1)),cO(this,"getDirection",e=>e.copy(this.direction).applyQuaternion(this.camera.quaternion)),cO(this,"moveForward",e=>{ck.setFromMatrixColumn(this.camera.matrix,0),ck.crossVectors(this.camera.up,ck),this.camera.position.addScaledVector(ck,e)}),cO(this,"moveRight",e=>{ck.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(ck,e)}),cO(this,"lock",()=>{this.domElement&&this.domElement.requestPointerLock()}),cO(this,"unlock",()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()}),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,t&&this.connect(t)}}let cV=eT.forwardRef((e,t)=>{let{domElement:r,selector:n,onChange:i,onLock:o,onUnlock:a,enabled:s=!0,makeDefault:l,...c}=e,{camera:u,...h}=c,d=(0,eP.A)(e=>e.setEvents),A=(0,eP.A)(e=>e.gl),f=(0,eP.A)(e=>e.camera),p=(0,eP.A)(e=>e.invalidate),m=(0,eP.A)(e=>e.events),g=(0,eP.A)(e=>e.get),v=(0,eP.A)(e=>e.set),y=u||f,E=r||m.connected||A.domElement,C=eT.useMemo(()=>new cH(y),[y]);return eT.useEffect(()=>{if(s){C.connect(E);let e=g().events.compute;return d({compute(e,t){let r=t.size.width/2,n=t.size.height/2;t.pointer.set(r/t.size.width*2-1,-(n/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),()=>{C.disconnect(),d({compute:e})}}},[s,C]),eT.useEffect(()=>{let e=e=>{p(),i&&i(e)};C.addEventListener("change",e),o&&C.addEventListener("lock",o),a&&C.addEventListener("unlock",a);let t=()=>C.lock(),r=n?Array.from(document.querySelectorAll(n)):[document];return r.forEach(e=>e&&e.addEventListener("click",t)),()=>{C.removeEventListener("change",e),o&&C.removeEventListener("lock",o),a&&C.removeEventListener("unlock",a),r.forEach(e=>e?e.removeEventListener("click",t):void 0)}},[i,o,a,n,C,p]),eT.useEffect(()=>{if(l){let e=g().controls;return v({controls:C}),()=>v({controls:e})}},[l,C]),eT.createElement("primitive",(0,eS.Z)({ref:t,object:C},h))});var cj=Object.defineProperty,cJ=(e,t,r)=>t in e?cj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cY=(e,t,r)=>(cJ(e,"symbol"!=typeof t?t+"":t,r),r);let cW=new eR.Vector3;class cq extends eR.EventDispatcher{constructor(e,t){super(),cY(this,"object"),cY(this,"domElement"),cY(this,"enabled",!0),cY(this,"movementSpeed",1),cY(this,"lookSpeed",.005),cY(this,"lookVertical",!0),cY(this,"autoForward",!1),cY(this,"activeLook",!0),cY(this,"heightSpeed",!1),cY(this,"heightCoef",1),cY(this,"heightMin",0),cY(this,"heightMax",1),cY(this,"constrainVertical",!1),cY(this,"verticalMin",0),cY(this,"verticalMax",Math.PI),cY(this,"mouseDragOn",!1),cY(this,"autoSpeedFactor",0),cY(this,"mouseX",0),cY(this,"mouseY",0),cY(this,"moveForward",!1),cY(this,"moveBackward",!1),cY(this,"moveLeft",!1),cY(this,"moveRight",!1),cY(this,"moveUp",!1),cY(this,"moveDown",!1),cY(this,"viewHalfX",0),cY(this,"viewHalfY",0),cY(this,"lat",0),cY(this,"lon",0),cY(this,"lookDirection",new eR.Vector3),cY(this,"spherical",new eR.Spherical),cY(this,"target",new eR.Vector3),cY(this,"connect",e=>{e.setAttribute("tabindex","-1"),e.style.touchAction="none",e.addEventListener("contextmenu",this.contextmenu),e.addEventListener("mousemove",this.onMouseMove),e.addEventListener("mousedown",this.onMouseDown),e.addEventListener("mouseup",this.onMouseUp),this.domElement=e,window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.handleResize()}),cY(this,"dispose",()=>{var e,t,r,n;null==(e=this.domElement)||e.removeEventListener("contextmenu",this.contextmenu),null==(t=this.domElement)||t.removeEventListener("mousedown",this.onMouseDown),null==(r=this.domElement)||r.removeEventListener("mousemove",this.onMouseMove),null==(n=this.domElement)||n.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}),cY(this,"handleResize",()=>{this.domElement&&(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)}),cY(this,"onMouseDown",e=>{var t;if(null==(t=this.domElement)||t.focus(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0}),cY(this,"onMouseUp",e=>{if(this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1}),cY(this,"onMouseMove",e=>{this.domElement&&(this.mouseX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=e.pageY-this.domElement.offsetTop-this.viewHalfY)}),cY(this,"onKeyDown",e=>{switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0}}),cY(this,"onKeyUp",e=>{switch(e.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1}}),cY(this,"lookAt",(e,t,r)=>(e instanceof eR.Vector3?this.target.copy(e):t&&r&&this.target.set(e,t,r),this.object.lookAt(this.target),this.setOrientation(),this)),cY(this,"update",e=>{if(!this.enabled)return;if(this.heightSpeed){let t=eR.MathUtils.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=t*this.heightCoef*e}else this.autoSpeedFactor=0;let t=e*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(t+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(t),this.moveLeft&&this.object.translateX(-t),this.moveRight&&this.object.translateX(t),this.moveUp&&this.object.translateY(t),this.moveDown&&this.object.translateY(-t);let r=e*this.lookSpeed;this.activeLook||(r=0);let n=1;this.constrainVertical&&(n=Math.PI/(this.verticalMax-this.verticalMin)),this.lon-=this.mouseX*r,this.lookVertical&&(this.lat-=this.mouseY*r*n),this.lat=Math.max(-85,Math.min(85,this.lat));let i=eR.MathUtils.degToRad(90-this.lat),o=eR.MathUtils.degToRad(this.lon);this.constrainVertical&&(i=eR.MathUtils.mapLinear(i,0,Math.PI,this.verticalMin,this.verticalMax));let a=this.object.position;cW.setFromSphericalCoords(1,i,o).add(a),this.object.lookAt(cW)}),cY(this,"contextmenu",e=>e.preventDefault()),cY(this,"setOrientation",()=>{this.lookDirection.set(0,0,-1).applyQuaternion(this.object.quaternion),this.spherical.setFromVector3(this.lookDirection),this.lat=90-eR.MathUtils.radToDeg(this.spherical.phi),this.lon=eR.MathUtils.radToDeg(this.spherical.theta)}),this.object=e,this.domElement=t,this.setOrientation(),t&&this.connect(t)}}let cK=eT.forwardRef((e,t)=>{let{domElement:r,makeDefault:n,...i}=e,o=(0,eP.A)(e=>e.camera),a=(0,eP.A)(e=>e.gl),s=(0,eP.A)(e=>e.events),l=(0,eP.A)(e=>e.get),c=(0,eP.A)(e=>e.set),u=r||s.connected||a.domElement,[h]=eT.useState(()=>new cq(o,u));return eT.useEffect(()=>{if(n){let e=l().controls;return c({controls:h}),()=>c({controls:e})}},[n,h]),(0,eP.C)((e,t)=>{h.update(t)},-1),h?eT.createElement("primitive",(0,eS.Z)({ref:t,object:h},i)):null}),cX={LEFT:1,RIGHT:2,MIDDLE:4},cZ=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),c$={NONE:0,IN:1,OUT:-1};function c0(e){return e.isPerspectiveCamera}function c1(e){return e.isOrthographicCamera}let c2=2*Math.PI,c3=Math.PI/2,c4=Math.PI/180;function c5(e,t,r){return Math.max(t,Math.min(r,e))}function c9(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-5;return Math.abs(e)<t}function c6(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5;return c9(e-t,r)}function c8(e,t){return Math.round(e/t)*t}function c7(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function ue(e){return Math.abs(e)<Number.MAX_VALUE?e:1/0*e}function ut(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=arguments.length>5?arguments[5]:void 0,a=2/(n=Math.max(1e-4,n)),s=a*o,l=1/(1+s+.48*s*s+.235*s*s*s),c=e-t,u=t,h=i*n;t=e-(c=c5(c,-h,h));let d=(r.value+a*c)*o;r.value=(r.value-a*d)*l;let A=t+(c+d)*l;return u-e>0==A>u&&(A=u,r.value=(A-u)/o),A}function ur(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=2/(n=Math.max(1e-4,n)),l=s*o,c=1/(1+l+.48*l*l+.235*l*l*l),u=t.x,h=t.y,d=t.z,A=e.x-u,f=e.y-h,p=e.z-d,m=u,g=h,v=d,y=i*n,E=A*A+f*f+p*p;if(E>y*y){let e=Math.sqrt(E);A=A/e*y,f=f/e*y,p=p/e*y}u=e.x-A,h=e.y-f,d=e.z-p;let C=(r.x+s*A)*o,w=(r.y+s*f)*o,B=(r.z+s*p)*o;r.x=(r.x-s*C)*c,r.y=(r.y-s*w)*c,r.z=(r.z-s*B)*c,a.x=u+(A+C)*c,a.y=h+(f+w)*c,a.z=d+(p+B)*c;let x=m-e.x,I=g-e.y,b=v-e.z;return x*(a.x-m)+I*(a.y-g)+b*(a.z-v)>0&&(a.x=m,a.y=g,a.z=v,r.x=(a.x-m)/o,r.y=(a.y-g)/o,r.z=(a.z-v)/o),a}function un(e,t){t.set(0,0),e.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=e.length,t.y/=e.length}function ui(e,t){return!!c1(e)&&(console.warn("".concat(t," is not supported in OrthographicCamera")),!0)}class uo{addEventListener(e,t){let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e)}}constructor(){this._listeners={}}}let ua=1/8,us=/Mac/.test(null===(ex=null==globalThis?void 0:globalThis.navigator)||void 0===ex?void 0:ex.platform);class ul extends uo{static install(e){c=Object.freeze(new(l=e.THREE).Vector3(0,0,0)),u=Object.freeze(new l.Vector3(0,1,0)),h=Object.freeze(new l.Vector3(0,0,1)),d=new l.Vector2,A=new l.Vector3,f=new l.Vector3,p=new l.Vector3,m=new l.Vector3,g=new l.Vector3,v=new l.Vector3,y=new l.Vector3,E=new l.Vector3,C=new l.Vector3,w=new l.Spherical,B=new l.Spherical,x=new l.Box3,I=new l.Box3,b=new l.Sphere,_=new l.Quaternion,M=new l.Quaternion,S=new l.Matrix4,T=new l.Raycaster}static get ACTION(){return cZ}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){(this._spherical.radius!==e||this._sphericalEnd.radius!==e)&&(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){(this._spherical.theta!==e||this._sphericalEnd.theta!==e)&&(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){(this._spherical.phi!==e||this._sphericalEnd.phi!==e)&&(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=c5(e.width,0,1),this._interactiveArea.height=c5(e.height,0,1),this._interactiveArea.x=c5(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=c5(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,r)}rotateAzimuthTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isUserControllingRotate=!1;let n=c5(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=c5(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=n,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,r||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);let o=!r||c6(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&c6(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._isUserControllingDolly=!1,this._lastDollyDirection=c$.NONE,this._changedDolly=0,this._dollyToNoClamp(c5(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){let t=this._collisionTest(),n=c6(t,this._spherical.radius);if(!(r>e)&&n)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);let n=!t||c6(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(n)}dollyInFixed(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._targetEnd.add(this._getCameraDirection(m).multiplyScalar(e)),t||this._target.copy(this._targetEnd);let r=!t||c6(this._target.x,this._targetEnd.x,this.restThreshold)&&c6(this._target.y,this._targetEnd.y,this.restThreshold)&&c6(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}zoom(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._isUserControllingZoom=!1,this._zoomEnd=c5(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);let r=!t||c6(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(r)}pan(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,r)}truck(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._camera.updateMatrix(),g.setFromMatrixColumn(this._camera.matrix,0),v.setFromMatrixColumn(this._camera.matrix,1),g.multiplyScalar(e),v.multiplyScalar(-t);let n=A.copy(g).add(v),i=f.copy(this._targetEnd).add(n);return this.moveTo(i.x,i.y,i.z,r)}forward(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];A.setFromMatrixColumn(this._camera.matrix,0),A.crossVectors(this._camera.up,A),A.multiplyScalar(e);let r=f.copy(this._targetEnd).add(A);return this.moveTo(r.x,r.y,r.z,t)}elevate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return A.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+A.x,this._targetEnd.y+A.y,this._targetEnd.z+A.z,t)}moveTo(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._isUserControllingTruck=!1;let i=A.set(e,t,r).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,n||this._target.copy(this._targetEnd);let o=!n||c6(this._target.x,this._targetEnd.x,this.restThreshold)&&c6(this._target.y,this._targetEnd.y,this.restThreshold)&&c6(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=A.set(e,t,r).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(i.x,i.y,i.z,n)}fitToBox(e,t){let{cover:r=!1,paddingLeft:n=0,paddingRight:i=0,paddingBottom:o=0,paddingTop:a=0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=[],l=e.isBox3?x.copy(e):x.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());let c=c8(this._sphericalEnd.theta,c3),d=c8(this._sphericalEnd.phi,c3);s.push(this.rotateTo(c,d,t));let p=A.setFromSpherical(this._sphericalEnd).normalize(),m=_.setFromUnitVectors(p,h),g=c6(Math.abs(p.y),1);g&&m.multiply(M.setFromAxisAngle(u,c)),m.multiply(this._yAxisUpSpaceInverse);let v=I.makeEmpty();f.copy(l.min).applyQuaternion(m),v.expandByPoint(f),f.copy(l.min).setX(l.max.x).applyQuaternion(m),v.expandByPoint(f),f.copy(l.min).setY(l.max.y).applyQuaternion(m),v.expandByPoint(f),f.copy(l.max).setZ(l.min.z).applyQuaternion(m),v.expandByPoint(f),f.copy(l.min).setZ(l.max.z).applyQuaternion(m),v.expandByPoint(f),f.copy(l.max).setY(l.min.y).applyQuaternion(m),v.expandByPoint(f),f.copy(l.max).setX(l.min.x).applyQuaternion(m),v.expandByPoint(f),f.copy(l.max).applyQuaternion(m),v.expandByPoint(f),v.min.x-=n,v.min.y-=o,v.max.x+=i,v.max.y+=a,m.setFromUnitVectors(h,p),g&&m.premultiply(M.invert()),m.premultiply(this._yAxisUpSpace);let y=v.getSize(A),E=v.getCenter(f).applyQuaternion(m);if(c0(this._camera)){let e=this.getDistanceToFitBox(y.x,y.y,y.z,r);s.push(this.moveTo(E.x,E.y,E.z,t)),s.push(this.dollyTo(e,t)),s.push(this.setFocalOffset(0,0,0,t))}else if(c1(this._camera)){let e=this._camera,n=e.right-e.left,i=e.top-e.bottom,o=r?Math.max(n/y.x,i/y.y):Math.min(n/y.x,i/y.y);s.push(this.moveTo(E.x,E.y,E.z,t)),s.push(this.zoomTo(o,t)),s.push(this.setFocalOffset(0,0,0,t))}return Promise.all(s)}fitToSphere(e,t){let r=[],n="isObject3D"in e?ul.createBoundingSphere(e,b):b.copy(e);if(r.push(this.moveTo(n.center.x,n.center.y,n.center.z,t)),c0(this._camera)){let e=this.getDistanceToFitSphere(n.radius);r.push(this.dollyTo(e,t))}else if(c1(this._camera)){let e=this._camera.right-this._camera.left,i=this._camera.top-this._camera.bottom,o=2*n.radius;r.push(this.zoomTo(Math.min(e/o,i/o),t))}return r.push(this.setFocalOffset(0,0,0,t)),Promise.all(r)}setLookAt(e,t,r,n,i,o){let a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=c$.NONE,this._changedDolly=0;let s=f.set(n,i,o),l=A.set(e,t,r);this._targetEnd.copy(s),this._sphericalEnd.setFromVector3(l.sub(s).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let c=!a||c6(this._target.x,this._targetEnd.x,this.restThreshold)&&c6(this._target.y,this._targetEnd.y,this.restThreshold)&&c6(this._target.z,this._targetEnd.z,this.restThreshold)&&c6(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&c6(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&c6(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,t,r,n,i,o,a,s,l,c,u,h,d){let m=arguments.length>13&&void 0!==arguments[13]&&arguments[13];this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=c$.NONE,this._changedDolly=0;let g=A.set(n,i,o),v=f.set(e,t,r);w.setFromVector3(v.sub(g).applyQuaternion(this._yAxisUpSpace));let y=p.set(c,u,h),E=f.set(a,s,l);B.setFromVector3(E.sub(y).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(g.lerp(y,d));let C=B.theta-w.theta,x=B.phi-w.phi,I=B.radius-w.radius;this._sphericalEnd.set(w.radius+I*d,w.phi+x*d,w.theta+C*d),this.normalizeRotations(),this._needsUpdate=!0,m||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));let b=!m||c6(this._target.x,this._targetEnd.x,this.restThreshold)&&c6(this._target.y,this._targetEnd.y,this.restThreshold)&&c6(this._target.z,this._targetEnd.z,this.restThreshold)&&c6(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&c6(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&c6(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(b)}setPosition(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.setLookAt(e,t,r,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,n)}setTarget(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.getPosition(A),o=this.setLookAt(i.x,i.y,i.z,e,t,r,n);return this._sphericalEnd.phi=c5(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,r),this._needsUpdate=!0,n||this._focalOffset.copy(this._focalOffsetEnd);let i=!n||c6(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&c6(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&c6(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,r){this._camera.updateMatrixWorld(),g.setFromMatrixColumn(this._camera.matrixWorldInverse,0),v.setFromMatrixColumn(this._camera.matrixWorldInverse,1),y.setFromMatrixColumn(this._camera.matrixWorldInverse,2);let n=A.set(e,t,r),i=n.distanceTo(this._camera.position),o=n.sub(this._camera.position);g.multiplyScalar(o.x),v.multiplyScalar(o.y),y.multiplyScalar(o.z),A.copy(g).add(v).add(y),A.z=A.z+i,this.dollyTo(i,!1),this.setFocalOffset(-A.x,A.y,-A.z,!1),this.moveTo(e,t,r,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,r,n){if(null===e){this._viewport=null;return}this._viewport=this._viewport||new l.Vector4,"number"==typeof e?this._viewport.set(e,t,r,n):this._viewport.copy(e)}getDistanceToFitBox(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(ui(this._camera,"getDistanceToFitBox"))return this._spherical.radius;let i=e/t,o=this._camera.getEffectiveFOV()*c4,a=this._camera.aspect;return .5*((n?i>a:i<a)?t:e/a)/Math.tan(.5*o)+.5*r}getDistanceToFitSphere(e){if(ui(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;let t=this._camera.getEffectiveFOV()*c4,r=2*Math.atan(Math.tan(.5*t)*this._camera.aspect);return e/Math.sin(.5*(1<this._camera.aspect?t:r))}getTarget(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e&&e.isVector3?e:new l.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e&&e.isVector3?e:new l.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e||new l.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(e&&e.isVector3?e:new l.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%c2,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=c2),this._spherical.theta+=c2*Math.round((this._sphericalEnd.theta-this._spherical.theta)/c2)}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!c6(this._camera.up.x,this._cameraUp0.x)||!c6(this._camera.up.y,this._cameraUp0.y)||!c6(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);let e=this.getPosition(A);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}return Promise.all([this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)])}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,u),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){let e=A.subVectors(this._target,this._camera.position).normalize(),t=f.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();let r=this.getPosition(A);this.updateCameraUp(),this.setPosition(r.x,r.y,r.z)}update(e){let t=this._sphericalEnd.theta-this._spherical.theta,r=this._sphericalEnd.phi-this._spherical.phi,n=this._sphericalEnd.radius-this._spherical.radius,i=E.subVectors(this._targetEnd,this._target),o=C.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(c9(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=ut(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(c9(r))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{let t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=ut(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(c9(n))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{let t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=ut(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(c9(i.x)&&c9(i.y)&&c9(i.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{let t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;ur(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(c9(o.x)&&c9(o.y)&&c9(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{let t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;ur(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(c9(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{let t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=ut(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor){if(c0(this._camera)&&0!==this._changedDolly){let e=this._spherical.radius-this._lastDistance,t=this._camera,r=this._getCameraDirection(m),n=A.copy(r).cross(t.up).normalize();0===n.lengthSq()&&(n.x=1);let i=f.crossVectors(n,r),o=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*c4*.5),a=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,s=p.copy(this._targetEnd).add(n.multiplyScalar(this._dollyControlCoord.x*o*t.aspect)).add(i.multiplyScalar(this._dollyControlCoord.y*o)),l=A.copy(this._targetEnd).lerp(s,a),c=this._lastDollyDirection===c$.IN&&this._spherical.radius<=this.minDistance,u=this._lastDollyDirection===c$.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(c||u)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;let t=f.copy(r).multiplyScalar(-e);l.add(t)}this._boundary.clampPoint(l,l);let h=f.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedDolly-=e,c9(this._changedDolly)&&(this._changedDolly=0)}else if(c1(this._camera)&&0!==this._changedZoom){let e=this._zoom-this._lastZoom,t=this._camera,r=A.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),n=f.set(0,0,-1).applyQuaternion(t.quaternion),i=p.copy(r).add(n.multiplyScalar(-r.dot(t.up))),o=-(this._zoom-e-this._zoom)/this._zoom,a=this._getCameraDirection(m),s=this._targetEnd.dot(a),l=A.copy(this._targetEnd).lerp(i,o),c=l.dot(a),u=a.multiplyScalar(c-s);l.sub(u),this._boundary.clampPoint(l,l);let h=f.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedZoom-=e,c9(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;let s=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,s),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),c9(this._focalOffset.x)&&c9(this._focalOffset.y)&&c9(this._focalOffset.z)||(this._camera.updateMatrixWorld(),g.setFromMatrixColumn(this._camera.matrix,0),v.setFromMatrixColumn(this._camera.matrix,1),y.setFromMatrixColumn(this._camera.matrix,2),g.multiplyScalar(this._focalOffset.x),v.multiplyScalar(-this._focalOffset.y),y.multiplyScalar(this._focalOffset.z),A.copy(g).add(v).add(y),this._camera.position.add(A)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),A.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);let l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),c9(t,this.restThreshold)&&c9(r,this.restThreshold)&&c9(n,this.restThreshold)&&c9(i.x,this.restThreshold)&&c9(i.y,this.restThreshold)&&c9(i.z,this.restThreshold)&&c9(o.x,this.restThreshold)&&c9(o.y,this.restThreshold)&&c9(o.z,this.restThreshold)&&c9(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:c7(this.maxDistance),minZoom:this.minZoom,maxZoom:c7(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:c7(this.maxPolarAngle),minAzimuthAngle:c7(this.minAzimuthAngle),maxAzimuthAngle:c7(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:A.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=JSON.parse(e);this.enabled=r.enabled,this.minDistance=r.minDistance,this.maxDistance=ue(r.maxDistance),this.minZoom=r.minZoom,this.maxZoom=ue(r.maxZoom),this.minPolarAngle=r.minPolarAngle,this.maxPolarAngle=ue(r.maxPolarAngle),this.minAzimuthAngle=ue(r.minAzimuthAngle),this.maxAzimuthAngle=ue(r.maxAzimuthAngle),this.smoothTime=r.smoothTime,this.draggingSmoothTime=r.draggingSmoothTime,this.dollySpeed=r.dollySpeed,this.truckSpeed=r.truckSpeed,this.dollyToCursor=r.dollyToCursor,this.verticalDragToForward=r.verticalDragToForward,this._target0.fromArray(r.target0),this._position0.fromArray(r.position0),this._zoom0=r.zoom0,this._focalOffset0.fromArray(r.focalOffset0),this.moveTo(r.target[0],r.target[1],r.target[2],t),w.setFromVector3(A.fromArray(r.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(w.theta,w.phi,t),this.dollyTo(w.radius,t),this.zoomTo(r.zoom,t),this.setFocalOffset(r.focalOffset[0],r.focalOffset[1],r.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version","2.8.5"),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,r){let n=t.lengthSq();if(0===n)return e;let i=f.copy(t).add(e),o=this._boundary.clampPoint(i,p).sub(i),a=o.lengthSq();if(0===a)return e.add(t);if(a===n)return e;if(0===r)return e.add(t).add(o);{let n=1+r*a/t.dot(o);return e.add(f.copy(t).multiplyScalar(n)).add(o.multiplyScalar(1-r))}}_updateNearPlaneCorners(){if(c0(this._camera)){let e=this._camera,t=e.near,r=Math.tan(e.getEffectiveFOV()*c4*.5)*t,n=r*e.aspect;this._nearPlaneCorners[0].set(-n,-r,0),this._nearPlaneCorners[1].set(n,-r,0),this._nearPlaneCorners[2].set(n,r,0),this._nearPlaneCorners[3].set(-n,r,0)}else if(c1(this._camera)){let e=this._camera,t=1/e.zoom,r=e.left*t,n=e.right*t,i=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(r,i,0),this._nearPlaneCorners[1].set(n,i,0),this._nearPlaneCorners[2].set(n,o,0),this._nearPlaneCorners[3].set(r,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||ui(this._camera,"_collisionTest"))return e;let t=this._getTargetDirection(m);S.lookAt(c,t,this._camera.up);for(let r=0;r<4;r++){let n=f.copy(this._nearPlaneCorners[r]);n.applyMatrix4(S);let i=p.addVectors(this._target,n);T.set(i,t),T.far=this._spherical.radius+1;let o=T.intersectObjects(this.colliderMeshes);0!==o.length&&o[0].distance<e&&(e=o[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;let t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{let t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l.Sphere,r=t.center;x.makeEmpty(),e.traverseVisible(e=>{e.isMesh&&x.expandByObject(e)}),x.getCenter(r);let n=0;return e.traverseVisible(e=>{if(!e.isMesh)return;let t=e.geometry.clone();t.applyMatrix4(e.matrixWorld);let i=t.attributes.position;for(let e=0,t=i.count;e<t;e++)A.fromBufferAttribute(i,e),n=Math.max(n,r.distanceToSquared(A))}),t.radius=Math.sqrt(n),t}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=cZ.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=c$.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new l.Vector3,this._focalOffsetVelocity=new l.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,r)=>{let n,i;if(c0(this._camera)){let r=A.copy(this._camera.position).sub(this._target),o=this._camera.getEffectiveFOV()*c4,a=r.length()*Math.tan(.5*o);n=this.truckSpeed*e*a/this._elementRect.height,i=this.truckSpeed*t*a/this._elementRect.height}else{if(!c1(this._camera))return;let r=this._camera;n=e*(r.right-r.left)/r.zoom/this._elementRect.width,i=t*(r.top-r.bottom)/r.zoom/this._elementRect.height}this.verticalDragToForward?(r?this.setFocalOffset(this._focalOffsetEnd.x+n,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(n,0,!0),this.forward(-i,!0)):r?this.setFocalOffset(this._focalOffsetEnd.x+n,this._focalOffsetEnd.y+i,this._focalOffsetEnd.z,!0):this.truck(n,i,!0)},this._rotateInternal=(e,t)=>{let r=c2*this.azimuthRotateSpeed*e/this._elementRect.height,n=c2*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(r,n,!0)},this._dollyInternal=(e,t,r)=>{let n=Math.pow(.95,-e*this.dollySpeed),i=this._sphericalEnd.radius,o=this._sphericalEnd.radius*n,a=c5(o,this.minDistance,this.maxDistance);this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(o,!0):(this.infinityDolly&&!this.dollyToCursor&&this.dollyInFixed(a-o,!0),this._dollyToNoClamp(a,!0)),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?o:a)-i,this._dollyControlCoord.set(t,r)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,r)=>{let n=Math.pow(.95,e*this.dollySpeed),i=this._zoom,o=this._zoom*n;this.zoomTo(o,!0),this.dollyToCursor&&(this._changedZoom+=o-i,this._dollyControlCoord.set(t,r))},void 0===l&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new l.Quaternion().setFromUnitVectors(this._camera.up,u),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=cZ.NONE,this._target=new l.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new l.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new l.Spherical().setFromVector3(A.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new l.Vector3,new l.Vector3,new l.Vector3,new l.Vector3],this._updateNearPlaneCorners(),this._boundary=new l.Box3(new l.Vector3(-1/0,-1/0,-1/0),new l.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new l.Vector2,this.mouseButtons={left:cZ.ROTATE,middle:cZ.DOLLY,right:cZ.TRUCK,wheel:c0(this._camera)?cZ.DOLLY:c1(this._camera)?cZ.ZOOM:cZ.NONE},this.touches={one:cZ.TOUCH_ROTATE,two:c0(this._camera)?cZ.TOUCH_DOLLY_TRUCK:c1(this._camera)?cZ.TOUCH_ZOOM_TRUCK:cZ.NONE,three:cZ.TOUCH_TRUCK};let r=new l.Vector2,n=new l.Vector2,i=new l.Vector2,o=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),r=e.clientX/t.width,n=e.clientY/t.height;if(r<this._interactiveArea.left||r>this._interactiveArea.right||n<this._interactiveArea.top||n>this._interactiveArea.bottom)return}let t="mouse"!==e.pointerType?null:(e.buttons&cX.LEFT)===cX.LEFT?cX.LEFT:(e.buttons&cX.MIDDLE)===cX.MIDDLE?cX.MIDDLE:(e.buttons&cX.RIGHT)===cX.RIGHT?cX.RIGHT:null;if(null!==t){let e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&cX.LEFT)===cX.LEFT&&this._lockedPointer)return;let r={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(r),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",s),this._isDragging=!0,p(e)},a=e=>{e.cancelable&&e.preventDefault();let t=e.pointerId,r=this._lockedPointer||this._findPointerById(t);if(r){if(r.clientX=e.clientX,r.clientY=e.clientY,r.deltaX=e.movementX,r.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&cX.LEFT)===cX.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&cX.MIDDLE)===cX.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&cX.RIGHT)===cX.RIGHT&&(this._state=this._state|this.mouseButtons.right);m()}},s=e=>{let t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=cZ.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=cZ.NONE;g()}},c=-1,h=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===cZ.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){let t=this._domElement.getBoundingClientRect(),r=e.clientX/t.width,n=e.clientY/t.height;if(r<this._interactiveArea.left||r>this._interactiveArea.right||n<this._interactiveArea.top||n>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===cZ.ROTATE||this.mouseButtons.wheel===cZ.TRUCK){let e=performance.now();c-e<1e3&&this._getClientRect(this._elementRect),c=e}let t=us?-1:-3,r=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),n=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,i=this.dollyToCursor?-((e.clientY-this._elementRect.y)/this._elementRect.height*2)+1:0;switch(this.mouseButtons.wheel){case cZ.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case cZ.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1),this._isUserControllingTruck=!0;break;case cZ.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0),this._isUserControllingOffset=!0;break;case cZ.DOLLY:this._dollyInternal(-r,n,i),this._isUserControllingDolly=!0;break;case cZ.ZOOM:this._zoomInternal(-r,n,i),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},f=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===ul.ACTION.NONE){let t=e instanceof PointerEvent?e.pointerId:0,r=this._findPointerById(t);r&&this._disposePointer(r),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s);return}e.preventDefault()}},p=e=>{if(this._enabled){if(un(this._activePointers,d),this._getClientRect(this._elementRect),r.copy(d),n.copy(d),this._activePointers.length>=2){let e=d.x-this._activePointers[1].clientX,t=d.y-this._activePointers[1].clientY;i.set(0,Math.sqrt(e*e+t*t));let r=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,o=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;n.set(r,o)}if(this._state=0,e){if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(e.buttons&cX.LEFT)!==cX.LEFT||(this._state=this._state|this.mouseButtons.left),(e.buttons&cX.MIDDLE)===cX.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&cX.RIGHT)===cX.RIGHT&&(this._state=this._state|this.mouseButtons.right)}else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&cZ.ROTATE)===cZ.ROTATE||(this._state&cZ.TOUCH_ROTATE)===cZ.TOUCH_ROTATE||(this._state&cZ.TOUCH_DOLLY_ROTATE)===cZ.TOUCH_DOLLY_ROTATE||(this._state&cZ.TOUCH_ZOOM_ROTATE)===cZ.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&cZ.TRUCK)===cZ.TRUCK||(this._state&cZ.TOUCH_TRUCK)===cZ.TOUCH_TRUCK||(this._state&cZ.TOUCH_DOLLY_TRUCK)===cZ.TOUCH_DOLLY_TRUCK||(this._state&cZ.TOUCH_ZOOM_TRUCK)===cZ.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&cZ.DOLLY)===cZ.DOLLY||(this._state&cZ.TOUCH_DOLLY)===cZ.TOUCH_DOLLY||(this._state&cZ.TOUCH_DOLLY_TRUCK)===cZ.TOUCH_DOLLY_TRUCK||(this._state&cZ.TOUCH_DOLLY_OFFSET)===cZ.TOUCH_DOLLY_OFFSET||(this._state&cZ.TOUCH_DOLLY_ROTATE)===cZ.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&cZ.ZOOM)===cZ.ZOOM||(this._state&cZ.TOUCH_ZOOM)===cZ.TOUCH_ZOOM||(this._state&cZ.TOUCH_ZOOM_TRUCK)===cZ.TOUCH_ZOOM_TRUCK||(this._state&cZ.TOUCH_ZOOM_OFFSET)===cZ.TOUCH_ZOOM_OFFSET||(this._state&cZ.TOUCH_ZOOM_ROTATE)===cZ.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&cZ.OFFSET)===cZ.OFFSET||(this._state&cZ.TOUCH_OFFSET)===cZ.TOUCH_OFFSET||(this._state&cZ.TOUCH_DOLLY_OFFSET)===cZ.TOUCH_DOLLY_OFFSET||(this._state&cZ.TOUCH_ZOOM_OFFSET)===cZ.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},m=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,un(this._activePointers,d);let e=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:n.x-d.x,o=e?-e.deltaY:n.y-d.y;if(n.copy(d),((this._state&cZ.ROTATE)===cZ.ROTATE||(this._state&cZ.TOUCH_ROTATE)===cZ.TOUCH_ROTATE||(this._state&cZ.TOUCH_DOLLY_ROTATE)===cZ.TOUCH_DOLLY_ROTATE||(this._state&cZ.TOUCH_ZOOM_ROTATE)===cZ.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,o),this._isUserControllingRotate=!0),(this._state&cZ.DOLLY)===cZ.DOLLY||(this._state&cZ.ZOOM)===cZ.ZOOM){let e=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?-((r.y-this._elementRect.y)/this._elementRect.height*2)+1:0,n=this.dollyDragInverted?-1:1;(this._state&cZ.DOLLY)===cZ.DOLLY?(this._dollyInternal(n*o*ua,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(n*o*ua,e,t),this._isUserControllingZoom=!0)}if((this._state&cZ.TOUCH_DOLLY)===cZ.TOUCH_DOLLY||(this._state&cZ.TOUCH_ZOOM)===cZ.TOUCH_ZOOM||(this._state&cZ.TOUCH_DOLLY_TRUCK)===cZ.TOUCH_DOLLY_TRUCK||(this._state&cZ.TOUCH_ZOOM_TRUCK)===cZ.TOUCH_ZOOM_TRUCK||(this._state&cZ.TOUCH_DOLLY_OFFSET)===cZ.TOUCH_DOLLY_OFFSET||(this._state&cZ.TOUCH_ZOOM_OFFSET)===cZ.TOUCH_ZOOM_OFFSET||(this._state&cZ.TOUCH_DOLLY_ROTATE)===cZ.TOUCH_DOLLY_ROTATE||(this._state&cZ.TOUCH_ZOOM_ROTATE)===cZ.TOUCH_ZOOM_ROTATE){let e=d.x-this._activePointers[1].clientX,t=d.y-this._activePointers[1].clientY,r=Math.sqrt(e*e+t*t),o=i.y-r;i.set(0,r);let a=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?-((n.y-this._elementRect.y)/this._elementRect.height*2)+1:0;(this._state&cZ.TOUCH_DOLLY)===cZ.TOUCH_DOLLY||(this._state&cZ.TOUCH_DOLLY_ROTATE)===cZ.TOUCH_DOLLY_ROTATE||(this._state&cZ.TOUCH_DOLLY_TRUCK)===cZ.TOUCH_DOLLY_TRUCK||(this._state&cZ.TOUCH_DOLLY_OFFSET)===cZ.TOUCH_DOLLY_OFFSET?(this._dollyInternal(o*ua,a,s),this._isUserControllingDolly=!0):(this._zoomInternal(o*ua,a,s),this._isUserControllingZoom=!0)}((this._state&cZ.TRUCK)===cZ.TRUCK||(this._state&cZ.TOUCH_TRUCK)===cZ.TOUCH_TRUCK||(this._state&cZ.TOUCH_DOLLY_TRUCK)===cZ.TOUCH_DOLLY_TRUCK||(this._state&cZ.TOUCH_ZOOM_TRUCK)===cZ.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,o,!1),this._isUserControllingTruck=!0),((this._state&cZ.OFFSET)===cZ.OFFSET||(this._state&cZ.TOUCH_OFFSET)===cZ.TOUCH_OFFSET||(this._state&cZ.TOUCH_DOLLY_OFFSET)===cZ.TOUCH_DOLLY_OFFSET||(this._state&cZ.TOUCH_ZOOM_OFFSET)===cZ.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,o,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},g=()=>{un(this._activePointers,d),n.copy(d),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",v),this._domElement.ownerDocument.addEventListener("pointerlockerror",y),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",s),p())},this.unlockPointer=()=>{var e,t,r;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(e=this._domElement)||void 0===e||e.ownerDocument.exitPointerLock(),null===(t=this._domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerlockchange",v),null===(r=this._domElement)||void 0===r||r.ownerDocument.removeEventListener("pointerlockerror",y),this.cancel()};let v=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},y=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),this._domElement.addEventListener("pointercancel",s),this._domElement.addEventListener("wheel",h,{passive:!1}),this._domElement.addEventListener("contextmenu",f)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("pointercancel",s),this._domElement.removeEventListener("wheel",h,{passive:!1}),this._domElement.removeEventListener("contextmenu",f),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",s),this._domElement.ownerDocument.removeEventListener("pointerlockchange",v),this._domElement.ownerDocument.removeEventListener("pointerlockerror",y))},this.cancel=()=>{this._state!==cZ.NONE&&(this._state=cZ.NONE,this._activePointers.length=0,g())},t&&this.connect(t),this.update(0)}}let uc=(0,eT.forwardRef)((e,t)=>{(0,eT.useMemo)(()=>{let e={Box3:eR.Box3,MathUtils:{clamp:eR.MathUtils.clamp},Matrix4:eR.Matrix4,Quaternion:eR.Quaternion,Raycaster:eR.Raycaster,Sphere:eR.Sphere,Spherical:eR.Spherical,Vector2:eR.Vector2,Vector3:eR.Vector3,Vector4:eR.Vector4};ul.install({THREE:e}),(0,eP.e)({CameraControlsImpl:ul})},[]);let{camera:r,domElement:n,makeDefault:i,onStart:o,onEnd:a,onChange:s,regress:l,...c}=e,u=(0,eP.A)(e=>e.camera),h=(0,eP.A)(e=>e.gl),d=(0,eP.A)(e=>e.invalidate),A=(0,eP.A)(e=>e.events),f=(0,eP.A)(e=>e.setEvents),p=(0,eP.A)(e=>e.set),m=(0,eP.A)(e=>e.get),g=(0,eP.A)(e=>e.performance),v=r||u,y=n||A.connected||h.domElement,E=(0,eT.useMemo)(()=>new ul(v),[v]);return(0,eP.C)((e,t)=>{E.enabled&&E.update(t)},-1),(0,eT.useEffect)(()=>(E.connect(y),()=>void E.disconnect()),[y,E]),(0,eT.useEffect)(()=>{let e=e=>{d(),l&&g.regress(),s&&s(e)},t=e=>{o&&o(e)},r=e=>{a&&a(e)};return E.addEventListener("update",e),E.addEventListener("controlstart",t),E.addEventListener("controlend",r),E.addEventListener("control",e),E.addEventListener("transitionstart",e),E.addEventListener("wake",e),()=>{E.removeEventListener("update",e),E.removeEventListener("controlstart",t),E.removeEventListener("controlend",r),E.removeEventListener("control",e),E.removeEventListener("transitionstart",e),E.removeEventListener("wake",e)}},[E,o,a,d,f,l,s]),(0,eT.useEffect)(()=>{if(i){let e=m().controls;return p({controls:E}),()=>p({controls:e})}},[i,E]),eT.createElement("primitive",(0,eS.Z)({ref:t,object:E},c))}),uu=e=>(null==e?void 0:e.current)instanceof eR.Object3D,uh=eT.createContext(null);function ud(){return eT.useContext(uh)}function uA(e){let{points:t=50}=e,{path:r}=ud(),[n,i]=eT.useState([]),[o]=eT.useState(()=>new eR.MeshBasicMaterial({color:"black"})),[a]=eT.useState(()=>new eR.SphereGeometry(.025,16,16)),s=eT.useRef([]);return eT.useEffect(()=>{r.curves!==s.current&&(i(r.getPoints(t)),s.current=r.curves)}),eT.createElement(eT.Fragment,null,n.map((e,t)=>eT.createElement("mesh",{key:t,material:o,geometry:a,position:[e.x,e.y,e.z]})))}let uf=eT.forwardRef((e,t)=>{let{children:r,curves:n=[],object:i,debug:o=!1,smooth:a=!1,focus:s,offset:l,eps:c=1e-5,damping:u=.1,focusDamping:h=.1,maxSpeed:d=1/0,...A}=e,{camera:f}=(0,eP.A)(),p=eT.useRef(),[m]=eT.useState(()=>new eR.CurvePath),g=eT.useRef(null!=l?l:0),v=eT.useMemo(()=>({focus:s,object:(null==i?void 0:i.current)instanceof eR.Object3D?i:{current:f},path:m,current:g.current,offset:g.current,point:new eR.Vector3,tangent:new eR.Vector3,next:new eR.Vector3}),[s,i]);eT.useLayoutEffect(()=>{var e;m.curves=[];let t=n.length>0?n:null==(e=p.current)?void 0:e.__r3f.objects;for(var r=0;r<t.length;r++)m.add(t[r]);if(a){let e=m.getPoints("number"==typeof a?a:1),t=new eR.CatmullRomCurve3(e);m.curves=[t]}m.updateArcLengths()}),eT.useImperativeHandle(t,()=>p.current,[]),eT.useLayoutEffect(()=>{g.current=rh.repeat(g.current,1)},[l]);let y=0,[E]=eT.useState(()=>new eR.Vector3);return(0,eP.C)((e,t)=>{if(y=v.offset,rH.damp(g,"current",void 0!==l?l:v.current,u,t,d,void 0,c),v.offset=rh.repeat(g.current,1),m.getCurveLengths().length>0){m.getPointAt(v.offset,v.point),m.getTangentAt(v.offset,v.tangent).normalize(),m.getPointAt(rh.repeat(g.current-(y-v.offset),1),v.next);let e=(null==i?void 0:i.current)instanceof eR.Object3D?i.current:f;e.position.copy(v.point),s&&rH.dampLookAt(e,uu(s)?s.current.getWorldPosition(E):s,h,t,d,void 0,c)}}),eT.createElement("group",(0,eS.Z)({ref:p},A),eT.createElement(uh.Provider,{value:v},r,o&&eT.createElement(uA,null)))});function up(e){let t,{defaultScene:r,defaultCamera:n,renderPriority:i=1}=e,{gl:o,scene:a,camera:s}=(0,eP.A)();return(0,eP.C)(()=>{t=o.autoClear,1===i&&(o.autoClear=!0,o.render(r,n)),o.autoClear=!1,o.clearDepth(),o.render(a,s),o.autoClear=t},i),eT.createElement("group",{onPointerOver:()=>null})}function um(e){let{children:t,renderPriority:r=1}=e,{scene:n,camera:i}=(0,eP.A)(),[o]=eT.useState(()=>new eR.Scene);return eT.createElement(eT.Fragment,null,(0,eP.g)(eT.createElement(eT.Fragment,null,t,eT.createElement(up,{defaultScene:n,defaultCamera:i,renderPriority:r})),o,{events:{priority:r+1}}))}let ug=eT.createContext({}),uv=()=>eT.useContext(ug),uy=2*Math.PI,uE=new eR.Object3D,uC=new eR.Matrix4,[uw,uB]=[new eR.Quaternion,new eR.Quaternion],ux=new eR.Vector3,uI=new eR.Vector3,ub=e=>"minPolarAngle"in e,u_=e=>{let{alignment:t="bottom-right",margin:r=[80,80],renderPriority:n=1,onUpdate:i,onTarget:o,children:a}=e,s=(0,eP.A)(e=>e.size),l=(0,eP.A)(e=>e.camera),c=(0,eP.A)(e=>e.controls),u=(0,eP.A)(e=>e.invalidate),h=eT.useRef(null),d=eT.useRef(null),A=eT.useRef(!1),f=eT.useRef(0),p=eT.useRef(new eR.Vector3(0,0,0)),m=eT.useRef(new eR.Vector3(0,0,0));eT.useEffect(()=>{m.current.copy(l.up)},[l]);let g=eT.useCallback(e=>{A.current=!0,(c||o)&&(p.current=(null==c?void 0:c.target)||(null==o?void 0:o())),f.current=l.position.distanceTo(ux),uw.copy(l.quaternion),uI.copy(e).multiplyScalar(f.current).add(ux),uE.lookAt(uI),uE.up.copy(l.up),uB.copy(uE.quaternion),u()},[c,l,o,u]);(0,eP.C)((e,t)=>{if(d.current&&h.current){var r;A.current&&(.01>uw.angleTo(uB)?(A.current=!1,ub(c)&&l.up.copy(m.current)):(uw.rotateTowards(uB,t*uy),l.position.set(0,0,1).applyQuaternion(uw).multiplyScalar(f.current).add(p.current),l.up.set(0,1,0).applyQuaternion(uw).normalize(),l.quaternion.copy(uw),i?i():c&&c.update(),u())),uC.copy(l.matrix).invert(),null==(r=h.current)||r.quaternion.setFromRotationMatrix(uC)}});let v=eT.useMemo(()=>({tweenCamera:g}),[g]),[y,E]=r,C=t.endsWith("-center")?0:t.endsWith("-left")?-s.width/2+y:s.width/2-y,w=t.startsWith("center-")?0:t.startsWith("top-")?s.height/2-E:-s.height/2+E;return eT.createElement(um,{renderPriority:n},eT.createElement(ug.Provider,{value:v},eT.createElement(lY,{makeDefault:!0,ref:d,position:[0,0,200]}),eT.createElement("group",{ref:h,position:[C,w,0]},a)))},uM={bg:"#f0f0f0",hover:"#999",text:"black",stroke:"black"},uS=["Right","Left","Top","Bottom","Front","Back"],uT=e=>new eR.Vector3(...e).multiplyScalar(.38),uD=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(uT),uR=[.25,.25,.25],uP=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(uT),uF=uP.map(e=>e.toArray().map(e=>0==e?.5:.25)),uQ=e=>{let{hover:t,index:r,font:n="20px Inter var, Arial, sans-serif",faces:i=uS,color:o=uM.bg,hoverColor:a=uM.hover,textColor:s=uM.text,strokeColor:l=uM.stroke,opacity:c=1}=e,u=(0,eP.A)(e=>e.gl),h=eT.useMemo(()=>{let e=document.createElement("canvas");e.width=128,e.height=128;let t=e.getContext("2d");return t.fillStyle=o,t.fillRect(0,0,e.width,e.height),t.strokeStyle=l,t.strokeRect(0,0,e.width,e.height),t.font=n,t.textAlign="center",t.fillStyle=s,t.fillText(i[r].toUpperCase(),64,76),new eR.CanvasTexture(e)},[r,i,n,o,s,l]);return eT.createElement("meshBasicMaterial",{map:h,"map-anisotropy":u.capabilities.getMaxAnisotropy()||1,attach:"material-".concat(r),color:t?a:"white",transparent:!0,opacity:c})},uO=e=>{let{tweenCamera:t}=uv(),[r,n]=eT.useState(null);return eT.createElement("mesh",{onPointerOut:e=>{e.stopPropagation(),n(null)},onPointerMove:e=>{e.stopPropagation(),n(Math.floor(e.faceIndex/2))},onClick:e.onClick||(e=>{e.stopPropagation(),t(e.face.normal)})},[...Array(6)].map((t,n)=>eT.createElement(uQ,(0,eS.Z)({key:n,index:n,hover:r===n},e))),eT.createElement("boxGeometry",null))},uL=e=>{let{onClick:t,dimensions:r,position:n,hoverColor:i=uM.hover}=e,{tweenCamera:o}=uv(),[a,s]=eT.useState(!1);return eT.createElement("mesh",{scale:1.01,position:n,onPointerOver:e=>{e.stopPropagation(),s(!0)},onPointerOut:e=>{e.stopPropagation(),s(!1)},onClick:t||(e=>{e.stopPropagation(),o(n)})},eT.createElement("meshBasicMaterial",{color:a?i:"white",transparent:!0,opacity:.6,visible:a}),eT.createElement("boxGeometry",{args:r}))},uk=e=>eT.createElement("group",{scale:[60,60,60]},eT.createElement(uO,e),uP.map((t,r)=>eT.createElement(uL,(0,eS.Z)({key:r,position:t,dimensions:uF[r]},e))),uD.map((t,r)=>eT.createElement(uL,(0,eS.Z)({key:r,position:t,dimensions:uR},e))));function uU(e){let{scale:t=[.8,.05,.05],color:r,rotation:n}=e;return eT.createElement("group",{rotation:n},eT.createElement("mesh",{position:[.4,0,0]},eT.createElement("boxGeometry",{args:t}),eT.createElement("meshBasicMaterial",{color:r,toneMapped:!1})))}function uG(e){let{onClick:t,font:r,disabled:n,arcStyle:i,label:o,labelColor:a,axisHeadScale:s=1,...l}=e,c=(0,eP.A)(e=>e.gl),u=eT.useMemo(()=>{let e=document.createElement("canvas");e.width=64,e.height=64;let t=e.getContext("2d");return t.beginPath(),t.arc(32,32,16,0,2*Math.PI),t.closePath(),t.fillStyle=i,t.fill(),o&&(t.font=r,t.textAlign="center",t.fillStyle=a,t.fillText(o,32,41)),new eR.CanvasTexture(e)},[i,o,a,r]),[h,d]=eT.useState(!1),A=(o?1:.75)*(h?1.2:1)*s;return eT.createElement("sprite",(0,eS.Z)({scale:A,onPointerOver:n?void 0:e=>{e.stopPropagation(),d(!0)},onPointerOut:n?void 0:t||(e=>{e.stopPropagation(),d(!1)})},l),eT.createElement("spriteMaterial",{map:u,"map-anisotropy":c.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:o?1:.75,toneMapped:!1}))}let uN=e=>{let{hideNegativeAxes:t,hideAxisHeads:r,disabled:n,font:i="18px Inter var, Arial, sans-serif",axisColors:o=["#ff2060","#20df80","#2080ff"],axisHeadScale:a=1,axisScale:s,labels:l=["X","Y","Z"],labelColor:c="#000",onClick:u,...h}=e,[d,A,f]=o,{tweenCamera:p}=uv(),m={font:i,disabled:n,labelColor:c,onClick:u,axisHeadScale:a,onPointerDown:n?void 0:e=>{p(e.object.position),e.stopPropagation()}};return eT.createElement("group",(0,eS.Z)({scale:40},h),eT.createElement(uU,{color:d,rotation:[0,0,0],scale:s}),eT.createElement(uU,{color:A,rotation:[0,0,Math.PI/2],scale:s}),eT.createElement(uU,{color:f,rotation:[0,-Math.PI/2,0],scale:s}),!r&&eT.createElement(eT.Fragment,null,eT.createElement(uG,(0,eS.Z)({arcStyle:d,position:[1,0,0],label:l[0]},m)),eT.createElement(uG,(0,eS.Z)({arcStyle:A,position:[0,1,0],label:l[1]},m)),eT.createElement(uG,(0,eS.Z)({arcStyle:f,position:[0,0,1],label:l[2]},m)),!t&&eT.createElement(eT.Fragment,null,eT.createElement(uG,(0,eS.Z)({arcStyle:d,position:[-1,0,0]},m)),eT.createElement(uG,(0,eS.Z)({arcStyle:A,position:[0,-1,0]},m)),eT.createElement(uG,(0,eS.Z)({arcStyle:f,position:[0,0,-1]},m)))))},uz=a1({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new eR.Color,sectionColor:new eR.Color,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new eR.Vector3,worldPlanePosition:new eR.Vector3},"\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform vec3 worldPlanePosition;\n    uniform float fadeDistance;\n    uniform bool infiniteGrid;\n    uniform bool followCamera;\n\n    void main() {\n      localPosition = position.xzy;\n      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;\n      \n      worldPosition = modelMatrix * vec4(localPosition, 1.0);\n      if (followCamera) {\n        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);\n        localPosition = (inverse(modelMatrix) * worldPosition).xyz;\n      }\n\n      gl_Position = projectionMatrix * viewMatrix * worldPosition;\n    }\n  ","\n    varying vec3 localPosition;\n    varying vec4 worldPosition;\n\n    uniform vec3 worldCamProjPosition;\n    uniform float cellSize;\n    uniform float sectionSize;\n    uniform vec3 cellColor;\n    uniform vec3 sectionColor;\n    uniform float fadeDistance;\n    uniform float fadeStrength;\n    uniform float fadeFrom;\n    uniform float cellThickness;\n    uniform float sectionThickness;\n\n    float getGrid(float size, float thickness) {\n      vec2 r = localPosition.xz / size;\n      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n      float line = min(grid.x, grid.y) + 1.0 - thickness;\n      return 1.0 - min(line, 1.0);\n    }\n\n    void main() {\n      float g1 = getGrid(cellSize, cellThickness);\n      float g2 = getGrid(sectionSize, sectionThickness);\n\n      vec3 from = worldCamProjPosition*vec3(fadeFrom);\n      float dist = distance(from, worldPosition.xyz);\n      float d = 1.0 - min(dist / fadeDistance, 1.0);\n      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));\n\n      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));\n      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);\n      if (gl_FragColor.a <= 0.0) discard;\n\n      #include <tonemapping_fragment>\n      #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n    }\n  ")),uH=eT.forwardRef((e,t)=>{let{args:r,cellColor:n="#000000",sectionColor:i="#2080ff",cellSize:o=.5,sectionSize:a=1,followCamera:s=!1,infiniteGrid:l=!1,fadeDistance:c=100,fadeStrength:u=1,fadeFrom:h=1,cellThickness:d=.5,sectionThickness:A=1,side:f=eR.BackSide,...p}=e;(0,eP.e)({GridMaterial:uz});let m=eT.useRef(null);eT.useImperativeHandle(t,()=>m.current,[]);let g=new eR.Plane,v=new eR.Vector3(0,1,0),y=new eR.Vector3(0,0,0);return(0,eP.C)(e=>{g.setFromNormalAndCoplanarPoint(v,y).applyMatrix4(m.current.matrixWorld);let t=m.current.material,r=t.uniforms.worldCamProjPosition,n=t.uniforms.worldPlanePosition;g.projectPoint(e.camera.position,r.value),n.value.set(0,0,0).applyMatrix4(m.current.matrixWorld)}),eT.createElement("mesh",(0,eS.Z)({ref:m,frustumCulled:!1},p),eT.createElement("gridMaterial",(0,eS.Z)({transparent:!0,"extensions-derivatives":!0,side:f},{cellSize:o,sectionSize:a,cellColor:n,sectionColor:i,cellThickness:d,sectionThickness:A},{fadeDistance:c,fadeStrength:u,fadeFrom:h,infiniteGrid:l,followCamera:s})),eT.createElement("planeGeometry",{args:r}))});function uV(e,t){let{path:r}=t,[n]=(0,eP.F)(eR.CubeTextureLoader,[e],e=>e.setPath(r));return n}function uj(e){let{children:t,files:r,...n}=e,i=uV(r,{...n});return eT.createElement(eT.Fragment,null,null==t?void 0:t(i))}uV.preload=(e,t)=>{let{path:r}=t;return eP.F.preload(eR.CubeTextureLoader,[e],e=>e.setPath(r))};var uJ={},uY=Uint8Array,uW=Uint16Array,uq=Uint32Array,uK=new uY([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),uX=new uY([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uZ=new uY([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u$=function(e,t){for(var r=new uW(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new uq(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)i[o]=o-r[n]<<5|n;return[r,i]},u0=u$(uK,2),u1=u0[0],u2=u0[1];u1[28]=258,u2[258]=28;for(var u3=u$(uX,0),u4=u3[0],u5=u3[1],u9=new uW(32768),u6=0;u6<32768;++u6){var u8=(43690&u6)>>>1|(21845&u6)<<1;u8=(61680&(u8=(52428&u8)>>>2|(13107&u8)<<2))>>>4|(3855&u8)<<4,u9[u6]=((65280&u8)>>>8|(255&u8)<<8)>>>1}for(var u7=function(e,t,r){for(var n,i=e.length,o=0,a=new uW(t);o<i;++o)++a[e[o]-1];var s=new uW(t);for(o=0;o<t;++o)s[o]=s[o-1]+a[o-1]<<1;if(r){n=new uW(1<<t);var l=15-t;for(o=0;o<i;++o)if(e[o])for(var c=o<<4|e[o],u=t-e[o],h=s[e[o]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)n[u9[h]>>>l]=c}else for(o=0,n=new uW(i);o<i;++o)e[o]&&(n[o]=u9[s[e[o]-1]++]>>>15-e[o]);return n},he=new uY(288),u6=0;u6<144;++u6)he[u6]=8;for(var u6=144;u6<256;++u6)he[u6]=9;for(var u6=256;u6<280;++u6)he[u6]=7;for(var u6=280;u6<288;++u6)he[u6]=8;for(var ht=new uY(32),u6=0;u6<32;++u6)ht[u6]=5;var hr=u7(he,9,1),hn=u7(ht,5,1),hi=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ho=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},ha=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},hs=function(e){return(e/8|0)+(7&e&&1)},hl=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof uW?uW:e instanceof uq?uq:uY)(r-t);return n.set(e.subarray(t,r)),n},hc=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new uY(0);var i=!t||r,o=!r||r.i;r||(r={}),t||(t=new uY(3*n));var a=function(e){var r=t.length;if(e>r){var n=new uY(Math.max(2*r,e));n.set(t),t=n}},s=r.f||0,l=r.p||0,c=r.b||0,u=r.l,h=r.d,d=r.m,A=r.n,f=8*n;do{if(!u){r.f=s=ho(e,l,1);var p=ho(e,l+1,3);if(l+=3,p){if(1==p)u=hr,h=hn,d=9,A=5;else if(2==p){var m=ho(e,l,31)+257,g=ho(e,l+10,15)+4,v=m+ho(e,l+5,31)+1;l+=14;for(var y=new uY(v),E=new uY(19),C=0;C<g;++C)E[uZ[C]]=ho(e,l+3*C,7);l+=3*g;for(var w=hi(E),B=(1<<w)-1,x=u7(E,w,1),C=0;C<v;){var I=x[ho(e,l,B)];l+=15&I;var b=I>>>4;if(b<16)y[C++]=b;else{var _=0,M=0;for(16==b?(M=3+ho(e,l,3),l+=2,_=y[C-1]):17==b?(M=3+ho(e,l,7),l+=3):18==b&&(M=11+ho(e,l,127),l+=7);M--;)y[C++]=_}}var S=y.subarray(0,m),T=y.subarray(m);d=hi(S),A=hi(T),u=u7(S,d,1),h=u7(T,A,1)}else throw"invalid block type"}else{var b=hs(l)+4,D=e[b-4]|e[b-3]<<8,R=b+D;if(R>n){if(o)throw"unexpected EOF";break}i&&a(c+D),t.set(e.subarray(b,R),c),r.b=c+=D,r.p=l=8*R;continue}if(l>f){if(o)throw"unexpected EOF";break}}i&&a(c+131072);for(var P=(1<<d)-1,F=(1<<A)-1,Q=l;;Q=l){var _=u[ha(e,l)&P],O=_>>>4;if((l+=15&_)>f){if(o)throw"unexpected EOF";break}if(!_)throw"invalid length/literal";if(O<256)t[c++]=O;else if(256==O){Q=l,u=null;break}else{var L=O-254;if(O>264){var C=O-257,k=uK[C];L=ho(e,l,(1<<k)-1)+u1[C],l+=k}var U=h[ha(e,l)&F],G=U>>>4;if(!U)throw"invalid distance";l+=15&U;var T=u4[G];if(G>3){var k=uX[G];T+=ha(e,l)&(1<<k)-1,l+=k}if(l>f){if(o)throw"unexpected EOF";break}i&&a(c+131072);for(var N=c+L;c<N;c+=4)t[c]=t[c-T],t[c+1]=t[c+1-T],t[c+2]=t[c+2-T],t[c+3]=t[c+3-T];c=N}}r.l=u,r.p=Q,r.b=c,u&&(s=1,r.m=d,r.d=h,r.n=A)}while(!s);return c==t.length?t:hl(t,0,c)},hu=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8},hh=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},hd=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,o=r.slice();if(!i)return[hy,0];if(1==i){var a=new uY(r[0].s+1);return a[r[0].s]=1,[a,1]}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var s=r[0],l=r[1],c=0,u=1,h=2;for(r[0]={s:-1,f:s.f+l.f,l:s,r:l};u!=i-1;)s=r[r[c].f<r[h].f?c++:h++],l=r[c!=u&&r[c].f<r[h].f?c++:h++],r[u++]={s:-1,f:s.f+l.f,l:s,r:l};for(var d=o[0].s,n=1;n<i;++n)o[n].s>d&&(d=o[n].s);var A=new uW(d+1),f=hA(r[u-1],A,0);if(f>t){var n=0,p=0,m=f-t,g=1<<m;for(o.sort(function(e,t){return A[t.s]-A[e.s]||e.f-t.f});n<i;++n){var v=o[n].s;if(A[v]>t)p+=g-(1<<f-A[v]),A[v]=t;else break}for(p>>>=m;p>0;){var y=o[n].s;A[y]<t?p-=1<<t-A[y]++-1:++n}for(;n>=0&&p;--n){var E=o[n].s;A[E]==t&&(--A[E],++p)}f=t}return[new uY(A),f]},hA=function(e,t,r){return -1==e.s?Math.max(hA(e.l,t,r+1),hA(e.r,t,r+1)):t[e.s]=r},hf=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new uW(++t),n=0,i=e[0],o=1,a=function(e){r[n++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)a(32754);o>2&&(a(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(a(i),--o;o>6;o-=6)a(8304);o>2&&(a(o-3<<5|8208),o=0)}for(;o--;)a(i);o=1,i=e[s]}return[r.subarray(0,n),t]},hp=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},hm=function(e,t,r){var n=r.length,i=hs(t+2);e[i]=255&n,e[i+1]=n>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<n;++o)e[i+o+4]=r[o];return(i+4+n)*8},hg=function(e,t,r,n,i,o,a,s,l,c,u){hu(t,u++,r),++i[256];for(var h,d,A,f,p=hd(i,15),m=p[0],g=p[1],v=hd(o,15),y=v[0],E=v[1],C=hf(m),w=C[0],B=C[1],x=hf(y),I=x[0],b=x[1],_=new uW(19),M=0;M<w.length;++M)_[31&w[M]]++;for(var M=0;M<I.length;++M)_[31&I[M]]++;for(var S=hd(_,7),T=S[0],D=S[1],R=19;R>4&&!T[uZ[R-1]];--R);var P=c+5<<3,F=hp(i,he)+hp(o,ht)+a,Q=hp(i,m)+hp(o,y)+a+14+3*R+hp(_,T)+(2*_[16]+3*_[17]+7*_[18]);if(P<=F&&P<=Q)return hm(t,u,e.subarray(l,l+c));if(hu(t,u,1+(Q<F)),u+=2,Q<F){h=u7(m,g,0),d=m,A=u7(y,E,0),f=y;var O=u7(T,D,0);hu(t,u,B-257),hu(t,u+5,b-1),hu(t,u+10,R-4),u+=14;for(var M=0;M<R;++M)hu(t,u+3*M,T[uZ[M]]);u+=3*R;for(var L=[w,I],k=0;k<2;++k)for(var U=L[k],M=0;M<U.length;++M){var G=31&U[M];hu(t,u,O[G]),u+=T[G],G>15&&(hu(t,u,U[M]>>>5&127),u+=U[M]>>>12)}}else h=null,d=he,A=null,f=ht;for(var M=0;M<s;++M)if(n[M]>255){var G=n[M]>>>18&31;hh(t,u,h[G+257]),u+=d[G+257],G>7&&(hu(t,u,n[M]>>>23&31),u+=uK[G]);var N=31&n[M];hh(t,u,A[N]),u+=f[N],N>3&&(hh(t,u,n[M]>>>5&8191),u+=uX[N])}else hh(t,u,h[n[M]]),u+=d[n[M]];return hh(t,u,h[256]),u+d[256]},hv=new uq([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hy=new uY(0),hE=function(e){if((15&e[0])!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function hC(e,t){return hc((hE(e),e.subarray(2,-4)),t)}var hw="undefined"!=typeof TextDecoder&&new TextDecoder;try{hw.decode(hy,{stream:!0})}catch(e){}function hB(e,t,r){let n=r.length-e-1;if(t>=r[n])return n-1;if(t<=r[e])return e;let i=e,o=n,a=Math.floor((i+o)/2);for(;t<r[a]||t>=r[a+1];)t<r[a]?o=a:i=a,a=Math.floor((i+o)/2);return a}class hx extends eR.Curve{getPoint(e,t){let r=t||new eR.Vector3,n=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=function(e,t,r,n){let i=hB(e,n,t),o=function(e,t,r,n){let i=[],o=[],a=[];i[0]=1;for(let s=1;s<=r;++s){o[s]=t-n[e+1-s],a[s]=n[e+s]-t;let r=0;for(let e=0;e<s;++e){let t=a[e+1],n=o[s-e],l=i[e]/(t+n);i[e]=r+t*l,r=n*l}i[s]=r}return i}(i,n,e,t),a=new eR.Vector4(0,0,0,0);for(let t=0;t<=e;++t){let n=r[i-e+t],s=o[t],l=n.w*s;a.x+=n.x*l,a.y+=n.y*l,a.z+=n.z*l,a.w+=n.w*s}return a}(this.degree,this.knots,this.controlPoints,n);return 1!=i.w&&i.divideScalar(i.w),r.set(i.x,i.y,i.z)}getTangent(e,t){var r;let n=t||new eR.Vector3,i=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),o=(r=this.degree,function(e){let t=e.length,r=[],n=[];for(let i=0;i<t;++i){let t=e[i];r[i]=new eR.Vector3(t.x,t.y,t.z),n[i]=t.w}let i=[];for(let e=0;e<t;++e){let t=r[e].clone();for(let r=1;r<=e;++r)t.sub(i[e-r].clone().multiplyScalar(function(e,t){let r=1;for(let t=2;t<=e;++t)r*=t;let n=1;for(let e=2;e<=t;++e)n*=e;for(let r=2;r<=e-t;++r)n*=r;return r/n}(e,r)*n[r]));i[e]=t.divideScalar(n[0])}return i}(function(e,t,r,n,i){let o=i<e?i:e,a=[],s=hB(e,n,t),l=function(e,t,r,n,i){let o=[];for(let e=0;e<=r;++e)o[e]=0;let a=[];for(let e=0;e<=n;++e)a[e]=o.slice(0);let s=[];for(let e=0;e<=r;++e)s[e]=o.slice(0);s[0][0]=1;let l=o.slice(0),c=o.slice(0);for(let n=1;n<=r;++n){l[n]=t-i[e+1-n],c[n]=i[e+n]-t;let r=0;for(let e=0;e<n;++e){let t=c[e+1],i=l[n-e];s[n][e]=t+i;let o=s[e][n-1]/s[n][e];s[e][n]=r+t*o,r=i*o}s[n][n]=r}for(let e=0;e<=r;++e)a[0][e]=s[e][r];for(let e=0;e<=r;++e){let t=0,i=1,l=[];for(let e=0;e<=r;++e)l[e]=o.slice(0);l[0][0]=1;for(let o=1;o<=n;++o){let n=0,c=e-o,u=r-o;e>=o&&(l[i][0]=l[t][0]/s[u+1][c],n=l[i][0]*s[c][u]);let h=c>=-1?1:-c,d=e-1<=u?o-1:r-e;for(let e=h;e<=d;++e)l[i][e]=(l[t][e]-l[t][e-1])/s[u+1][c+e],n+=l[i][e]*s[c+e][u];e<=u&&(l[i][o]=-l[t][o-1]/s[u+1][e],n+=l[i][o]*s[e][u]),a[o][e]=n;let A=t;t=i,i=A}}let u=r;for(let e=1;e<=n;++e){for(let t=0;t<=r;++t)a[e][t]*=u;u*=r-e}return a}(s,n,e,o,t),c=[];for(let e=0;e<r.length;++e){let t=r[e].clone(),n=t.w;t.x*=n,t.y*=n,t.z*=n,c[e]=t}for(let t=0;t<=o;++t){let r=c[s-e].clone().multiplyScalar(l[t][0]);for(let n=1;n<=e;++n)r.add(c[s-e+n].clone().multiplyScalar(l[t][n]));a[t]=r}for(let e=o+1;e<=i+1;++e)a[e]=new eR.Vector4(0,0,0);return a}(r,this.knots,this.controlPoints,i,1)));return n.copy(o[1]).normalize(),n}constructor(e,t,r,n,i){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=i||this.knots.length-1;for(let e=0;e<r.length;++e){let t=r[e];this.controlPoints[e]=new eR.Vector4(t.x,t.y,t.z,t.w)}}}class hI extends eR.Loader{load(e,t,r,n){let i=this,o=""===i.path?eR.LoaderUtils.extractUrlBase(e):i.path,a=new eR.FileLoader(this.manager);a.setPath(i.path),a.setResponseType("arraybuffer"),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(r){try{t(i.parse(r,o))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e,t){if(function(e){let t="Kaydara FBX Binary  \x00";return e.byteLength>=t.length&&t===hz(e,0,t.length)}(e))D=new hT().parse(e);else{let t=hz(e);if(!function(e){let t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;for(let n=0;n<t.length;++n)if(function(t){let n=e[t-1];return e=e.slice(r+t),r++,n}(1)===t[n])return!1;return!0}(t))throw Error("THREE.FBXLoader: Unknown format.");if(7e3>hP(t))throw Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+hP(t));D=new hS().parse(t)}return new hb(new eR.TextureLoader(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin),this.manager).parse(D)}constructor(e){super(e)}}class hb{parse(){R=this.parseConnections();let e=this.parseImages(),t=this.parseTextures(e),r=this.parseMaterials(t),n=this.parseDeformers(),i=new h_().parse(n);return this.parseScene(n,i,r),P}parseConnections(){let e=new Map;return"Connections"in D&&D.Connections.connections.forEach(function(t){let r=t[0],n=t[1],i=t[2];e.has(r)||e.set(r,{parents:[],children:[]}),e.get(r).parents.push({ID:n,relationship:i}),e.has(n)||e.set(n,{parents:[],children:[]}),e.get(n).children.push({ID:r,relationship:i})}),e}parseImages(){let e={},t={};if("Video"in D.Objects){let r=D.Objects.Video;for(let n in r){let i=r[n];if(e[parseInt(n)]=i.RelativeFilename||i.Filename,"Content"in i){let e=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,o="string"==typeof i.Content&&""!==i.Content;if(e||o){let e=this.parseImage(r[n]);t[i.RelativeFilename||i.Filename]=e}}}}for(let r in e){let n=e[r];void 0!==t[n]?e[r]=t[n]:e[r]=e[r].split("\\").pop()}return e}parseImage(e){let t;let r=e.Content,n=e.RelativeFilename||e.Filename,i=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(i){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),t="image/tga";break;default:console.warn('FBXLoader: Image type "'+i+'" is not supported.');return}if("string"==typeof r)return"data:"+t+";base64,"+r;{let e=new Uint8Array(r);return window.URL.createObjectURL(new Blob([e],{type:t}))}}parseTextures(e){let t=new Map;if("Texture"in D.Objects){let r=D.Objects.Texture;for(let n in r){let i=this.parseTexture(r[n],e);t.set(parseInt(n),i)}}return t}parseTexture(e,t){let r=this.loadTexture(e,t);r.ID=e.id,r.name=e.attrName;let n=e.WrapModeU,i=e.WrapModeV,o=void 0!==n?n.value:0,a=void 0!==i?i.value:0;if(r.wrapS=0===o?eR.RepeatWrapping:eR.ClampToEdgeWrapping,r.wrapT=0===a?eR.RepeatWrapping:eR.ClampToEdgeWrapping,"Scaling"in e){let t=e.Scaling.value;r.repeat.x=t[0],r.repeat.y=t[1]}return r}loadTexture(e,t){let r,n;let i=this.textureLoader.path,o=R.get(e.id).children;void 0!==o&&o.length>0&&void 0!==t[o[0].ID]&&(0===(r=t[o[0].ID]).indexOf("blob:")||0===r.indexOf("data:"))&&this.textureLoader.setPath(void 0);let a=e.FileName.slice(-3).toLowerCase();if("tga"===a){let t=this.manager.getHandler(".tga");null===t?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),n=new eR.Texture):(t.setPath(this.textureLoader.path),n=t.load(r))}else"psd"===a?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),n=new eR.Texture):n=this.textureLoader.load(r);return this.textureLoader.setPath(i),n}parseMaterials(e){let t=new Map;if("Material"in D.Objects){let r=D.Objects.Material;for(let n in r){let i=this.parseMaterial(r[n],e);null!==i&&t.set(parseInt(n),i)}}return t}parseMaterial(e,t){let r;let n=e.id,i=e.attrName,o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!R.has(n))return null;let a=this.parseParameters(e,t,n);switch(o.toLowerCase()){case"phong":r=new eR.MeshPhongMaterial;break;case"lambert":r=new eR.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),r=new eR.MeshPhongMaterial}return r.setValues(a),r.name=i,r}parseParameters(e,t,r){let n={};e.BumpFactor&&(n.bumpScale=e.BumpFactor.value),e.Diffuse?n.color=new eR.Color().fromArray(e.Diffuse.value):e.DiffuseColor&&("Color"===e.DiffuseColor.type||"ColorRGB"===e.DiffuseColor.type)&&(n.color=new eR.Color().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(n.displacementScale=e.DisplacementFactor.value),e.Emissive?n.emissive=new eR.Color().fromArray(e.Emissive.value):e.EmissiveColor&&("Color"===e.EmissiveColor.type||"ColorRGB"===e.EmissiveColor.type)&&(n.emissive=new eR.Color().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(n.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(n.opacity=parseFloat(e.Opacity.value)),n.opacity<1&&(n.transparent=!0),e.ReflectionFactor&&(n.reflectivity=e.ReflectionFactor.value),e.Shininess&&(n.shininess=e.Shininess.value),e.Specular?n.specular=new eR.Color().fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(n.specular=new eR.Color().fromArray(e.SpecularColor.value));let i=this;return R.get(r).children.forEach(function(e){let r=e.relationship;switch(r){case"Bump":n.bumpMap=i.getTexture(t,e.ID);break;case"Maya|TEX_ao_map":n.aoMap=i.getTexture(t,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":n.map=i.getTexture(t,e.ID),void 0!==n.map&&("colorSpace"in n.map?n.map.colorSpace="srgb":n.map.encoding=3001);break;case"DisplacementColor":n.displacementMap=i.getTexture(t,e.ID);break;case"EmissiveColor":n.emissiveMap=i.getTexture(t,e.ID),void 0!==n.emissiveMap&&("colorSpace"in n.emissiveMap?n.emissiveMap.colorSpace="srgb":n.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":n.normalMap=i.getTexture(t,e.ID);break;case"ReflectionColor":n.envMap=i.getTexture(t,e.ID),void 0!==n.envMap&&(n.envMap.mapping=eR.EquirectangularReflectionMapping,"colorSpace"in n.envMap?n.envMap.colorSpace="srgb":n.envMap.encoding=3001);break;case"SpecularColor":n.specularMap=i.getTexture(t,e.ID),void 0!==n.specularMap&&("colorSpace"in n.specularMap?n.specularMap.colorSpace="srgb":n.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":n.alphaMap=i.getTexture(t,e.ID),n.transparent=!0;break;default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",r)}}),n}getTexture(e,t){return"LayeredTexture"in D.Objects&&t in D.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=R.get(t).children[0].ID),e.get(t)}parseDeformers(){let e={},t={};if("Deformer"in D.Objects){let r=D.Objects.Deformer;for(let n in r){let i=r[n],o=R.get(parseInt(n));if("Skin"===i.attrType){let t=this.parseSkeleton(o,r);t.ID=n,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),t.geometryID=o.parents[0].ID,e[n]=t}else if("BlendShape"===i.attrType){let e={id:n};e.rawTargets=this.parseMorphTargets(o,r),e.id=n,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[n]=e}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){let r=[];return e.children.forEach(function(e){let n=t[e.ID];if("Cluster"!==n.attrType)return;let i={ID:e.ID,indices:[],weights:[],transformLink:new eR.Matrix4().fromArray(n.TransformLink.a)};"Indexes"in n&&(i.indices=n.Indexes.a,i.weights=n.Weights.a),r.push(i)}),{rawBones:r,bones:[]}}parseMorphTargets(e,t){let r=[];for(let n=0;n<e.children.length;n++){let i=e.children[n],o=t[i.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if("BlendShapeChannel"!==o.attrType)return;a.geoID=R.get(parseInt(i.ID)).children.filter(function(e){return void 0===e.relationship})[0].ID,r.push(a)}return r}parseScene(e,t,r){P=new eR.Group;let n=this.parseModels(e.skeletons,t,r),i=D.Objects.Model,o=this;n.forEach(function(e){let t=i[e.ID];o.setLookAtProperties(e,t),R.get(e.ID).parents.forEach(function(t){let r=n.get(t.ID);void 0!==r&&r.add(e)}),null===e.parent&&P.add(e)}),this.bindSkeleton(e.skeletons,t,n),this.createAmbientLight(),P.traverse(function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);let t=hU(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}});let a=new hM().parse();1===P.children.length&&P.children[0].isGroup&&(P.children[0].animations=a,P=P.children[0]),P.animations=a}parseModels(e,t,r){let n=new Map,i=D.Objects.Model;for(let o in i){let a=parseInt(o),s=i[o],l=R.get(a),c=this.buildSkeleton(l,e,a,s.attrName);if(!c){switch(s.attrType){case"Camera":c=this.createCamera(l);break;case"Light":c=this.createLight(l);break;case"Mesh":c=this.createMesh(l,t,r);break;case"NurbsCurve":c=this.createCurve(l,t);break;case"LimbNode":case"Root":c=new eR.Bone;break;default:c=new eR.Group}c.name=s.attrName?eR.PropertyBinding.sanitizeNodeName(s.attrName):"",c.ID=a}this.getTransformData(c,s),n.set(a,c)}return n}buildSkeleton(e,t,r,n){let i=null;return e.parents.forEach(function(e){for(let o in t){let a=t[o];a.rawBones.forEach(function(t,o){if(t.ID===e.ID){let e=i;(i=new eR.Bone).matrixWorld.copy(t.transformLink),i.name=n?eR.PropertyBinding.sanitizeNodeName(n):"",i.ID=r,a.bones[o]=i,null!==e&&i.add(e)}})}}),i}createCamera(e){let t,r;if(e.children.forEach(function(e){let t=D.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new eR.Object3D;else{let e=0;void 0!==r.CameraProjectionType&&1===r.CameraProjectionType.value&&(e=1);let n=1;void 0!==r.NearPlane&&(n=r.NearPlane.value/1e3);let i=1e3;void 0!==r.FarPlane&&(i=r.FarPlane.value/1e3);let o=window.innerWidth,a=window.innerHeight;void 0!==r.AspectWidth&&void 0!==r.AspectHeight&&(o=r.AspectWidth.value,a=r.AspectHeight.value);let s=o/a,l=45;void 0!==r.FieldOfView&&(l=r.FieldOfView.value);let c=r.FocalLength?r.FocalLength.value:null;switch(e){case 0:t=new eR.PerspectiveCamera(l,s,n,i),null!==c&&t.setFocalLength(c);break;case 1:t=new eR.OrthographicCamera(-o/2,o/2,a/2,-a/2,n,i);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+e+"."),t=new eR.Object3D}}return t}createLight(e){let t,r;if(e.children.forEach(function(e){let t=D.Objects.NodeAttribute[e.ID];void 0!==t&&(r=t)}),void 0===r)t=new eR.Object3D;else{let e;e=void 0===r.LightType?0:r.LightType.value;let n=16777215;void 0!==r.Color&&(n=new eR.Color().fromArray(r.Color.value));let i=void 0===r.Intensity?1:r.Intensity.value/100;void 0!==r.CastLightOnObject&&0===r.CastLightOnObject.value&&(i=0);let o=0;switch(void 0!==r.FarAttenuationEnd&&(o=void 0!==r.EnableFarAttenuation&&0===r.EnableFarAttenuation.value?0:r.FarAttenuationEnd.value),e){case 0:t=new eR.PointLight(n,i,o,1);break;case 1:t=new eR.DirectionalLight(n,i);break;case 2:let a=Math.PI/3;void 0!==r.InnerAngle&&(a=eR.MathUtils.degToRad(r.InnerAngle.value));let s=0;void 0!==r.OuterAngle&&(s=Math.max(s=eR.MathUtils.degToRad(r.OuterAngle.value),1)),t=new eR.SpotLight(n,i,o,a,s,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+r.LightType.value+", defaulting to a PointLight."),t=new eR.PointLight(n,i)}void 0!==r.CastShadows&&1===r.CastShadows.value&&(t.castShadow=!0)}return t}createMesh(e,t,r){let n;let i=null,o=null,a=[];return e.children.forEach(function(e){t.has(e.ID)&&(i=t.get(e.ID)),r.has(e.ID)&&a.push(r.get(e.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new eR.MeshPhongMaterial({color:13421772}),a.push(o)),"color"in i.attributes&&a.forEach(function(e){e.vertexColors=!0}),i.FBX_Deformer?(n=new eR.SkinnedMesh(i,o)).normalizeSkinWeights():n=new eR.Mesh(i,o),n}createCurve(e,t){let r=e.children.reduce(function(e,r){return t.has(r.ID)&&(e=t.get(r.ID)),e},null),n=new eR.LineBasicMaterial({color:3342591,linewidth:1});return new eR.Line(r,n)}getTransformData(e,t){let r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?r.eulerOrder=hG(t.RotationOrder.value):r.eulerOrder="ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r}setLookAtProperties(e,t){"LookAtProperty"in t&&R.get(e.ID).children.forEach(function(t){if("LookAtProperty"===t.relationship){let r=D.Objects.Model[t.ID];if("Lcl_Translation"in r){let t=r.Lcl_Translation.value;void 0!==e.target?(e.target.position.fromArray(t),P.add(e.target)):e.lookAt(new eR.Vector3().fromArray(t))}}})}bindSkeleton(e,t,r){let n=this.parsePoseNodes();for(let i in e){let o=e[i];R.get(parseInt(o.ID)).parents.forEach(function(e){if(t.has(e.ID)){let t=e.ID;R.get(t).parents.forEach(function(e){r.has(e.ID)&&r.get(e.ID).bind(new eR.Skeleton(o.bones),n[e.ID])})}})}}parsePoseNodes(){let e={};if("Pose"in D.Objects){let t=D.Objects.Pose;for(let r in t)if("BindPose"===t[r].attrType&&t[r].NbPoseNodes>0){let n=t[r].PoseNode;Array.isArray(n)?n.forEach(function(t){e[t.Node]=new eR.Matrix4().fromArray(t.Matrix.a)}):e[n.Node]=new eR.Matrix4().fromArray(n.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in D&&"AmbientColor"in D.GlobalSettings){let e=D.GlobalSettings.AmbientColor.value,t=e[0],r=e[1],n=e[2];if(0!==t||0!==r||0!==n){let e=new eR.Color(t,r,n);P.add(new eR.AmbientLight(e,1))}}}constructor(e,t){this.textureLoader=e,this.manager=t}}class h_{parse(e){let t=new Map;if("Geometry"in D.Objects){let r=D.Objects.Geometry;for(let n in r){let i=R.get(parseInt(n)),o=this.parseGeometry(i,r[n],e);t.set(parseInt(n),o)}}return t}parseGeometry(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,r){let n=r.skeletons,i=[],o=e.parents.map(function(e){return D.Objects.Model[e.ID]});if(0===o.length)return;let a=e.children.reduce(function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e},null);e.children.forEach(function(e){void 0!==r.morphTargets[e.ID]&&i.push(r.morphTargets[e.ID])});let s=o[0],l={};"RotationOrder"in s&&(l.eulerOrder=hG(s.RotationOrder.value)),"InheritType"in s&&(l.inheritType=parseInt(s.InheritType.value)),"GeometricTranslation"in s&&(l.translation=s.GeometricTranslation.value),"GeometricRotation"in s&&(l.rotation=s.GeometricRotation.value),"GeometricScaling"in s&&(l.scale=s.GeometricScaling.value);let c=hU(l);return this.genGeometry(t,a,i,c)}genGeometry(e,t,r,n){let i=new eR.BufferGeometry;e.attrName&&(i.name=e.attrName);let o=this.parseGeoNode(e,t),a=this.genBuffers(o),s=new eR.Float32BufferAttribute(a.vertex,3);if(s.applyMatrix4(n),i.setAttribute("position",s),a.colors.length>0&&i.setAttribute("color",new eR.Float32BufferAttribute(a.colors,3)),t&&(i.setAttribute("skinIndex",new eR.Uint16BufferAttribute(a.weightsIndices,4)),i.setAttribute("skinWeight",new eR.Float32BufferAttribute(a.vertexWeights,4)),i.FBX_Deformer=t),a.normal.length>0){let e=new eR.Matrix3().getNormalMatrix(n),t=new eR.Float32BufferAttribute(a.normal,3);t.applyNormalMatrix(e),i.setAttribute("normal",t)}if(a.uvs.forEach(function(e,t){let r="uv"+(t+1).toString();0===t&&(r="uv"),i.setAttribute(r,new eR.Float32BufferAttribute(a.uvs[t],2))}),o.material&&"AllSame"!==o.material.mappingType){let e=a.materialIndex[0],t=0;if(a.materialIndex.forEach(function(r,n){r!==e&&(i.addGroup(t,n-t,e),e=r,t=n)}),i.groups.length>0){let t=i.groups[i.groups.length-1],r=t.start+t.count;r!==a.materialIndex.length&&i.addGroup(r,a.materialIndex.length-r,e)}0===i.groups.length&&i.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(i,e,r,n),i}parseGeoNode(e,t){let r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];let t=0;for(;e.LayerElementUV[t];)e.LayerElementUV[t].UV&&r.uv.push(this.parseUVs(e.LayerElementUV[t])),t++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(n,i){void 0===r.weightTable[n]&&(r.weightTable[n]=[]),r.weightTable[n].push({id:t,weight:e.weights[i]})})})),r}genBuffers(e){let t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,n=0,i=!1,o=[],a=[],s=[],l=[],c=[],u=[],h=this;return e.vertexIndices.forEach(function(d,A){let f;let p=!1;d<0&&(d^=-1,p=!0);let m=[],g=[];if(o.push(3*d,3*d+1,3*d+2),e.color){let t=hO(A,r,d,e.color);s.push(t[0],t[1],t[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach(function(e){g.push(e.weight),m.push(e.id)}),g.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);let e=[0,0,0,0],t=[0,0,0,0];g.forEach(function(r,n){let i=r,o=m[n];t.forEach(function(t,r,n){if(i>t){n[r]=i,i=t;let a=e[r];e[r]=o,o=a}})}),m=e,g=t}for(;g.length<4;)g.push(0),m.push(0);for(let e=0;e<4;++e)c.push(g[e]),u.push(m[e])}if(e.normal){let t=hO(A,r,d,e.normal);a.push(t[0],t[1],t[2])}e.material&&"AllSame"!==e.material.mappingType&&(f=hO(A,r,d,e.material)[0]),e.uv&&e.uv.forEach(function(e,t){let n=hO(A,r,d,e);void 0===l[t]&&(l[t]=[]),l[t].push(n[0]),l[t].push(n[1])}),n++,p&&(h.genFace(t,e,o,f,a,s,l,c,u,n),r++,n=0,o=[],a=[],s=[],l=[],c=[],u=[])}),t}genFace(e,t,r,n,i,o,a,s,l,c){for(let u=2;u<c;u++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[(u-1)*3]]),e.vertex.push(t.vertexPositions[r[(u-1)*3+1]]),e.vertex.push(t.vertexPositions[r[(u-1)*3+2]]),e.vertex.push(t.vertexPositions[r[3*u]]),e.vertex.push(t.vertexPositions[r[3*u+1]]),e.vertex.push(t.vertexPositions[r[3*u+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[(u-1)*4]),e.vertexWeights.push(s[(u-1)*4+1]),e.vertexWeights.push(s[(u-1)*4+2]),e.vertexWeights.push(s[(u-1)*4+3]),e.vertexWeights.push(s[4*u]),e.vertexWeights.push(s[4*u+1]),e.vertexWeights.push(s[4*u+2]),e.vertexWeights.push(s[4*u+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[(u-1)*4]),e.weightsIndices.push(l[(u-1)*4+1]),e.weightsIndices.push(l[(u-1)*4+2]),e.weightsIndices.push(l[(u-1)*4+3]),e.weightsIndices.push(l[4*u]),e.weightsIndices.push(l[4*u+1]),e.weightsIndices.push(l[4*u+2]),e.weightsIndices.push(l[4*u+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[(u-1)*3]),e.colors.push(o[(u-1)*3+1]),e.colors.push(o[(u-1)*3+2]),e.colors.push(o[3*u]),e.colors.push(o[3*u+1]),e.colors.push(o[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[(u-1)*3]),e.normal.push(i[(u-1)*3+1]),e.normal.push(i[(u-1)*3+2]),e.normal.push(i[3*u]),e.normal.push(i[3*u+1]),e.normal.push(i[3*u+2])),t.uv&&t.uv.forEach(function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(a[r][0]),e.uvs[r].push(a[r][1]),e.uvs[r].push(a[r][(u-1)*2]),e.uvs[r].push(a[r][(u-1)*2+1]),e.uvs[r].push(a[r][2*u]),e.uvs[r].push(a[r][2*u+1])})}addMorphTargets(e,t,r,n){if(0===r.length)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];let i=this;r.forEach(function(r){r.rawTargets.forEach(function(r){let o=D.Objects.Geometry[r.geoID];void 0!==o&&i.genMorphGeometry(e,t,o,n,r.name)})})}genMorphGeometry(e,t,r,n,i){let o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],a=void 0!==r.Vertices?r.Vertices.a:[],s=void 0!==r.Indexes?r.Indexes.a:[],l=3*e.attributes.position.count,c=new Float32Array(l);for(let e=0;e<s.length;e++){let t=3*s[e];c[t]=a[3*e],c[t+1]=a[3*e+1],c[t+2]=a[3*e+2]}let u=this.genBuffers({vertexIndices:o,vertexPositions:c}),h=new eR.Float32BufferAttribute(u.vertex,3);h.name=i||r.attrName,h.applyMatrix4(n),e.morphAttributes.position.push(h)}parseNormals(e){let t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Normals.a,i=[];return"IndexToDirect"===r&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:i,mappingType:t,referenceType:r}}parseUVs(e){let t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.UV.a,i=[];return"IndexToDirect"===r&&(i=e.UVIndex.a),{dataSize:2,buffer:n,indices:i,mappingType:t,referenceType:r}}parseVertexColors(e){let t=e.MappingInformationType,r=e.ReferenceInformationType,n=e.Colors.a,i=[];return"IndexToDirect"===r&&(i=e.ColorIndex.a),{dataSize:4,buffer:n,indices:i,mappingType:t,referenceType:r}}parseMaterialIndices(e){let t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};let n=e.Materials.a,i=[];for(let e=0;e<n.length;++e)i.push(e);return{dataSize:1,buffer:n,indices:i,mappingType:t,referenceType:r}}parseNurbsGeometry(e){let t,r;if(void 0===hx)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new eR.BufferGeometry;let n=parseInt(e.Order);if(isNaN(n))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new eR.BufferGeometry;let i=n-1,o=e.KnotVector.a,a=[],s=e.Points.a;for(let e=0,t=s.length;e<t;e+=4)a.push(new eR.Vector4().fromArray(s,e));if("Closed"===e.Form)a.push(a[0]);else if("Periodic"===e.Form){t=i,r=o.length-1-t;for(let e=0;e<i;++e)a.push(a[e])}let l=new hx(i,o,a,t,r).getPoints(12*a.length);return new eR.BufferGeometry().setFromPoints(l)}}class hM{parse(){let e=[],t=this.parseClips();if(void 0!==t)for(let r in t){let n=t[r],i=this.addClip(n);e.push(i)}return e}parseClips(){if(void 0===D.Objects.AnimationCurve)return;let e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);let t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){let e=D.Objects.AnimationCurveNode,t=new Map;for(let r in e){let n=e[r];if(null!==n.attrName.match(/S|R|T|DeformPercent/)){let e={id:n.id,attr:n.attrName,curves:{}};t.set(e.id,e)}}return t}parseAnimationCurves(e){let t=D.Objects.AnimationCurve;for(let r in t){let n={id:t[r].id,times:t[r].KeyTime.a.map(hF),values:t[r].KeyValueFloat.a},i=R.get(n.id);if(void 0!==i){let t=i.parents[0].ID,r=i.parents[0].relationship;r.match(/X/)?e.get(t).curves.x=n:r.match(/Y/)?e.get(t).curves.y=n:r.match(/Z/)?e.get(t).curves.z=n:r.match(/d|DeformPercent/)&&e.has(t)&&(e.get(t).curves.morph=n)}}}parseAnimationLayers(e){let t=D.Objects.AnimationLayer,r=new Map;for(let n in t){let t=[],i=R.get(parseInt(n));void 0!==i&&(i.children.forEach(function(r,n){if(e.has(r.ID)){let i=e.get(r.ID);if(void 0!==i.curves.x||void 0!==i.curves.y||void 0!==i.curves.z){if(void 0===t[n]){let e=R.get(r.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID;if(void 0!==e){let i=D.Objects.Model[e.toString()];if(void 0===i){console.warn("THREE.FBXLoader: Encountered a unused curve.",r);return}let o={modelName:i.attrName?eR.PropertyBinding.sanitizeNodeName(i.attrName):"",ID:i.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};P.traverse(function(e){e.ID===i.id&&(o.transform=e.matrix,e.userData.transformData&&(o.eulerOrder=e.userData.transformData.eulerOrder))}),o.transform||(o.transform=new eR.Matrix4),"PreRotation"in i&&(o.preRotation=i.PreRotation.value),"PostRotation"in i&&(o.postRotation=i.PostRotation.value),t[n]=o}}t[n]&&(t[n][i.attr]=i)}else if(void 0!==i.curves.morph){if(void 0===t[n]){let e=R.get(r.ID).parents.filter(function(e){return void 0!==e.relationship})[0].ID,i=R.get(e).parents[0].ID,o=R.get(i).parents[0].ID,a=R.get(o).parents[0].ID,s=D.Objects.Model[a],l={modelName:s.attrName?eR.PropertyBinding.sanitizeNodeName(s.attrName):"",morphName:D.Objects.Deformer[e].attrName};t[n]=l}t[n][i.attr]=i}}}),r.set(parseInt(n),t))}return r}parseAnimStacks(e){let t=D.Objects.AnimationStack,r={};for(let n in t){let i=R.get(parseInt(n)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");let o=e.get(i[0].ID);r[n]={name:t[n].attrName,layer:o}}return r}addClip(e){let t=[],r=this;return e.layer.forEach(function(e){t=t.concat(r.generateTracks(e))}),new eR.AnimationClip(e.name,-1,t)}generateTracks(e){let t=[],r=new eR.Vector3,n=new eR.Quaternion,i=new eR.Vector3;if(e.transform&&e.transform.decompose(r,n,i),r=r.toArray(),n=new eR.Euler().setFromQuaternion(n,e.eulerOrder).toArray(),i=i.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){let n=this.generateVectorTrack(e.modelName,e.T.curves,r,"position");void 0!==n&&t.push(n)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){let r=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);void 0!==r&&t.push(r)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){let r=this.generateVectorTrack(e.modelName,e.S.curves,i,"scale");void 0!==r&&t.push(r)}if(void 0!==e.DeformPercent){let r=this.generateMorphTrack(e);void 0!==r&&t.push(r)}return t}generateVectorTrack(e,t,r,n){let i=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(i,t,r);return new eR.VectorKeyframeTrack(e+"."+n,i,o)}generateRotationTrack(e,t,r,n,i,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(eR.MathUtils.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(eR.MathUtils.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(eR.MathUtils.degToRad));let a=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(a,t,r);void 0!==n&&((n=n.map(eR.MathUtils.degToRad)).push(o),n=new eR.Euler().fromArray(n),n=new eR.Quaternion().setFromEuler(n)),void 0!==i&&((i=i.map(eR.MathUtils.degToRad)).push(o),i=new eR.Euler().fromArray(i),i=new eR.Quaternion().setFromEuler(i).invert());let l=new eR.Quaternion,c=new eR.Euler,u=[];for(let e=0;e<s.length;e+=3)c.set(s[e],s[e+1],s[e+2],o),l.setFromEuler(c),void 0!==n&&l.premultiply(n),void 0!==i&&l.multiply(i),l.toArray(u,e/3*4);return new eR.QuaternionKeyframeTrack(e+".quaternion",a,u)}generateMorphTrack(e){let t=e.DeformPercent.curves.morph,r=t.values.map(function(e){return e/100}),n=P.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new eR.NumberKeyframeTrack(e.modelName+".morphTargetInfluences["+n+"]",t.times,r)}getTimesForAllAxes(e){let t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),(t=t.sort(function(e,t){return e-t})).length>1){let e=1,r=t[0];for(let n=1;n<t.length;n++){let i=t[n];i!==r&&(t[e]=i,r=i,e++)}t=t.slice(0,e)}return t}getKeyframeTrackValues(e,t,r){let n=[],i=-1,o=-1,a=-1;return e.forEach(function(e){if(t.x&&(i=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(a=t.z.times.indexOf(e)),-1!==i){let e=t.x.values[i];n.push(e),r[0]=e}else n.push(r[0]);if(-1!==o){let e=t.y.values[o];n.push(e),r[1]=e}else n.push(r[1]);if(-1!==a){let e=t.z.values[a];n.push(e),r[2]=e}else n.push(r[2])}),n}interpolateRotations(e){for(let t=1;t<e.values.length;t++){let r=e.values[t-1],n=e.values[t]-r,i=Math.abs(n);if(i>=180){let o=i/180,a=n/o,s=r+a,l=e.times[t-1],c=(e.times[t]-l)/o,u=l+c,h=[],d=[];for(;u<e.times[t];)h.push(u),u+=c,d.push(s),s+=a;e.times=hH(e.times,t,h),e.values=hH(e.values,t,d)}}}}class hS{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new hR,this.nodeStack=[],this.currentProp=[],this.currentPropName="";let t=this,r=e.split(/[\r\n]+/);return r.forEach(function(e,n){let i=e.match(/^[\s\t]*;/),o=e.match(/^[\s\t]*$/);if(i||o)return;let a=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");a?t.parseNodeBegin(e,a):s?t.parseNodeProperty(e,s,r[++n]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}),this.allNodes}parseNodeBegin(e,t){let r=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:r},o=this.parseNodeAttr(n),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,i):r in a?("PoseNode"===r?a.PoseNode.push(i):void 0!==a[r].id&&(a[r]={},a[r][a[r].id]=a[r]),""!==o.id&&(a[r][o.id]=i)):"number"==typeof o.id?(a[r]={},a[r][o.id]=i):"Properties70"!==r&&("PoseNode"===r?a[r]=[i]:a[r]=i),"number"==typeof o.id&&(i.id=o.id),""!==o.name&&(i.attrName=o.name),""!==o.type&&(i.attrType=o.type),this.pushStack(i)}parseNodeAttr(e){let t=e[0];""!==e[0]&&isNaN(t=parseInt(e[0]))&&(t=e[0]);let r="",n="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:r,type:n}}parseNodeProperty(e,t,r){let n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===i&&(i=r.replace(/"/g,"").replace(/,$/,"").trim());let o=this.getCurrentNode();if("Properties70"===o.name){this.parseNodeSpecialProperty(e,n,i);return}if("C"===n){let e=i.split(",").slice(1),t=parseInt(e[0]),r=parseInt(e[1]),a=i.split(",").slice(3);a=a.map(function(e){return e.trim().replace(/^"/,"")}),n="connections",function(e,t){for(let r=0,n=e.length,i=t.length;r<i;r++,n++)e[n]=t[r]}(i=[t,r],a),void 0===o[n]&&(o[n]=[])}"Node"===n&&(o.id=i),n in o&&Array.isArray(o[n])?o[n].push(i):"a"!==n?o[n]=i:o.a=i,this.setCurrentProp(o,n),"a"===n&&","!==i.slice(-1)&&(o.a=hN(i))}parseNodePropertyContinued(e){let t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=hN(t.a))}parseNodeSpecialProperty(e,t,r){let n=r.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=n[0],o=n[1],a=n[2],s=n[3],l=n[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=hN(l)}this.getPrevNode()[i]={type:o,type2:a,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),i)}}class hT{parse(e){let t=new hD(e);t.skip(23);let r=t.getUint32();if(r<6400)throw Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);let n=new hR;for(;!this.endOfContent(t);){let e=this.parseNode(t,r);null!==e&&n.add(e.name,e)}return n}endOfContent(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){let r={},n=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();let o=e.getUint8(),a=e.getString(o);if(0===n)return null;let s=[];for(let t=0;t<i;t++)s.push(this.parseProperty(e));let l=s.length>0?s[0]:"",c=s.length>1?s[1]:"",u=s.length>2?s[2]:"";for(r.singleProperty=1===i&&e.getOffset()===n;n>e.getOffset();){let n=this.parseNode(e,t);null!==n&&this.parseSubNode(a,r,n)}return r.propertyList=s,"number"==typeof l&&(r.id=l),""!==c&&(r.attrName=c),""!==u&&(r.attrType=u),""!==a&&(r.name=a),r}parseSubNode(e,t,r){if(!0===r.singleProperty){let e=r.propertyList[0];Array.isArray(e)?(t[r.name]=r,r.a=e):t[r.name]=e}else if("Connections"===e&&"C"===r.name){let e=[];r.propertyList.forEach(function(t,r){0!==r&&e.push(t)}),void 0===t.connections&&(t.connections=[]),t.connections.push(e)}else if("Properties70"===r.name)Object.keys(r).forEach(function(e){t[e]=r[e]});else if("Properties70"===e&&"P"===r.name){let e,n=r.propertyList[0],i=r.propertyList[1],o=r.propertyList[2],a=r.propertyList[3];0===n.indexOf("Lcl ")&&(n=n.replace("Lcl ","Lcl_")),0===i.indexOf("Lcl ")&&(i=i.replace("Lcl ","Lcl_")),e="Color"===i||"ColorRGB"===i||"Vector"===i||"Vector3D"===i||0===i.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[n]={type:i,type2:o,flag:a,value:e}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)}parseProperty(e){let t;let r=e.getString(1);switch(r){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return t=e.getUint32(),e.getArrayBuffer(t);case"S":return t=e.getUint32(),e.getString(t);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":let n=e.getUint32(),i=e.getUint32(),o=e.getUint32();if(0===i)switch(r){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}let a=new hD(hC(new Uint8Array(e.getArrayBuffer(o))).buffer);switch(r){case"b":case"c":return a.getBooleanArray(n);case"d":return a.getFloat64Array(n);case"f":return a.getFloat32Array(n);case"i":return a.getInt32Array(n);case"l":return a.getInt64Array(n)}default:throw Error("THREE.FBXLoader: Unknown property type "+r)}}}class hD{getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(1&this.getUint8())==1}getBooleanArray(e){let t=[];for(let r=0;r<e;r++)t.push(this.getBoolean());return t}getUint8(){let e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){let e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){let e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getInt32());return t}getUint32(){let e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return(this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t)?(t=4294967295&~t,4294967295==(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e}getInt64Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e}getFloat32(){let e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getFloat32());return t}getFloat64(){let e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){let t=[];for(let r=0;r<e;r++)t.push(this.getFloat64());return t}getArrayBuffer(e){let t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();let r=t.indexOf(0);return r>=0&&(t=t.slice(0,r)),sj(new Uint8Array(t))}constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}}class hR{add(e,t){this[e]=t}}function hP(e){let t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function hF(e){return e/46186158e3}let hQ=[];function hO(e,t,r,n){let i;switch(n.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=r;break;case"AllSame":i=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(i=n.indices[i]);let o=i*n.dataSize,a=o+n.dataSize;return function(e,t,r,n){for(let i=r,o=0;i<n;i++,o++)e[o]=t[i];return e}(hQ,n.buffer,o,a)}let hL=new eR.Euler,hk=new eR.Vector3;function hU(e){let t=new eR.Matrix4,r=new eR.Matrix4,n=new eR.Matrix4,i=new eR.Matrix4,o=new eR.Matrix4,a=new eR.Matrix4,s=new eR.Matrix4,l=new eR.Matrix4,c=new eR.Matrix4,u=new eR.Matrix4,h=new eR.Matrix4,d=new eR.Matrix4,A=e.inheritType?e.inheritType:0;if(e.translation&&t.setPosition(hk.fromArray(e.translation)),e.preRotation){let t=e.preRotation.map(eR.MathUtils.degToRad);t.push(e.eulerOrder),r.makeRotationFromEuler(hL.fromArray(t))}if(e.rotation){let t=e.rotation.map(eR.MathUtils.degToRad);t.push(e.eulerOrder),n.makeRotationFromEuler(hL.fromArray(t))}if(e.postRotation){let t=e.postRotation.map(eR.MathUtils.degToRad);t.push(e.eulerOrder),i.makeRotationFromEuler(hL.fromArray(t)),i.invert()}e.scale&&o.scale(hk.fromArray(e.scale)),e.scalingOffset&&s.setPosition(hk.fromArray(e.scalingOffset)),e.scalingPivot&&a.setPosition(hk.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(hk.fromArray(e.rotationOffset)),e.rotationPivot&&c.setPosition(hk.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(h.copy(e.parentMatrix),u.copy(e.parentMatrixWorld));let f=r.clone().multiply(n).multiply(i),p=new eR.Matrix4;p.extractRotation(u);let m=new eR.Matrix4;m.copyPosition(u);let g=m.clone().invert().multiply(u),v=p.clone().invert().multiply(g),y=new eR.Matrix4;if(0===A)y.copy(p).multiply(f).multiply(v).multiply(o);else if(1===A)y.copy(p).multiply(v).multiply(f).multiply(o);else{let e=new eR.Matrix4().scale(new eR.Vector3().setFromMatrixScale(h)).clone().invert(),t=v.clone().multiply(e);y.copy(p).multiply(f).multiply(t).multiply(o)}let E=c.clone().invert(),C=a.clone().invert(),w=t.clone().multiply(l).multiply(c).multiply(r).multiply(n).multiply(i).multiply(E).multiply(s).multiply(a).multiply(o).multiply(C),B=new eR.Matrix4().copyPosition(w),x=u.clone().multiply(B);return d.copyPosition(x),(w=d.clone().multiply(y)).premultiply(u.invert()),w}function hG(e){return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),"ZYX"):["ZYX","YZX","XZY","ZXY","YXZ","XYZ"][e]}function hN(e){return e.split(",").map(function(e){return parseFloat(e)})}function hz(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=e.byteLength),sj(new Uint8Array(e,t,r))}function hH(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}function hV(e){return(0,eP.F)(hI,e)}function hj(e){let{path:t,...r}=e,n=hV(t).children[0];return eT.createElement(sb,(0,eS.Z)({},r,{object:n}))}hV.preload=e=>eP.F.preload(hI,e),hV.clear=e=>eP.F.clear(hI,e);class hJ{_initWorker(e){if(!this.workers[e]){let t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return -1}_onMessage(e,t){let r=this.workersResolve[e];if(r&&r(t),this.queue.length){let{resolve:t,msg:r,transfer:n}=this.queue.shift();this.workersResolve[e]=t,this.workers[e].postMessage(r,n)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(r=>{let n=this._getIdleWorker();-1!==n?(this._initWorker(n),this.workerStatus|=1<<n,this.workersResolve[n]=r,this.workers[n].postMessage(e,t)):this.queue.push({resolve:r,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}}var hY=r(3663).lW;class hW{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class hq{_nextUint8(){let e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){let e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){let e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){let e=this._dataView.getUint32(this._offset,this._littleEndian),t=this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e+4294967296*t}_nextInt32(){let e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint8Array(e){let t=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,e);return this._offset+=e,t}_skip(e){return this._offset+=e,this}_scan(e,t){void 0===t&&(t=0);let r=this._offset,n=0;for(;this._dataView.getUint8(this._offset)!==t&&n<e;)n++,this._offset++;return n<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+r,n)}constructor(e,t,r,n){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(e.buffer,e.byteOffset+t,r),this._littleEndian=n,this._offset=0}}let hK=[171,75,84,88,32,50,48,187,13,10,26,10];function hX(e){return"undefined"!=typeof TextDecoder?new TextDecoder().decode(e):hY.from(e).toString("utf8")}var hZ=r(3663).lW;let h$={env:{emscripten_notify_memory_growth:function(e){O=new Uint8Array(Q.exports.memory.buffer)}}};class h0{init(){return F||(F="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+h1).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,h$)).then(this._init):WebAssembly.instantiate(hZ.from(h1,"base64"),h$).then(this._init))}_init(e){Q=e.instance,h$.env.emscripten_notify_memory_growth(0)}decode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Q)throw Error("ZSTDDecoder: Await .init() before decoding.");let r=e.byteLength,n=Q.exports.malloc(r);O.set(e,n),t=t||Number(Q.exports.ZSTD_findDecompressedSize(n,r));let i=Q.exports.malloc(t),o=Q.exports.ZSTD_decompress(i,t,n,r),a=O.slice(i,i+o);return Q.exports.free(n),Q.exports.free(i),a}}let h1="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IAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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";class h2 extends eR.CompressedTexture{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,eR.CubeReflectionMapping),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class h3 extends eR.CompressedTexture{constructor(e,t,r,n,i,o){super(e,t,r,i,o),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=eR.ClampToEdgeWrapping}}class h4 extends eR.Texture{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=eR.NearestFilter,this.minFilter=eR.NearestFilter,this.wrapR=eR.ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}var h5=Object.defineProperty,h9=(e,t,r)=>t in e?h5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h6=(e,t,r)=>(h9(e,"symbol"!=typeof t?t+"":t,r),r);let h8="srgb",h7=new WeakMap,de=0,dt=class extends eR.Loader{setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}detectSupport(e){return this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},e.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){let e=new eR.FileLoader(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);let t=e.loadAsync("basis_transcoder.js"),r=new eR.FileLoader(this.manager);r.setPath(this.transcoderPath),r.setResponseType("arraybuffer"),r.setWithCredentials(this.withCredentials);let n=r.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,n]).then(e=>{let[t,r]=e,n=dt.BasisWorker.toString(),i=["/* constants */","let _EngineFormat = "+JSON.stringify(dt.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(dt.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(dt.BasisFormat),"/* basis_transcoder.js */",t,"/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i])),this.transcoderBinary=r,this.workerPool.setWorkerCreator(()=>{let e=new Worker(this.workerSourceURL),t=this.transcoderBinary.slice(0);return e.postMessage({type:"init",config:this.workerConfig,transcoderBinary:t},[t]),e})}),de>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),de++}return this.transcoderPending}load(e,t,r,n){if(null===this.workerConfig)throw Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");let i=new eR.FileLoader(this.manager);i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials),i.load(e,e=>{if(h7.has(e))return h7.get(e).promise.then(t).catch(n);this._createTexture(e).then(e=>t?t(e):null).catch(n)},r,n)}_createTextureFrom(e,t){let r;let{faces:n,width:i,height:o,format:a,type:s,error:l,dfdFlags:c}=e;if("error"===s)return Promise.reject(l);if(6===t.faceCount)r=new h2(n,a,eR.UnsignedByteType);else{let e=n[0].mipmaps;r=t.layerCount>1?new h3(e,i,o,t.layerCount,a,eR.UnsignedByteType):new eR.CompressedTexture(e,i,o,a,eR.UnsignedByteType)}r.minFilter=1===n[0].mipmaps.length?eR.LinearFilter:eR.LinearMipmapLinearFilter,r.magFilter=eR.LinearFilter,r.generateMipmaps=!1,r.needsUpdate=!0;let u=ds(t);return"colorSpace"in r?r.colorSpace=u:r.encoding=u===h8?3001:3e3,r.premultiplyAlpha=!!(1&c),r}async _createTexture(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(e){let t=new Uint8Array(e.buffer,e.byteOffset,hK.length);if(t[0]!==hK[0]||t[1]!==hK[1]||t[2]!==hK[2]||t[3]!==hK[3]||t[4]!==hK[4]||t[5]!==hK[5]||t[6]!==hK[6]||t[7]!==hK[7]||t[8]!==hK[8]||t[9]!==hK[9]||t[10]!==hK[10]||t[11]!==hK[11])throw Error("Missing KTX 2.0 identifier.");let r=new hW,n=17*Uint32Array.BYTES_PER_ELEMENT,i=new hq(e,hK.length,n,!0);r.vkFormat=i._nextUint32(),r.typeSize=i._nextUint32(),r.pixelWidth=i._nextUint32(),r.pixelHeight=i._nextUint32(),r.pixelDepth=i._nextUint32(),r.layerCount=i._nextUint32(),r.faceCount=i._nextUint32();let o=i._nextUint32();r.supercompressionScheme=i._nextUint32();let a=i._nextUint32(),s=i._nextUint32(),l=i._nextUint32(),c=i._nextUint32(),u=i._nextUint64(),h=i._nextUint64(),d=new hq(e,hK.length+n,24*o,!0);for(let t=0;t<o;t++)r.levels.push({levelData:new Uint8Array(e.buffer,e.byteOffset+d._nextUint64(),d._nextUint64()),uncompressedByteLength:d._nextUint64()});let A=new hq(e,a,s,!0),f={vendorId:A._skip(4)._nextUint16(),descriptorType:A._nextUint16(),versionNumber:A._nextUint16(),descriptorBlockSize:A._nextUint16(),colorModel:A._nextUint8(),colorPrimaries:A._nextUint8(),transferFunction:A._nextUint8(),flags:A._nextUint8(),texelBlockDimension:[A._nextUint8(),A._nextUint8(),A._nextUint8(),A._nextUint8()],bytesPlane:[A._nextUint8(),A._nextUint8(),A._nextUint8(),A._nextUint8(),A._nextUint8(),A._nextUint8(),A._nextUint8(),A._nextUint8()],samples:[]},p=(f.descriptorBlockSize/4-6)/4;for(let e=0;e<p;e++){let t={bitOffset:A._nextUint16(),bitLength:A._nextUint8(),channelType:A._nextUint8(),samplePosition:[A._nextUint8(),A._nextUint8(),A._nextUint8(),A._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&t.channelType?(t.sampleLower=A._nextInt32(),t.sampleUpper=A._nextInt32()):(t.sampleLower=A._nextUint32(),t.sampleUpper=A._nextUint32()),f.samples[e]=t}r.dataFormatDescriptor.length=0,r.dataFormatDescriptor.push(f);let m=new hq(e,l,c,!0);for(;m._offset<c;){let e=m._nextUint32(),t=m._scan(e),n=hX(t);if(r.keyValue[n]=m._nextUint8Array(e-t.byteLength-1),n.match(/^ktx/i)){let e=hX(r.keyValue[n]);r.keyValue[n]=e.substring(0,e.lastIndexOf("\x00"))}let i=e%4?4-e%4:0;m._skip(i)}if(h<=0)return r;let g=new hq(e,u,h,!0),v=g._nextUint16(),y=g._nextUint16(),E=g._nextUint32(),C=g._nextUint32(),w=g._nextUint32(),B=g._nextUint32(),x=[];for(let e=0;e<o;e++)x.push({imageFlags:g._nextUint32(),rgbSliceByteOffset:g._nextUint32(),rgbSliceByteLength:g._nextUint32(),alphaSliceByteOffset:g._nextUint32(),alphaSliceByteLength:g._nextUint32()});let I=u+g._offset,b=I+E,_=b+C,M=_+w,S=new Uint8Array(e.buffer,e.byteOffset+I,E),T=new Uint8Array(e.buffer,e.byteOffset+b,C),D=new Uint8Array(e.buffer,e.byteOffset+_,w),R=new Uint8Array(e.buffer,e.byteOffset+M,B);return r.globalData={endpointCount:v,selectorCount:y,imageDescs:x,endpointsData:S,selectorsData:T,tablesData:D,extendedData:R},r}(new Uint8Array(e));if(0!==r.vkFormat)return da(r);let n=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:t},[e])).then(e=>this._createTextureFrom(e.data,r));return h7.set(e,{promise:n}),n}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),de--,this}constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new hJ,this.workerSourceURL="",this.workerConfig=null,"undefined"!=typeof MSC_TRANSCODER&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}};h6(dt,"BasisFormat",{ETC1S:0,UASTC_4x4:1}),h6(dt,"TranscoderFormat",{ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16}),h6(dt,"EngineFormat",{RGBAFormat:eR.RGBAFormat,RGBA_ASTC_4x4_Format:eR.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:eR.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:eR.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:eR.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:eR.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:eR.RGB_ETC1_Format,RGB_ETC2_Format:eR.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:eR.RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format:eR.RGB_S3TC_DXT1_Format}),h6(dt,"BasisWorker",function(){let e,t,r;let n=_EngineFormat,i=_TranscoderFormat,o=_BasisFormat;self.addEventListener("message",function(a){let u=a.data;switch(u.type){case"init":var h;e=u.config,h=u.transcoderBinary,t=new Promise(e=>{r={wasmBinary:h,onRuntimeInitialized:e},BASIS(r)}).then(()=>{r.initializeBasis(),void 0===r.KTX2File&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")});break;case"transcode":t.then(()=>{try{let{faces:t,buffers:a,width:h,height:d,hasAlpha:A,format:f,dfdFlags:p}=function(t){let a=new r.KTX2File(new Uint8Array(t));function u(){a.close(),a.delete()}if(!a.isValid())throw u(),Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");let h=a.isUASTC()?o.UASTC_4x4:o.ETC1S,d=a.getWidth(),A=a.getHeight(),f=a.getLayers()||1,p=a.getLevels(),m=a.getFaces(),g=a.getHasAlpha(),v=a.getDFDFlags(),{transcoderFormat:y,engineFormat:E}=function(t,r,a,u){let h;let d=t===o.ETC1S?s:l;for(let n=0;n<d.length;n++){let i=d[n];if(e[i.if]&&i.basisFormat.includes(t)&&(!u||!(i.transcoderFormat.length<2))&&(!i.needsPowerOfTwo||c(r)&&c(a)))return{transcoderFormat:i.transcoderFormat[u?1:0],engineFormat:i.engineFormat[u?1:0]}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),{transcoderFormat:i.RGBA32,engineFormat:n.RGBAFormat}}(h,d,A,g);if(!d||!A||!p)throw u(),Error("THREE.KTX2Loader:	Invalid texture");if(!a.startTranscoding())throw u(),Error("THREE.KTX2Loader: .startTranscoding failed");let C=[],w=[];for(let e=0;e<m;e++){let t=[];for(let r=0;r<p;r++){let n,i;let o=[];for(let t=0;t<f;t++){let s=a.getImageLevelInfo(r,t,e);0===e&&0===r&&0===t&&(s.origWidth%4!=0||s.origHeight%4!=0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),p>1?(n=s.origWidth,i=s.origHeight):(n=s.width,i=s.height);let l=new Uint8Array(a.getImageTranscodedSizeInBytes(r,t,0,y));if(!a.transcodeImage(l,r,t,e,y,0,-1,-1))throw u(),Error("THREE.KTX2Loader: .transcodeImage failed.");o.push(l)}let s=function(e){if(1===e.length)return e[0];let t=0;for(let r=0;r<e.length;r++)t+=e[r].byteLength;let r=new Uint8Array(t),n=0;for(let t=0;t<e.length;t++){let i=e[t];r.set(i,n),n+=i.byteLength}return r}(o);t.push({data:s,width:n,height:i}),w.push(s.buffer)}C.push({mipmaps:t,width:d,height:A,format:E})}return u(),{faces:C,buffers:w,width:d,height:A,hasAlpha:g,format:E,dfdFlags:v}}(u.buffer);self.postMessage({type:"transcode",id:u.id,faces:t,width:h,height:d,hasAlpha:A,format:f,dfdFlags:p},a)}catch(e){console.error(e),self.postMessage({type:"error",id:u.id,error:e.message})}})}});let a=[{if:"astcSupported",basisFormat:[o.UASTC_4x4],transcoderFormat:[i.ASTC_4x4,i.ASTC_4x4],engineFormat:[n.RGBA_ASTC_4x4_Format,n.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.BC7_M5,i.BC7_M5],engineFormat:[n.RGBA_BPTC_Format,n.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.BC1,i.BC3],engineFormat:[n.RGB_S3TC_DXT1_Format,n.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.ETC1,i.ETC2],engineFormat:[n.RGB_ETC2_Format,n.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.ETC1],engineFormat:[n.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[o.ETC1S,o.UASTC_4x4],transcoderFormat:[i.PVRTC1_4_RGB,i.PVRTC1_4_RGBA],engineFormat:[n.RGB_PVRTC_4BPPV1_Format,n.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],s=a.sort(function(e,t){return e.priorityETC1S-t.priorityETC1S}),l=a.sort(function(e,t){return e.priorityUASTC-t.priorityUASTC});function c(e){return e<=2||(e&e-1)==0&&0!==e}});let dr=new Set([eR.RGBAFormat,eR.RGFormat,eR.RedFormat]),dn={109:eR.RGBAFormat,97:eR.RGBAFormat,37:eR.RGBAFormat,43:eR.RGBAFormat,103:eR.RGFormat,83:eR.RGFormat,16:eR.RGFormat,22:eR.RGFormat,100:eR.RedFormat,76:eR.RedFormat,15:eR.RedFormat,9:eR.RedFormat,166:eR.RGBA_ASTC_6x6_Format,165:eR.RGBA_ASTC_6x6_Format},di={109:eR.FloatType,97:eR.HalfFloatType,37:eR.UnsignedByteType,43:eR.UnsignedByteType,103:eR.FloatType,83:eR.HalfFloatType,16:eR.UnsignedByteType,22:eR.UnsignedByteType,100:eR.FloatType,76:eR.HalfFloatType,15:eR.UnsignedByteType,9:eR.UnsignedByteType,166:eR.UnsignedByteType,165:eR.UnsignedByteType};async function da(e){let t,r;let{vkFormat:n}=e;if(void 0===dn[n])throw Error("THREE.KTX2Loader: Unsupported vkFormat.");2===e.supercompressionScheme&&(L||(L=new Promise(async e=>{let t=new h0;await t.init(),e(t)})),t=await L);let i=[];for(let r=0;r<e.levels.length;r++){let o,a;let s=Math.max(1,e.pixelWidth>>r),l=Math.max(1,e.pixelHeight>>r),c=e.pixelDepth?Math.max(1,e.pixelDepth>>r):0,u=e.levels[r];if(0===e.supercompressionScheme)o=u.levelData;else if(2===e.supercompressionScheme)o=t.decode(u.levelData,u.uncompressedByteLength);else throw Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");a=di[n]===eR.FloatType?new Float32Array(o.buffer,o.byteOffset,o.byteLength/Float32Array.BYTES_PER_ELEMENT):di[n]===eR.HalfFloatType?new Uint16Array(o.buffer,o.byteOffset,o.byteLength/Uint16Array.BYTES_PER_ELEMENT):o,i.push({data:a,width:s,height:l,depth:c})}if(dr.has(dn[n]))r=0===e.pixelDepth?new eR.DataTexture(i[0].data,e.pixelWidth,e.pixelHeight):new h4(i[0].data,e.pixelWidth,e.pixelHeight,e.pixelDepth);else{if(e.pixelDepth>0)throw Error("THREE.KTX2Loader: Unsupported pixelDepth.");r=new eR.CompressedTexture(i,e.pixelWidth,e.pixelHeight)}r.mipmaps=i,r.type=di[n],r.format=dn[n],r.needsUpdate=!0;let o=ds(e);return"colorSpace"in r?r.colorSpace=o:r.encoding=o===h8?3001:3e3,Promise.resolve(r)}function ds(e){let t=e.dataFormatDescriptor[0];return 1===t.colorPrimaries?2===t.transferFunction?h8:"srgb-linear":10===t.colorPrimaries?2===t.transferFunction?"display-p3":"display-p3-linear":(0===t.colorPrimaries||console.warn('THREE.KTX2Loader: Unsupported color primaries, "'.concat(t.colorPrimaries,'"')),"")}let dl="https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master";function dc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat(dl,"/basis/"),r=(0,eP.A)(e=>e.gl),n=(0,eP.F)(dt,a2(e)?Object.values(e):e,e=>{e.detectSupport(r),e.setTranscoderPath(t)});if((0,eT.useEffect)(()=>{(Array.isArray(n)?n:[n]).forEach(r.initTexture)},[r,n]),!a2(e))return n;{let t=Object.keys(e),r={};return t.forEach(e=>Object.assign(r,{[e]:n[t.indexOf(e)]})),r}}dc.preload=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"".concat(dl,"/basis/");return eP.F.preload(dt,e,e=>{e.setTranscoderPath(t)})},dc.clear=e=>eP.F.clear(dt,e);let du=e=>{let{children:t,input:r,basisPath:n}=e,i=dc(r,n);return eT.createElement(eT.Fragment,null,null==t?void 0:t(i))},dh="undefined"!=typeof window&&"function"==typeof(null==(eI=window.document)?void 0:eI.createElement)&&"string"==typeof(null==(eb=window.navigator)?void 0:eb.userAgent),dd=null;async function dA(e,t){if(dh&&e.pathname.endsWith(".m3u8")){var n;if(null!==(n=dd)&&void 0!==n||(dd=await r.e(350).then(r.t.bind(r,6754,23))),dd.default.isSupported())return new dd.default({...t})}return null}function df(e){let{unsuspend:t="loadedmetadata",start:r=!0,crossOrigin:n="anonymous",muted:i=!0,loop:o=!0,hls:a={},...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=new URL("string"==typeof e?e:"",window.location.href),c=(0,eT.useRef)(null),u=(0,eT.useRef)(null),h=(0,eP.A)(e=>e.gl),d=(0,au.Rq)(()=>new Promise(async r=>{let d=Object.assign(document.createElement("video"),{src:"string"==typeof e&&e||void 0,srcObject:e instanceof MediaStream&&e||void 0,crossOrigin:n,loop:o,muted:i,...s});if(u.current=d,"string"==typeof e){let t=c.current=await dA(l,a);t?(t.attachMedia(d),t.on("hlsMediaAttached",()=>{t.loadSource(e)})):d.src=e}else e instanceof MediaStream&&(d.srcObject=e);let A=new eR.VideoTexture(d);"colorSpace"in A?A.colorSpace=h.outputColorSpace:A.encoding=h.outputEncoding,d.addEventListener(t,()=>r(A))}),[e]);return(0,eT.useEffect)(()=>(r&&d.image.play(),()=>{c.current&&(c.current.destroy(),c.current=null)}),[d,r]),d}let dp=e=>{let{children:t,src:r,...n}=e,i=df(r,n);return eT.createElement(eT.Fragment,null,null==t?void 0:t(i))},dm=e=>{if(Array.isArray(e))return e[0];if("object"!=typeof e||null===e)return{w:0,h:0};{let t=Object.keys(e);return e[t[0]][0]}},dg=e=>{for(let t=3;t<e.length;t+=4)if(0!==e[t])return!1;return!0},dv=(e,t,r,n)=>{let i=t*(n.aspect>e/t?n.width/e:n.height/t),o=e*(n.aspect>e/t?n.width/e:n.height/t)*r,a=i*r,s=Math.min(1,o),l=Math.min(1,a);return o>1&&(s=1,l=a/o*1),new eR.Vector3(s,l,1)};function dy(e,t,r,n,i){let o=(0,eP.A)(e=>e.viewport),a=eT.useRef(null),s=eT.useRef(0),[l,c]=(0,eT.useState)(null),[u,h]=eT.useState(new eR.Texture),d=new eR.TextureLoader,[A,f]=(0,eT.useState)(null);function p(t){(t||e)&&new Promise(r=>{d.load(null!=t?t:e,r)}).then(e=>{g(null,e)})}function m(e,t,r){Promise.all([fetch(e).then(e=>e.json()),new Promise(e=>{d.load(t,e)})]).then(e=>{r(e[0],e[1])})}eT.useLayoutEffect(()=>(t&&e?m(t,e,g):e&&p(),()=>{e&&eP.F.clear(eR.TextureLoader,e)}),[]);let g=(e,t)=>{let r=new eR.Vector3(1,1,1);if(null===e){if(t&&n){let e=t.image.width,i=t.image.height;s.current=n;let{rows:l,columns:c,frameWidth:u,frameHeight:h,emptyFrames:d}=v(t,n);a.current={frames:[],meta:{version:"1.0",size:{w:e,h:i},rows:l,columns:c,frameWidth:u,frameHeight:h,scale:"1"}};for(let e=0;e<l;e++)for(let t=0;t<c;t++)(null!=d?d:[]).some(r=>r.row===e&&r.col===t)||a.current.frames.push({frame:{x:t*u,y:e*h,w:u,h:h},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:u,h:h},sourceSize:{w:u,h:h}});r=dv(u,h,.1,o)}a.current.frames=E(a.current.frames)}else if(t){a.current=e,a.current.frames=y(),s.current=Array.isArray(e.frames)?e.frames.length:Object.keys(e.frames).length;let{w:t,h:n}=dm(e.frames).sourceSize;r=dv(t,n,.1,o)}c(a.current),"encoding"in t?t.encoding=3001:t.colorSpace=eR.SRGBColorSpace,h(t),f({spriteTexture:t,spriteData:a.current,aspect:r})},v=(e,t)=>{if(!e.image)return{rows:0,columns:0,frameWidth:0,frameHeight:0,emptyFrames:[]};{let r=document.createElement("canvas"),n=r.getContext("2d");r.width=e.image.width,r.height=e.image.height,n.drawImage(e.image,0,0);let i=e.image.width,o=e.image.height,a=Math.round(Math.sqrt(i/o*t)),s=Math.round(t/a),l=i/a,c=o/s,u=[];for(let e=0;e<s;e++)for(let r=0;r<a;r++){if(e*a+r>=t){u.push({row:e,col:r});continue}dg(n.getImageData(r*l,e*c,l,c).data)&&u.push({row:e,col:r})}return{rows:s,columns:a,frameWidth:l,frameHeight:c,emptyFrames:u}}},y=()=>{let e={},t=a.current;if(r&&Array.isArray(t.frames)){for(let n=0;n<r.length;n++)for(let i of(e[r[n]]=[],t.frames)){let t=i.frame,o=t.x,a=t.y,s=t.w,l=t.h,c=i.sourceSize.w,u=i.sourceSize.h;"string"==typeof i.filename&&-1!==i.filename.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({x:o,y:a,w:s,h:l,frame:t,sourceSize:{w:c,h:u}})}for(let t in e)e[t].frame=E(e[t]);return e}if(r&&"object"==typeof t.frames){for(let n=0;n<r.length;n++)for(let i in e[r[n]]=[],t.frames){let o=t.frames[i],a=o.frame,s=a.x,l=a.y,c=a.w,u=a.h,h=o.sourceSize.w,d=o.sourceSize.h;"string"==typeof i&&-1!==i.toLowerCase().indexOf(r[n].toLowerCase())&&e[r[n]].push({x:s,y:l,w:c,h:u,frame:a,sourceSize:{w:h,h:d}})}for(let t in e)e[t].frame=E(e[t]);return e}{let e=[];for(let r in t.frames)e.push(t.frames[r]);return E(e)}},E=e=>{let t=null;for(let r of e){let{w:e,h:n}=r.frame,i=e*n;(!t||i>t.area)&&(t={...r.frame,area:i})}for(let i of e){var r,n;let{w:e,h:o}=i.frame,a=e*o;a===(null==(r=t)?void 0:r.area)?i.scaleRatio=1:i.scaleRatio=Math.sqrt(a/(null==(n=t)?void 0:n.area))}return e};return eT.useLayoutEffect(()=>{null==i||i(u,l)},[u,l]),{spriteObj:A,loadJsonAndTexture:function(e,t){t&&e?m(t,e,g):p(e)}}}function dE(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];let o=eT.useRef(),a=(0,eP.A)(e=>e.scene);return eT.useLayoutEffect(()=>{let r;if(e&&null!=e&&e.current&&t&&(o.current=r=new t(e.current,...n)),r)return r.traverse(e=>e.raycast=()=>null),a.add(r),()=>{o.current=void 0,a.remove(r),null==r.dispose||r.dispose()}},[a,t,e,...n]),(0,eP.C)(()=>{var e;null==(e=o.current)||null==e.update||e.update()}),o}dy.preload=e=>eP.F.preload(eR.TextureLoader,e),dy.clear=e=>eP.F.clear(eR.TextureLoader,e);let dC=e=>{let{type:t,args:r=[]}=e,n=eT.useRef(null),i=eT.useRef(null);return eT.useLayoutEffect(()=>{i.current=n.current.parent}),dE(i,t,...r),eT.createElement("object3D",{ref:n})};var dw=r(3028),dB=r.n(dw);function dx(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}function dI(e){let{showPanel:t=0,className:r,parent:n}=e,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,[n,i]=eT.useState();return eT.useLayoutEffect(()=>{let t=e();return i(t),dx(r,t),()=>dx(r,null)},t),n}(()=>new(dB()),[]);return eT.useEffect(()=>{if(i){let e=n&&n.current||document.body;i.showPanel(t),null==e||e.appendChild(i.dom);let o=(null!=r?r:"").split(" ").filter(e=>e);o.length&&i.dom.classList.add(...o);let a=(0,eP.n)(()=>i.begin()),s=(0,eP.o)(()=>i.end());return()=>{o.length&&i.dom.classList.remove(...o),null==e||e.removeChild(i.dom),a(),s()}}},[n,i,r,t]),null}class db{update(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=1/0,a=0;this.context&&(o=Math.min(o,e),a=Math.max(r,e),n=Math.max(n,t),this.context.fillStyle=this.bg,this.context.globalAlpha=1,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(e.toFixed(i)+" "+this.name+" ("+o.toFixed(i)+"-"+parseFloat(a.toFixed(i))+")",this.TEXT_X,this.TEXT_Y),this.context.drawImage(this.canvas,this.GRAPH_X+this.PR,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT,this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT),this.context.fillRect(this.GRAPH_X+this.GRAPH_WIDTH-this.PR,this.GRAPH_Y,this.PR,this.GRAPH_HEIGHT),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X+this.GRAPH_WIDTH-this.PR,this.GRAPH_Y,this.PR,(1-t/n)*this.GRAPH_HEIGHT))}constructor(e,t,r){this.name=e,this.fg=t,this.bg=r,this.PR=Math.round(window.devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=document.createElement("canvas"),this.canvas.width=90*this.PR,this.canvas.height=48*this.PR,this.canvas.style.width="90px",this.canvas.style.position="absolute",this.canvas.style.height="48px",this.canvas.style.cssText="width:90px;height:48px",this.context=this.canvas.getContext("2d"),this.context&&(this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}}let d_=class e{patchThreeRenderer(e){let t=e.render,r=this;e.render=function(e,n){r.begin(),t.call(this,e,n),r.end()},this.threeRendererPatched=!0}resizePanel(e,t){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=t*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=t*e.HEIGHT/e.PR+"px"))}addPanel(e,t){return e.canvas&&(this.dom.appendChild(e.canvas),this.resizePanel(e,t)),e}showPanel(e){for(let t=0;t<this.dom.children.length;t++)this.dom.children[t].style.display=t===e?"block":"none";this.mode=e}async init(t){if(!t){console.error('Stats: The "canvas" parameter is undefined.');return}if(t.isWebGLRenderer&&!this.threeRendererPatched?(this.patchThreeRenderer(t),this.gl=t.getContext()):!this.gl&&t instanceof WebGL2RenderingContext&&(this.gl=t),t.isWebGPURenderer){t.backend.trackTimestamp=!0,await t.hasFeatureAsync("timestamp-query")&&(this.gpuPanel=this.addPanel(new e.Panel("GPU","#ff0","#220"),2),this.gpuPanelCompute=this.addPanel(new e.Panel("CPT","#e1e1e1","#212121"),3),this.info=t.info);return}if(!this.gl&&t instanceof HTMLCanvasElement||t instanceof OffscreenCanvas){if(this.gl=t.getContext("webgl2"),!this.gl){console.error("Stats: Unable to obtain WebGL2 context.");return}}else if(!this.gl){console.error("Stats: Invalid input type. Expected WebGL2RenderingContext, HTMLCanvasElement, or OffscreenCanvas.");return}this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new e.Panel("GPU","#ff0","#220"),2))}begin(){this.isRunningCPUProfiling||this.beginProfiling("cpu-started"),this.gl&&this.ext&&this.gl&&this.ext&&(this.activeQuery&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.activeQuery=this.gl.createQuery(),null!==this.activeQuery&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery))}end(){this.renderCount++,this.gl&&this.ext&&this.activeQuery&&(this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.gpuQueries.push({query:this.activeQuery}),this.activeQuery=null)}processGpuQueries(){this.gl&&this.ext&&(this.totalGpuDuration=0,this.gpuQueries.forEach((e,t)=>{if(this.gl){let r=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),n=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT);if(r&&!n){let r=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT);this.totalGpuDuration+=1e-6*r,this.gl.deleteQuery(e.query),this.gpuQueries.splice(t,1)}}}))}update(){void 0===this.info?this.processGpuQueries():(this.totalGpuDuration=this.info.render.timestamp,this.totalGpuDurationCompute=this.info.compute.timestamp,this.addToAverage(this.totalGpuDurationCompute,this.averageGpuCompute)),this.endProfiling("cpu-started","cpu-finished","cpu-duration"),this.addToAverage(this.totalCpuDuration,this.averageCpu),this.addToAverage(this.totalGpuDuration,this.averageGpu),this.renderCount=0,0===this.totalCpuDuration&&this.beginProfiling("cpu-started"),this.totalCpuDuration=0,this.totalFps=0,this.beginTime=this.endInternal()}endInternal(){this.frames++;let e=(performance||Date).now();if(e>=this.prevCpuTime+1e3/this.logsPerSecond&&(this.updatePanel(this.msPanel,this.averageCpu),this.updatePanel(this.gpuPanel,this.averageGpu),this.gpuPanelCompute&&this.updatePanel(this.gpuPanelCompute,this.averageGpuCompute),this.prevCpuTime=e),e>=this.prevTime+1e3){let t=1e3*this.frames/(e-this.prevTime);this.fpsPanel.update(t,t,100,100,0),this.prevTime=e,this.frames=0}return e}addToAverage(e,t){t.logs.push(e),t.logs.length>this.samplesLog&&t.logs.shift(),t.graph.push(e),t.graph.length>this.samplesGraph&&t.graph.shift()}beginProfiling(e){window.performance&&(window.performance.mark(e),this.isRunningCPUProfiling=!0)}endProfiling(e,t,r){if(window.performance&&t&&this.isRunningCPUProfiling){window.performance.mark(t);let n=performance.measure(r,e,t);this.totalCpuDuration+=n.duration,this.isRunningCPUProfiling=!1}}updatePanel(e,t){if(t.logs.length>0){let r=0,n=.01;for(let e=0;e<t.logs.length;e++)r+=t.logs[e],t.logs[e]>n&&(n=t.logs[e]);let i=0,o=.01;for(let e=0;e<t.graph.length;e++)i+=t.graph[e],t.graph[e]>o&&(o=t.graph[e]);e&&e.update(r/Math.min(t.logs.length,this.samplesLog),i/Math.min(t.graph.length,this.samplesGraph),n,o,this.precision)}}get domElement(){return this.dom}get container(){return console.warn("Stats: Deprecated! this.container as been replaced to this.dom "),this.dom}constructor({logsPerSecond:t=20,samplesLog:r=100,samplesGraph:n=10,precision:i=2,minimal:o=!1,horizontal:a=!0,mode:s=0}={}){this.totalCpuDuration=0,this.totalGpuDuration=0,this.totalGpuDurationCompute=0,this.totalFps=0,this.activeQuery=null,this.gpuQueries=[],this.renderCount=0,this.mode=s,this.horizontal=a,this.dom=document.createElement("div"),this.dom.style.cssText="position:fixed;top:0;left:0;opacity:0.9;z-index:10000;",o&&(this.dom.style.cssText+="cursor:pointer"),this.gl=null,this.query=null,this.isRunningCPUProfiling=!1,this.minimal=o,this.beginTime=(performance||Date).now(),this.prevTime=this.beginTime,this.prevCpuTime=this.beginTime,this.frames=0,this.renderCount=0,this.threeRendererPatched=!1,this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.averageGpuCompute={logs:[],graph:[]},this.queryCreated=!1,this.fpsPanel=this.addPanel(new e.Panel("FPS","#0ff","#002"),0),this.msPanel=this.addPanel(new e.Panel("CPU","#0f0","#020"),1),this.gpuPanel=null,this.gpuPanelCompute=null,this.samplesLog=r,this.samplesGraph=n,this.precision=i,this.logsPerSecond=t,this.minimal?(this.dom.addEventListener("click",e=>{e.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},!1),this.mode=s,this.showPanel(this.mode)):window.addEventListener("resize",()=>{this.resizePanel(this.fpsPanel,0),this.resizePanel(this.msPanel,1),this.gpuPanel&&this.resizePanel(this.gpuPanel,2),this.gpuPanelCompute&&this.resizePanel(this.gpuPanelCompute,3)})}};function dM(e){let{className:t,parent:r,...n}=e,i=(0,eP.A)(e=>e.gl),o=eT.useMemo(()=>{let e=new d_({...n});return e.init(i),e},[i]);return eT.useEffect(()=>{if(o){let e=r&&r.current||document.body;null==e||e.appendChild(o.dom);let n=(null!=t?t:"").split(" ").filter(e=>e);n.length&&o.dom.classList.add(...n);let i=(0,eP.o)(()=>o.update());return()=>{n.length&&o.dom.classList.remove(...n),null==e||e.removeChild(o.dom),i()}}},[r,o,t]),null}function dS(){let{size:e=256,frames:t=1/0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,eP.A)(e=>e.viewport.dpr),{width:n,height:i}=(0,eP.A)(e=>e.size),o=e||n*r,a=e||i*r,s=eT.useMemo(()=>{let e=new eR.DepthTexture(o,a);return e.format=eR.DepthFormat,e.type=eR.UnsignedShortType,{depthTexture:e}},[o,a]),l=0,c=lV(o,a,s);return(0,eP.C)(e=>{(t===1/0||l<t)&&(e.gl.setRenderTarget(c),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(null),l++)}),c.depthTexture}function dT(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=(0,eP.A)(e=>e.viewport),i=t*(n.aspect>e/t?n.width/e:n.height/t);return[e*(n.aspect>e/t?n.width/e:n.height/t)*r,i*r,1]}function dD(e,t){let r=(0,eP.A)(e=>e.pointer),[n]=eT.useState(()=>{let n=new eR.Raycaster;return t&&(0,eP.j)(n,t,{}),function(t,i){n.setFromCamera(r,e instanceof eR.Camera?e:e.current);let o=this.constructor.prototype.raycast.bind(this);o&&o(n,i)}});return n}function dR(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})}d_.Panel=db,"function"==typeof SuppressedError&&SuppressedError;let dP=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function dF(e){return e=e.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}let dQ="undefined"==typeof window,dO=(()=>{if(dQ)return;let{userAgent:e,platform:t,maxTouchPoints:r}=window.navigator,n=/(iphone|ipod|ipad)/i.test(e),i="iPad"===t||"MacIntel"===t&&r>0&&!window.MSStream;return{isIpad:i,isMobile:/android/i.test(e)||n||i,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e)}})();class dL extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}let dk=[],dU=[];function dG(e){return null!=e}let dN=function(){let{mobileTiers:e=[0,15,30,60],desktopTiers:t=[0,15,30,60],override:r={},glContext:n,failIfMajorPerformanceCaveat:i=!1,benchmarksURL:o="https://unpkg.com/detect-gpu@5.0.38/dist/benchmarks"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return dR(void 0,void 0,void 0,function*(){let a={};if(dQ)return{tier:0,type:"SSR"};let{isIpad:s=!!(null==dO?void 0:dO.isIpad),isMobile:l=!!(null==dO?void 0:dO.isMobile),screenSize:c=window.screen,loadBenchmarks:u=e=>dR(void 0,void 0,void 0,function*(){let t=yield fetch("".concat(o,"/").concat(e)).then(e=>e.json());if(4>parseInt(t.shift().split(".")[0],10))throw new dL("Detect GPU benchmark data is out of date. Please update to version 4x");return t})}=r,{renderer:h}=r,d=(e,t,r,n,i)=>({device:i,fps:n,gpu:r,isMobile:l,tier:e,type:t}),A,f="";if(h)A=[h=dF(h)];else{var p;let e=n||function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:t,powerPreference:"high-performance",stencil:!1};e&&delete r.powerPreference;let n=window.document.createElement("canvas"),i=n.getContext("webgl",r)||n.getContext("experimental-webgl",r);return null!=i?i:void 0}(null==dO?void 0:dO.isSafari12,i);if(!e)return d(0,"WEBGL_UNSUPPORTED");let t=(null==dO?void 0:dO.isFirefox)?null:e.getExtension("WEBGL_debug_renderer_info");if(!(h=t?e.getParameter(t.UNMASKED_RENDERER_WEBGL):e.getParameter(e.RENDERER)))return d(1,"FALLBACK");f=h,A="apple gpu"===(p=h=dF(h))?function(e,t,r){let n;if(!r)return[t];let i=function(e){let t=e.createShader(35633),r=e.createShader(35632),n=e.createProgram();if(!(r&&t&&n))return;e.shaderSource(t,"\n    precision highp float;\n    attribute vec3 aPosition;\n    varying float vvv;\n    void main() {\n      vvv = 0.31622776601683794;\n      gl_Position = vec4(aPosition, 1.0);\n    }\n  "),e.shaderSource(r,"\n    precision highp float;\n    varying float vvv;\n    void main() {\n      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\n      enc = fract(enc);\n      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n      gl_FragColor = enc;\n    }\n  "),e.compileShader(t),e.compileShader(r),e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),e.detachShader(n,t),e.detachShader(n,r),e.deleteShader(t),e.deleteShader(r),e.useProgram(n);let i=e.createBuffer();e.bindBuffer(34962,i),e.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);let o=e.getAttribLocation(n,"aPosition");e.vertexAttribPointer(o,3,5126,!1,0,0),e.enableVertexAttribArray(o),e.clearColor(1,1,1,1),e.clear(16384),e.viewport(0,0,1,1),e.drawArrays(4,0,3);let a=new Uint8Array(4);return e.readPixels(0,0,1,1,6408,5121,a),e.deleteProgram(n),e.deleteBuffer(i),a.join("")}(e),o="801621810",a="8016218135",s="80162181161",l=(null==dO?void 0:dO.isIpad)?[["a7",s,12],["a8",a,15],["a8x",a,15],["a9",a,15],["a9x",a,15],["a10",a,15],["a10x",a,15],["a12",o,15],["a12x",o,15],["a12z",o,15],["a14",o,15],["m1",o,15]]:[["a7",s,12],["a8",a,12],["a9",a,15],["a10",a,15],["a11",o,15],["a12",o,15],["a13",o,15],["a14",o,15],["a15",o,15],["a16",o,15],["a17",o,15]];return"80162181255"===i?n=l.filter(e=>{let[,,t]=e;return t>=14}):(n=l.filter(e=>{let[,t]=e;return t===i})).length||(n=l),n.map(e=>{let[t]=e;return"apple ".concat(t," gpu")})}(e,p,l):[p]}let m=(yield Promise.all(A.map(function(e){var t;return dR(this,void 0,void 0,function*(){let r;let n=(e=>{for(let t of l?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"])if(e.includes(t))return t})(e);if(!n)return;let i="".concat(l?"m":"d","-").concat(n).concat(s?"-ipad":"",".json"),o=a[i]=null!==(t=a[i])&&void 0!==t?t:u(i);try{r=yield o}catch(e){if(e instanceof dL)throw e;return}let h=function(e){var t;let r=(e=e.replace(/\([^)]+\)/,"")).match(/\d+/)||e.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return null!==(t=null==r?void 0:r.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""}(e),d=r.filter(e=>{let[,t]=e;return t===h});d.length||(d=r.filter(t=>{let[r]=t;return r.includes(e)}));let A=d.length;if(0===A)return;let f=e.split(/[.,()\[\]/\s]/g).sort().filter((e,t,r)=>0===t||e!==r[t-1]).join(" "),p,[m,,,,g]=A>1?d.map(e=>[e,function(e,t){if(e===t)return 0;let r=e;e.length>t.length&&(e=t,t=r);let n=e.length,i=t.length;for(;n>0&&e.charCodeAt(~-n)===t.charCodeAt(~-i);)n--,i--;let o,a=0;for(;a<n&&e.charCodeAt(a)===t.charCodeAt(a);)a++;if(n-=a,i-=a,0===n)return i;let s,l,c=0,u=0,h=0;for(;u<n;)dU[u]=e.charCodeAt(a+u),dk[u]=++u;for(;h<i;)for(o=t.charCodeAt(a+h),s=h++,c=h,u=0;u<n;u++)l=o===dU[u]?s:s+1,s=dk[u],c=dk[u]=s>c?l>c?c+1:l:l>s?s+1:l;return c}(f,e[2])]).sort((e,t)=>{let[,r]=e,[,n]=t;return r-n})[0][0]:d[0],v=Number.MAX_VALUE,{devicePixelRatio:y}=window,E=c.width*y*c.height*y;for(let e of g){let[t,r]=e,n=Math.abs(E-t*r);n<v&&(v=n,p=e)}if(!p)return;let[,,C,w]=p;return[v,C,m,w]})}))).filter(dG).sort((e,t)=>{let[r=Number.MAX_VALUE,n]=e,[i=Number.MAX_VALUE,o]=t;return r===i?n-o:r-i});if(!m.length){let e=dP.find(e=>h.includes(e));return e?d(0,"BLOCKLISTED",e):d(1,"FALLBACK","".concat(h," (").concat(f,")"))}let[,g,v,y]=m[0];if(-1===g)return d(0,"BLOCKLISTED",v,g,y);let E=l?e:t,C=0;for(let e=0;e<E.length;e++)g>=E[e]&&(C=e);return d(C,"BENCHMARK",v,g,y)})},dz=e=>(0,au.Rq)(()=>dN(e),["useDetectGPU"]);function dH(e){let{children:t,...r}=e,n=dz(r);return eT.createElement(eT.Fragment,null,null==t?void 0:t(n))}let dV=Symbol("SKIP_GENERATION");function dj(e,t,r){return null===e?null:(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(r.ray.origin),e.object=t,e)}function dJ(e){return e.index?e.index.count:e.attributes.position.count}function dY(e){return dJ(e)/3}function dW(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ArrayBuffer;return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}function dq(e){let t=dY(e),r=e.drawRange,n=r.start/3,i=(r.start+r.count)/3,o=Math.max(0,n);return[{offset:Math.floor(o),count:Math.floor(Math.min(t,i)-o)}]}function dK(e){if(!e.groups||!e.groups.length)return dq(e);let t=[],r=new Set,n=e.drawRange,i=n.start/3,o=(n.start+n.count)/3;for(let t of e.groups){let e=t.start/3,n=(t.start+t.count)/3;r.add(Math.max(i,e)),r.add(Math.min(o,n))}let a=Array.from(r.values()).sort((e,t)=>e-t);for(let e=0;e<a.length-1;e++){let r=a[e],n=a[e+1];t.push({offset:Math.floor(r),count:Math.floor(n-r)})}return t}function dX(e,t,r,n,i){let o=1/0,a=1/0,s=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,A=1/0,f=-1/0,p=-1/0,m=-1/0;for(let n=6*t,i=(t+r)*6;n<i;n+=6){let t=e[n+0],r=e[n+1],i=t-r,g=t+r;i<o&&(o=i),g>l&&(l=g),t<h&&(h=t),t>f&&(f=t);let v=e[n+2],y=e[n+3],E=v-y,C=v+y;E<a&&(a=E),C>c&&(c=C),v<d&&(d=v),v>p&&(p=v);let w=e[n+4],B=e[n+5],x=w-B,I=w+B;x<s&&(s=x),I>u&&(u=I),w<A&&(A=w),w>m&&(m=w)}n[0]=o,n[1]=a,n[2]=s,n[3]=l,n[4]=c,n[5]=u,i[0]=h,i[1]=d,i[2]=A,i[3]=f,i[4]=p,i[5]=m}function dZ(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function d$(e){let t=-1,r=-1/0;for(let n=0;n<3;n++){let i=e[n+3]-e[n];i>r&&(r=i,t=n)}return t}function d0(e,t,r){let n,i;for(let o=0;o<3;o++){let a=o+3;n=e[o],i=t[o],r[o]=n<i?n:i,n=e[a],i=t[a],r[a]=n>i?n:i}}function d1(e,t,r){for(let n=0;n<3;n++){let i=t[e+2*n],o=t[e+2*n+1],a=i-o,s=i+o;a<r[n]&&(r[n]=a),s>r[n+3]&&(r[n+3]=s)}}function d2(e){let t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return 2*(t*r+r*n+n*t)}let d3=(e,t)=>e.candidate-t.candidate,d4=Array(32).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),d5=new Float32Array(6);class d9{constructor(){this.boundingData=new Float32Array(6)}}function d6(e,t,r,n,i,o){let a=n,s=n+i-1,l=o.pos,c=2*o.axis;for(;;){for(;a<=s&&r[6*a+c]<l;)a++;for(;a<=s&&r[6*s+c]>=l;)s--;if(!(a<s))return a;for(let e=0;e<3;e++){let r=t[3*a+e];t[3*a+e]=t[3*s+e],t[3*s+e]=r}for(let e=0;e<6;e++){let t=r[6*a+e];r[6*a+e]=r[6*s+e],r[6*s+e]=t}a++,s--}}function d8(e,t,r,n,i,o){let a=n,s=n+i-1,l=o.pos,c=2*o.axis;for(;;){for(;a<=s&&r[6*a+c]<l;)a++;for(;a<=s&&r[6*s+c]>=l;)s--;if(!(a<s))return a;{let t=e[a];e[a]=e[s],e[s]=t;for(let e=0;e<6;e++){let t=r[6*a+e];r[6*a+e]=r[6*s+e],r[6*s+e]=t}a++,s--}}}function d7(e,t){return 65535===t[e+15]}function Ae(e,t){return t[e+14]}class At{setFromPointsField(e,t){let r=1/0,n=-1/0;for(let i=0,o=e.length;i<o;i++){let o=e[i][t];r=o<r?o:r,n=o>n?o:n}this.min=r,this.max=n}setFromPoints(e,t){let r=1/0,n=-1/0;for(let i=0,o=t.length;i<o;i++){let o=t[i],a=e.dot(o);r=a<r?a:r,n=a>n?a:n}this.min=r,this.max=n}isSeparated(e){return this.min>e.max||e.min>this.max}constructor(){this.min=1/0,this.max=-1/0}}At.prototype.setFromBox=function(){let e=new eR.Vector3;return function(t,r){let n=r.min,i=r.max,o=1/0,a=-1/0;for(let r=0;r<=1;r++)for(let s=0;s<=1;s++)for(let l=0;l<=1;l++){e.x=n.x*r+i.x*(1-r),e.y=n.y*s+i.y*(1-s),e.z=n.z*l+i.z*(1-l);let c=t.dot(e);o=Math.min(c,o),a=Math.max(c,a)}this.min=o,this.max=a}}(),new At;let Ar=function(){let e=new eR.Vector3,t=new eR.Vector3,r=new eR.Vector3;return function(n,i,o){let a,s;let l=n.start,c=i.start;r.subVectors(l,c),e.subVectors(n.end,n.start),t.subVectors(i.end,i.start);let u=r.dot(t),h=t.dot(e),d=t.dot(t),A=r.dot(e),f=e.dot(e)*d-h*h;a=0!==f?(u*h-A*d)/f:0,s=(u+a*h)/d,o.x=a,o.y=s}}(),An=function(){let e=new eR.Vector2,t=new eR.Vector3,r=new eR.Vector3;return function(n,i,o,a){Ar(n,i,e);let s=e.x,l=e.y;if(s>=0&&s<=1&&l>=0&&l<=1){n.at(s,o),i.at(l,a);return}if(s>=0&&s<=1){l<0?i.at(0,a):i.at(1,a),n.closestPointToPoint(a,!0,o);return}if(l>=0&&l<=1){s<0?n.at(0,o):n.at(1,o),i.closestPointToPoint(o,!0,a);return}{let e,c;if(e=s<0?n.start:n.end,c=l<0?i.start:i.end,n.closestPointToPoint(c,!0,t),i.closestPointToPoint(e,!0,r),t.distanceToSquared(c)<=r.distanceToSquared(e)){o.copy(t),a.copy(c);return}o.copy(e),a.copy(r);return}}}(),Ai=function(){let e=new eR.Vector3,t=new eR.Vector3,r=new eR.Plane,n=new eR.Line3;return function(i,o){let{radius:a,center:s}=i,{a:l,b:c,c:u}=o;if(n.start=l,n.end=c,n.closestPointToPoint(s,!0,e).distanceTo(s)<=a||(n.start=l,n.end=u,n.closestPointToPoint(s,!0,e).distanceTo(s)<=a)||(n.start=c,n.end=u,n.closestPointToPoint(s,!0,e).distanceTo(s)<=a))return!0;let h=o.getPlane(r);if(Math.abs(h.distanceToPoint(s))<=a){let e=h.projectPoint(s,t);if(o.containsPoint(e))return!0}return!1}}();function Ao(e){return 1e-15>Math.abs(e)}class Aa extends eR.Triangle{intersectsSphere(e){return Ai(e,this)}update(){let e=this.a,t=this.b,r=this.c,n=this.points,i=this.satAxes,o=this.satBounds,a=i[0],s=o[0];this.getNormal(a),s.setFromPoints(a,n);let l=i[1],c=o[1];l.subVectors(e,t),c.setFromPoints(l,n);let u=i[2],h=o[2];u.subVectors(t,r),h.setFromPoints(u,n);let d=i[3],A=o[3];d.subVectors(r,e),A.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=[,,,,].fill().map(()=>new eR.Vector3),this.satBounds=[,,,,].fill().map(()=>new At),this.points=[this.a,this.b,this.c],this.sphere=new eR.Sphere,this.plane=new eR.Plane,this.needsUpdate=!0}}Aa.prototype.closestPointToSegment=function(){let e=new eR.Vector3,t=new eR.Vector3,r=new eR.Line3;return function(n){let i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,{start:s,end:l}=n,c=this.points,u=1/0;for(let s=0;s<3;s++){let l=(s+1)%3;r.start.copy(c[s]),r.end.copy(c[l]),An(r,n,e,t),(i=e.distanceToSquared(t))<u&&(u=i,o&&o.copy(e),a&&a.copy(t))}return this.closestPointToPoint(s,e),(i=s.distanceToSquared(e))<u&&(u=i,o&&o.copy(e),a&&a.copy(s)),this.closestPointToPoint(l,e),(i=l.distanceToSquared(e))<u&&(u=i,o&&o.copy(e),a&&a.copy(l)),Math.sqrt(u)}}(),Aa.prototype.intersectsTriangle=function(){let e=new Aa,t=[,,,],r=[,,,],n=new At,i=new At,o=new eR.Vector3,a=new eR.Vector3,s=new eR.Vector3,l=new eR.Vector3,c=new eR.Vector3,u=new eR.Line3,h=new eR.Line3,d=new eR.Line3,A=new eR.Vector3;function f(e,t,r){let n=e.points,i=0,o=-1;for(let e=0;e<3;e++){let{start:s,end:l}=u;s.copy(n[e]),l.copy(n[(e+1)%3]),u.delta(a);let c=Ao(t.distanceToPoint(s));if(Ao(t.normal.dot(a))&&c){r.copy(u),i=2;break}let h=t.intersectLine(u,A);if(!h&&c&&A.copy(s),(h||c)&&!Ao(A.distanceTo(l))){if(i<=1)(1===i?r.start:r.end).copy(A),c&&(o=i);else if(i>=2){(1===o?r.start:r.end).copy(A),i=2;break}if(2==++i&&-1===o)break}}return i}return function(a){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,A=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.needsUpdate&&this.update(),a.isExtendedTriangle?a.needsUpdate&&a.update():(e.copy(a),e.update(),a=e);let p=this.plane,m=a.plane;if(Math.abs(p.normal.dot(m.normal))>1-1e-10){let e=this.satBounds,s=this.satAxes;r[0]=a.a,r[1]=a.b,r[2]=a.c;for(let t=0;t<4;t++){let i=e[t],o=s[t];if(n.setFromPoints(o,r),i.isSeparated(n))return!1}let l=a.satBounds,c=a.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let e=0;e<4;e++){let r=l[e],i=c[e];if(n.setFromPoints(i,t),r.isSeparated(n))return!1}for(let e=0;e<4;e++){let a=s[e];for(let e=0;e<4;e++){let s=c[e];if(o.crossVectors(a,s),n.setFromPoints(o,t),i.setFromPoints(o,r),n.isSeparated(i))return!1}}return u&&(A||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),u.start.set(0,0,0),u.end.set(0,0,0)),!0}{let e=f(this,m,h);if(1===e&&a.containsPoint(h.end))return u&&(u.start.copy(h.end),u.end.copy(h.end)),!0;if(2!==e)return!1;let t=f(a,p,d);if(1===t&&this.containsPoint(d.end))return u&&(u.start.copy(d.end),u.end.copy(d.end)),!0;if(2!==t)return!1;if(h.delta(s),d.delta(l),0>s.dot(l)){let e=d.start;d.start=d.end,d.end=e}let r=h.start.dot(s),n=h.end.dot(s),i=d.start.dot(s),o=d.end.dot(s);return(r===o||i===n||n<i!=r<o)&&(u&&(c.subVectors(h.start,d.start),c.dot(s)>0?u.start.copy(h.start):u.start.copy(d.start),c.subVectors(h.end,d.end),0>c.dot(s)?u.end.copy(h.end):u.end.copy(d.end)),!0)}}}(),Aa.prototype.distanceToPoint=function(){let e=new eR.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),Aa.prototype.distanceToTriangle=function(){let e=new eR.Vector3,t=new eR.Vector3,r=["a","b","c"],n=new eR.Line3,i=new eR.Line3;return function(o){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=a||s?n:null;if(this.intersectsTriangle(o,l))return(a||s)&&(a&&l.getCenter(a),s&&l.getCenter(s)),0;let c=1/0;for(let t=0;t<3;t++){let n;let i=r[t],l=o[i];this.closestPointToPoint(l,e),(n=l.distanceToSquared(e))<c&&(c=n,a&&a.copy(e),s&&s.copy(l));let u=this[i];o.closestPointToPoint(u,e),(n=u.distanceToSquared(e))<c&&(c=n,a&&a.copy(u),s&&s.copy(e))}for(let l=0;l<3;l++){let u=r[l],h=r[(l+1)%3];n.set(this[u],this[h]);for(let l=0;l<3;l++){let u=r[l],h=r[(l+1)%3];i.set(o[u],o[h]),An(n,i,e,t);let d=e.distanceToSquared(t);d<c&&(c=d,a&&a.copy(e),s&&s.copy(t))}}return Math.sqrt(c)}}();class As{set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}constructor(e,t,r){this.isOrientedBox=!0,this.min=new eR.Vector3,this.max=new eR.Vector3,this.matrix=new eR.Matrix4,this.invMatrix=new eR.Matrix4,this.points=Array(8).fill().map(()=>new eR.Vector3),this.satAxes=[,,,].fill().map(()=>new eR.Vector3),this.satBounds=[,,,].fill().map(()=>new At),this.alignedSatBounds=[,,,].fill().map(()=>new At),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}}As.prototype.update=function(){let e=this.matrix,t=this.min,r=this.max,n=this.points;for(let i=0;i<=1;i++)for(let o=0;o<=1;o++)for(let a=0;a<=1;a++){let s=n[1*i|2*o|4*a];s.x=i?r.x:t.x,s.y=o?r.y:t.y,s.z=a?r.z:t.z,s.applyMatrix4(e)}let i=this.satBounds,o=this.satAxes,a=n[0];for(let e=0;e<3;e++){let t=o[e],r=i[e],s=n[1<<e];t.subVectors(a,s),r.setFromPoints(t,n)}let s=this.alignedSatBounds;s[0].setFromPointsField(n,"x"),s[1].setFromPointsField(n,"y"),s[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},As.prototype.intersectsBox=function(){let e=new At;return function(t){this.needsUpdate&&this.update();let r=t.min,n=t.max,i=this.satBounds,o=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=n.x,a[0].isSeparated(e)||(e.min=r.y,e.max=n.y,a[1].isSeparated(e))||(e.min=r.z,e.max=n.z,a[2].isSeparated(e)))return!1;for(let r=0;r<3;r++){let n=o[r],a=i[r];if(e.setFromBox(n,t),a.isSeparated(e))return!1}return!0}}(),As.prototype.intersectsTriangle=function(){let e=new Aa,t=[,,,],r=new At,n=new At,i=new eR.Vector3;return function(o){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(e.copy(o),e.update(),o=e);let a=this.satBounds,s=this.satAxes;t[0]=o.a,t[1]=o.b,t[2]=o.c;for(let e=0;e<3;e++){let n=a[e],i=s[e];if(r.setFromPoints(i,t),n.isSeparated(r))return!1}let l=o.satBounds,c=o.satAxes,u=this.points;for(let e=0;e<3;e++){let t=l[e],n=c[e];if(r.setFromPoints(n,u),t.isSeparated(r))return!1}for(let e=0;e<3;e++){let o=s[e];for(let e=0;e<4;e++){let a=c[e];if(i.crossVectors(o,a),r.setFromPoints(i,t),n.setFromPoints(i,u),r.isSeparated(n))return!1}}return!0}}(),As.prototype.closestPointToPoint=function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t},As.prototype.distanceToPoint=function(){let e=new eR.Vector3;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),As.prototype.distanceToBox=function(){let e=["x","y","z"],t=Array(12).fill().map(()=>new eR.Line3),r=Array(12).fill().map(()=>new eR.Line3),n=new eR.Vector3,i=new eR.Vector3;return function(o){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.needsUpdate&&this.update(),this.intersectsBox(o))return(s||l)&&(o.getCenter(i),this.closestPointToPoint(i,n),o.closestPointToPoint(n,i),s&&s.copy(n),l&&l.copy(i)),0;let c=a*a,u=o.min,h=o.max,d=this.points,A=1/0;for(let e=0;e<8;e++){let t=d[e];i.copy(t).clamp(u,h);let r=t.distanceToSquared(i);if(r<A&&(A=r,s&&s.copy(t),l&&l.copy(i),r<c))return Math.sqrt(r)}let f=0;for(let n=0;n<3;n++)for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){let a=(n+1)%3,s=(n+2)%3,l=i<<a|o<<s,c=1<<n|i<<a|o<<s,A=d[l],p=d[c];t[f].set(A,p);let m=e[n],g=e[a],v=e[s],y=r[f],E=y.start,C=y.end;E[m]=u[m],E[g]=i?u[g]:h[g],E[v]=o?u[v]:h[g],C[m]=h[m],C[g]=i?u[g]:h[g],C[v]=o?u[v]:h[g],f++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let r=0;r<=1;r++){i.x=e?h.x:u.x,i.y=t?h.y:u.y,i.z=r?h.z:u.z,this.closestPointToPoint(i,n);let o=i.distanceToSquared(n);if(o<A&&(A=o,s&&s.copy(n),l&&l.copy(i),o<c))return Math.sqrt(o)}for(let e=0;e<12;e++){let o=t[e];for(let e=0;e<12;e++){An(o,r[e],n,i);let t=n.distanceToSquared(i);if(t<A&&(A=t,s&&s.copy(n),l&&l.copy(i),t<c))return Math.sqrt(t)}}return Math.sqrt(A)}}();class Al{getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}constructor(e){this._getNewPrimitive=e,this._primitives=[]}}class Ac extends Al{constructor(){super(()=>new Aa)}}let Au=new Ac;class Ah{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;let e=[],t=null;this.setBuffer=r=>{t&&e.push(t),t=r,this.float32Array=new Float32Array(r),this.uint16Array=new Uint16Array(r),this.uint32Array=new Uint32Array(r)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}}let Ad=new Ah,AA=[],Af=new Al(()=>new eR.Box3),Ap=new eR.Vector3,Am=new eR.Vector3,Ag=new eR.Vector3,Av=new eR.Vector3,Ay=new eR.Vector3,AE=new eR.Vector2,AC=new eR.Vector2,Aw=new eR.Vector2,AB=new eR.Vector3,Ax=new eR.Vector3,AI=new eR.Vector3,Ab=new eR.Vector3;function A_(e,t,r,n,i,o,a){let s=3*n,l=s+0,c=s+1,u=s+2,h=e.index;e.index&&(l=h.getX(l),c=h.getX(c),u=h.getX(u));let{position:d,normal:A,uv:f,uv1:p}=e.attributes,m=function(e,t,r,n,i,o,a,s,l,c,u){Ag.fromBufferAttribute(t,o),Av.fromBufferAttribute(t,a),Ay.fromBufferAttribute(t,s);let h=function(e,t,r,n,i,o,a,s){if(null===(o===eR.BackSide?e.intersectTriangle(n,r,t,!0,i):e.intersectTriangle(t,r,n,o!==eR.DoubleSide,i)))return null;let l=e.origin.distanceTo(i);return l<a||l>s?null:{distance:l,point:i.clone()}}(e,Ag,Av,Ay,Ab,l,c,u);if(h){n&&(AE.fromBufferAttribute(n,o),AC.fromBufferAttribute(n,a),Aw.fromBufferAttribute(n,s),h.uv=eR.Triangle.getInterpolation(Ab,Ag,Av,Ay,AE,AC,Aw,new eR.Vector2)),i&&(AE.fromBufferAttribute(i,o),AC.fromBufferAttribute(i,a),Aw.fromBufferAttribute(i,s),h.uv1=eR.Triangle.getInterpolation(Ab,Ag,Av,Ay,AE,AC,Aw,new eR.Vector2)),r&&(AB.fromBufferAttribute(r,o),Ax.fromBufferAttribute(r,a),AI.fromBufferAttribute(r,s),h.normal=eR.Triangle.getInterpolation(Ab,Ag,Av,Ay,AB,Ax,AI,new eR.Vector3),h.normal.dot(e.direction)>0&&h.normal.multiplyScalar(-1));let t={a:o,b:a,c:s,normal:new eR.Vector3,materialIndex:0};eR.Triangle.getNormal(Ag,Av,Ay,t.normal),h.face=t,h.faceIndex=o}return h}(r,d,A,f,p,l,c,u,t,o,a);return m?(m.faceIndex=n,i&&i.push(m),m):null}function AM(e,t,r,n){let i=e.a,o=e.b,a=e.c,s=t,l=t+1,c=t+2;r&&(s=r.getX(s),l=r.getX(l),c=r.getX(c)),i.x=n.getX(s),i.y=n.getY(s),i.z=n.getZ(s),o.x=n.getX(l),o.y=n.getY(l),o.z=n.getZ(l),a.x=n.getX(c),a.y=n.getY(c),a.z=n.getZ(c)}function AS(e,t,r,n,i,o,a){let{geometry:s}=r,{index:l}=s,c=s.attributes.position;for(let r=e,s=t+e;r<s;r++){let e;if(AM(a,3*(e=r),l,c),a.needsUpdate=!0,n(a,e,i,o))return!0}return!1}function AT(e,t,r,n,i){let o,a,s,l,c,u;let h=1/r.direction.x,d=1/r.direction.y,A=1/r.direction.z,f=r.origin.x,p=r.origin.y,m=r.origin.z,g=t[e],v=t[e+3],y=t[e+1],E=t[e+3+1],C=t[e+2],w=t[e+3+2];return h>=0?(o=(g-f)*h,a=(v-f)*h):(o=(v-f)*h,a=(g-f)*h),d>=0?(s=(y-p)*d,l=(E-p)*d):(s=(E-p)*d,l=(y-p)*d),!(o>l)&&!(s>a)&&((s>o||isNaN(o))&&(o=s),(l<a||isNaN(a))&&(a=l),A>=0?(c=(C-m)*A,u=(w-m)*A):(c=(w-m)*A,u=(C-m)*A),!(o>u)&&!(c>a)&&((c>o||o!=o)&&(o=c),(u<a||a!=a)&&(a=u),o<=i&&a>=n))}function AD(e,t,r,n,i,o,a){Ad.setBuffer(e._roots[t]),function e(t,r,n,i,o,a,s){let{float32Array:l,uint16Array:c,uint32Array:u}=Ad,h=2*t;if(d7(h,c))!function(e,t,r,n,i,o,a,s){let{geometry:l,_indirectBuffer:c}=e;for(let e=n,c=n+i;e<c;e++)A_(l,t,r,e,o,a,s)}(r,n,i,u[t+6],Ae(h,c),o,a,s);else{let c=t+8;AT(c,l,i,a,s)&&e(c,r,n,i,o,a,s);let h=u[t+6];AT(h,l,i,a,s)&&e(h,r,n,i,o,a,s)}}(0,e,r,n,i,o,a),Ad.clearBuffer()}let AR=["x","y","z"];function AP(e,t,r,n,i,o){Ad.setBuffer(e._roots[t]);let a=function e(t,r,n,i,o,a){let{float32Array:s,uint16Array:l,uint32Array:c}=Ad,u=2*t;if(d7(u,l))return function(e,t,r,n,i,o,a){let{geometry:s,_indirectBuffer:l}=e,c=1/0,u=null;for(let e=n,l=n+i;e<l;e++){let n;(n=A_(s,t,r,e,null,o,a))&&n.distance<c&&(u=n,c=n.distance)}return u}(r,n,i,c[t+6],Ae(u,l),o,a);{let l,u;let h=c[t+7],d=AR[h],A=i.direction[d]>=0;A?(l=t+8,u=c[t+6]):(l=c[t+6],u=t+8);let f=AT(l,s,i,o,a)?e(l,r,n,i,o,a):null;if(f){let e=f.point[d];if(A?e<=s[u+h]:e>=s[u+h+3])return f}let p=AT(u,s,i,o,a)?e(u,r,n,i,o,a):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}(0,e,r,n,i,o);return Ad.clearBuffer(),a}let AF=new eR.Box3,AQ=new Aa,AO=new Aa,AL=new eR.Matrix4,Ak=new As,AU=new As;function AG(e,t,r,n){Ad.setBuffer(e._roots[t]);let i=function e(t,r,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,{float32Array:a,uint16Array:s,uint32Array:l}=Ad,c=2*t;if(null===o&&(n.boundingBox||n.computeBoundingBox(),Ak.set(n.boundingBox.min,n.boundingBox.max,i),o=Ak),d7(c,s)){let e=r.geometry,o=e.index,u=e.attributes.position,h=n.index,d=n.attributes.position,A=l[t+6],f=Ae(c,s);if(AL.copy(i).invert(),n.boundsTree)return dZ(t,a,AU),AU.matrix.copy(AL),AU.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>AU.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let t=3*A,r=(f+A)*3;t<r;t+=3)if(AM(AO,t,o,u),AO.needsUpdate=!0,e.intersectsTriangle(AO))return!0;return!1}});for(let e=3*A,t=(f+A)*3;e<t;e+=3){AM(AQ,e,o,u),AQ.a.applyMatrix4(AL),AQ.b.applyMatrix4(AL),AQ.c.applyMatrix4(AL),AQ.needsUpdate=!0;for(let e=0,t=h.count;e<t;e+=3)if(AM(AO,e,h,d),AO.needsUpdate=!0,AQ.intersectsTriangle(AO))return!0}}else{let s=t+8,c=l[t+6];return dZ(s,a,AF),!!(o.intersectsBox(AF)&&e(s,r,n,i,o))||(dZ(c,a,AF),!!(o.intersectsBox(AF)&&e(c,r,n,i,o)))}}(0,e,r,n);return Ad.clearBuffer(),i}let AN=new eR.Matrix4,Az=new As,AH=new As,AV=new eR.Vector3,Aj=new eR.Vector3,AJ=new eR.Vector3,AY=new eR.Vector3;function AW(e,t,r,n,i,o,a){let{geometry:s}=r,{index:l}=s,c=s.attributes.position;for(let s=e,u=t+e;s<u;s++){let e;if(AM(a,3*(e=r.resolveTriangleIndex(s)),l,c),a.needsUpdate=!0,n(a,e,i,o))return!0}return!1}function Aq(e,t,r,n,i,o,a){Ad.setBuffer(e._roots[t]),function e(t,r,n,i,o,a,s){let{float32Array:l,uint16Array:c,uint32Array:u}=Ad,h=2*t;if(d7(h,c))!function(e,t,r,n,i,o,a,s){let{geometry:l,_indirectBuffer:c}=e;for(let e=n,u=n+i;e<u;e++)A_(l,t,r,c?c[e]:e,o,a,s)}(r,n,i,u[t+6],Ae(h,c),o,a,s);else{let c=t+8;AT(c,l,i,a,s)&&e(c,r,n,i,o,a,s);let h=u[t+6];AT(h,l,i,a,s)&&e(h,r,n,i,o,a,s)}}(0,e,r,n,i,o,a),Ad.clearBuffer()}let AK=["x","y","z"];function AX(e,t,r,n,i,o){Ad.setBuffer(e._roots[t]);let a=function e(t,r,n,i,o,a){let{float32Array:s,uint16Array:l,uint32Array:c}=Ad,u=2*t;if(d7(u,l))return function(e,t,r,n,i,o,a){let{geometry:s,_indirectBuffer:l}=e,c=1/0,u=null;for(let e=n,h=n+i;e<h;e++){let n;(n=A_(s,t,r,l?l[e]:e,null,o,a))&&n.distance<c&&(u=n,c=n.distance)}return u}(r,n,i,c[t+6],Ae(u,l),o,a);{let l,u;let h=c[t+7],d=AK[h],A=i.direction[d]>=0;A?(l=t+8,u=c[t+6]):(l=c[t+6],u=t+8);let f=AT(l,s,i,o,a)?e(l,r,n,i,o,a):null;if(f){let e=f.point[d];if(A?e<=s[u+h]:e>=s[u+h+3])return f}let p=AT(u,s,i,o,a)?e(u,r,n,i,o,a):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}(0,e,r,n,i,o);return Ad.clearBuffer(),a}let AZ=new eR.Box3,A$=new Aa,A0=new Aa,A1=new eR.Matrix4,A2=new As,A3=new As;function A4(e,t,r,n){Ad.setBuffer(e._roots[t]);let i=function e(t,r,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,{float32Array:a,uint16Array:s,uint32Array:l}=Ad,c=2*t;if(null===o&&(n.boundingBox||n.computeBoundingBox(),A2.set(n.boundingBox.min,n.boundingBox.max,i),o=A2),d7(c,s)){let e=r.geometry,o=e.index,u=e.attributes.position,h=n.index,d=n.attributes.position,A=l[t+6],f=Ae(c,s);if(A1.copy(i).invert(),n.boundsTree)return dZ(t,a,A3),A3.matrix.copy(A1),A3.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>A3.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let t=A,n=f+A;t<n;t++)if(AM(A0,3*r.resolveTriangleIndex(t),o,u),A0.needsUpdate=!0,e.intersectsTriangle(A0))return!0;return!1}});for(let e=A,t=f+A;e<t;e++){AM(A$,3*r.resolveTriangleIndex(e),o,u),A$.a.applyMatrix4(A1),A$.b.applyMatrix4(A1),A$.c.applyMatrix4(A1),A$.needsUpdate=!0;for(let e=0,t=h.count;e<t;e+=3)if(AM(A0,e,h,d),A0.needsUpdate=!0,A$.intersectsTriangle(A0))return!0}}else{let s=t+8,c=l[t+6];return dZ(s,a,AZ),!!(o.intersectsBox(AZ)&&e(s,r,n,i,o))||(dZ(c,a,AZ),!!(o.intersectsBox(AZ)&&e(c,r,n,i,o)))}}(0,e,r,n);return Ad.clearBuffer(),i}let A5=new eR.Matrix4,A9=new As,A6=new As,A8=new eR.Vector3,A7=new eR.Vector3,fe=new eR.Vector3,ft=new eR.Vector3,fr=new Ad.constructor,fn=new Ad.constructor,fi=new Al(()=>new eR.Box3),fo=new eR.Box3,fa=new eR.Box3,fs=new eR.Box3,fl=new eR.Box3,fc=!1,fu=new As,fh=new eR.Box3,fd={strategy:0,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0};class fA{static serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t={cloneBuffers:!0,...t};let r=e.geometry,n=e._roots,i=e._indirectBuffer,o=r.getIndex();return t.cloneBuffers?{roots:n.map(e=>e.slice()),index:o?o.array.slice():null,indirectBuffer:i?i.slice():null}:{roots:n,index:o?o.array:null,indirectBuffer:i}}static deserialize(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r={setIndex:!0,indirect:!!e.indirectBuffer,...r};let{index:n,roots:i,indirectBuffer:o}=e,a=new fA(t,{...r,[dV]:!0});if(a._roots=i,a._indirectBuffer=o||null,r.setIndex){let r=t.getIndex();if(null===r){let r=new eR.BufferAttribute(e.index,1,!1);t.setIndex(r)}else r.array!==n&&(r.array.set(n),r.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}refit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return(this.indirect?function(e){let t,r,n,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o&&Array.isArray(o)&&(o=new Set(o));let a=e.geometry,s=a.index?a.index.array:null,l=a.attributes.position,c=0,u=e._roots;for(let a=0,h=u.length;a<h;a++)t=u[a],r=new Uint32Array(t),n=new Uint16Array(t),i=new Float32Array(t),function t(a,c){let u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=2*a;if(65535===n[h+15]){let t=r[a+6],o=n[h+14],c=1/0,u=1/0,d=1/0,A=-1/0,f=-1/0,p=-1/0;for(let r=t,n=t+o;r<n;r++){let t=3*e.resolveTriangleIndex(r);for(let e=0;e<3;e++){let r=t+e;r=s?s[r]:r;let n=l.getX(r),i=l.getY(r),o=l.getZ(r);n<c&&(c=n),n>A&&(A=n),i<u&&(u=i),i>f&&(f=i),o<d&&(d=o),o>p&&(p=o)}}return(i[a+0]!==c||i[a+1]!==u||i[a+2]!==d||i[a+3]!==A||i[a+4]!==f||i[a+5]!==p)&&(i[a+0]=c,i[a+1]=u,i[a+2]=d,i[a+3]=A,i[a+4]=f,i[a+5]=p,!0)}{let e=a+8,n=r[a+6],s=u,l=!1,h=!1;o?s||(l=o.has(e+c),h=o.has(n+c),s=!l&&!h):(l=!0,h=!0);let d=s||l,A=s||h,f=!1;d&&(f=t(e,c,s));let p=!1;A&&(p=t(n,c,s));let m=f||p;if(m)for(let t=0;t<3;t++){let r=e+t,o=n+t,s=i[r],l=i[r+3],c=i[o],u=i[o+3];i[a+t]=s<c?s:c,i[a+t+3]=l>u?l:u}return m}}(0,c),c+=t.byteLength}:function(e){let t,r,n,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o&&Array.isArray(o)&&(o=new Set(o));let a=e.geometry,s=a.index?a.index.array:null,l=a.attributes.position,c=0,u=e._roots;for(let e=0,a=u.length;e<a;e++)t=u[e],r=new Uint32Array(t),n=new Uint16Array(t),i=new Float32Array(t),function e(t,a){let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=2*t;if(65535===n[u+15]){let e=r[t+6],o=n[u+14],a=1/0,c=1/0,h=1/0,d=-1/0,A=-1/0,f=-1/0;for(let t=3*e,r=3*(e+o);t<r;t++){let e=s[t],r=l.getX(e),n=l.getY(e),i=l.getZ(e);r<a&&(a=r),r>d&&(d=r),n<c&&(c=n),n>A&&(A=n),i<h&&(h=i),i>f&&(f=i)}return(i[t+0]!==a||i[t+1]!==c||i[t+2]!==h||i[t+3]!==d||i[t+4]!==A||i[t+5]!==f)&&(i[t+0]=a,i[t+1]=c,i[t+2]=h,i[t+3]=d,i[t+4]=A,i[t+5]=f,!0)}{let n=t+8,s=r[t+6],l=c,u=!1,h=!1;o?l||(u=o.has(n+a),h=o.has(s+a),l=!u&&!h):(u=!0,h=!0);let d=l||u,A=l||h,f=!1;d&&(f=e(n,a,l));let p=!1;A&&(p=e(s,a,l));let m=f||p;if(m)for(let e=0;e<3;e++){let r=n+e,o=s+e,a=i[r],l=i[r+3],c=i[o],u=i[o+3];i[t+e]=a<c?a:c,i[t+e+3]=l>u?l:u}return m}}(0,c),c+=t.byteLength})(this,e)}traverse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._roots[t],n=new Uint32Array(r),i=new Uint16Array(r);!function t(o){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=2*o,l=65535===i[s+15];if(l){let t=n[o+6],c=i[s+14];e(a,l,new Float32Array(r,4*o,6),t,c)}else{let i=n[o+6],s=n[o+7];e(a,l,new Float32Array(r,4*o,6),s)||(t(o+8,a+1),t(i,a+1))}}(0)}raycast(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eR.FrontSide,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=this._roots,o=this.geometry,a=[],s=t.isMaterial,l=Array.isArray(t),c=o.groups,u=s?t.side:t,h=this.indirect?Aq:AD;for(let o=0,s=i.length;o<s;o++){let i=l?t[c[o].materialIndex].side:u,s=a.length;if(h(this,o,i,e,a,r,n),l){let e=c[o].materialIndex;for(let t=s,r=a.length;t<r;t++)a[t].face.materialIndex=e}}return a}raycastFirst(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eR.FrontSide,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=this._roots,o=this.geometry,a=t.isMaterial,s=Array.isArray(t),l=null,c=o.groups,u=a?t.side:t,h=this.indirect?AX:AP;for(let o=0,a=i.length;o<a;o++){let i=s?t[c[o].materialIndex].side:u,a=h(this,o,i,e,r,n);null!=a&&(null==l||a.distance<l.distance)&&(l=a,s&&(a.face.materialIndex=c[o].materialIndex))}return l}intersectsGeometry(e,t){let r=!1,n=this._roots,i=this.indirect?A4:AG;for(let o=0,a=n.length;o<a&&!(r=i(this,o,e,t));o++);return r}shapecast(e){let t=Au.getPrimitive(),r=this.indirect?AW:AS,{boundsTraverseOrder:n,intersectsBounds:i,intersectsRange:o,intersectsTriangle:a}=e;if(o&&a){let e=o;o=(n,i,o,s,l)=>!!e(n,i,o,s,l)||r(n,i,this,a,o,s,t)}else o||(o=a?(e,n,i,o)=>r(e,n,this,a,i,o,t):(e,t,r)=>r);let s=!1,l=0,c=this._roots;for(let e=0,t=c.length;e<t;e++){let t=c[e];if(s=function(e,t,r,n,i,o){z=Af.getPrimitive(),H=Af.getPrimitive(),AA.push(z,H),Ad.setBuffer(e._roots[t]);let a=function e(t,r,n,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,{float32Array:l,uint16Array:c,uint32Array:u}=Ad,h=2*t;if(d7(h,c)){let e=u[t+6],r=Ae(h,c);return dZ(t,l,z),i(e,r,!1,s,a+t,z)}{let h,f,p,m,g,v;let y=t+8,E=u[t+6],C=y,w=E;if(o&&(p=z,m=H,dZ(C,l,p),dZ(w,l,m),h=o(p),(f=o(m))<h)){C=E,w=y;let e=h;h=f,f=e,p=m}p||dZ(C,l,p=z);let B=n(p,d7(2*C,c),h,s+1,a+C);if(2===B){let e=d(C);g=i(e,A(C)-e,!0,s+1,a+C,p)}else g=B&&e(C,r,n,i,o,a,s+1);if(g)return!0;dZ(w,l,m=H);let x=n(m,d7(2*w,c),f,s+1,a+w);if(2===x){let e=d(w);v=i(e,A(w)-e,!0,s+1,a+w,m)}else v=x&&e(w,r,n,i,o,a,s+1);if(v)return!0;return!1;function d(e){let{uint16Array:t,uint32Array:r}=Ad,n=2*e;for(;!d7(n,t);)e+=8,n=2*e;return r[e+6]}function A(e){let{uint16Array:t,uint32Array:r}=Ad,n=2*e;for(;!d7(n,t);)n=2*(e=r[e+6]);return r[e+6]+Ae(n,t)}}}(0,e.geometry,r,n,i,o);Ad.clearBuffer(),Af.releasePrimitive(z),Af.releasePrimitive(H),AA.pop(),AA.pop();let s=AA.length;return s>0&&(H=AA[s-1],z=AA[s-2]),a}(this,e,i,o,n,l))break;l+=t.byteLength}return Au.releasePrimitive(t),s}bvhcast(e,t,r){let{intersectsRanges:n,intersectsTriangles:i}=r,o=Au.getPrimitive(),a=this.geometry.index,s=this.geometry.attributes.position,l=this.indirect?e=>{AM(o,3*this.resolveTriangleIndex(e),a,s)}:e=>{AM(o,3*e,a,s)},c=Au.getPrimitive(),u=e.geometry.index,h=e.geometry.attributes.position,d=e.indirect?t=>{AM(c,3*e.resolveTriangleIndex(t),u,h)}:e=>{AM(c,3*e,u,h)};if(i){let e=(e,r,n,a,s,u,h,A)=>{for(let f=n,p=n+a;f<p;f++){d(f),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let t=e,n=e+r;t<n;t++)if(l(t),o.needsUpdate=!0,i(o,c,t,f,s,u,h,A))return!0}return!1};if(n){let t=n;n=function(r,n,i,o,a,s,l,c){return!!t(r,n,i,o,a,s,l,c)||e(r,n,i,o,a,s,l,c)}}else n=e}return function(e,t,r,n){let i;if(fc)throw Error("MeshBVH: Recursive calls to bvhcast not supported.");fc=!0;let o=e._roots,a=t._roots,s=0,l=0,c=new eR.Matrix4().copy(r).invert();for(let e=0,t=o.length;e<t;e++){fr.setBuffer(o[e]),l=0;let t=fi.getPrimitive();dZ(0,fr.float32Array,t),t.applyMatrix4(c);for(let o=0,u=a.length;o<u&&(fn.setBuffer(a[e]),i=function e(t,r,n,i,o){let a,s,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,A=arguments.length>10&&void 0!==arguments[10]&&arguments[10];A?(a=fn,s=fr):(a=fr,s=fn);let f=a.float32Array,p=a.uint32Array,m=a.uint16Array,g=s.float32Array,v=s.uint32Array,y=s.uint16Array,E=2*r,C=d7(2*t,m),w=d7(E,y),B=!1;if(w&&C)B=A?o(v[r+6],Ae(2*r,y),p[t+6],Ae(2*t,m),h,c+r,u,l+t):o(p[t+6],Ae(2*t,m),v[r+6],Ae(2*r,y),u,l+t,h,c+r);else if(w){let a=fi.getPrimitive();dZ(r,g,a),a.applyMatrix4(n);let s=t+8,d=p[t+6];dZ(s,f,fo),dZ(d,f,fa);let m=a.intersectsBox(fo),v=a.intersectsBox(fa);B=m&&e(r,s,i,n,o,c,l,h,u+1,a,!A)||v&&e(r,d,i,n,o,c,l,h,u+1,a,!A),fi.releasePrimitive(a)}else{let a=r+8,s=v[r+6];dZ(a,g,fs),dZ(s,g,fl);let m=d.intersectsBox(fs),y=d.intersectsBox(fl);if(m&&y)B=e(t,a,n,i,o,l,c,u,h+1,d,A)||e(t,s,n,i,o,l,c,u,h+1,d,A);else if(m){if(C)B=e(t,a,n,i,o,l,c,u,h+1,d,A);else{let r=fi.getPrimitive();r.copy(fs).applyMatrix4(n);let s=t+8,d=p[t+6];dZ(s,f,fo),dZ(d,f,fa);let m=r.intersectsBox(fo),g=r.intersectsBox(fa);B=m&&e(a,s,i,n,o,c,l,h,u+1,r,!A)||g&&e(a,d,i,n,o,c,l,h,u+1,r,!A),fi.releasePrimitive(r)}}else if(y){if(C)B=e(t,s,n,i,o,l,c,u,h+1,d,A);else{let r=fi.getPrimitive();r.copy(fl).applyMatrix4(n);let a=t+8,d=p[t+6];dZ(a,f,fo),dZ(d,f,fa);let m=r.intersectsBox(fo),g=r.intersectsBox(fa);B=m&&e(s,a,i,n,o,c,l,h,u+1,r,!A)||g&&e(s,d,i,n,o,c,l,h,u+1,r,!A),fi.releasePrimitive(r)}}}return B}(0,0,r,c,n,s,l,0,0,t),fn.clearBuffer(),l+=a[o].length,!i);o++);if(fi.releasePrimitive(t),fr.clearBuffer(),s+=o[e].length,i)break}return fc=!1,i}(this,e,t,n)}intersectsBox(e,t){return fu.set(e.min,e.max,t),fu.needsUpdate=!0,this.shapecast({intersectsBounds:e=>fu.intersectsBox(e),intersectsTriangle:e=>fu.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0;return(this.indirect?function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),A9.set(t.boundingBox.min,t.boundingBox.max,r),A9.needsUpdate=!0;let s=e.geometry,l=s.attributes.position,c=s.index,u=t.attributes.position,h=t.index,d=Au.getPrimitive(),A=Au.getPrimitive(),f=null,p=null;i&&(f=fe,p=ft);let m=1/0,g=null,v=null;return(A5.copy(r).invert(),A6.matrix.copy(A5),e.shapecast({boundsTraverseOrder:e=>A9.distanceToBox(e),intersectsBounds:(e,t,r)=>r<m&&r<a&&(t&&(A6.min.copy(e.min),A6.max.copy(e.max),A6.needsUpdate=!0),!0),intersectsRange:(n,i)=>{if(t.boundsTree){let s=t.boundsTree;return s.shapecast({boundsTraverseOrder:e=>A6.distanceToBox(e),intersectsBounds:(e,t,r)=>r<m&&r<a,intersectsRange:(t,a)=>{for(let y=t,E=t+a;y<E;y++){AM(A,3*s.resolveTriangleIndex(y),h,u),A.a.applyMatrix4(r),A.b.applyMatrix4(r),A.c.applyMatrix4(r),A.needsUpdate=!0;for(let t=n,r=n+i;t<r;t++){AM(d,3*e.resolveTriangleIndex(t),c,l),d.needsUpdate=!0;let r=d.distanceToTriangle(A,A8,f);if(r<m&&(A7.copy(A8),p&&p.copy(f),m=r,g=t,v=y),r<o)return!0}}}})}{let a=dY(t);for(let t=0;t<a;t++){AM(A,3*t,h,u),A.a.applyMatrix4(r),A.b.applyMatrix4(r),A.c.applyMatrix4(r),A.needsUpdate=!0;for(let r=n,a=n+i;r<a;r++){AM(d,3*e.resolveTriangleIndex(r),c,l),d.needsUpdate=!0;let n=d.distanceToTriangle(A,A8,f);if(n<m&&(A7.copy(A8),p&&p.copy(f),m=n,g=r,v=t),n<o)return!0}}}}}),Au.releasePrimitive(d),Au.releasePrimitive(A),m===1/0)?null:(n.point?n.point.copy(A7):n.point=A7.clone(),n.distance=m,n.faceIndex=g,i&&(i.point?i.point.copy(p):i.point=p.clone(),i.point.applyMatrix4(A5),A7.applyMatrix4(A5),i.distance=A7.sub(i.point).length(),i.faceIndex=v),n)}:function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1/0;t.boundingBox||t.computeBoundingBox(),Az.set(t.boundingBox.min,t.boundingBox.max,r),Az.needsUpdate=!0;let s=e.geometry,l=s.attributes.position,c=s.index,u=t.attributes.position,h=t.index,d=Au.getPrimitive(),A=Au.getPrimitive(),f=null,p=null;i&&(f=AJ,p=AY);let m=1/0,g=null,v=null;return(AN.copy(r).invert(),AH.matrix.copy(AN),e.shapecast({boundsTraverseOrder:e=>Az.distanceToBox(e),intersectsBounds:(e,t,r)=>r<m&&r<a&&(t&&(AH.min.copy(e.min),AH.max.copy(e.max),AH.needsUpdate=!0),!0),intersectsRange:(e,n)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:e=>AH.distanceToBox(e),intersectsBounds:(e,t,r)=>r<m&&r<a,intersectsRange:(t,i)=>{for(let a=t,s=t+i;a<s;a++){AM(A,3*a,h,u),A.a.applyMatrix4(r),A.b.applyMatrix4(r),A.c.applyMatrix4(r),A.needsUpdate=!0;for(let t=e,r=e+n;t<r;t++){AM(d,3*t,c,l),d.needsUpdate=!0;let e=d.distanceToTriangle(A,AV,f);if(e<m&&(Aj.copy(AV),p&&p.copy(f),m=e,g=t,v=a),e<o)return!0}}}});{let i=dY(t);for(let t=0;t<i;t++){AM(A,3*t,h,u),A.a.applyMatrix4(r),A.b.applyMatrix4(r),A.c.applyMatrix4(r),A.needsUpdate=!0;for(let r=e,i=e+n;r<i;r++){AM(d,3*r,c,l),d.needsUpdate=!0;let e=d.distanceToTriangle(A,AV,f);if(e<m&&(Aj.copy(AV),p&&p.copy(f),m=e,g=r,v=t),e<o)return!0}}}}}),Au.releasePrimitive(d),Au.releasePrimitive(A),m===1/0)?null:(n.point?n.point.copy(Aj):n.point=Aj.clone(),n.distance=m,n.faceIndex=g,i&&(i.point?i.point.copy(p):i.point=p.clone(),i.point.applyMatrix4(AN),Aj.applyMatrix4(AN),i.distance=Aj.sub(i.point).length(),i.faceIndex=v),n)})(this,e,t,r,n,i,o)}closestPointToPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,o=n*n,a=i*i,s=1/0,l=null;if(e.shapecast({boundsTraverseOrder:e=>(Ap.copy(t).clamp(e.min,e.max),Ap.distanceToSquared(t)),intersectsBounds:(e,t,r)=>r<s&&r<a,intersectsTriangle:(e,r)=>{e.closestPointToPoint(t,Ap);let n=t.distanceToSquared(Ap);return n<s&&(Am.copy(Ap),s=n,l=r),n<o}}),s===1/0)return null;let c=Math.sqrt(s);return r.point?r.point.copy(Am):r.point=Am.clone(),r.distance=c,r.faceIndex=l,r}(this,e,t,r,n)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{dZ(0,new Float32Array(t),fh),e.union(fh)}),e}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw Error("MeshBVH: Only BufferGeometries are supported.");if((t=Object.assign({...fd,[dV]:!1},t)).useSharedArrayBuffer&&!("undefined"!=typeof SharedArrayBuffer))throw Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[dV]||(function(e,t){let r=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){let r=(e.index?e.index.count:e.attributes.position.count)/3,n=r>65536,i=n?4:2,o=t?new SharedArrayBuffer(r*i):new ArrayBuffer(r*i),a=n?new Uint32Array(o):new Uint16Array(o);for(let e=0,t=a.length;e<t;e++)a[e]=e;return a}(r,t.useSharedArrayBuffer),function(e){if(0===e.groups.length)return!1;let t=dY(e),r=dK(e).sort((e,t)=>e.offset-t.offset),n=r[r.length-1];n.count=Math.min(t-n.offset,n.count);let i=0;return r.forEach(e=>{let{count:t}=e;return i+=t}),t!==i}(r)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||function(e,t){if(!e.index){let r=e.attributes.position.count,n=dW(r,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new eR.BufferAttribute(n,1));for(let e=0;e<r;e++)n[e]=e}}(r,t);let n=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=function(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.attributes.position,a=e.index?e.index.array:null,s=dY(e),l=o.normalized;null===r?(t=new Float32Array(24*s),n=0,i=s):(t=r,n=n||0,i=i||s);let c=o.array,u=o.offset||0,h=3;o.isInterleavedBufferAttribute&&(h=o.data.stride);let d=["getX","getY","getZ"];for(let e=n;e<n+i;e++){let r=3*e,n=6*e,i=r+0,s=r+1,A=r+2;a&&(i=a[i],s=a[s],A=a[A]),l||(i=i*h+u,s=s*h+u,A=A*h+u);for(let e=0;e<3;e++){let r,a,u;l?(r=o[d[e]](i),a=o[d[e]](s),u=o[d[e]](A)):(r=c[i+e],a=c[s+e],u=c[A+e]);let h=r;a<h&&(h=a),u<h&&(h=u);let f=r;a>f&&(f=a),u>f&&(f=u);let p=(f-h)/2,m=2*e;t[n+m+0]=h+p,t[n+m+1]=p+(Math.abs(h)+p)*5960464477539063e-23}}return t}(r),o=t.indirect?dq(r):dK(r);e._roots=o.map(r=>{let o=function(e,t,r,n,i){let{maxDepth:o,verbose:a,maxLeafTris:s,strategy:l,onProgress:c,indirect:u}=i,h=e._indirectBuffer,d=e.geometry,A=d.index?d.index.array:null,f=u?d8:d6,p=dY(d),m=new Float32Array(6),g=!1,v=new d9;return dX(t,r,n,v.boundingData,m),function e(r,n,i){let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(!g&&u>=o&&(g=!0,a&&(console.warn("MeshBVH: Max depth of ".concat(o," reached when generating BVH. Consider increasing maxDepth.")),console.warn(d))),i<=s||u>=o)return y(n+i),r.offset=n,r.count=i,r;let p=function(e,t,r,n,i,o){let a=-1,s=0;if(0===o)-1!==(a=d$(t))&&(s=(t[a]+t[a+3])/2);else if(1===o)-1!==(a=d$(e))&&(s=function(e,t,r,n){let i=0;for(let o=t,a=t+r;o<a;o++)i+=e[6*o+2*n];return i/r}(r,n,i,a));else if(2===o){let o=d2(e),l=1.25*i,c=6*n,u=(n+i)*6;for(let e=0;e<3;e++){let n=t[e],h=(t[e+3]-n)/32;if(i<8){let t=[...d4];t.length=i;let n=0;for(let i=c;i<u;i+=6,n++){let o=t[n];o.candidate=r[i+2*e],o.count=0;let{bounds:a,leftCacheBounds:s,rightCacheBounds:l}=o;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,s[e]=1/0,s[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0;d1(i,r,a)}t.sort(d3);let h=i;for(let e=0;e<h;e++){let r=t[e];for(;e+1<h&&t[e+1].candidate===r.candidate;)t.splice(e+1,1),h--}for(let n=c;n<u;n+=6){let i=r[n+2*e];for(let e=0;e<h;e++){let o=t[e];i>=o.candidate?d1(n,r,o.rightCacheBounds):(d1(n,r,o.leftCacheBounds),o.count++)}}for(let r=0;r<h;r++){let n=t[r],c=n.count,u=i-n.count,h=n.leftCacheBounds,d=n.rightCacheBounds,A=0;0!==c&&(A=d2(h)/o);let f=0;0!==u&&(f=d2(d)/o);let p=1+1.25*(A*c+f*u);p<l&&(a=e,l=p,s=n.candidate)}}else{for(let e=0;e<32;e++){let t=d4[e];t.count=0,t.candidate=n+h+e*h;let r=t.bounds;for(let e=0;e<3;e++)r[e]=1/0,r[e+3]=-1/0}for(let t=c;t<u;t+=6){let i=~~((r[t+2*e]-n)/h);i>=32&&(i=31);let o=d4[i];o.count++,d1(t,r,o.bounds)}let t=d4[31];!function(e,t){t.set(e)}(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){let t=d4[e],r=d4[e+1];d0(t.bounds,r.rightCacheBounds,t.rightCacheBounds)}let d=0;for(let t=0;t<31;t++){let r=d4[t],n=r.count,c=r.bounds,u=d4[t+1].rightCacheBounds;0!==n&&(0===d?function(e,t){t.set(e)}(c,d5):d0(c,d5,d5));let h=0,A=0;0!==(d+=n)&&(h=d2(d5)/o);let f=i-d;0!==f&&(A=d2(u)/o);let p=1+1.25*(h*d+A*f);p<l&&(a=e,l=p,s=r.candidate)}}}}else console.warn("MeshBVH: Invalid build strategy value ".concat(o," used."));return{axis:a,pos:s}}(r.boundingData,c,t,n,i,l);if(-1===p.axis)return y(n+i),r.offset=n,r.count=i,r;let v=f(h,A,t,n,i,p);if(v===n||v===n+i)y(n+i),r.offset=n,r.count=i;else{r.splitAxis=p.axis;let o=new d9,a=v-n;r.left=o,dX(t,n,a,o.boundingData,m),e(o,n,a,m,u+1);let s=new d9,l=i-a;r.right=s,dX(t,v,l,s.boundingData,m),e(s,v,l,m,u+1)}return r}(v,r,n,m),v;function y(e){c&&c(e/p)}}(e,i,r.offset,r.count,t),a=new n(32*function e(t){return"count"in t?1:1+e(t.left)+e(t.right)}(o));return k=new Float32Array(a),U=new Uint32Array(a),G=new Uint16Array(a),N=new Uint8Array(a),function e(t,r){let n=t/4,i=t/2,o=r.boundingData;for(let e=0;e<6;e++)k[n+e]=o[e];if("count"in r){if(r.buffer){let e=r.buffer;N.set(new Uint8Array(e),t);for(let r=t,i=t+e.byteLength;r<i;r+=32)d7(r/2,G)||(U[r/4+6]+=n);return t+e.byteLength}{let e=r.offset,o=r.count;return U[n+6]=e,G[i+14]=o,G[i+15]=65535,t+32}}{let i;let o=r.left,a=r.right,s=r.splitAxis;if((i=e(t+32,o))/4>4294967296)throw Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return U[n+6]=i/4,i=e(i,a),U[n+7]=s,i}}(0,o),a})}(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new eR.Box3))),this.resolveTriangleIndex=t.indirect?e=>this._indirectBuffer[e]:e=>e}}let ff=new eR.Ray,fp=new eR.Vector3,fm=new eR.Matrix4,fg=eR.Mesh.prototype.raycast,fv=new eR.Vector3;function fy(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;fm.copy(this.matrixWorld).invert(),ff.copy(e.ray).applyMatrix4(fm),function(e,t){let r=e.elements,n=t.set(r[0],r[1],r[2]).length(),i=t.set(r[4],r[5],r[6]).length(),o=t.set(r[8],r[9],r[10]).length();t.set(n,i,o)}(this.matrixWorld,fv),fp.copy(ff.direction).multiply(fv);let r=fp.length(),n=e.near/r,i=e.far/r,o=this.geometry.boundsTree;if(!0===e.firstHitOnly){let r=dj(o.raycastFirst(ff,this.material,n,i),this,e);r&&t.push(r)}else{let r=o.raycast(ff,this.material,n,i);for(let n=0,i=r.length;n<i;n++){let i=dj(r[n],this,e);i&&t.push(i)}}}else fg.call(this,e,t)}function fE(e){return this.boundsTree=new fA(this,e),this.boundsTree}function fC(){this.boundsTree=null}let fw=e=>e.isMesh;function fB(e,t){t={strategy:2,verbose:!1,setBoundingBox:!0,maxDepth:40,maxLeafTris:10,indirect:!1,...t},eT.useEffect(()=>{if(e.current){e.current.raycast=fy;let r=e.current.geometry;return r.computeBoundsTree=fE,r.disposeBoundsTree=fC,r.computeBoundsTree(t),()=>{r.boundsTree&&r.disposeBoundsTree()}}},[e,JSON.stringify(t)])}let fx=eT.forwardRef((e,t)=>{let{enabled:r=!0,firstHitOnly:n=!1,children:i,strategy:o=2,verbose:a=!1,setBoundingBox:s=!0,maxDepth:l=40,maxLeafTris:c=10,indirect:u=!1,...h}=e,d=eT.useRef(null),A=(0,eP.A)(e=>e.raycaster);return eT.useImperativeHandle(t,()=>d.current,[]),eT.useEffect(()=>{if(r){let e={strategy:o,verbose:a,setBoundingBox:s,maxDepth:l,maxLeafTris:c,indirect:u},t=d.current;return A.firstHitOnly=n,t.traverse(t=>{fw(t)&&!t.geometry.boundsTree&&t.raycast===eR.Mesh.prototype.raycast&&(t.raycast=fy,t.geometry.computeBoundsTree=fE,t.geometry.disposeBoundsTree=fC,t.geometry.computeBoundsTree(e))}),()=>{delete A.firstHitOnly,t.traverse(e=>{fw(e)&&e.geometry.boundsTree&&(e.geometry.disposeBoundsTree(),e.raycast=eR.Mesh.prototype.raycast)})}}},[]),eT.createElement("group",(0,eS.Z)({ref:d},h),i)});function fI(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let n=eT.useRef([]);return n.current=t.map(e=>eT.useContext(e)),eT.useMemo(()=>e=>{let{children:r}=e;return t.reduceRight((e,t,r)=>eT.createElement(t.Provider,{value:n.current[r],children:e}),r)},[])}function fb(e,t){let r=eT.useRef(),[n]=eT.useState(()=>t?t instanceof eR.Object3D?{current:t}:t:r),[i]=eT.useState(()=>new eR.AnimationMixer(void 0));eT.useLayoutEffect(()=>{t&&(n.current=t instanceof eR.Object3D?t:t.current),i._root=n.current});let o=eT.useRef({}),a=eT.useMemo(()=>{let t={};return e.forEach(e=>Object.defineProperty(t,e.name,{enumerable:!0,get(){if(n.current)return o.current[e.name]||(o.current[e.name]=i.clipAction(e,n.current))},configurable:!0})),{ref:n,clips:e,actions:t,names:e.map(e=>e.name),mixer:i}},[e]);return(0,eP.C)((e,t)=>i.update(t)),eT.useEffect(()=>{let e=n.current;return()=>{o.current={},i.stopAllAction(),Object.values(a.actions).forEach(t=>{e&&i.uncacheAction(t,e)})}},[e]),a}function f_(e){let t=eT.useRef(null),r=eT.useRef(!1),n=eT.useRef(!1),i=eT.useRef(e);return eT.useLayoutEffect(()=>void(i.current=e),[e]),eT.useEffect(()=>{let e=t.current;if(e){let t=(0,eP.n)(()=>(r.current=!1,!0)),o=e.onBeforeRender;e.onBeforeRender=()=>r.current=!0;let a=(0,eP.o)(()=>(r.current!==n.current&&(null==i.current||i.current(n.current=r.current)),!0));return()=>{e.onBeforeRender=o,t(),a()}}},[]),t}function fM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new eR.Vector3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eR.Vector3,[r]=eT.useState(()=>({position:new eR.Vector3,size:new eR.Vector3}));(0,eP.j)(r,{position:e,size:t});let n=eT.useRef(null),i=eT.useMemo(()=>({ref:n,onBeforeCompile:e=>{var t,n;return t=r.position,n=r.size,void(e.defines.BOX_PROJECTED_ENV_MAP=!0,e.uniforms.envMapPosition={value:t},e.uniforms.envMapSize={value:n},e.vertexShader="\n  varying vec3 vWorldPosition;\n  ".concat(e.vertexShader.replace("#include <worldpos_vertex>","\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n  vec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n  #ifdef BOX_PROJECTED_ENV_MAP\n    vWorldPosition = worldPosition.xyz;\n  #endif\n#endif\n")),e.fragmentShader="\n    ".concat("\n#ifdef BOX_PROJECTED_ENV_MAP\n  uniform vec3 envMapSize;\n  uniform vec3 envMapPosition;\n  varying vec3 vWorldPosition;\n    \n  vec3 parallaxCorrectNormal( vec3 v, vec3 cubeSize, vec3 cubePos ) {\n    vec3 nDir = normalize( v );\n    vec3 rbmax = ( .5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbmin = ( -.5 * cubeSize + cubePos - vWorldPosition ) / nDir;\n    vec3 rbminmax;\n    rbminmax.x = ( nDir.x > 0. ) ? rbmax.x : rbmin.x;\n    rbminmax.y = ( nDir.y > 0. ) ? rbmax.y : rbmin.y;\n    rbminmax.z = ( nDir.z > 0. ) ? rbmax.z : rbmin.z;\n    float correction = min( min( rbminmax.x, rbminmax.y ), rbminmax.z );\n    vec3 boxIntersection = vWorldPosition + nDir * correction;    \n    return boxIntersection - cubePos;\n  }\n#endif\n","\n    ").concat(e.fragmentShader.replace("#include <envmap_physical_pars_fragment>",eR.ShaderChunk.envmap_physical_pars_fragment).replace("vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n         ".concat("\n#ifdef BOX_PROJECTED_ENV_MAP\n  worldNormal = parallaxCorrectNormal( worldNormal, envMapSize, envMapPosition );\n#endif\n","\n         ")).replace("reflectVec = inverseTransformDirection( reflectVec, viewMatrix );","reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n         ".concat("\n#ifdef BOX_PROJECTED_ENV_MAP\n  reflectVec = parallaxCorrectNormal( reflectVec, envMapSize, envMapPosition );\n#endif\n","\n        "))))},customProgramCacheKey:()=>JSON.stringify(r.position.toArray())+JSON.stringify(r.size.toArray())}),[...r.position.toArray(),...r.size.toArray()]);return eT.useLayoutEffect(()=>void(n.current.needsUpdate=!0),[r]),i}let fS=new eR.Box3,fT=new eR.Vector3,fD=e=>{let{anchor:t,...r}=e,n=eT.useRef(null),i=eT.useRef(null);return eT.useEffect(()=>{var e;null!=(e=n.current)&&null!=(e=e.parent)&&e.parent&&(i.current=n.current.parent,n.current.parent.parent.add(n.current))},[]),(0,eP.C)(()=>{i.current&&(fS.setFromObject(i.current),fS.getSize(fT),n.current.position.set(i.current.position.x+fT.x*(Array.isArray(t)?t[0]:t.x)/2,i.current.position.y+fT.y*(Array.isArray(t)?t[1]:t.y)/2,i.current.position.z+fT.z*(Array.isArray(t)?t[2]:t.z)/2))}),eT.createElement("group",(0,eS.Z)({ref:n},r))},fR=e=>Math.sqrt(1-Math.pow(e-1,2));class fP{initTexture(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=this.size;let e=this.canvas.getContext("2d");if(null===e)throw Error("2D not available");this.ctx=e,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.texture=new eR.Texture(this.canvas),this.canvas.id="touchTexture",this.canvas.style.width=this.canvas.style.height="".concat(this.canvas.width,"px")}update(e){this.clear(),this.trail.forEach((t,r)=>{t.age+=1e3*e,t.age>this.maxAge&&this.trail.splice(r,1)}),this.trail.length||(this.force=0),this.trail.forEach(e=>{this.drawTouch(e)}),this.texture.needsUpdate=!0}clear(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}addTouch(e){let t=this.trail[this.trail.length-1];if(t){let r=t.x-e.x,n=t.y-e.y,i=r*r+n*n,o=Math.max(this.minForce,Math.min(1e4*i,1));if(this.force=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9;return t*r+e*(1-r)}(o,this.force,this.smoothing),this.interpolate){let e=Math.ceil(i/Math.pow(.5*this.radius/this.interpolate,2));if(e>1)for(let i=1;i<e;i++)this.trail.push({x:t.x-r/e*i,y:t.y-n/e*i,age:0,force:o})}}this.trail.push({x:e.x,y:e.y,age:0,force:this.force})}drawTouch(e){let t={x:e.x*this.size,y:(1-e.y)*this.size},r=1;r=(e.age<.3*this.maxAge?this.ease(e.age/(.3*this.maxAge)):this.ease(1-(e.age-.3*this.maxAge)/(.7*this.maxAge)))*e.force,this.ctx.globalCompositeOperation=this.blend;let n=this.size*this.radius*r,i=this.ctx.createRadialGradient(t.x,t.y,Math.max(0,.25*n),t.x,t.y,Math.max(0,n));i.addColorStop(0,"rgba(255, 255, 255, ".concat(this.intensity,")")),i.addColorStop(1,"rgba(0, 0, 0, 0.0)"),this.ctx.beginPath(),this.ctx.fillStyle=i,this.ctx.arc(t.x,t.y,Math.max(0,n),0,2*Math.PI),this.ctx.fill()}constructor({size:e=256,maxAge:t=750,radius:r=.3,intensity:n=.2,interpolate:i=0,smoothing:o=0,minForce:a=.3,blend:s="screen",ease:l=fR}={}){this.size=e,this.maxAge=t,this.radius=r,this.intensity=n,this.ease=l,this.interpolate=i,this.smoothing=o,this.minForce=a,this.blend=s,this.trail=[],this.force=0,this.initTexture()}}function fF(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{size:t,maxAge:r,radius:n,intensity:i,interpolate:o,smoothing:a,minForce:s,blend:l,ease:c}=e,u=(0,eT.useMemo)(()=>new fP(e),[t,r,n,i,o,a,s,l,c]);(0,eP.C)((e,t)=>void u.update(t));let h=(0,eT.useCallback)(e=>u.addTouch(e.uv),[u]);return[u.texture,h]}let fQ=e=>{let{children:t,...r}=e,n=fF(r);return eT.createElement(eT.Fragment,null,null==t?void 0:t(n))},fO=eT.forwardRef(function(e,t){let{children:r,disable:n,disableX:i,disableY:o,disableZ:a,left:s,right:l,top:c,bottom:u,front:h,back:d,onCentered:A,precise:f=!0,cacheKey:p=0,...m}=e,g=eT.useRef(null),v=eT.useRef(null),y=eT.useRef(null);return eT.useLayoutEffect(()=>{v.current.matrixWorld.identity();let e=new eR.Box3().setFromObject(y.current,f),t=new eR.Vector3,r=new eR.Sphere,p=e.max.x-e.min.x,m=e.max.y-e.min.y,E=e.max.z-e.min.z;e.getCenter(t),e.getBoundingSphere(r);let C=c?m/2:u?-m/2:0,w=s?-p/2:l?p/2:0,B=h?E/2:d?-E/2:0;v.current.position.set(n||i?0:-t.x+w,n||o?0:-t.y+C,n||a?0:-t.z+B),void 0!==A&&A({parent:g.current.parent,container:g.current,width:p,height:m,depth:E,boundingBox:e,boundingSphere:r,center:t,verticalAlignment:C,horizontalAlignment:w,depthAlignment:B})},[p,A,c,s,h,n,i,o,a,f,l,u,d]),eT.useImperativeHandle(t,()=>g.current,[]),eT.createElement("group",(0,eS.Z)({ref:g},m),eT.createElement("group",{ref:v},eT.createElement("group",{ref:y},r)))}),fL=eT.forwardRef((e,t)=>{let{font:r,color:n="#cbcbcb",bevelSize:i=.04,debug:o=!1,children:a,...s}=e,[l,c]=eT.useState(0),u=eT.useCallback(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return c(l+e)},[l]),h=eT.useCallback(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return c(l-e)},[l]),d=eT.useMemo(()=>({incr:u,decr:h}),[u,h]);return eT.useImperativeHandle(t,()=>d,[d]),eT.createElement("group",s,eT.createElement(eT.Suspense,{fallback:null},eT.createElement(fO,{top:!0,cacheKey:JSON.stringify({counter:l,font:r})},eT.createElement(ab,{bevelEnabled:!0,bevelSize:i,font:r},o?eT.createElement("meshNormalMaterial",{wireframe:!0}):eT.createElement("meshStandardMaterial",{color:n}),l))),a)});var fk=r(4404),fU=r.n(fk);function fG(e){return function e(t,r,n){if(n=n||[],!r[0])return t(n);function i(i){return e(t,r.slice(1),n.concat([i]))}return"function"==typeof r[0]?r[0]({results:n,render:i}):(0,eT.cloneElement)(r[0],{children:i})}(e.children,e.components)}fG.propTypes={children:fU().func.isRequired,components:fU().arrayOf(fU().oneOfType([fU().element,fU().func])).isRequired};let fN=(e,t)=>{"updateRanges"in e?e.updateRanges[0]=t:e.updateRange=t},fz=new eR.Matrix4,fH=new eR.Matrix4,fV=[],fj=new eR.Mesh;class fJ extends eR.Group{get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){let r=this.instance.current;if(!r||!r.geometry||!r.material)return;fj.geometry=r.geometry;let n=r.matrixWorld,i=r.userData.instances.indexOf(this.instanceKey);if(-1!==i&&!(i>r.count)){r.getMatrixAt(i,fz),fH.multiplyMatrices(n,fz),fj.matrixWorld=fH,r.material instanceof eR.Material?fj.material.side=r.material.side:fj.material.side=r.material[0].side,fj.raycast(e,fV);for(let e=0,r=fV.length;e<r;e++){let r=fV[e];r.instanceId=i,r.object=this,t.push(r)}fV.length=0}}constructor(){super(),this.color=new eR.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}}let fY=eT.createContext(null),fW=new eR.Matrix4,fq=new eR.Matrix4,fK=new eR.Matrix4,fX=new eR.Vector3,fZ=new eR.Quaternion,f$=new eR.Vector3,f0=eT.forwardRef((e,t)=>{let{context:r,children:n,...i}=e;eT.useMemo(()=>(0,eP.e)({PositionMesh:fJ}),[]);let o=eT.useRef();eT.useImperativeHandle(t,()=>o.current,[]);let{subscribe:a,getParent:s}=eT.useContext(r||fY);return eT.useLayoutEffect(()=>a(o),[]),eT.createElement("positionMesh",(0,eS.Z)({instance:s(),instanceKey:o,ref:o},i),n)}),f1=eT.forwardRef((e,t)=>{let{children:r,range:n,limit:i=1e3,frames:o=1/0,...a}=e,[{context:s,instance:l}]=eT.useState(()=>{let e=eT.createContext(null);return{context:e,instance:eT.forwardRef((t,r)=>eT.createElement(f0,(0,eS.Z)({context:e},t,{ref:r})))}}),c=eT.useRef(null);eT.useImperativeHandle(t,()=>c.current,[]);let[u,h]=eT.useState([]),[[d,A]]=eT.useState(()=>{let e=new Float32Array(16*i);for(let t=0;t<i;t++)fK.identity().toArray(e,16*t);return[e,new Float32Array([...Array(3*i)].map(()=>1))]});eT.useEffect(()=>{c.current.instanceMatrix.needsUpdate=!0});let f=0,p=0;(0,eP.C)(()=>{if(o===1/0||f<o){c.current.updateMatrix(),c.current.updateMatrixWorld(),fW.copy(c.current.matrixWorld).invert(),p=Math.min(i,void 0!==n?n:i,u.length),c.current.count=p,fN(c.current.instanceMatrix,{offset:0,count:16*p}),fN(c.current.instanceColor,{offset:0,count:3*p});for(let e=0;e<u.length;e++){let t=u[e].current;t.matrixWorld.decompose(fX,fZ,f$),fq.compose(fX,fZ,f$).premultiply(fW),fq.toArray(d,16*e),c.current.instanceMatrix.needsUpdate=!0,t.color.toArray(A,3*e),c.current.instanceColor.needsUpdate=!0}f++}});let m=eT.useMemo(()=>({getParent:()=>c,subscribe:e=>(h(t=>[...t,e]),()=>h(t=>t.filter(t=>t.current!==e.current)))}),[]);return eT.createElement("instancedMesh",(0,eS.Z)({userData:{instances:u},matrixAutoUpdate:!1,ref:c,args:[null,null,0],raycast:()=>null},a),eT.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:d.length/16,array:d,itemSize:16,usage:eR.DynamicDrawUsage}),eT.createElement("instancedBufferAttribute",{attach:"instanceColor",count:A.length/3,array:A,itemSize:3,usage:eR.DynamicDrawUsage}),"function"==typeof r?eT.createElement(s.Provider,{value:m},r(l)):eT.createElement(fY.Provider,{value:m},r))}),f2=eT.forwardRef(function(e,t){let{meshes:r,children:n,...i}=e,o=Array.isArray(r);if(!o)for(let e of Object.keys(r))r[e].isMesh||delete r[e];return eT.createElement("group",{ref:t},eT.createElement(fG,{components:(o?r:Object.values(r)).map(e=>{let{geometry:t,material:r}=e;return eT.createElement(f1,(0,eS.Z)({key:t.uuid,geometry:t,material:r},i))})},e=>o?n(...e):n(Object.keys(r).filter(e=>r[e].isMesh).reduce((t,r,n)=>({...t,[r]:e[n]}),{}))))}),f3=eT.createContext(null);function f4(){return eT.useContext(f3)}let f5=eT.forwardRef((e,t)=>{var r,n;let i;let{startFrame:o,endFrame:a,fps:s,frameName:l,textureDataURL:c,textureImageURL:u,loop:h,numberOfFrames:d,autoPlay:A,animationNames:f,onStart:p,onEnd:m,onLoopEnd:g,onFrame:v,play:y,pause:E,flipX:C,alphaTest:w,children:B,asSprite:x,offset:I,playBackwards:b,resetOnEnd:_,maxItems:M,instanceItems:S,spriteDataset:T,...D}=e,R=eT.useRef(),P=eT.useRef(null),F=eT.useRef(),Q=eT.useRef(),O=eT.useRef(window.performance.now()),L=eT.useRef(o||0),k=eT.useRef(l||""),U=1e3/(s||30),[G,N]=eT.useState(new eR.Texture),z=eT.useRef(0),[H,V]=eT.useState([1,1,1]),j=C?-1:1,[J,Y]=eT.useState(null==x||x),W=eT.useRef(E),q=eT.useRef(I),K=eT.useRef(!1),X=eT.useRef([]),{spriteObj:Z,loadJsonAndTexture:$}=dy(null,null,f,d);function ee(){}let et=eT.useMemo(()=>({current:q.current,offset:q.current,imageUrl:u,reset:ee,hasEnded:!1,ref:t}),[u,T]);eT.useImperativeHandle(t,()=>R.current,[]),eT.useLayoutEffect(()=>{q.current=I},[I]);let er=(e,t)=>{let r=t/e;return Q.current&&Q.current.scale.set(1,r,1),[1,r,1]};eT.useEffect(()=>{if(T){var e;en(null==T||null==(e=T.spriteTexture)?void 0:e.clone(),T.spriteData)}else $(u,c)},[T]),eT.useEffect(()=>{if(Z){var e;en(null==Z||null==(e=Z.spriteTexture)?void 0:e.clone(),null==Z?void 0:Z.spriteData)}},[Z]),eT.useEffect(()=>{Y(null==x||x)},[x]),eT.useEffect(()=>{et.hasEnded=!1,P.current&&!0===b?L.current=P.current.frames.length-1:L.current=0},[b]),eT.useLayoutEffect(()=>{ei()},[G,C]),eT.useEffect(()=>{A&&(W.current=!1)},[A]),eT.useLayoutEffect(()=>{if(k.current!==l&&l&&(L.current=0,k.current=l,et.hasEnded=!1,P.current)){let{w:e,h:t}=es(P.current.frames).sourceSize;V(er(e,t))}},[l]);let en=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===t){if(d){let r=e.image.width,n=e.image.height;z.current=d,b&&(L.current=d-1),P.current={frames:[],meta:{version:"1.0",size:{w:r,h:n},scale:"1"}},P.current.frames=t}}else{P.current=t,z.current=P.current.frames.length,b&&(L.current=z.current-1);let{w:r,h:n}=es(P.current.frames).sourceSize;V(er(r,n)),F.current&&(F.current.map=e)}if(S)for(var r=0;r<S.length;r++){let e=Object.keys(P.current.frames),t=e[Math.floor(Math.random()*e.length)];X.current.push({key:r,frames:P.current.frames,selectedFrame:t,offset:{x:0,y:0}})}N(e)},ei=()=>{if(!P.current)return;let{meta:{size:e},frames:t}=P.current,{w:r,h:n}=Array.isArray(t)?t[0].sourceSize:l&&t[l]?t[l][0].sourceSize:{w:0,h:0};F.current.map.wrapS=F.current.map.wrapT=eR.RepeatWrapping,F.current.map.center.set(0,0),F.current.map.repeat.set(1*j/(e.w/r),1/(e.h/n));let i=(e.h-1)/n;F.current.map.offset.x=0,F.current.map.offset.y=1-1/i,p&&p({currentFrameName:l,currentFrame:L.current})},eo=()=>{let e=window.performance.now(),t=e-O.current,{meta:{size:r},frames:n}=P.current,{w:i,h:s}=es(n).sourceSize,c=Array.isArray(n)?n:l?n[l]:[],u=a||c.length-1;var d=void 0===I?et.current:I,A=b?L.current<0:L.current>u,f=b?L.current===u:0===L.current,v=b?L.current<0:L.current>=u;if(A){if(L.current=h&&null!=o?o:0,b&&(L.current=u),h?null==g||g({currentFrameName:l,currentFrame:L.current}):(null==m||m({currentFrameName:l,currentFrame:L.current}),et.hasEnded=!_,_&&(W.current=!0)),!h)return}else f&&(null==p||p({currentFrameName:l,currentFrame:L.current}));void 0!==d&&v?!1===K.current&&(null==m||m({currentFrameName:l,currentFrame:L.current}),K.current=!0):K.current=!1,t<=U||(O.current=e-t%U,ea(i,s,r,c))},ea=(e,t,r,n)=>{var i=void 0===I?et.current:I;let o=L.current,a=0,s=0;er(e,t);let l=Math.round((r.w-1)/e),c=Math.round((r.h-1)/t);if(!n[o])return;let{frame:{x:u,y:h},sourceSize:{w:d,h:A}}=n[o],f=1/l,p=1/c;if(a=j>0?u/d*f:u/d*f-F.current.map.repeat.x,s=Math.abs(1-p)-h/A*p,F.current.map.offset.x=a,F.current.map.offset.y=s,null!=i){let e=Math.floor(i*n.length);isNaN(e=Math.max(0,Math.min(e,n.length-1)))&&(e=0),L.current=e}else b?L.current-=1:L.current+=1};(0,eP.C)((e,t)=>{var r,n;null!=(r=P.current)&&r.frames&&null!=(n=F.current)&&n.map&&!W.current&&!et.hasEnded&&(A||y)&&(eo(),v&&v({currentFrameName:k.current,currentFrame:L.current}))});let es=e=>{if(Array.isArray(e))return e[0];if("object"!=typeof e||null===e)return{w:0,h:0};{let t=Object.keys(e);return l?e[l][0]:e[t[0]][0]}};return eT.createElement("group",(0,eS.Z)({},D,{ref:R,scale:(n=null!==(r=D.scale)&&void 0!==r?r:1,i=[],"number"==typeof n?i=[n,n,n]:Array.isArray(n)?i=n:n instanceof eR.Vector3&&(i=[n.x,n.y,n.z]),(null!=H?H:[1,1,1]).map((e,t)=>e*i[t]))}),eT.createElement(f3.Provider,{value:et},eT.createElement(eT.Suspense,{fallback:null},J&&eT.createElement("sprite",{ref:Q,scale:1},eT.createElement("spriteMaterial",{premultipliedAlpha:!1,toneMapped:!1,ref:F,map:G,transparent:!0,alphaTest:null!=w?w:0})),!J&&eT.createElement(f1,{limit:null!=M?M:1},eT.createElement("planeGeometry",{args:[1,1]}),eT.createElement("meshBasicMaterial",{premultipliedAlpha:!1,toneMapped:!1,side:eR.DoubleSide,ref:F,map:G,transparent:!0,alphaTest:null!=w?w:0}),(null!=S?S:[0]).map((e,t)=>eT.createElement(f0,{key:t,ref:(null==S?void 0:S.length)===1?Q:null,position:e,scale:1})))),B))});var f9=Object.defineProperty,f6=(e,t,r)=>t in e?f9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f8=(e,t,r)=>(f6(e,"symbol"!=typeof t?t+"":t,r),r);let f7=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=new Float32Array(4096*e*4),r=new eR.DataTexture(t,1024,4*e,eR.RGBAFormat,eR.FloatType);return r.wrapS=eR.RepeatWrapping,r.wrapT=eR.RepeatWrapping,r.magFilter=eR.NearestFilter,r.needsUpdate=!0,r},pe=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Math.floor(1024);t.arcLengthDivisions=n/2,t.updateArcLengths();let i=t.getSpacedPoints(n),o=t.computeFrenetFrames(n,!0);for(let t=0;t<n;t++){let n=Math.floor(t/1024),a=t%1024,s=i[t];pt(e,a,s.x,s.y,s.z,0+n+4*r),pt(e,a,(s=o.tangents[t]).x,s.y,s.z,1+n+4*r),pt(e,a,(s=o.normals[t]).x,s.y,s.z,2+n+4*r),pt(e,a,(s=o.binormals[t]).x,s.y,s.z,3+n+4*r)}e.needsUpdate=!0},pt=(e,t,r,n,i,o)=>{let{data:a}=e.image,s=4096*o;a[4*t+s+0]=r,a[4*t+s+1]=n,a[4*t+s+2]=i,a[4*t+s+3]=1},pr=e=>({spineTexture:{value:e},pathOffset:{type:"f",value:0},pathSegment:{type:"f",value:1},spineOffset:{type:"f",value:161},spineLength:{type:"f",value:400},flow:{type:"i",value:1}});class pn{updateCurve(e,t){if(e>=this.curveArray.length)throw Error("Index out of range for Flow");let r=t.getLength();this.uniforms.spineLength.value=r,this.curveLengthArray[e]=r,this.curveArray[e]=t,pe(this.splineTexure,t,e)}moveAlongCurve(e){this.uniforms.pathOffset.value+=e}constructor(e,t=1){f8(this,"curveArray"),f8(this,"curveLengthArray"),f8(this,"object3D"),f8(this,"splineTexure"),f8(this,"uniforms");let r=e.clone(),n=f7(t),i=pr(n);r.traverse(e=>{(e instanceof eR.Mesh||e instanceof eR.InstancedMesh)&&(e.material=e.material.clone(),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e.__ok||(e.__ok=!0,e.onBeforeCompile=e=>{if(e.__modified)return;e.__modified=!0,Object.assign(e.uniforms,t);let n="\n		uniform sampler2D spineTexture;\n		uniform float pathOffset;\n		uniform float pathSegment;\n		uniform float spineOffset;\n		uniform float spineLength;\n		uniform int flow;\n\n		float textureLayers = ".concat(4*r,".;\n		float textureStacks = ").concat(1,".;\n\n		").concat(e.vertexShader,"\n		").replace("#include <beginnormal_vertex>","").replace("#include <defaultnormal_vertex>","").replace("#include <begin_vertex>","").replace(/void\s*main\s*\(\)\s*\{/,"\n        void main() {\n        #include <beginnormal_vertex>\n\n        vec4 worldPos = modelMatrix * vec4(position, 1.);\n\n        bool bend = flow > 0;\n        float xWeight = bend ? 0. : 1.;\n\n        #ifdef USE_INSTANCING\n        float pathOffsetFromInstanceMatrix = instanceMatrix[3][2];\n        float spineLengthFromInstanceMatrix = instanceMatrix[3][0];\n        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLengthFromInstanceMatrix : 0.;\n        float mt = (spinePortion * pathSegment + pathOffset + pathOffsetFromInstanceMatrix)*textureStacks;\n        #else\n        float spinePortion = bend ? (worldPos.x + spineOffset) / spineLength : 0.;\n        float mt = (spinePortion * pathSegment + pathOffset)*textureStacks;\n        #endif\n\n        mt = mod(mt, textureStacks);\n        float rowOffset = floor(mt);\n\n        #ifdef USE_INSTANCING\n        rowOffset += instanceMatrix[3][1] * ".concat(4,".;\n        #endif\n\n        vec3 spinePos = texture2D(spineTexture, vec2(mt, (0. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 a =        texture2D(spineTexture, vec2(mt, (1. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 b =        texture2D(spineTexture, vec2(mt, (2. + rowOffset + 0.5) / textureLayers)).xyz;\n        vec3 c =        texture2D(spineTexture, vec2(mt, (3. + rowOffset + 0.5) / textureLayers)).xyz;\n        mat3 basis = mat3(a, b, c);\n\n        vec3 transformed = basis\n          * vec3(worldPos.x * xWeight, worldPos.y * 1., worldPos.z * 1.)\n          + spinePos;\n\n        vec3 transformedNormal = normalMatrix * (basis * objectNormal);\n			")).replace("#include <project_vertex>","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n				gl_Position = projectionMatrix * mvPosition;");e.vertexShader=n})}(e.material,i,t))}),this.curveArray=Array(t),this.curveLengthArray=Array(t),this.object3D=r,this.splineTexure=n,this.uniforms=i}}new eR.Matrix4;let pi=eT.forwardRef((e,t)=>{let{children:r,curve:n}=e,[i]=eT.useState(()=>new eR.Scene),[o,a]=eT.useState(),s=eT.useRef();return eT.useEffect(()=>{s.current=new pn(i.children[0]),a(s.current.object3D)},[r]),eT.useEffect(()=>{var e;n&&(null==(e=s.current)||e.updateCurve(0,n))},[n]),eT.useImperativeHandle(t,()=>({moveAlongCurve:e=>{var t;null==(t=s.current)||t.moveAlongCurve(e)}})),eT.createElement(eT.Fragment,null,(0,eP.g)(r,i),o&&eT.createElement("primitive",{object:o}))});class po extends eR.MeshPhysicalMaterial{onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.radius=this._radius,e.uniforms.distort=this._distort,e.vertexShader="\n      uniform float time;\n      uniform float radius;\n      uniform float distort;\n      ".concat("#define GLSLIFY 1\nvec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}","\n      ").concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","\n        float updateTime = time / 50.0;\n        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));\n        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));\n        ")}get time(){return this._time.value}set time(e){this._time.value=e}get distort(){return this._distort.value}set distort(e){this._distort.value=e}get radius(){return this._radius.value}set radius(e){this._radius.value=e}constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._distort={value:.4},this._radius={value:1}}}let pa=eT.forwardRef((e,t)=>{let{speed:r=1,...n}=e,[i]=eT.useState(()=>new po);return(0,eP.C)(e=>i&&(i.time=e.clock.getElapsedTime()*r)),eT.createElement("primitive",(0,eS.Z)({object:i,ref:t,attach:"material"},n))});class ps extends eR.MeshStandardMaterial{onBeforeCompile(e){e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader="\n      uniform float time;\n      uniform float factor;\n      ".concat(e.vertexShader,"\n    "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n        float c = cos( theta );\n        float s = sin( theta );\n        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n        vec3 transformed = vec3( position ) * m;\n        vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}constructor(e={}){super(e),this.setValues(e),this._time={value:0},this._factor={value:1}}}let pl=eT.forwardRef((e,t)=>{let{speed:r=1,...n}=e,[i]=eT.useState(()=>new ps);return(0,eP.C)(e=>i&&(i.time=e.clock.getElapsedTime()*r)),eT.createElement("primitive",(0,eS.Z)({object:i,ref:t,attach:"material"},n))});class pc extends eR.ShaderMaterial{setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setResolution(e){this.uniforms.resolution.value.copy(e)}constructor(e=new eR.Vector2){super({uniforms:{inputBuffer:new eR.Uniform(null),depthBuffer:new eR.Uniform(null),resolution:new eR.Uniform(new eR.Vector2),texelSize:new eR.Uniform(new eR.Vector2),halfTexelSize:new eR.Uniform(new eR.Vector2),kernel:new eR.Uniform(0),scale:new eR.Uniform(1),cameraNear:new eR.Uniform(0),cameraFar:new eR.Uniform(1),minDepthThreshold:new eR.Uniform(0),maxDepthThreshold:new eR.Uniform(1),depthScale:new eR.Uniform(0),depthToBlurRatioBias:new eR.Uniform(.25)},fragmentShader:"#include <common>\n        #include <dithering_pars_fragment>      \n        uniform sampler2D inputBuffer;\n        uniform sampler2D depthBuffer;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          float depthFactor = 0.0;\n          \n          #ifdef USE_DEPTH\n            vec4 depth = texture2D(depthBuffer, vUv);\n            depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n            depthFactor *= depthScale;\n            depthFactor = max(0.0, min(1.0, depthFactor + 0.25));\n          #endif\n          \n          vec4 sum = texture2D(inputBuffer, mix(vUv0, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv1, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv2, vUv, depthFactor));\n          sum += texture2D(inputBuffer, mix(vUv3, vUv, depthFactor));\n          gl_FragColor = sum * 0.25 ;\n\n          #include <dithering_fragment>\n          #include <tonemapping_fragment>\n          #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n        }"),vertexShader:"uniform vec2 texelSize;\n        uniform vec2 halfTexelSize;\n        uniform float kernel;\n        uniform float scale;\n        varying vec2 vUv;\n        varying vec2 vUv0;\n        varying vec2 vUv1;\n        varying vec2 vUv2;\n        varying vec2 vUv3;\n\n        void main() {\n          vec2 uv = position.xy * 0.5 + 0.5;\n          vUv = uv;\n\n          vec2 dUv = (texelSize * vec2(kernel) + halfTexelSize) * scale;\n          vUv0 = vec2(uv.x - dUv.x, uv.y + dUv.y);\n          vUv1 = vec2(uv.x + dUv.x, uv.y + dUv.y);\n          vUv2 = vec2(uv.x + dUv.x, uv.y - dUv.y);\n          vUv3 = vec2(uv.x - dUv.x, uv.y - dUv.y);\n\n          gl_Position = vec4(position.xy, 1.0, 1.0);\n        }",blending:eR.NoBlending,depthWrite:!1,depthTest:!1}),this.toneMapped=!1,this.setTexelSize(e.x,e.y),this.kernel=new Float32Array([0,1,2,2,3])}}class pu{render(e,t,r){let n,i,o;let a=this.scene,s=this.camera,l=this.renderTargetA,c=this.renderTargetB,u=this.convolutionMaterial,h=u.uniforms;h.depthBuffer.value=t.depthTexture;let d=u.kernel,A=t;for(i=0,o=d.length-1;i<o;++i)n=(1&i)==0?l:c,h.kernel.value=d[i],h.inputBuffer.value=A.texture,e.setRenderTarget(n),e.render(a,s),A=n;h.kernel.value=d[i],h.inputBuffer.value=A.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(a,s)}constructor({gl:e,resolution:t,width:r=500,height:n=500,minDepthThreshold:i=0,maxDepthThreshold:o=1,depthScale:a=0,depthToBlurRatioBias:s=.25}){this.renderToScreen=!1,this.renderTargetA=new eR.WebGLRenderTarget(t,t,{minFilter:eR.LinearFilter,magFilter:eR.LinearFilter,stencilBuffer:!1,depthBuffer:!1,type:eR.HalfFloatType}),this.renderTargetB=this.renderTargetA.clone(),this.convolutionMaterial=new pc,this.convolutionMaterial.setTexelSize(1/r,1/n),this.convolutionMaterial.setResolution(new eR.Vector2(r,n)),this.scene=new eR.Scene,this.camera=new eR.Camera,this.convolutionMaterial.uniforms.minDepthThreshold.value=i,this.convolutionMaterial.uniforms.maxDepthThreshold.value=o,this.convolutionMaterial.uniforms.depthScale.value=a,this.convolutionMaterial.uniforms.depthToBlurRatioBias.value=s,this.convolutionMaterial.defines.USE_DEPTH=a>0;let l=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),c=new Float32Array([0,0,2,0,0,2]),u=new eR.BufferGeometry;u.setAttribute("position",new eR.BufferAttribute(l,3)),u.setAttribute("uv",new eR.BufferAttribute(c,2)),this.screen=new eR.Mesh(u,this.convolutionMaterial),this.screen.frustumCulled=!1,this.scene.add(this.screen)}}class ph extends eR.MeshStandardMaterial{onBeforeCompile(e){var t;null!=(t=e.defines)&&t.USE_UV||(e.defines.USE_UV=""),e.uniforms.hasBlur=this._hasBlur,e.uniforms.tDiffuse=this._tDiffuse,e.uniforms.tDepth=this._tDepth,e.uniforms.distortionMap=this._distortionMap,e.uniforms.tDiffuseBlur=this._tDiffuseBlur,e.uniforms.textureMatrix=this._textureMatrix,e.uniforms.mirror=this._mirror,e.uniforms.mixBlur=this._mixBlur,e.uniforms.mixStrength=this._blurStrength,e.uniforms.minDepthThreshold=this._minDepthThreshold,e.uniforms.maxDepthThreshold=this._maxDepthThreshold,e.uniforms.depthScale=this._depthScale,e.uniforms.depthToBlurRatioBias=this._depthToBlurRatioBias,e.uniforms.distortion=this._distortion,e.uniforms.mixContrast=this._mixContrast,e.vertexShader="\n        uniform mat4 textureMatrix;\n        varying vec4 my_vUv;\n      ".concat(e.vertexShader),e.vertexShader=e.vertexShader.replace("#include <project_vertex>","#include <project_vertex>\n        my_vUv = textureMatrix * vec4( position, 1.0 );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"),e.fragmentShader="\n        uniform sampler2D tDiffuse;\n        uniform sampler2D tDiffuseBlur;\n        uniform sampler2D tDepth;\n        uniform sampler2D distortionMap;\n        uniform float distortion;\n        uniform float cameraNear;\n			  uniform float cameraFar;\n        uniform bool hasBlur;\n        uniform float mixBlur;\n        uniform float mirror;\n        uniform float mixStrength;\n        uniform float minDepthThreshold;\n        uniform float maxDepthThreshold;\n        uniform float mixContrast;\n        uniform float depthScale;\n        uniform float depthToBlurRatioBias;\n        varying vec4 my_vUv;\n        ".concat(e.fragmentShader),e.fragmentShader=e.fragmentShader.replace("#include <emissivemap_fragment>","#include <emissivemap_fragment>\n\n      float distortionFactor = 0.0;\n      #ifdef USE_DISTORTION\n        distortionFactor = texture2D(distortionMap, vUv).r * distortion;\n      #endif\n\n      vec4 new_vUv = my_vUv;\n      new_vUv.x += distortionFactor;\n      new_vUv.y += distortionFactor;\n\n      vec4 base = texture2DProj(tDiffuse, new_vUv);\n      vec4 blur = texture2DProj(tDiffuseBlur, new_vUv);\n\n      vec4 merge = base;\n\n      #ifdef USE_NORMALMAP\n        vec2 normal_uv = vec2(0.0);\n        vec4 normalColor = texture2D(normalMap, vUv * normalScale);\n        vec3 my_normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );\n        vec3 coord = new_vUv.xyz / new_vUv.w;\n        normal_uv = coord.xy + coord.z * my_normal.xz * 0.05;\n        vec4 base_normal = texture2D(tDiffuse, normal_uv);\n        vec4 blur_normal = texture2D(tDiffuseBlur, normal_uv);\n        merge = base_normal;\n        blur = blur_normal;\n      #endif\n\n      float depthFactor = 0.0001;\n      float blurFactor = 0.0;\n\n      #ifdef USE_DEPTH\n        vec4 depth = texture2DProj(tDepth, new_vUv);\n        depthFactor = smoothstep(minDepthThreshold, maxDepthThreshold, 1.0-(depth.r * depth.a));\n        depthFactor *= depthScale;\n        depthFactor = max(0.0001, min(1.0, depthFactor));\n\n        #ifdef USE_BLUR\n          blur = blur * min(1.0, depthFactor + depthToBlurRatioBias);\n          merge = merge * min(1.0, depthFactor + 0.5);\n        #else\n          merge = merge * depthFactor;\n        #endif\n\n      #endif\n\n      float reflectorRoughnessFactor = roughness;\n      #ifdef USE_ROUGHNESSMAP\n        vec4 reflectorTexelRoughness = texture2D( roughnessMap, vUv );\n        reflectorRoughnessFactor *= reflectorTexelRoughness.g;\n      #endif\n\n      #ifdef USE_BLUR\n        blurFactor = min(1.0, mixBlur * reflectorRoughnessFactor);\n        merge = mix(merge, blur, blurFactor);\n      #endif\n\n      vec4 newMerge = vec4(0.0, 0.0, 0.0, 1.0);\n      newMerge.r = (merge.r - 0.5) * mixContrast + 0.5;\n      newMerge.g = (merge.g - 0.5) * mixContrast + 0.5;\n      newMerge.b = (merge.b - 0.5) * mixContrast + 0.5;\n\n      diffuseColor.rgb = diffuseColor.rgb * ((1.0 - min(1.0, mirror)) + newMerge.rgb * mixStrength);\n      ")}get tDiffuse(){return this._tDiffuse.value}set tDiffuse(e){this._tDiffuse.value=e}get tDepth(){return this._tDepth.value}set tDepth(e){this._tDepth.value=e}get distortionMap(){return this._distortionMap.value}set distortionMap(e){this._distortionMap.value=e}get tDiffuseBlur(){return this._tDiffuseBlur.value}set tDiffuseBlur(e){this._tDiffuseBlur.value=e}get textureMatrix(){return this._textureMatrix.value}set textureMatrix(e){this._textureMatrix.value=e}get hasBlur(){return this._hasBlur.value}set hasBlur(e){this._hasBlur.value=e}get mirror(){return this._mirror.value}set mirror(e){this._mirror.value=e}get mixBlur(){return this._mixBlur.value}set mixBlur(e){this._mixBlur.value=e}get mixStrength(){return this._blurStrength.value}set mixStrength(e){this._blurStrength.value=e}get minDepthThreshold(){return this._minDepthThreshold.value}set minDepthThreshold(e){this._minDepthThreshold.value=e}get maxDepthThreshold(){return this._maxDepthThreshold.value}set maxDepthThreshold(e){this._maxDepthThreshold.value=e}get depthScale(){return this._depthScale.value}set depthScale(e){this._depthScale.value=e}get depthToBlurRatioBias(){return this._depthToBlurRatioBias.value}set depthToBlurRatioBias(e){this._depthToBlurRatioBias.value=e}get distortion(){return this._distortion.value}set distortion(e){this._distortion.value=e}get mixContrast(){return this._mixContrast.value}set mixContrast(e){this._mixContrast.value=e}constructor(e={}){super(e),this._tDepth={value:null},this._distortionMap={value:null},this._tDiffuse={value:null},this._tDiffuseBlur={value:null},this._textureMatrix={value:null},this._hasBlur={value:!1},this._mirror={value:0},this._mixBlur={value:0},this._blurStrength={value:.5},this._minDepthThreshold={value:.9},this._maxDepthThreshold={value:1},this._depthScale={value:0},this._depthToBlurRatioBias={value:.25},this._distortion={value:1},this._mixContrast={value:1},this.setValues(e)}}let pd=eT.forwardRef((e,t)=>{let{mixBlur:r=0,mixStrength:n=1,resolution:i=256,blur:o=[0,0],minDepthThreshold:a=.9,maxDepthThreshold:s=1,depthScale:l=0,depthToBlurRatioBias:c=.25,mirror:u=0,distortion:h=1,mixContrast:d=1,distortionMap:A,reflectorOffset:f=0,...p}=e;(0,eP.e)({MeshReflectorMaterialImpl:ph});let m=(0,eP.A)(e=>{let{gl:t}=e;return t}),g=(0,eP.A)(e=>{let{camera:t}=e;return t}),v=(0,eP.A)(e=>{let{scene:t}=e;return t}),y=(o=Array.isArray(o)?o:[o,o])[0]+o[1]>0,E=eT.useRef(null);eT.useImperativeHandle(t,()=>E.current,[]);let[C]=eT.useState(()=>new eR.Plane),[w]=eT.useState(()=>new eR.Vector3),[B]=eT.useState(()=>new eR.Vector3),[x]=eT.useState(()=>new eR.Vector3),[I]=eT.useState(()=>new eR.Matrix4),[b]=eT.useState(()=>new eR.Vector3(0,0,-1)),[_]=eT.useState(()=>new eR.Vector4),[M]=eT.useState(()=>new eR.Vector3),[S]=eT.useState(()=>new eR.Vector3),[T]=eT.useState(()=>new eR.Vector4),[D]=eT.useState(()=>new eR.Matrix4),[R]=eT.useState(()=>new eR.PerspectiveCamera),P=eT.useCallback(()=>{var e;let t=E.current.parent||(null==(e=E.current)?void 0:e.__r3f.parent);if(!t||(B.setFromMatrixPosition(t.matrixWorld),x.setFromMatrixPosition(g.matrixWorld),I.extractRotation(t.matrixWorld),w.set(0,0,1),w.applyMatrix4(I),B.addScaledVector(w,f),M.subVectors(B,x),M.dot(w)>0))return;M.reflect(w).negate(),M.add(B),I.extractRotation(g.matrixWorld),b.set(0,0,-1),b.applyMatrix4(I),b.add(x),S.subVectors(B,b),S.reflect(w).negate(),S.add(B),R.position.copy(M),R.up.set(0,1,0),R.up.applyMatrix4(I),R.up.reflect(w),R.lookAt(S),R.far=g.far,R.updateMatrixWorld(),R.projectionMatrix.copy(g.projectionMatrix),D.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),D.multiply(R.projectionMatrix),D.multiply(R.matrixWorldInverse),D.multiply(t.matrixWorld),C.setFromNormalAndCoplanarPoint(w,B),C.applyMatrix4(R.matrixWorldInverse),_.set(C.normal.x,C.normal.y,C.normal.z,C.constant);let r=R.projectionMatrix;T.x=(Math.sign(_.x)+r.elements[8])/r.elements[0],T.y=(Math.sign(_.y)+r.elements[9])/r.elements[5],T.z=-1,T.w=(1+r.elements[10])/r.elements[14],_.multiplyScalar(2/_.dot(T)),r.elements[2]=_.x,r.elements[6]=_.y,r.elements[10]=_.z+1,r.elements[14]=_.w},[g,f]),[F,Q,O,L]=eT.useMemo(()=>{let e={minFilter:eR.LinearFilter,magFilter:eR.LinearFilter,type:eR.HalfFloatType},t=new eR.WebGLRenderTarget(i,i,e);t.depthBuffer=!0,t.depthTexture=new eR.DepthTexture(i,i),t.depthTexture.format=eR.DepthFormat,t.depthTexture.type=eR.UnsignedShortType;let f=new eR.WebGLRenderTarget(i,i,e),p=new pu({gl:m,resolution:i,width:o[0],height:o[1],minDepthThreshold:a,maxDepthThreshold:s,depthScale:l,depthToBlurRatioBias:c}),g={mirror:u,textureMatrix:D,mixBlur:r,tDiffuse:t.texture,tDepth:t.depthTexture,tDiffuseBlur:f.texture,hasBlur:y,mixStrength:n,minDepthThreshold:a,maxDepthThreshold:s,depthScale:l,depthToBlurRatioBias:c,distortion:h,distortionMap:A,mixContrast:d,"defines-USE_BLUR":y?"":void 0,"defines-USE_DEPTH":l>0?"":void 0,"defines-USE_DISTORTION":A?"":void 0};return[t,f,p,g]},[m,o,D,i,u,y,r,n,a,s,l,c,h,A,d]);return(0,eP.C)(()=>{var e;let t=E.current.parent||(null==(e=E.current)?void 0:e.__r3f.parent);if(!t)return;t.visible=!1;let r=m.xr.enabled,n=m.shadowMap.autoUpdate;P(),m.xr.enabled=!1,m.shadowMap.autoUpdate=!1,m.setRenderTarget(F),m.state.buffers.depth.setMask(!0),m.autoClear||m.clear(),m.render(v,R),y&&O.render(m,F,Q),m.xr.enabled=r,m.shadowMap.autoUpdate=n,t.visible=!0,m.setRenderTarget(null)}),eT.createElement("meshReflectorMaterialImpl",(0,eS.Z)({attach:"material",key:"key"+L["defines-USE_BLUR"]+L["defines-USE_DEPTH"]+L["defines-USE_DISTORTION"],ref:E},L,p))});function pA(e){switch(e){case 1:return eR.RedIntegerFormat;case 2:return eR.RGIntegerFormat;case 3:case 4:return eR.RGBAIntegerFormat}}class pf extends eR.DataTexture{updateFrom(e){let t,r,n,i;let o=this.overrideItemSize,a=e.itemSize,s=e.count;if(null!==o){if(a*s%o!=0)throw Error("VertexAttributeTexture: overrideItemSize must divide evenly into buffer length.");e.itemSize=o,e.count=s*a/o}let l=e.itemSize,c=e.count,u=e.normalized,h=e.array.constructor,d=h.BYTES_PER_ELEMENT,A=this._forcedType,f=l;if(null===A)switch(h){case Float32Array:A=eR.FloatType;break;case Uint8Array:case Uint16Array:case Uint32Array:A=eR.UnsignedIntType;break;case Int8Array:case Int16Array:case Int32Array:A=eR.IntType}let p=function(e){switch(e){case 1:return"R";case 2:return"RG";case 3:case 4:return"RGBA"}throw Error()}(l);switch(A){case eR.FloatType:n=1,r=function(e){switch(e){case 1:return eR.RedFormat;case 2:return eR.RGFormat;case 3:case 4:return eR.RGBAFormat}}(l),u&&1===d?(i=h,p+="8",h===Uint8Array?t=eR.UnsignedByteType:(t=eR.ByteType,p+="_SNORM")):(i=Float32Array,p+="32F",t=eR.FloatType);break;case eR.IntType:p+=8*d+"I",n=u?Math.pow(2,8*h.BYTES_PER_ELEMENT-1):1,r=pA(l),1===d?(i=Int8Array,t=eR.ByteType):2===d?(i=Int16Array,t=eR.ShortType):(i=Int32Array,t=eR.IntType);break;case eR.UnsignedIntType:p+=8*d+"UI",n=u?Math.pow(2,8*h.BYTES_PER_ELEMENT-1):1,r=pA(l),1===d?(i=Uint8Array,t=eR.UnsignedByteType):2===d?(i=Uint16Array,t=eR.UnsignedShortType):(i=Uint32Array,t=eR.UnsignedIntType)}3===f&&(r===eR.RGBAFormat||r===eR.RGBAIntegerFormat)&&(f=4);let m=Math.ceil(Math.sqrt(c))||1,g=new i(f*m*m),v=e.normalized;e.normalized=!1;for(let t=0;t<c;t++){let r=f*t;g[r]=e.getX(t)/n,l>=2&&(g[r+1]=e.getY(t)/n),l>=3&&(g[r+2]=e.getZ(t)/n,4===f&&(g[r+3]=1)),l>=4&&(g[r+3]=e.getW(t)/n)}e.normalized=v,this.internalFormat=p,this.format=r,this.type=t,this.image.width=m,this.image.height=m,this.image.data=g,this.needsUpdate=!0,this.dispose(),e.itemSize=a,e.count=s}constructor(){super(),this.minFilter=eR.NearestFilter,this.magFilter=eR.NearestFilter,this.generateMipmaps=!1,this.overrideItemSize=null,this._forcedType=null}}class pp extends pf{constructor(){super(),this._forcedType=eR.UnsignedIntType}}class pm extends pf{constructor(){super(),this._forcedType=eR.FloatType}}class pg{updateFrom(e){let{geometry:t}=e;if(function(e,t,r){let n=e._roots;if(1!==n.length)throw Error("MeshBVHUniformStruct: Multi-root BVHs not supported.");let i=n[0],o=new Uint16Array(i),a=new Uint32Array(i),s=new Float32Array(i),l=i.byteLength/32,c=2*Math.ceil(Math.sqrt(l/2)),u=new Float32Array(4*c*c),h=Math.ceil(Math.sqrt(l)),d=new Uint32Array(2*h*h);for(let e=0;e<l;e++){let t=32*e/4,r=2*t;for(let r=0;r<3;r++)u[8*e+0+r]=s[t+0+r],u[8*e+4+r]=s[t+3+r];if(d7(r,o)){let n=Ae(r,o),i=a[t+6],s=4294901760|n;d[2*e+0]=s,d[2*e+1]=i}else{let r=4*a[t+6]/32,n=a[t+7];d[2*e+0]=n,d[2*e+1]=r}}t.image.data=u,t.image.width=c,t.image.height=c,t.format=eR.RGBAFormat,t.type=eR.FloatType,t.internalFormat="RGBA32F",t.minFilter=eR.NearestFilter,t.magFilter=eR.NearestFilter,t.generateMipmaps=!1,t.needsUpdate=!0,t.dispose(),r.image.data=d,r.image.width=h,r.image.height=h,r.format=eR.RGIntegerFormat,r.type=eR.UnsignedIntType,r.internalFormat="RG32UI",r.minFilter=eR.NearestFilter,r.magFilter=eR.NearestFilter,r.generateMipmaps=!1,r.needsUpdate=!0,r.dispose()}(e,this.bvhBounds,this.bvhContents),this.position.updateFrom(t.attributes.position),e.indirect){let r=e._indirectBuffer;if(null===this._cachedIndexAttr||this._cachedIndexAttr.count!==r.length){if(t.index)this._cachedIndexAttr=t.index.clone();else{let e=dW(dJ(t));this._cachedIndexAttr=new eR.BufferAttribute(e,1,!1)}}(function(e,t,r){let n=r.array,i=e.index?e.index.array:null;for(let e=0,r=t.length;e<r;e++){let r=3*e,o=3*t[e];for(let e=0;e<3;e++)n[r+e]=i?i[o+e]:o+e}})(t,r,this._cachedIndexAttr),this.index.updateFrom(this._cachedIndexAttr)}else this.index.updateFrom(t.index)}dispose(){let{index:e,position:t,bvhBounds:r,bvhContents:n}=this;e&&e.dispose(),t&&t.dispose(),r&&r.dispose(),n&&n.dispose()}constructor(){this.index=new pp,this.position=new pm,this.bvhBounds=new eR.DataTexture,this.bvhContents=new eR.DataTexture,this._cachedIndexAttr=null,this.index.overrideItemSize=3}}let pv="\n	".concat("\n\n// A stack of uint32 indices can can store the indices for\n// a perfectly balanced tree with a depth up to 31. Lower stack\n// depth gets higher performance.\n//\n// However not all trees are balanced. Best value to set this to\n// is the trees max depth.\n#ifndef BVH_STACK_DEPTH\n#define BVH_STACK_DEPTH 60\n#endif\n\n#ifndef INFINITY\n#define INFINITY 1e20\n#endif\n\n// Utilities\nuvec4 uTexelFetch1D( usampler2D tex, uint index ) {\n\n	uint width = uint( textureSize( tex, 0 ).x );\n	uvec2 uv;\n	uv.x = index % width;\n	uv.y = index / width;\n\n	return texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nivec4 iTexelFetch1D( isampler2D tex, uint index ) {\n\n	uint width = uint( textureSize( tex, 0 ).x );\n	uvec2 uv;\n	uv.x = index % width;\n	uv.y = index / width;\n\n	return texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nvec4 texelFetch1D( sampler2D tex, uint index ) {\n\n	uint width = uint( textureSize( tex, 0 ).x );\n	uvec2 uv;\n	uv.x = index % width;\n	uv.y = index / width;\n\n	return texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nvec4 textureSampleBarycoord( sampler2D tex, vec3 barycoord, uvec3 faceIndices ) {\n\n	return\n		barycoord.x * texelFetch1D( tex, faceIndices.x ) +\n		barycoord.y * texelFetch1D( tex, faceIndices.y ) +\n		barycoord.z * texelFetch1D( tex, faceIndices.z );\n\n}\n\nvoid ndcToCameraRay(\n	vec2 coord, mat4 cameraWorld, mat4 invProjectionMatrix,\n	out vec3 rayOrigin, out vec3 rayDirection\n) {\n\n	// get camera look direction and near plane for camera clipping\n	vec4 lookDirection = cameraWorld * vec4( 0.0, 0.0, - 1.0, 0.0 );\n	vec4 nearVector = invProjectionMatrix * vec4( 0.0, 0.0, - 1.0, 1.0 );\n	float near = abs( nearVector.z / nearVector.w );\n\n	// get the camera direction and position from camera matrices\n	vec4 origin = cameraWorld * vec4( 0.0, 0.0, 0.0, 1.0 );\n	vec4 direction = invProjectionMatrix * vec4( coord, 0.5, 1.0 );\n	direction /= direction.w;\n	direction = cameraWorld * direction - origin;\n\n	// slide the origin along the ray until it sits at the near clip plane position\n	origin.xyz += direction.xyz * near / dot( direction, lookDirection );\n\n	rayOrigin = origin.xyz;\n	rayDirection = direction.xyz;\n\n}\n","\n	").concat("\n\n#ifndef TRI_INTERSECT_EPSILON\n#define TRI_INTERSECT_EPSILON 1e-5\n#endif\n\n// Raycasting\nbool intersectsBounds( vec3 rayOrigin, vec3 rayDirection, vec3 boundsMin, vec3 boundsMax, out float dist ) {\n\n	// https://www.reddit.com/r/opengl/comments/8ntzz5/fast_glsl_ray_box_intersection/\n	// https://tavianator.com/2011/ray_box.html\n	vec3 invDir = 1.0 / rayDirection;\n\n	// find intersection distances for each plane\n	vec3 tMinPlane = invDir * ( boundsMin - rayOrigin );\n	vec3 tMaxPlane = invDir * ( boundsMax - rayOrigin );\n\n	// get the min and max distances from each intersection\n	vec3 tMinHit = min( tMaxPlane, tMinPlane );\n	vec3 tMaxHit = max( tMaxPlane, tMinPlane );\n\n	// get the furthest hit distance\n	vec2 t = max( tMinHit.xx, tMinHit.yz );\n	float t0 = max( t.x, t.y );\n\n	// get the minimum hit distance\n	t = min( tMaxHit.xx, tMaxHit.yz );\n	float t1 = min( t.x, t.y );\n\n	// set distance to 0.0 if the ray starts inside the box\n	dist = max( t0, 0.0 );\n\n	return t1 >= dist;\n\n}\n\nbool intersectsTriangle(\n	vec3 rayOrigin, vec3 rayDirection, vec3 a, vec3 b, vec3 c,\n	out vec3 barycoord, out vec3 norm, out float dist, out float side\n) {\n\n	// https://stackoverflow.com/questions/42740765/intersection-between-line-and-triangle-in-3d\n	vec3 edge1 = b - a;\n	vec3 edge2 = c - a;\n	norm = cross( edge1, edge2 );\n\n	float det = - dot( rayDirection, norm );\n	float invdet = 1.0 / det;\n\n	vec3 AO = rayOrigin - a;\n	vec3 DAO = cross( AO, rayDirection );\n\n	vec4 uvt;\n	uvt.x = dot( edge2, DAO ) * invdet;\n	uvt.y = - dot( edge1, DAO ) * invdet;\n	uvt.z = dot( AO, norm ) * invdet;\n	uvt.w = 1.0 - uvt.x - uvt.y;\n\n	// set the hit information\n	barycoord = uvt.wxy; // arranged in A, B, C order\n	dist = uvt.z;\n	side = sign( det );\n	norm = side * normalize( norm );\n\n	// add an epsilon to avoid misses between triangles\n	uvt += vec4( TRI_INTERSECT_EPSILON );\n\n	return all( greaterThanEqual( uvt, vec4( 0.0 ) ) );\n\n}\n\nbool intersectTriangles(\n	// geometry info and triangle range\n	sampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,\n\n	// ray\n	vec3 rayOrigin, vec3 rayDirection,\n\n	// outputs\n	inout float minDistance, inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,\n	inout float side, inout float dist\n) {\n\n	bool found = false;\n	vec3 localBarycoord, localNormal;\n	float localDist, localSide;\n	for ( uint i = offset, l = offset + count; i < l; i ++ ) {\n\n		uvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;\n		vec3 a = texelFetch1D( positionAttr, indices.x ).rgb;\n		vec3 b = texelFetch1D( positionAttr, indices.y ).rgb;\n		vec3 c = texelFetch1D( positionAttr, indices.z ).rgb;\n\n		if (\n			intersectsTriangle( rayOrigin, rayDirection, a, b, c, localBarycoord, localNormal, localDist, localSide )\n			&& localDist < minDistance\n		) {\n\n			found = true;\n			minDistance = localDist;\n\n			faceIndices = uvec4( indices.xyz, i );\n			faceNormal = localNormal;\n\n			side = localSide;\n			barycoord = localBarycoord;\n			dist = localDist;\n\n		}\n\n	}\n\n	return found;\n\n}\n\nbool intersectsBVHNodeBounds( vec3 rayOrigin, vec3 rayDirection, sampler2D bvhBounds, uint currNodeIndex, out float dist ) {\n\n	uint cni2 = currNodeIndex * 2u;\n	vec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;\n	vec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;\n	return intersectsBounds( rayOrigin, rayDirection, boundsMin, boundsMax, dist );\n\n}\n\n// use a macro to hide the fact that we need to expand the struct into separate fields\n#define	bvhIntersectFirstHit(		bvh,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)	_bvhIntersectFirstHit(		bvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,		rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist	)\n\nbool _bvhIntersectFirstHit(\n	// bvh info\n	sampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,\n\n	// ray\n	vec3 rayOrigin, vec3 rayDirection,\n\n	// output variables split into separate variables due to output precision\n	inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,\n	inout float side, inout float dist\n) {\n\n	// stack needs to be twice as long as the deepest tree we expect because\n	// we push both the left and right child onto the stack every traversal\n	int ptr = 0;\n	uint stack[ BVH_STACK_DEPTH ];\n	stack[ 0 ] = 0u;\n\n	float triangleDistance = INFINITY;\n	bool found = false;\n	while ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {\n\n		uint currNodeIndex = stack[ ptr ];\n		ptr --;\n\n		// check if we intersect the current bounds\n		float boundsHitDistance;\n		if (\n			! intersectsBVHNodeBounds( rayOrigin, rayDirection, bvh_bvhBounds, currNodeIndex, boundsHitDistance )\n			|| boundsHitDistance > triangleDistance\n		) {\n\n			continue;\n\n		}\n\n		uvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;\n		bool isLeaf = bool( boundsInfo.x & 0xffff0000u );\n\n		if ( isLeaf ) {\n\n			uint count = boundsInfo.x & 0x0000ffffu;\n			uint offset = boundsInfo.y;\n\n			found = intersectTriangles(\n				bvh_position, bvh_index, offset, count,\n				rayOrigin, rayDirection, triangleDistance,\n				faceIndices, faceNormal, barycoord, side, dist\n			) || found;\n\n		} else {\n\n			uint leftIndex = currNodeIndex + 1u;\n			uint splitAxis = boundsInfo.x & 0x0000ffffu;\n			uint rightIndex = boundsInfo.y;\n\n			bool leftToRight = rayDirection[ splitAxis ] >= 0.0;\n			uint c1 = leftToRight ? leftIndex : rightIndex;\n			uint c2 = leftToRight ? rightIndex : leftIndex;\n\n			// set c2 in the stack so we traverse it later. We need to keep track of a pointer in\n			// the stack while we traverse. The second pointer added is the one that will be\n			// traversed first\n			ptr ++;\n			stack[ ptr ] = c2;\n\n			ptr ++;\n			stack[ ptr ] = c1;\n\n		}\n\n	}\n\n	return found;\n\n}\n","\n"),py=a1({envMap:null,bounces:3,ior:2.4,correctMips:!0,aberrationStrength:.01,fresnel:0,bvh:new pg,color:new eR.Color("white"),resolution:new eR.Vector2,viewMatrixInverse:new eR.Matrix4,projectionMatrixInverse:new eR.Matrix4},"\n  uniform mat4 viewMatrixInverse;\n\n  varying vec3 vWorldPosition;  \n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #ifdef USE_INSTANCING_COLOR\n    varying vec3 vInstanceColor;\n  #endif\n\n  void main() {        \n    vec4 transformedNormal = vec4(normal, 0.0);\n    vec4 transformedPosition = vec4(position, 1.0);\n    #ifdef USE_INSTANCING\n      transformedNormal = instanceMatrix * transformedNormal;\n      transformedPosition = instanceMatrix * transformedPosition;\n    #endif\n\n    #ifdef USE_INSTANCING\n      vModelMatrixInverse = inverse(modelMatrix * instanceMatrix);\n    #else\n      vModelMatrixInverse = inverse(modelMatrix);\n    #endif\n\n    #ifdef USE_INSTANCING_COLOR\n      vInstanceColor = instanceColor.rgb;\n    #endif\n\n    vWorldPosition = (modelMatrix * transformedPosition).xyz;\n    vNormal = normalize((viewMatrixInverse * vec4(normalMatrix * transformedNormal.xyz, 0.0)).xyz);\n    gl_Position = projectionMatrix * viewMatrix * modelMatrix * transformedPosition;\n  }","\n  #define ENVMAP_TYPE_CUBE_UV\n  precision highp isampler2D;\n  precision highp usampler2D;\n  varying vec3 vWorldPosition;\n  varying vec3 vNormal;\n  varying mat4 vModelMatrixInverse;\n\n  #ifdef USE_INSTANCING_COLOR\n    varying vec3 vInstanceColor;\n  #endif\n    \n  #ifdef ENVMAP_TYPE_CUBEM\n    uniform samplerCube envMap;\n  #else\n    uniform sampler2D envMap;\n  #endif\n    \n  uniform float bounces;\n  ".concat("\nstruct BVH {\n\n	usampler2D index;\n	sampler2D position;\n\n	sampler2D bvhBounds;\n	usampler2D bvhContents;\n\n};\n","\n  ").concat(pv,"\n  uniform BVH bvh;\n  uniform float ior;\n  uniform bool correctMips;\n  uniform vec2 resolution;\n  uniform float fresnel;\n  uniform mat4 modelMatrix;\n  uniform mat4 projectionMatrixInverse;\n  uniform mat4 viewMatrixInverse;\n  uniform float aberrationStrength;\n  uniform vec3 color;\n  \n  float fresnelFunc(vec3 viewDirection, vec3 worldNormal) {\n    return pow( 1.0 + dot( viewDirection, worldNormal), 10.0 );\n  }\n    \n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 normal, float ior, mat4 modelMatrixInverse) {\n    vec3 rayOrigin = ro;\n    vec3 rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = vWorldPosition + rayDirection * 0.001;\n    rayOrigin = (modelMatrixInverse * vec4(rayOrigin, 1.0)).xyz;\n    rayDirection = normalize((modelMatrixInverse * vec4(rayDirection, 0.0)).xyz);\n    for(float i = 0.0; i < bounces; i++) {\n      uvec4 faceIndices = uvec4( 0u );\n      vec3 faceNormal = vec3( 0.0, 0.0, 1.0 );\n      vec3 barycoord = vec3( 0.0 );\n      float side = 1.0;\n      float dist = 0.0;\n      bvhIntersectFirstHit( bvh, rayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist );\n      vec3 hitPos = rayOrigin + rayDirection * max(dist - 0.001, 0.0);      \n      vec3 tempDir = refract(rayDirection, faceNormal, ior);\n      if (length(tempDir) != 0.0) {\n        rayDirection = tempDir;\n        break;\n      }\n      rayDirection = reflect(rayDirection, faceNormal);\n      rayOrigin = hitPos + rayDirection * 0.01;\n    }\n    rayDirection = normalize((modelMatrix * vec4(rayDirection, 0.0)).xyz);\n    return rayDirection;\n  }\n    \n  #include <common>\n  #include <cube_uv_reflection_fragment>\n    \n  #ifdef ENVMAP_TYPE_CUBEM\n    vec4 textureGradient(samplerCube envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      return textureGrad(envMap, rayDirection, dFdx(correctMips ? directionCamPerfect: rayDirection), dFdy(correctMips ? directionCamPerfect: rayDirection));\n    }\n  #else\n    vec4 textureGradient(sampler2D envMap, vec3 rayDirection, vec3 directionCamPerfect) {\n      vec2 uvv = equirectUv( rayDirection );\n      vec2 smoothUv = equirectUv( directionCamPerfect );\n      return textureGrad(envMap, uvv, dFdx(correctMips ? smoothUv : uvv), dFdy(correctMips ? smoothUv : uvv));\n    }\n  #endif\n  \n  void main() {\n    vec2 uv = gl_FragCoord.xy / resolution;\n    vec3 directionCamPerfect = (projectionMatrixInverse * vec4(uv * 2.0 - 1.0, 0.0, 1.0)).xyz;\n    directionCamPerfect = (viewMatrixInverse * vec4(directionCamPerfect, 0.0)).xyz;\n    directionCamPerfect = normalize(directionCamPerfect);\n    vec3 normal = vNormal;\n    vec3 rayOrigin = cameraPosition;\n    vec3 rayDirection = normalize(vWorldPosition - cameraPosition);\n    vec3 finalColor;\n    #ifdef CHROMATIC_ABERRATIONS\n      vec3 rayDirectionG = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      #ifdef FAST_CHROMA \n        vec3 rayDirectionR = normalize(rayDirectionG + 1.0 * vec3(aberrationStrength / 2.0));\n        vec3 rayDirectionB = normalize(rayDirectionG - 1.0 * vec3(aberrationStrength / 2.0));\n      #else\n        vec3 rayDirectionR = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 - aberrationStrength), 1.0), vModelMatrixInverse);\n        vec3 rayDirectionB = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior * (1.0 + aberrationStrength), 1.0), vModelMatrixInverse);\n      #endif\n      float finalColorR = textureGradient(envMap, rayDirectionR, directionCamPerfect).r;\n      float finalColorG = textureGradient(envMap, rayDirectionG, directionCamPerfect).g;\n      float finalColorB = textureGradient(envMap, rayDirectionB, directionCamPerfect).b;\n      finalColor = vec3(finalColorR, finalColorG, finalColorB);\n    #else\n      rayDirection = totalInternalReflection(rayOrigin, rayDirection, normal, max(ior, 1.0), vModelMatrixInverse);\n      finalColor = textureGradient(envMap, rayDirection, directionCamPerfect).rgb;    \n    #endif\n\n    finalColor *= color;\n    #ifdef USE_INSTANCING_COLOR\n      finalColor *= vInstanceColor;\n    #endif\n\n    vec3 viewDirection = normalize(vWorldPosition - cameraPosition);\n    float nFresnel = fresnelFunc(viewDirection, normal) * fresnel;\n    gl_FragColor = vec4(mix(finalColor, vec3(1.0), nFresnel), 1.0);      \n    #include <tonemapping_fragment>\n    #include <").concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n  }")),pE=e=>e&&e.isCubeTexture;function pC(e){let{aberrationStrength:t=0,fastChroma:r=!0,envMap:n,...i}=e;(0,eP.e)({MeshRefractionMaterial:py});let o=(0,eT.useRef)(),{size:a}=(0,eP.A)(),s=(0,eT.useMemo)(()=>{var e,i;let o={},a=pE(n),s=Math.floor(Math.log2((null!==(e=a?null==(i=n.image[0])?void 0:i.width:n.image.width)&&void 0!==e?e:1024)/4)),l=Math.pow(2,s);return a&&(o.ENVMAP_TYPE_CUBEM=""),o.CUBEUV_TEXEL_WIDTH="".concat(1/(3*Math.max(l,112))),o.CUBEUV_TEXEL_HEIGHT="".concat(1/(4*l)),o.CUBEUV_MAX_MIP="".concat(s,".0"),t>0&&(o.CHROMATIC_ABERRATIONS=""),r&&(o.FAST_CHROMA=""),o},[t,r]);return(0,eT.useLayoutEffect)(()=>{var e;let t=null==(e=o.current)||null==(e=e.__r3f)||null==(e=e.parent)?void 0:e.geometry;t&&(o.current.bvh=new pg,o.current.bvh.updateFrom(new fA(t.clone().toNonIndexed(),{lazyGeneration:!1,strategy:2})))},[]),(0,eP.C)(e=>{let{camera:t}=e;o.current.viewMatrixInverse=t.matrixWorld,o.current.projectionMatrixInverse=t.projectionMatrixInverse}),eT.createElement("meshRefractionMaterial",(0,eS.Z)({key:JSON.stringify(s),defines:s,ref:o,resolution:[a.width,a.height],aberrationStrength:t,envMap:n},i))}let pw=a1({},"void main() { }","void main() { gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0); discard;  }");class pB extends eR.MeshPhysicalMaterial{constructor(e=6,t=!1){super(),this.uniforms={chromaticAberration:{value:.05},transmission:{value:0},_transmission:{value:1},transmissionMap:{value:null},roughness:{value:0},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:1/0},attenuationColor:{value:new eR.Color("white")},anisotropicBlur:{value:.1},time:{value:0},distortion:{value:0},distortionScale:{value:.5},temporalDistortion:{value:0},buffer:{value:null}},this.onBeforeCompile=r=>{r.uniforms={...r.uniforms,...this.uniforms},this.anisotropy>0&&(r.defines.USE_ANISOTROPY=""),t?r.defines.USE_SAMPLER="":r.defines.USE_TRANSMISSION="",r.fragmentShader="\n      uniform float chromaticAberration;         \n      uniform float anisotropicBlur;      \n      uniform float time;\n      uniform float distortion;\n      uniform float distortionScale;\n      uniform float temporalDistortion;\n      uniform sampler2D buffer;\n\n      vec3 random3(vec3 c) {\n        float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n        vec3 r;\n        r.z = fract(512.0*j);\n        j *= .125;\n        r.x = fract(512.0*j);\n        j *= .125;\n        r.y = fract(512.0*j);\n        return r-0.5;\n      }\n\n      uint hash( uint x ) {\n        x += ( x << 10u );\n        x ^= ( x >>  6u );\n        x += ( x <<  3u );\n        x ^= ( x >> 11u );\n        x += ( x << 15u );\n        return x;\n      }\n\n      // Compound versions of the hashing algorithm I whipped together.\n      uint hash( uvec2 v ) { return hash( v.x ^ hash(v.y)                         ); }\n      uint hash( uvec3 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z)             ); }\n      uint hash( uvec4 v ) { return hash( v.x ^ hash(v.y) ^ hash(v.z) ^ hash(v.w) ); }\n\n      // Construct a float with half-open range [0:1] using low 23 bits.\n      // All zeroes yields 0.0, all ones yields the next smallest representable value below 1.0.\n      float floatConstruct( uint m ) {\n        const uint ieeeMantissa = 0x007FFFFFu; // binary32 mantissa bitmask\n        const uint ieeeOne      = 0x3F800000u; // 1.0 in IEEE binary32\n        m &= ieeeMantissa;                     // Keep only mantissa bits (fractional part)\n        m |= ieeeOne;                          // Add fractional part to 1.0\n        float  f = uintBitsToFloat( m );       // Range [1:2]\n        return f - 1.0;                        // Range [0:1]\n      }\n\n      // Pseudo-random value in half-open range [0:1].\n      float randomBase( float x ) { return floatConstruct(hash(floatBitsToUint(x))); }\n      float randomBase( vec2  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec3  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float randomBase( vec4  v ) { return floatConstruct(hash(floatBitsToUint(v))); }\n      float rand(float seed) {\n        float result = randomBase(vec3(gl_FragCoord.xy, seed));\n        return result;\n      }\n\n      const float F3 =  0.3333333;\n      const float G3 =  0.1666667;\n\n      float snoise(vec3 p) {\n        vec3 s = floor(p + dot(p, vec3(F3)));\n        vec3 x = p - s + dot(s, vec3(G3));\n        vec3 e = step(vec3(0.0), x - x.yzx);\n        vec3 i1 = e*(1.0 - e.zxy);\n        vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n        vec3 x1 = x - i1 + G3;\n        vec3 x2 = x - i2 + 2.0*G3;\n        vec3 x3 = x - 1.0 + 3.0*G3;\n        vec4 w, d;\n        w.x = dot(x, x);\n        w.y = dot(x1, x1);\n        w.z = dot(x2, x2);\n        w.w = dot(x3, x3);\n        w = max(0.6 - w, 0.0);\n        d.x = dot(random3(s), x);\n        d.y = dot(random3(s + i1), x1);\n        d.z = dot(random3(s + i2), x2);\n        d.w = dot(random3(s + 1.0), x3);\n        w *= w;\n        w *= w;\n        d *= w;\n        return dot(d, vec4(52.0));\n      }\n\n      float snoiseFractal(vec3 m) {\n        return 0.5333333* snoise(m)\n              +0.2666667* snoise(2.0*m)\n              +0.1333333* snoise(4.0*m)\n              +0.0666667* snoise(8.0*m);\n      }\n"+r.fragmentShader,r.fragmentShader=r.fragmentShader.replace("#include <transmission_pars_fragment>","\n        #ifdef USE_TRANSMISSION\n          // Transmission code is based on glTF-Sampler-Viewer\n          // https://github.com/KhronosGroup/glTF-Sample-Viewer\n          uniform float _transmission;\n          uniform float thickness;\n          uniform float attenuationDistance;\n          uniform vec3 attenuationColor;\n          #ifdef USE_TRANSMISSIONMAP\n            uniform sampler2D transmissionMap;\n          #endif\n          #ifdef USE_THICKNESSMAP\n            uniform sampler2D thicknessMap;\n          #endif\n          uniform vec2 transmissionSamplerSize;\n          uniform sampler2D transmissionSamplerMap;\n          uniform mat4 modelMatrix;\n          uniform mat4 projectionMatrix;\n          varying vec3 vWorldPosition;\n          vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n            // Direction of refracted light.\n            vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n            // Compute rotation-independant scaling of the model matrix.\n            vec3 modelScale;\n            modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n            modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n            modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n            // The thickness is specified in local space.\n            return normalize( refractionVector ) * thickness * modelScale;\n          }\n          float applyIorToRoughness( const in float roughness, const in float ior ) {\n            // Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n            // an IOR of 1.5 results in the default amount of microfacet refraction.\n            return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n          }\n          vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n            float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );            \n            #ifdef USE_SAMPLER\n              #ifdef texture2DLodEXT\n                return texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #else\n                return texture2D(transmissionSamplerMap, fragCoord.xy, framebufferLod);\n              #endif\n            #else\n              return texture2D(buffer, fragCoord.xy);\n            #endif\n          }\n          vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n            if ( isinf( attenuationDistance ) ) {\n              // Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.\n              return radiance;\n            } else {\n              // Compute light attenuation using Beer's law.\n              vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n              vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance ); // Beer's law\n              return transmittance * radiance;\n            }\n          }\n          vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n            const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n            const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n            const in vec3 attenuationColor, const in float attenuationDistance ) {\n            vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n            vec3 refractedRayExit = position + transmissionRay;\n            // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n            vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n            vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n            refractionCoords += 1.0;\n            refractionCoords /= 2.0;\n            // Sample framebuffer to get pixel the refracted ray hits.\n            vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n            vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n            // Get the specular component.\n            vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n            return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n          }\n        #endif\n"),r.fragmentShader=r.fragmentShader.replace("#include <transmission_fragment>","  \n        // Improve the refraction to use the world pos\n        material.transmission = _transmission;\n        material.transmissionAlpha = 1.0;\n        material.thickness = thickness;\n        material.attenuationDistance = attenuationDistance;\n        material.attenuationColor = attenuationColor;\n        #ifdef USE_TRANSMISSIONMAP\n          material.transmission *= texture2D( transmissionMap, vUv ).r;\n        #endif\n        #ifdef USE_THICKNESSMAP\n          material.thickness *= texture2D( thicknessMap, vUv ).g;\n        #endif\n        \n        vec3 pos = vWorldPosition;\n        float runningSeed = 0.0;\n        vec3 v = normalize( cameraPosition - pos );\n        vec3 n = inverseTransformDirection( normal, viewMatrix );\n        vec3 transmission = vec3(0.0);\n        float transmissionR, transmissionB, transmissionG;\n        float randomCoords = rand(runningSeed++);\n        float thickness_smear = thickness * max(pow(roughnessFactor, 0.33), anisotropicBlur);\n        vec3 distortionNormal = vec3(0.0);\n        vec3 temporalOffset = vec3(time, -time, -time) * temporalDistortion;\n        if (distortion > 0.0) {\n          distortionNormal = distortion * vec3(snoiseFractal(vec3((pos * distortionScale + temporalOffset))), snoiseFractal(vec3(pos.zxy * distortionScale - temporalOffset)), snoiseFractal(vec3(pos.yxz * distortionScale + temporalOffset)));\n        }\n        for (float i = 0.0; i < ".concat(e,".0; i ++) {\n          vec3 sampleNorm = normalize(n + roughnessFactor * roughnessFactor * 2.0 * normalize(vec3(rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5, rand(runningSeed++) - 0.5)) * pow(rand(runningSeed++), 0.33) + distortionNormal);\n          transmissionR = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness  + thickness_smear * (i + randomCoords) / float(").concat(e,"),\n            material.attenuationColor, material.attenuationDistance\n          ).r;\n          transmissionG = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior  * (1.0 + chromaticAberration * (i + randomCoords) / float(").concat(e,")) , material.thickness + thickness_smear * (i + randomCoords) / float(").concat(e,"),\n            material.attenuationColor, material.attenuationDistance\n          ).g;\n          transmissionB = getIBLVolumeRefraction(\n            sampleNorm, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n            pos, modelMatrix, viewMatrix, projectionMatrix, material.ior * (1.0 + 2.0 * chromaticAberration * (i + randomCoords) / float(").concat(e,")), material.thickness + thickness_smear * (i + randomCoords) / float(").concat(e,"),\n            material.attenuationColor, material.attenuationDistance\n          ).b;\n          transmission.r += transmissionR;\n          transmission.g += transmissionG;\n          transmission.b += transmissionB;\n        }\n        transmission /= ").concat(e,".0;\n        totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n"))},Object.keys(this.uniforms).forEach(e=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t}))}}let px=eT.forwardRef((e,t)=>{let r,n,i,o,{buffer:a,transmissionSampler:s=!1,backside:l=!1,side:c=eR.FrontSide,transmission:u=1,thickness:h=0,backsideThickness:d=0,backsideEnvMapIntensity:A=1,samples:f=10,resolution:p,backsideResolution:m,background:g,anisotropy:v,anisotropicBlur:y,...E}=e;(0,eP.e)({MeshTransmissionMaterial:pB});let C=eT.useRef(null),[w]=eT.useState(()=>new pw),B=lV(m||p),x=lV(p);return(0,eP.C)(e=>{C.current.time=e.clock.getElapsedTime(),C.current.buffer===x.texture&&!s&&(o=C.current.__r3f.parent)&&(i=e.gl.toneMapping,r=e.scene.background,n=C.current.envMapIntensity,e.gl.toneMapping=eR.NoToneMapping,g&&(e.scene.background=g),o.material=w,l&&(e.gl.setRenderTarget(B),e.gl.render(e.scene,e.camera),o.material=C.current,o.material.buffer=B.texture,o.material.thickness=d,o.material.side=eR.BackSide,o.material.envMapIntensity=A),e.gl.setRenderTarget(x),e.gl.render(e.scene,e.camera),o.material=C.current,o.material.thickness=h,o.material.side=c,o.material.buffer=x.texture,o.material.envMapIntensity=n,e.scene.background=r,e.gl.setRenderTarget(null),e.gl.toneMapping=i)}),eT.useImperativeHandle(t,()=>C.current,[]),eT.createElement("meshTransmissionMaterial",(0,eS.Z)({args:[f,s],ref:C},E,{buffer:a||x.texture,_transmission:u,anisotropicBlur:null!=y?y:v,transmission:s?u:0,thickness:h,side:c}))}),pI=eT.forwardRef((e,t)=>((0,eP.e)({DiscardMaterialImpl:pw}),eT.createElement("discardMaterialImpl",(0,eS.Z)({ref:t},e)))),pb=a5>=154?"opaque_fragment":"output_fragment";class p_ extends eR.PointsMaterial{constructor(e){super(e),this.onBeforeCompile=(e,t)=>{let{isWebGL2:r}=t.capabilities;e.fragmentShader=e.fragmentShader.replace("#include <".concat(pb,">"),"\n        ".concat(r?"#include <".concat(pb,">"):"#extension GL_OES_standard_derivatives : enable\n#include <".concat(pb,">"),"\n      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n      float r = dot(cxy, cxy);\n      float delta = fwidth(r);     \n      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );\n      #include <tonemapping_fragment>\n      #include <").concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n      "))}}}let pM=eT.forwardRef((e,t)=>{let[r]=eT.useState(()=>new p_(null));return eT.createElement("primitive",(0,eS.Z)({},e,{object:r,ref:t,attach:"material"}))}),pS=function(){let{focus:e=0,size:t=25,samples:r=10}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"\n#define PENUMBRA_FILTER_SIZE float(".concat(t,")\n#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))\nvec3 randRGB(vec2 uv) {\n  return vec3(\n    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),\n    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),\n    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)\n  );\n}\n\nvec3 lowPassRandRGB(vec2 uv) {\n  // 3x3 convolution (average)\n  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9\n  vec3 result = vec3(0);\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));\n  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));\n  result *= 0.111111111; // 1.0 / 9.0\n  return result;\n}\nvec3 highPassRandRGB(vec2 uv) {\n  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal\n  // hp(x) = x - lp(x)\n  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;\n}\n\n\nvec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {\n  const float goldenAngle = 2.399963f; // radians\n  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));\n  float theta = float(sampleIndex) * goldenAngle + angle;\n  float sine = sin(theta);\n  float cosine = cos(theta);\n  return vec2(cosine, sine) * r;\n}\nfloat penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation\n  return (zReceiver - zBlocker) / zBlocker;\n}\nfloat findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float blockerDepthSum = float(").concat(e,");\n  float blockers = 0.0;\n\n  int j = 0;\n  vec2 offset = vec2(0.);\n  float depth = 0.;\n\n  #pragma unroll_loop_start\n  for(int i = 0; i < ").concat(r,"; i ++) {\n    offset = (vogelDiskSample(j, ").concat(r,", angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;\n    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));\n    if (depth < compare) {\n      blockerDepthSum += depth;\n      blockers++;\n    }\n    j++;\n  }\n  #pragma unroll_loop_end\n\n  if (blockers > 0.0) {\n    return blockerDepthSum / blockers;\n  }\n  return -1.0;\n}\n\n        \nfloat vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {\n  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);\n  float shadow = 0.0f;\n  int j = 0;\n  vec2 vogelSample = vec2(0.0);\n  vec2 offset = vec2(0.0);\n  #pragma unroll_loop_start\n  for (int i = 0; i < ").concat(r,"; i++) {\n    vogelSample = vogelDiskSample(j, ").concat(r,", angle) * texelSize;\n    offset = vogelSample * (1.0 + filterRadius * float(").concat(t,"));\n    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );\n    j++;\n  }\n  #pragma unroll_loop_end\n  return shadow * 1.0 / ").concat(r,".0;\n}\n\nfloat PCSS (sampler2D shadowMap, vec4 coords) {\n  vec2 uv = coords.xy;\n  float zReceiver = coords.z; // Assumed to be eye-space z in this code\n  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;\n  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);\n  if (avgBlockerDepth == -1.0) {\n    return 1.0;\n  }\n  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\n  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);\n}")};function pT(e,t,r){t.traverse(t=>{t.material&&(e.properties.remove(t.material),null==t.material.dispose||t.material.dispose())}),e.info.programs.length=0,e.compile(t,r)}function pD(e){let{focus:t=0,samples:r=10,size:n=25}=e,i=(0,eP.A)(e=>e.gl),o=(0,eP.A)(e=>e.scene),a=(0,eP.A)(e=>e.camera);return eT.useEffect(()=>{let e=eR.ShaderChunk.shadowmap_pars_fragment;return eR.ShaderChunk.shadowmap_pars_fragment=eR.ShaderChunk.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP\n"+pS({size:n,samples:r,focus:t})).replace("#if defined( SHADOWMAP_TYPE_PCF )","\nreturn PCSS(shadowMap, shadowCoord);\n#if defined( SHADOWMAP_TYPE_PCF )"),pT(i,o,a),()=>{eR.ShaderChunk.shadowmap_pars_fragment=e,pT(i,o,a)}},[t,n,r]),null}function pR(e,t){let r=e+"Geometry";return eT.forwardRef((e,n)=>{let{args:i,children:o,...a}=e,s=eT.useRef(null);return eT.useImperativeHandle(n,()=>s.current),eT.useLayoutEffect(()=>void(null==t||t(s.current))),eT.createElement("mesh",(0,eS.Z)({ref:s},a),eT.createElement(r,{attach:"geometry",args:i}),o)})}let pP=pR("box"),pF=pR("circle"),pQ=pR("cone"),pO=pR("cylinder"),pL=pR("sphere"),pk=pR("plane"),pU=pR("tube"),pG=pR("torus"),pN=pR("torusKnot"),pz=pR("tetrahedron"),pH=pR("ring"),pV=pR("polyhedron"),pj=pR("icosahedron"),pJ=pR("octahedron"),pY=pR("dodecahedron"),pW=pR("extrude"),pq=pR("lathe"),pK=pR("capsule"),pX=pR("shape",e=>{let{geometry:t}=e,r=t.attributes.position,n=new eR.Box3().setFromBufferAttribute(r),i=new eR.Vector3;n.getSize(i);let o=[],a=0,s=0,l=0,c=0;for(let e=0;e<r.count;e++)a=r.getX(e),s=r.getY(e),l=(a-n.min.x)/i.x,c=(s-n.min.y)/i.y,o.push(l,c);t.setAttribute("uv",new eR.Float32BufferAttribute(o,2))}),pZ=eT.forwardRef(function(e,t){let{args:[r=1,n=1,i=1]=[],radius:o=.05,steps:a=1,smoothness:s=4,bevelSegments:l=4,creaseAngle:c=.4,children:u,...h}=e,d=eT.useMemo(()=>(function(e,t,r){let n=new eR.Shape,i=r-1e-5;return n.absarc(1e-5,1e-5,1e-5,-Math.PI/2,-Math.PI,!0),n.absarc(1e-5,t-2*i,1e-5,Math.PI,Math.PI/2,!0),n.absarc(e-2*i,t-2*i,1e-5,Math.PI/2,0,!0),n.absarc(e-2*i,1e-5,1e-5,0,-Math.PI/2,!0),n})(r,n,o),[r,n,o]),A=eT.useMemo(()=>({depth:i-2*o,bevelEnabled:!0,bevelSegments:2*l,steps:a,bevelSize:o-1e-5,bevelThickness:o,curveSegments:s}),[i,o,s]),f=eT.useRef(null);return eT.useLayoutEffect(()=>{f.current&&(f.current.center(),af(f.current,c))},[d,A]),eT.createElement("mesh",(0,eS.Z)({ref:t},h),eT.createElement("extrudeGeometry",{ref:f,args:[d,A]}),u)});function p$(){let e=new eR.BufferGeometry,t=new Float32Array([-1,-1,3,-1,-1,3]);return e.boundingSphere=new eR.Sphere,e.boundingSphere.set(new eR.Vector3,1/0),e.setAttribute("position",new eR.BufferAttribute(t,2)),e}let p0=eT.forwardRef(function(e,t){let{children:r,...n}=e,i=eT.useMemo(p$,[]);return eT.createElement("mesh",(0,eS.Z)({ref:t,geometry:i,frustumCulled:!1},n),r)}),p1=eT.forwardRef((e,t)=>{let{children:r,width:n,height:i,depth:o,box3:a,precise:s=!0,...l}=e,c=eT.useRef(null),u=eT.useRef(null),h=eT.useRef(null);return eT.useLayoutEffect(()=>{u.current.matrixWorld.identity();let e=a||new eR.Box3().setFromObject(h.current,s),t=e.max.x-e.min.x,r=e.max.y-e.min.y,l=e.max.z-e.min.z,c=Math.max(t,r,l);n&&(c=t),i&&(c=r),o&&(c=l),u.current.scale.setScalar(1/c)},[n,i,o,a,s]),eT.useImperativeHandle(t,()=>c.current,[]),eT.createElement("group",(0,eS.Z)({ref:c},l),eT.createElement("group",{ref:u},eT.createElement("group",{ref:h},r)))});var p2=((Z=p2||{})[Z.NONE=0]="NONE",Z[Z.START=1]="START",Z[Z.ACTIVE=2]="ACTIVE",Z);let p3=e=>e&&e.isOrthographicCamera,p4=e=>e&&e.isBox3,p5=e=>1-Math.exp(-5*e)+.007*e,p9=eT.createContext(null);function p6(e){let{children:t,maxDuration:r=1,margin:n=1.2,observe:i,fit:o,clip:a,interpolateFunc:s=p5,onFit:l}=e,c=eT.useRef(null),{camera:u,size:h,invalidate:d}=(0,eP.A)(),A=(0,eP.A)(e=>e.controls),f=eT.useRef(l);f.current=l;let p=eT.useRef({camPos:new eR.Vector3,camRot:new eR.Quaternion,camZoom:1}),m=eT.useRef({camPos:void 0,camRot:void 0,camZoom:void 0,camUp:void 0,target:void 0}),g=eT.useRef(p2.NONE),v=eT.useRef(0),[y]=eT.useState(()=>new eR.Box3),E=eT.useMemo(()=>{function e(){let e=y.getSize(new eR.Vector3),t=y.getCenter(new eR.Vector3),r=Math.max(e.x,e.y,e.z),i=p3(u)?4*r:r/(2*Math.atan(Math.PI*u.fov/360)),o=p3(u)?4*r:i/u.aspect;return{box:y,size:e,center:t,distance:n*Math.max(i,o)}}return{getSize:e,refresh(e){if(p4(e))y.copy(e);else{let t=e||c.current;if(!t)return this;t.updateWorldMatrix(!0,!0),y.setFromObject(t)}if(y.isEmpty()){let e=u.position.length()||10;y.setFromCenterAndSize(new eR.Vector3,new eR.Vector3(e,e,e))}return p.current.camPos.copy(u.position),p.current.camRot.copy(u.quaternion),p3(u)&&(p.current.camZoom=u.zoom),m.current.camPos=void 0,m.current.camRot=void 0,m.current.camZoom=void 0,m.current.camUp=void 0,m.current.target=void 0,this},reset(){let{center:t,distance:r}=e(),n=u.position.clone().sub(t).normalize();m.current.camPos=t.clone().addScaledVector(n,r),m.current.target=t.clone();let i=new eR.Matrix4().lookAt(m.current.camPos,m.current.target,u.up);return m.current.camRot=new eR.Quaternion().setFromRotationMatrix(i),g.current=p2.START,v.current=0,this},moveTo(e){return m.current.camPos=Array.isArray(e)?new eR.Vector3(...e):e.clone(),g.current=p2.START,v.current=0,this},lookAt(e){let{target:t,up:r}=e;m.current.target=Array.isArray(t)?new eR.Vector3(...t):t.clone(),r?m.current.camUp=Array.isArray(r)?new eR.Vector3(...r):r.clone():m.current.camUp=u.up.clone();let n=new eR.Matrix4().lookAt(m.current.camPos||u.position,m.current.target,m.current.camUp);return m.current.camRot=new eR.Quaternion().setFromRotationMatrix(n),g.current=p2.START,v.current=0,this},to(e){let{position:t,target:r}=e;return this.moveTo(t).lookAt({target:r})},fit(){if(!p3(u))return this.reset();let e=0,t=0,r=[new eR.Vector3(y.min.x,y.min.y,y.min.z),new eR.Vector3(y.min.x,y.max.y,y.min.z),new eR.Vector3(y.min.x,y.min.y,y.max.z),new eR.Vector3(y.min.x,y.max.y,y.max.z),new eR.Vector3(y.max.x,y.max.y,y.max.z),new eR.Vector3(y.max.x,y.max.y,y.min.z),new eR.Vector3(y.max.x,y.min.y,y.max.z),new eR.Vector3(y.max.x,y.min.y,y.min.z)],i=m.current.camPos||u.position,o=m.current.target||(null==A?void 0:A.target),a=m.current.camUp||u.up,s=o?new eR.Matrix4().lookAt(i,o,a).setPosition(i).invert():u.matrixWorldInverse;for(let n of r)n.applyMatrix4(s),e=Math.max(e,Math.abs(n.y)),t=Math.max(t,Math.abs(n.x));e*=2,t*=2;let l=(u.top-u.bottom)/e,c=(u.right-u.left)/t;return m.current.camZoom=Math.min(l,c)/n,g.current=p2.START,v.current=0,f.current&&f.current(this.getSize()),this},clip(){let{distance:t}=e();return u.near=t/100,u.far=100*t,u.updateProjectionMatrix(),A&&(A.maxDistance=10*t,A.update()),d(),this}}},[y,u,A,n,d]);eT.useLayoutEffect(()=>{if(A){let e=()=>{if(A&&m.current.target&&g.current!==p2.NONE){let e=new eR.Vector3().setFromMatrixColumn(u.matrix,2),t=p.current.camPos.distanceTo(A.target),r=(m.current.camPos||p.current.camPos).distanceTo(m.current.target),n=(1-v.current)*t+v.current*r;A.target.copy(u.position).addScaledVector(e,-n),A.update()}g.current=p2.NONE};return A.addEventListener("start",e),()=>A.removeEventListener("start",e)}},[A]);let C=eT.useRef(0);return eT.useLayoutEffect(()=>{(i||0==C.current++)&&(E.refresh(),o&&E.reset().fit(),a&&E.clip())},[h,a,o,i,u,A]),(0,eP.C)((e,t)=>{if(g.current===p2.START)g.current=p2.ACTIVE,d();else if(g.current===p2.ACTIVE){if(v.current+=t/r,v.current>=1)m.current.camPos&&u.position.copy(m.current.camPos),m.current.camRot&&u.quaternion.copy(m.current.camRot),m.current.camUp&&u.up.copy(m.current.camUp),m.current.camZoom&&p3(u)&&(u.zoom=m.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix(),A&&m.current.target&&(A.target.copy(m.current.target),A.update()),g.current=p2.NONE;else{let e=s(v.current);m.current.camPos&&u.position.lerpVectors(p.current.camPos,m.current.camPos,e),m.current.camRot&&u.quaternion.slerpQuaternions(p.current.camRot,m.current.camRot,e),m.current.camUp&&u.up.set(0,1,0).applyQuaternion(u.quaternion),m.current.camZoom&&p3(u)&&(u.zoom=(1-e)*p.current.camZoom+e*m.current.camZoom),u.updateMatrixWorld(),u.updateProjectionMatrix()}d()}}),eT.createElement("group",{ref:c},eT.createElement(p9.Provider,{value:E},t))}function p8(){return eT.useContext(p9)}var p7=Object.defineProperty,me=(e,t,r)=>t in e?p7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mt=(e,t,r)=>(me(e,"symbol"!=typeof t?t+"":t,r),r);class mr{constructor(e=Math){mt(this,"grad3",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]]),mt(this,"grad4",[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]]),mt(this,"p",[]),mt(this,"perm",[]),mt(this,"simplex",[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]),mt(this,"dot",(e,t,r)=>e[0]*t+e[1]*r),mt(this,"dot3",(e,t,r,n)=>e[0]*t+e[1]*r+e[2]*n),mt(this,"dot4",(e,t,r,n,i)=>e[0]*t+e[1]*r+e[2]*n+e[3]*i),mt(this,"noise",(e,t)=>{let r,n,i;let o=.5*(Math.sqrt(3)-1)*(e+t),a=Math.floor(e+o),s=Math.floor(t+o),l=(3-Math.sqrt(3))/6,c=(a+s)*l,u=e-(a-c),h=t-(s-c),d=0,A=1;u>h&&(d=1,A=0);let f=u-d+l,p=h-A+l,m=u-1+2*l,g=h-1+2*l,v=255&a,y=255&s,E=this.perm[v+this.perm[y]]%12,C=this.perm[v+d+this.perm[y+A]]%12,w=this.perm[v+1+this.perm[y+1]]%12,B=.5-u*u-h*h;B<0?r=0:(B*=B,r=B*B*this.dot(this.grad3[E],u,h));let x=.5-f*f-p*p;x<0?n=0:(x*=x,n=x*x*this.dot(this.grad3[C],f,p));let I=.5-m*m-g*g;return I<0?i=0:(I*=I,i=I*I*this.dot(this.grad3[w],m,g)),70*(r+n+i)}),mt(this,"noise3d",(e,t,r)=>{let n,i,o,a,s,l,c,u,h,d;let A=1/3*(e+t+r),f=Math.floor(e+A),p=Math.floor(t+A),m=Math.floor(r+A),g=1/6*(f+p+m),v=e-(f-g),y=t-(p-g),E=r-(m-g);v>=y?y>=E?(s=1,l=0,c=0,u=1,h=1,d=0):(v>=E?(s=1,l=0,c=0):(s=0,l=0,c=1),u=1,h=0,d=1):y<E?(s=0,l=0,c=1,u=0,h=1,d=1):v<E?(s=0,l=1,c=0,u=0,h=1,d=1):(s=0,l=1,c=0,u=1,h=1,d=0);let C=v-s+1/6,w=y-l+1/6,B=E-c+1/6,x=v-u+1/6*2,I=y-h+1/6*2,b=E-d+1/6*2,_=v-1+1/6*3,M=y-1+1/6*3,S=E-1+1/6*3,T=255&f,D=255&p,R=255&m,P=this.perm[T+this.perm[D+this.perm[R]]]%12,F=this.perm[T+s+this.perm[D+l+this.perm[R+c]]]%12,Q=this.perm[T+u+this.perm[D+h+this.perm[R+d]]]%12,O=this.perm[T+1+this.perm[D+1+this.perm[R+1]]]%12,L=.6-v*v-y*y-E*E;L<0?n=0:(L*=L,n=L*L*this.dot3(this.grad3[P],v,y,E));let k=.6-C*C-w*w-B*B;k<0?i=0:(k*=k,i=k*k*this.dot3(this.grad3[F],C,w,B));let U=.6-x*x-I*I-b*b;U<0?o=0:(U*=U,o=U*U*this.dot3(this.grad3[Q],x,I,b));let G=.6-_*_-M*M-S*S;return G<0?a=0:(G*=G,a=G*G*this.dot3(this.grad3[O],_,M,S)),32*(n+i+o+a)}),mt(this,"noise4d",(e,t,r,n)=>{let i,o,a,s,l,c,u,h,d,A,f,p,m,g,v,y,E;let C=this.grad4,w=this.simplex,B=this.perm,x=(5-Math.sqrt(5))/20,I=(Math.sqrt(5)-1)/4*(e+t+r+n),b=Math.floor(e+I),_=Math.floor(t+I),M=Math.floor(r+I),S=Math.floor(n+I),T=(b+_+M+S)*x,D=e-(b-T),R=t-(_-T),P=r-(M-T),F=n-(S-T),Q=(D>R?32:0)+(D>P?16:0)+(R>P?8:0)+(D>F?4:0)+(R>F?2:0)+(P>F?1:0);c=w[Q][0]>=3?1:0,u=w[Q][1]>=3?1:0,h=w[Q][2]>=3?1:0,d=w[Q][3]>=3?1:0,A=w[Q][0]>=2?1:0,f=w[Q][1]>=2?1:0,p=w[Q][2]>=2?1:0,m=w[Q][3]>=2?1:0,g=w[Q][0]>=1?1:0,v=w[Q][1]>=1?1:0,y=w[Q][2]>=1?1:0,E=w[Q][3]>=1?1:0;let O=D-c+x,L=R-u+x,k=P-h+x,U=F-d+x,G=D-A+2*x,N=R-f+2*x,z=P-p+2*x,H=F-m+2*x,V=D-g+3*x,j=R-v+3*x,J=P-y+3*x,Y=F-E+3*x,W=D-1+4*x,q=R-1+4*x,K=P-1+4*x,X=F-1+4*x,Z=255&b,$=255&_,ee=255&M,et=255&S,er=B[Z+B[$+B[ee+B[et]]]]%32,en=B[Z+c+B[$+u+B[ee+h+B[et+d]]]]%32,ei=B[Z+A+B[$+f+B[ee+p+B[et+m]]]]%32,eo=B[Z+g+B[$+v+B[ee+y+B[et+E]]]]%32,ea=B[Z+1+B[$+1+B[ee+1+B[et+1]]]]%32,es=.6-D*D-R*R-P*P-F*F;es<0?i=0:(es*=es,i=es*es*this.dot4(C[er],D,R,P,F));let el=.6-O*O-L*L-k*k-U*U;el<0?o=0:(el*=el,o=el*el*this.dot4(C[en],O,L,k,U));let ec=.6-G*G-N*N-z*z-H*H;ec<0?a=0:(ec*=ec,a=ec*ec*this.dot4(C[ei],G,N,z,H));let eu=.6-V*V-j*j-J*J-Y*Y;eu<0?s=0:(eu*=eu,s=eu*eu*this.dot4(C[eo],V,j,J,Y));let eh=.6-W*W-q*q-K*K-X*X;return eh<0?l=0:(eh*=eh,l=eh*eh*this.dot4(C[ea],W,q,K,X)),27*(i+o+a+s+l)});for(let t=0;t<256;t++)this.p[t]=Math.floor(256*e.random());for(let e=0;e<512;e++)this.perm[e]=this.p[255&e]}}let mn=eT.forwardRef((e,t)=>{let{intensity:r=1,decay:n,decayRate:i=.65,maxYaw:o=.1,maxPitch:a=.1,maxRoll:s=.1,yawFrequency:l=.1,pitchFrequency:c=.1,rollFrequency:u=.1}=e,h=(0,eP.A)(e=>e.camera),d=(0,eP.A)(e=>e.controls),A=eT.useRef(r),f=eT.useRef(h.rotation.clone()),[p]=eT.useState(()=>new mr),[m]=eT.useState(()=>new mr),[g]=eT.useState(()=>new mr),v=()=>{(A.current<0||A.current>1)&&(A.current=A.current<0?0:1)};return eT.useImperativeHandle(t,()=>({getIntensity:()=>A.current,setIntensity:e=>{A.current=e,v()}}),[]),eT.useEffect(()=>{if(d){let e=()=>void(f.current=h.rotation.clone());return d.addEventListener("change",e),e(),()=>void d.removeEventListener("change",e)}},[h,d]),(0,eP.C)((e,t)=>{let r=Math.pow(A.current,2),d=o*r*p.noise(e.clock.elapsedTime*l,1),y=a*r*m.noise(e.clock.elapsedTime*c,1),E=s*r*g.noise(e.clock.elapsedTime*u,1);h.rotation.set(f.current.x+y,f.current.y+d,f.current.z+E),n&&A.current>0&&(A.current-=i*t,v())}),null}),mi=eT.forwardRef((e,t)=>{let{children:r,enabled:n=!0,speed:i=1,rotationIntensity:o=1,floatIntensity:a=1,floatingRange:s=[-.1,.1],...l}=e,c=eT.useRef(null);eT.useImperativeHandle(t,()=>c.current,[]);let u=eT.useRef(1e4*Math.random());return(0,eP.C)(e=>{var t,r;if(!n||0===i)return;let l=u.current+e.clock.getElapsedTime();c.current.rotation.x=Math.cos(l/4*i)/8*o,c.current.rotation.y=Math.sin(l/4*i)/8*o,c.current.rotation.z=Math.sin(l/4*i)/20*o;let h=Math.sin(l/4*i)/10;h=eR.MathUtils.mapLinear(h,-.1,.1,null!==(t=null==s?void 0:s[0])&&void 0!==t?t:-.1,null!==(r=null==s?void 0:s[1])&&void 0!==r?r:.1),c.current.position.y=h*a,c.current.updateMatrix()}),eT.createElement("group",l,eT.createElement("group",{ref:c,matrixAutoUpdate:!1},r))}),mo=e=>e&&e.isCubeTexture;class ma extends eR.Mesh{set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}constructor(e,t){var r,n;let i=mo(e),o=Math.floor(Math.log2((null!=(n=i?null==(r=e.image[0])?void 0:r.width:e.image.width)?n:1024)/4)),a=Math.pow(2,o),s=[i?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH ".concat(1/(3*Math.max(a,112))),"#define CUBEUV_TEXEL_HEIGHT ".concat(1/(4*a)),"#define CUBEUV_MAX_MIP ".concat(o,".0")].join("\n")+"\n        #define ENVMAP_TYPE_CUBE_UV\n        varying vec3 vWorldPosition;\n        uniform float radius;\n        uniform float height;\n        uniform float angle;\n        #ifdef ENVMAP_TYPE_CUBE\n            uniform samplerCube map;\n        #else\n            uniform sampler2D map;\n        #endif\n        // From: https://www.shadertoy.com/view/4tsBD7\n        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) \n        {\n            float d = dot ( rd, n );\n            \n            if( d > 0.0 ) { return 1e6; }\n            \n            vec3  o = ro - c;\n            float t = - dot( n, o ) / d;\n            vec3  q = o + rd * t;\n            \n            return ( dot( q, q ) < r * r ) ? t : 1e6;\n        }\n        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm\n        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) \n        {\n            vec3 oc = ro - ce;\n            float b = dot( oc, rd );\n            float c = dot( oc, oc ) - ra * ra;\n            float h = b * b - c;\n            \n            if( h < 0.0 ) { return -1.0; }\n            \n            h = sqrt( h );\n            \n            return - b + h;\n        }\n        vec3 project() \n        {\n            vec3 p = normalize( vWorldPosition );\n            vec3 camPos = cameraPosition;\n            camPos.y -= height;\n            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );\n            if( intersection > 0.0 ) {\n                \n                vec3 h = vec3( 0.0, - height, 0.0 );\n                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );\n                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;\n            } else {\n                p = vec3( 0.0, 1.0, 0.0 );\n            }\n            return p;\n        }\n        #include <common>\n        #include <cube_uv_reflection_fragment>\n        void main() \n        {\n            vec3 projectedWorldPosition = project();\n            \n            #ifdef ENVMAP_TYPE_CUBE\n                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;\n            #else\n                vec3 direction = normalize( projectedWorldPosition );\n                vec2 uv = equirectUv( direction );\n                vec3 outcolor = texture2D( map, uv ).rgb;\n            #endif\n            gl_FragColor = vec4( outcolor, 1.0 );\n            #include <tonemapping_fragment>\n            #include <".concat(parseInt(eR.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment",">\n        }\n        ");super(new eR.IcosahedronGeometry(1,16),new eR.ShaderMaterial({uniforms:{map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}},fragmentShader:s,vertexShader:"\n        varying vec3 vWorldPosition;\n        void main() \n        {\n            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );\n            vWorldPosition = worldPosition.xyz;\n            \n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n        ",side:eR.DoubleSide}))}}class ms extends eR.DataTextureLoader{parse(e){let t,r,n;let i=function(e,t){switch(e){case 1:throw Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw Error("THREE.RGBELoader: Memory Error: "+(t||""))}},o=function(e,t,r){t=t||1024;let n=e.pos,i=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));for(;0>(i=s.indexOf("\n"))&&o<t&&n<e.byteLength;)a+=s,o+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return -1<i&&(!1!==r&&(e.pos+=o+i+1),a+s.slice(0,i))},a=new Uint8Array(e);a.pos=0;let s=function(e){let t,r;let n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};for(!(e.pos>=e.byteLength)&&(t=o(e))||i(1,"no header found"),(r=t.match(/^#\?(\S+)/))||i(3,"bad initial token"),c.valid|=1,c.programtype=r[1],c.string+=t+"\n";!1!==(t=o(e));){if(c.string+=t+"\n","#"===t.charAt(0)){c.comments+=t+"\n";continue}if((r=t.match(n))&&(c.gamma=parseFloat(r[1])),(r=t.match(a))&&(c.exposure=parseFloat(r[1])),(r=t.match(s))&&(c.valid|=2,c.format=r[1]),(r=t.match(l))&&(c.valid|=4,c.height=parseInt(r[1],10),c.width=parseInt(r[2],10)),2&c.valid&&4&c.valid)break}return 2&c.valid||i(3,"missing format specifier"),4&c.valid||i(3,"missing image size specifier"),c}(a),l=s.width,c=s.height,u=function(e,t,r){if(t<8||t>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);t!==(e[2]<<8|e[3])&&i(3,"wrong scanline width");let n=new Uint8Array(4*t*r);n.length||i(4,"unable to allocate buffer space");let o=0,a=0,s=4*t,l=new Uint8Array(4),c=new Uint8Array(s),u=r;for(;u>0&&a<e.byteLength;){a+4>e.byteLength&&i(1),l[0]=e[a++],l[1]=e[a++],l[2]=e[a++],l[3]=e[a++],(2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=t)&&i(3,"bad rgbe scanline format");let r=0,h;for(;r<s&&a<e.byteLength;){let t=(h=e[a++])>128;if(t&&(h-=128),(0===h||r+h>s)&&i(3,"bad scanline data"),t){let t=e[a++];for(let e=0;e<h;e++)c[r++]=t}else c.set(e.subarray(a,a+h),r),r+=h,a+=h}for(let e=0;e<t;e++){let r=0;n[o]=c[e+r],r+=t,n[o+1]=c[e+r],r+=t,n[o+2]=c[e+r],r+=t,n[o+3]=c[e+r],o+=4}u--}return n}(a.subarray(a.pos),l,c);switch(this.type){case eR.FloatType:n=u.length/4;let h=new Float32Array(4*n);for(let e=0;e<n;e++)!function(e,t,r,n){let i=Math.pow(2,e[t+3]-128)/255;r[n+0]=e[t+0]*i,r[n+1]=e[t+1]*i,r[n+2]=e[t+2]*i,r[n+3]=1}(u,4*e,h,4*e);t=h,r=eR.FloatType;break;case eR.HalfFloatType:n=u.length/4;let d=new Uint16Array(4*n);for(let e=0;e<n;e++)!function(e,t,r,n){let i=Math.pow(2,e[t+3]-128)/255;r[n+0]=eR.DataUtils.toHalfFloat(Math.min(e[t+0]*i,65504)),r[n+1]=eR.DataUtils.toHalfFloat(Math.min(e[t+1]*i,65504)),r[n+2]=eR.DataUtils.toHalfFloat(Math.min(e[t+2]*i,65504)),r[n+3]=eR.DataUtils.toHalfFloat(1)}(u,4*e,d,4*e);t=d,r=eR.HalfFloatType;break;default:throw Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:l,height:c,data:t,header:s.string,gamma:s.gamma,exposure:s.exposure,type:r}}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,function(e,r){switch(e.type){case eR.FloatType:case eR.HalfFloatType:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=eR.LinearFilter,e.magFilter=eR.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)},r,n)}constructor(e){super(e),this.type=eR.HalfFloatType}}let ml="colorSpace"in new eR.Texture;class mc extends eR.DataTextureLoader{parse(e){let t={l:0,c:0,lc:0};function r(e,r,n,i,o){for(;n<e;)r=r<<8|I(i,o),n+=8;n-=e,t.l=r>>n&(1<<e)-1,t.c=r,t.lc=n}let n=Array(59),i={c:0,lc:0};function o(e,t,r,n){e=e<<8|I(r,n),t+=8,i.c=e,i.lc=t}let a={c:0,lc:0};function s(e,t,r,n,s,l,c,u,h,d){if(e==t){n<8&&(o(r,n,s,c),r=i.c,n=i.lc);var A=r>>(n-=8),A=new Uint8Array([A])[0];if(h.value+A>d)return!1;for(var f=u[h.value-1];A-- >0;)u[h.value++]=f}else{if(!(h.value<d))return!1;u[h.value++]=e}a.c=r,a.lc=n}function l(e){var t=65535&e;return t>32767?t-65536:t}let c={a:0,b:0};function u(e,t){var r=l(e),n=l(t),i=r+(1&n)+(n>>1),o=i-n;c.a=i,c.b=o}function h(e,t){var r=65535&t,n=(65535&e)-(r>>1)&65535;c.a=r+n-32768&65535,c.b=n}function d(e,l,c,u,h,d){var A=c.value,f=x(l,c),p=x(l,c);c.value+=4;var m=x(l,c);if(c.value+=4,f<0||f>=65537||p<0||p>=65537)throw"Something wrong with HUF_ENCSIZE";var g=Array(65537),v=Array(16384);!function(e){for(var t=0;t<16384;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(v);var y=u-(c.value-A);if(!function(e,i,o,a,s,l,c){for(var u=0,h=0;s<=l;s++){if(o.value-o.value>a)return!1;r(6,u,h,e,o);var d=t.l;if(u=t.c,h=t.lc,c[s]=d,63==d){if(o.value-o.value>a)throw"Something wrong with hufUnpackEncTable";r(8,u,h,e,o);var A=t.l+6;if(u=t.c,h=t.lc,s+A>l+1)throw"Something wrong with hufUnpackEncTable";for(;A--;)c[s++]=0;s--}else if(d>=59){var A=d-59+2;if(s+A>l+1)throw"Something wrong with hufUnpackEncTable";for(;A--;)c[s++]=0;s--}}!function(e){for(var t=0;t<=58;++t)n[t]=0;for(var t=0;t<65537;++t)n[e[t]]+=1;for(var r=0,t=58;t>0;--t){var i=r+n[t]>>1;n[t]=r,r=i}for(var t=0;t<65537;++t){var o=e[t];o>0&&(e[t]=o|n[o]++<<6)}}(c)}(e,0,c,y,f,p,g),m>8*(u-(c.value-A)))throw"Something wrong with hufUncompress";!function(e,t,r,n){for(;t<=r;t++){var i=e[t]>>6,o=63&e[t];if(i>>o)throw"Invalid table entry";if(o>14){var a=n[i>>o-14];if(a.len)throw"Invalid table entry";if(a.lit++,a.p){var s=a.p;a.p=Array(a.lit);for(var l=0;l<a.lit-1;++l)a.p[l]=s[l]}else a.p=[,];a.p[a.lit-1]=t}else if(o)for(var c=0,l=1<<14-o;l>0;l--){var a=n[(i<<14-o)+c];if(a.len||a.p)throw"Invalid table entry";a.len=o,a.lit=t,c++}}}(g,f,p,v),function(e,t,r,n,l,c,u,h,d,A){for(var f=0,p=0,m=Math.trunc(l.value+(c+7)/8);l.value<m;)for(o(f,p,r,l),f=i.c,p=i.lc;p>=14;){var g=t[f>>p-14&16383];if(g.len)p-=g.len,s(g.lit,u,f,p,r,n,l,d,A,h),f=a.c,p=a.lc;else{if(!g.p)throw"hufDecode issues";for(v=0;v<g.lit;v++){for(var v,y=63&e[g.p[v]];p<y&&l.value<m;)o(f,p,r,l),f=i.c,p=i.lc;if(p>=y&&e[g.p[v]]>>6==(f>>p-y&(1<<y)-1)){p-=y,s(g.p[v],u,f,p,r,n,l,d,A,h),f=a.c,p=a.lc;break}}if(v==g.lit)throw"hufDecode issues"}}var E=8-c&7;for(f>>=E,p-=E;p>0;){var g=t[f<<14-p&16383];if(g.len)p-=g.len,s(g.lit,u,f,p,r,n,l,d,A,h),f=a.c,p=a.lc;else throw"hufDecode issues"}}(g,v,e,l,c,m,p,d,h,{value:0})}function A(e){for(var t=1;t<e.length;t++){var r=e[t-1]+e[t]-128;e[t]=r}}function f(e,t){for(var r=0,n=Math.floor((e.length+1)/2),i=0,o=e.length-1;!(i>o)&&(t[i++]=e[r++],!(i>o));)t[i++]=e[n++]}function p(e){for(var t=e.byteLength,r=[],n=0,i=new DataView(e);t>0;){var o=i.getInt8(n++);if(o<0){var a=-o;t-=a+1;for(var s=0;s<a;s++)r.push(i.getUint8(n++))}else{var a=o;t-=2;for(var l=i.getUint8(n++),s=0;s<a+1;s++)r.push(l)}}return r}function m(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function g(e){var t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),r=new Uint8Array(p(t)),n=new Uint8Array(r.length);return A(r),f(r,n),new DataView(n.buffer)}function v(e){var t=hC(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new Uint8Array(t.length);return A(t),f(t,r),new DataView(r.buffer)}function y(e){for(var t=e.viewer,r={value:e.offset.value},n=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),i=new Uint8Array(8192),o=0,a=Array(e.channels),s=0;s<e.channels;s++)a[s]={},a[s].start=o,a[s].end=a[s].start,a[s].nx=e.width,a[s].ny=e.lines,a[s].size=e.type,o+=a[s].nx*a[s].ny*a[s].size;var l=D(t,r),A=D(t,r);if(A>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(l<=A)for(var s=0;s<A-l+1;s++)i[s+l]=b(t,r);var f=new Uint16Array(65536),p=function(e,t){for(var r=0,n=0;n<65536;++n)(0==n||e[n>>3]&1<<(7&n))&&(t[r++]=n);for(var i=r-1;r<65536;)t[r++]=0;return i}(i,f),m=x(t,r);d(e.array,t,r,m,n,o);for(var s=0;s<e.channels;++s)for(var g=a[s],v=0;v<a[s].size;++v)!function(e,t,r,n,i,o,a){for(var s=a<16384,l=r>i?i:r,d=1;d<=l;)d<<=1;for(d>>=1,A=d,d>>=1;d>=1;){for(var A,f,p,m,g,v=0,y=0+o*(i-A),E=o*d,C=o*A,w=n*d,B=n*A;v<=y;v+=C){for(var x=v,I=v+n*(r-A);x<=I;x+=B){var b=x+w,_=x+E,M=_+w;s?(u(e[x+t],e[_+t]),f=c.a,m=c.b,u(e[b+t],e[M+t]),p=c.a,g=c.b,u(f,p),e[x+t]=c.a,e[b+t]=c.b,u(m,g)):(h(e[x+t],e[_+t]),f=c.a,m=c.b,h(e[b+t],e[M+t]),p=c.a,g=c.b,h(f,p),e[x+t]=c.a,e[b+t]=c.b,h(m,g)),e[_+t]=c.a,e[M+t]=c.b}if(r&d){var _=x+E;s?u(e[x+t],e[_+t]):h(e[x+t],e[_+t]),f=c.a,e[_+t]=c.b,e[x+t]=f}}if(i&d)for(var x=v,I=v+n*(r-A);x<=I;x+=B){var b=x+w;s?u(e[x+t],e[b+t]):h(e[x+t],e[b+t]),f=c.a,e[b+t]=c.b,e[x+t]=f}A=d,d>>=1}}(n,g.start+v,g.nx,g.size,g.ny,g.nx*g.size,p);!function(e,t,r){for(var n=0;n<r;++n)t[n]=e[t[n]]}(f,n,o);for(var y=0,E=new Uint8Array(n.buffer.byteLength),C=0;C<e.lines;C++)for(var w=0;w<e.channels;w++){var g=a[w],B=g.nx*g.size,I=new Uint8Array(n.buffer,2*g.end,2*B);E.set(I,y),y+=2*B,g.end+=B}return new DataView(E.buffer)}function E(e){var t=hC(e.array.slice(e.offset.value,e.offset.value+e.size));let r=e.lines*e.channels*e.width,n=1==e.type?new Uint16Array(r):new Uint32Array(r),i=0,o=0,a=[,,,,];for(let r=0;r<e.lines;r++)for(let r=0;r<e.channels;r++){let r=0;switch(e.type){case 1:a[0]=i,a[1]=a[0]+e.width,i=a[1]+e.width;for(let i=0;i<e.width;++i)r+=t[a[0]++]<<8|t[a[1]++],n[o]=r,o++;break;case 2:a[0]=i,a[1]=a[0]+e.width,a[2]=a[1]+e.width,i=a[2]+e.width;for(let i=0;i<e.width;++i)r+=t[a[0]++]<<24|t[a[1]++]<<16|t[a[2]++]<<8,n[o]=r,o++}}return new DataView(n.buffer)}function C(e){var t=e.viewer,r={value:e.offset.value},n=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),i={version:_(t,r),unknownUncompressedSize:_(t,r),unknownCompressedSize:_(t,r),acCompressedSize:_(t,r),dcCompressedSize:_(t,r),rleCompressedSize:_(t,r),rleUncompressedSize:_(t,r),rleRawSize:_(t,r),totalAcUncompressedCount:_(t,r),totalDcUncompressedCount:_(t,r),acCompression:_(t,r)};if(i.version<2)throw"EXRLoader.parse: "+O.compression+" version "+i.version+" is unsupported";for(var o=[],a=D(t,r)-2;a>0;){var s=w(t.buffer,r),l=b(t,r),c=l>>2&3,u=(l>>4)-1,h=new Int8Array([u])[0],A=b(t,r);o.push({name:s,index:h,type:A,compression:c}),a-=s.length+3}for(var f=O.channels,m=Array(e.channels),g=0;g<e.channels;++g){var y=m[g]={},E=f[g];y.name=E.name,y.compression=0,y.decoded=!1,y.type=E.pixelType,y.pLinear=E.pLinear,y.width=e.width,y.height=e.lines}for(var C={idx:[,,,]},B=0;B<e.channels;++B)for(var y=m[B],g=0;g<o.length;++g){var x=o[g];y.name==x.name&&(y.compression=x.compression,x.index>=0&&(C.idx[x.index]=B),y.offset=B)}if(i.acCompressedSize>0)switch(i.acCompression){case 0:var I=new Uint16Array(i.totalAcUncompressedCount);d(e.array,t,r,i.acCompressedSize,I,i.totalAcUncompressedCount);break;case 1:var M=e.array.slice(r.value,r.value+i.totalAcUncompressedCount),S=hC(M),I=new Uint16Array(S.buffer);r.value+=i.totalAcUncompressedCount}if(i.dcCompressedSize>0){var R={array:e.array,offset:r,size:i.dcCompressedSize},P=new Uint16Array(v(R).buffer);r.value+=i.dcCompressedSize}if(i.rleRawSize>0){var M=e.array.slice(r.value,r.value+i.rleCompressedSize),S=hC(M),F=p(S.buffer);r.value+=i.rleCompressedSize}for(var Q=0,L=Array(m.length),g=0;g<L.length;++g)L[g]=[];for(var k=0;k<e.lines;++k)for(var U=0;U<m.length;++U)L[U].push(Q),Q+=m[U].width*e.type*2;!function(e,t,r,n,i,o){var a=new DataView(o.buffer),s=r[e.idx[0]].width,l=r[e.idx[0]].height,c=Math.floor(s/8),u=Math.ceil(s/8),h=Math.ceil(l/8),d=s-(u-1)*8,A=l-(h-1)*8,f={value:0},p=[,,,],m=[,,,],g=[,,,],v=[,,,],y=[,,,];for(let r=0;r<3;++r)y[r]=t[e.idx[r]],p[r]=r<1?0:p[r-1]+u*h,m[r]=new Float32Array(64),g[r]=new Uint16Array(64),v[r]=new Uint16Array(64*u);for(let t=0;t<h;++t){var E,C,w=8;t==h-1&&(w=A);var B=8;for(let e=0;e<u;++e){e==u-1&&(B=d);for(let e=0;e<3;++e)g[e].fill(0),g[e][0]=i[p[e]++],function(e,t,r){for(var n,i=1;i<64;)65280==(n=t[e.value])?i=64:n>>8==255?i+=255&n:(r[i]=n,i++),e.value++}(f,n,g[e]),E=g[e],(C=m[e])[0]=T(E[0]),C[1]=T(E[1]),C[2]=T(E[5]),C[3]=T(E[6]),C[4]=T(E[14]),C[5]=T(E[15]),C[6]=T(E[27]),C[7]=T(E[28]),C[8]=T(E[2]),C[9]=T(E[4]),C[10]=T(E[7]),C[11]=T(E[13]),C[12]=T(E[16]),C[13]=T(E[26]),C[14]=T(E[29]),C[15]=T(E[42]),C[16]=T(E[3]),C[17]=T(E[8]),C[18]=T(E[12]),C[19]=T(E[17]),C[20]=T(E[25]),C[21]=T(E[30]),C[22]=T(E[41]),C[23]=T(E[43]),C[24]=T(E[9]),C[25]=T(E[11]),C[26]=T(E[18]),C[27]=T(E[24]),C[28]=T(E[31]),C[29]=T(E[40]),C[30]=T(E[44]),C[31]=T(E[53]),C[32]=T(E[10]),C[33]=T(E[19]),C[34]=T(E[23]),C[35]=T(E[32]),C[36]=T(E[39]),C[37]=T(E[45]),C[38]=T(E[52]),C[39]=T(E[54]),C[40]=T(E[20]),C[41]=T(E[22]),C[42]=T(E[33]),C[43]=T(E[38]),C[44]=T(E[46]),C[45]=T(E[51]),C[46]=T(E[55]),C[47]=T(E[60]),C[48]=T(E[21]),C[49]=T(E[34]),C[50]=T(E[37]),C[51]=T(E[47]),C[52]=T(E[50]),C[53]=T(E[56]),C[54]=T(E[59]),C[55]=T(E[61]),C[56]=T(E[35]),C[57]=T(E[36]),C[58]=T(E[48]),C[59]=T(E[49]),C[60]=T(E[57]),C[61]=T(E[58]),C[62]=T(E[62]),C[63]=T(E[63]),function(e){let t=.5*Math.cos(3.14159/16),r=.5*Math.cos(3.14159/8),n=.5*Math.cos(3*3.14159/16),i=.5*Math.cos(3*3.14159/8);for(var o=[,,,,],a=[,,,,],s=[,,,,],l=[,,,,],c=0;c<8;++c){var u=8*c;o[0]=r*e[u+2],o[1]=i*e[u+2],o[2]=r*e[u+6],o[3]=i*e[u+6],a[0]=t*e[u+1]+n*e[u+3]+.2777854612564676*e[u+5]+.09754573032714427*e[u+7],a[1]=n*e[u+1]-.09754573032714427*e[u+3]-t*e[u+5]-.2777854612564676*e[u+7],a[2]=.2777854612564676*e[u+1]-t*e[u+3]+.09754573032714427*e[u+5]+n*e[u+7],a[3]=.09754573032714427*e[u+1]-.2777854612564676*e[u+3]+n*e[u+5]-t*e[u+7],s[0]=.35355362513961314*(e[u+0]+e[u+4]),s[3]=.35355362513961314*(e[u+0]-e[u+4]),s[1]=o[0]+o[3],s[2]=o[1]-o[2],l[0]=s[0]+s[1],l[1]=s[3]+s[2],l[2]=s[3]-s[2],l[3]=s[0]-s[1],e[u+0]=l[0]+a[0],e[u+1]=l[1]+a[1],e[u+2]=l[2]+a[2],e[u+3]=l[3]+a[3],e[u+4]=l[3]-a[3],e[u+5]=l[2]-a[2],e[u+6]=l[1]-a[1],e[u+7]=l[0]-a[0]}for(var h=0;h<8;++h)o[0]=r*e[16+h],o[1]=i*e[16+h],o[2]=r*e[48+h],o[3]=i*e[48+h],a[0]=t*e[8+h]+n*e[24+h]+.2777854612564676*e[40+h]+.09754573032714427*e[56+h],a[1]=n*e[8+h]-.09754573032714427*e[24+h]-t*e[40+h]-.2777854612564676*e[56+h],a[2]=.2777854612564676*e[8+h]-t*e[24+h]+.09754573032714427*e[40+h]+n*e[56+h],a[3]=.09754573032714427*e[8+h]-.2777854612564676*e[24+h]+n*e[40+h]-t*e[56+h],s[0]=.35355362513961314*(e[h]+e[32+h]),s[3]=.35355362513961314*(e[h]-e[32+h]),s[1]=o[0]+o[3],s[2]=o[1]-o[2],l[0]=s[0]+s[1],l[1]=s[3]+s[2],l[2]=s[3]-s[2],l[3]=s[0]-s[1],e[0+h]=l[0]+a[0],e[8+h]=l[1]+a[1],e[16+h]=l[2]+a[2],e[24+h]=l[3]+a[3],e[32+h]=l[3]-a[3],e[40+h]=l[2]-a[2],e[48+h]=l[1]-a[1],e[56+h]=l[0]-a[0]}(m[e]);!function(e){for(var t=0;t<64;++t){var r=e[0][t],n=e[1][t],i=e[2][t];e[0][t]=r+1.5747*i,e[1][t]=r-.1873*n-.4682*i,e[2][t]=r+1.8556*n}}(m);for(let t=0;t<3;++t)!function(e,t,r){for(var n,i=0;i<64;++i)t[r+i]=eR.DataUtils.toHalfFloat((n=e[i])<=1?Math.sign(n)*Math.pow(Math.abs(n),2.2):Math.sign(n)*Math.pow(9.025013291561939,Math.abs(n)-1))}(m[t],v[t],64*e)}let o=0;for(let n=0;n<3;++n){let i=r[e.idx[n]].type;for(let e=8*t;e<8*t+w;++e){o=y[n][e];for(let t=0;t<c;++t){let r=64*t+(7&e)*8;a.setUint16(o+0*i,v[n][r+0],!0),a.setUint16(o+2*i,v[n][r+1],!0),a.setUint16(o+4*i,v[n][r+2],!0),a.setUint16(o+6*i,v[n][r+3],!0),a.setUint16(o+8*i,v[n][r+4],!0),a.setUint16(o+10*i,v[n][r+5],!0),a.setUint16(o+12*i,v[n][r+6],!0),a.setUint16(o+14*i,v[n][r+7],!0),o+=16*i}}if(c!=u)for(let e=8*t;e<8*t+w;++e){let t=y[n][e]+8*c*2*i,r=64*c+(7&e)*8;for(let e=0;e<B;++e)a.setUint16(t+2*e*i,v[n][r+e],!0)}}}for(var x=new Uint16Array(s),a=new DataView(o.buffer),I=0;I<3;++I){r[e.idx[I]].decoded=!0;var b=r[e.idx[I]].type;if(2==r[I].type)for(var _=0;_<l;++_){let e=y[I][_];for(var M=0;M<s;++M)x[M]=a.getUint16(e+2*M*b,!0);for(var M=0;M<s;++M)a.setFloat32(e+2*M*b,T(x[M]),!0)}}}(C,L,m,I,P,n);for(var g=0;g<m.length;++g){var y=m[g];if(!y.decoded){if(2===y.compression)for(var G=0,N=0,k=0;k<e.lines;++k){for(var z=L[g][G],H=0;H<y.width;++H){for(var V=0;V<2*y.type;++V)n[z++]=F[N+V*y.width*y.height];N++}G++}else throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(n.buffer)}function w(e,t){for(var r=new Uint8Array(e),n=0;0!=r[t.value+n];)n+=1;var i=new TextDecoder().decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,i}function B(e,t){var r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function x(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function I(e,t){var r=e[t.value];return t.value=t.value+1,r}function b(e,t){var r=e.getUint8(t.value);return t.value=t.value+1,r}let _=function(e,t){let r;return r="getBigInt64"in DataView.prototype?Number(e.getBigInt64(t.value,!0)):e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,r};function M(e,t){var r=e.getFloat32(t.value,!0);return t.value+=4,r}function S(e,t){return eR.DataUtils.toHalfFloat(M(e,t))}function T(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function D(e,t){var r=e.getUint16(t.value,!0);return t.value+=2,r}function R(e,t){return T(D(e,t))}let P=new DataView(e),F=new Uint8Array(e),Q={value:0},O=function(e,t,r){let n={};if(20000630!=e.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";n.version=e.getUint8(4);let i=e.getUint8(5);n.spec={singleTile:!!(2&i),longName:!!(4&i),deepFormat:!!(8&i),multiPart:!!(16&i)},r.value=8;for(var o=!0;o;){var a=w(t,r);if(0==a)o=!1;else{var s=w(t,r),l=x(e,r),c=function(e,t,r,n,i){var o,a,s,l,c;if("string"===n||"stringvector"===n||"iccProfile"===n)return o=new TextDecoder().decode(new Uint8Array(t).slice(r.value,r.value+i)),r.value=r.value+i,o;if("chlist"===n)return function(e,t,r,n){for(var i=r.value,o=[];r.value<i+n-1;){var a=w(t,r),s=B(e,r),l=b(e,r);r.value+=3;var c=B(e,r),u=B(e,r);o.push({name:a,pixelType:s,pLinear:l,xSampling:c,ySampling:u})}return r.value+=1,o}(e,t,r,i);if("chromaticities"===n)return a=M(e,r),s=M(e,r),l=M(e,r),c=M(e,r),{redX:a,redY:s,greenX:l,greenY:c,blueX:M(e,r),blueY:M(e,r),whiteX:M(e,r),whiteY:M(e,r)};if("compression"===n)return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][b(e,r)];if("box2i"===n)return{xMin:x(e,r),yMin:x(e,r),xMax:x(e,r),yMax:x(e,r)};if("lineOrder"===n)return["INCREASING_Y"][b(e,r)];if("float"===n)return M(e,r);else if("v2f"===n)return[M(e,r),M(e,r)];else if("v3f"===n)return[M(e,r),M(e,r),M(e,r)];else if("int"===n)return B(e,r);else if("rational"===n)return[B(e,r),x(e,r)];else if("timecode"===n)return[x(e,r),x(e,r)];else return"preview"===n?(r.value+=i,"skipped"):void(r.value+=i)}(e,t,r,s,l);void 0===c?console.warn("EXRLoader.parse: skipped unknown header attribute type '".concat(s,"'.")):n[a]=c}}if((-5&i)!=0)throw console.error("EXRHeader:",n),"THREE.EXRLoader: provided file is currently unsupported.";return n}(P,e,Q),L=function(e,t,r,n,i){let o={size:0,viewer:t,array:r,offset:n,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[ml?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":o.lines=1,o.uncompress=m;break;case"RLE_COMPRESSION":o.lines=1,o.uncompress=g;break;case"ZIPS_COMPRESSION":o.lines=1,o.uncompress=v;break;case"ZIP_COMPRESSION":o.lines=16,o.uncompress=v;break;case"PIZ_COMPRESSION":o.lines=32,o.uncompress=y;break;case"PXR24_COMPRESSION":o.lines=16,o.uncompress=E;break;case"DWAA_COMPRESSION":o.lines=32,o.uncompress=C;break;case"DWAB_COMPRESSION":o.lines=256,o.uncompress=C;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(o.scanlineBlockSize=o.lines,1==o.type)switch(i){case eR.FloatType:o.getter=R,o.inputSize=2;break;case eR.HalfFloatType:o.getter=D,o.inputSize=2}else if(2==o.type)switch(i){case eR.FloatType:o.getter=M,o.inputSize=4;break;case eR.HalfFloatType:o.getter=S,o.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+o.type+" for "+e.compression+".";o.blockCount=(e.dataWindow.yMax+1)/o.scanlineBlockSize;for(var a=0;a<o.blockCount;a++)_(t,n);o.outputChannels=3==o.channels?4:o.channels;let s=o.width*o.height*o.outputChannels;switch(i){case eR.FloatType:o.byteArray=new Float32Array(s),o.channels<o.outputChannels&&o.byteArray.fill(1,0,s);break;case eR.HalfFloatType:o.byteArray=new Uint16Array(s),o.channels<o.outputChannels&&o.byteArray.fill(15360,0,s);break;default:console.error("THREE.EXRLoader: unsupported type: ",i)}return o.bytesPerLine=o.width*o.inputSize*o.channels,4==o.outputChannels?o.format=eR.RGBAFormat:o.format=eR.RedFormat,ml?o.colorSpace="srgb-linear":o.encoding=3e3,o}(O,P,F,Q,this.type),k={value:0},U={R:0,G:1,B:2,A:3,Y:0};for(let e=0;e<L.height/L.scanlineBlockSize;e++){let t=x(P,Q);L.size=x(P,Q),L.lines=t+L.scanlineBlockSize>L.height?L.height-t:L.scanlineBlockSize;let r=L.size<L.lines*L.bytesPerLine?L.uncompress(L):m(L);Q.value+=L.size;for(let t=0;t<L.scanlineBlockSize;t++){let n=t+e*L.scanlineBlockSize;if(n>=L.height)break;for(let e=0;e<L.channels;e++){let i=U[O.channels[e].name];for(let o=0;o<L.width;o++){k.value=(L.channels*L.width*t+e*L.width+o)*L.inputSize;let a=(L.height-1-n)*(L.width*L.outputChannels)+o*L.outputChannels+i;L.byteArray[a]=L.getter(r,k)}}}}return{header:O,width:L.width,height:L.height,data:L.byteArray,format:L.format,[ml?"colorSpace":"encoding"]:L[ml?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,function(e,r){ml?e.colorSpace=r.colorSpace:e.encoding=r.encoding,e.minFilter=eR.LinearFilter,e.magFilter=eR.LinearFilter,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,r)},r,n)}constructor(e){super(e),this.type=eR.HalfFloatType}}let mu=(e,t,r)=>{let n;switch(e){case eR.UnsignedByteType:n=new Uint8ClampedArray(t*r*4);break;case eR.HalfFloatType:n=new Uint16Array(t*r*4);break;case eR.UnsignedIntType:n=new Uint32Array(t*r*4);break;case eR.ByteType:n=new Int8Array(t*r*4);break;case eR.ShortType:n=new Int16Array(t*r*4);break;case eR.IntType:n=new Int32Array(t*r*4);break;case eR.FloatType:n=new Float32Array(t*r*4);break;default:throw Error("Unsupported data type")}return n},mh=(e,t,r,n)=>{if(void 0!==V)return V;let i=new eR.WebGLRenderTarget(1,1,n);t.setRenderTarget(i);let o=new eR.Mesh(new eR.PlaneGeometry,new eR.MeshBasicMaterial({color:16777215}));t.render(o,r),t.setRenderTarget(null);let a=mu(e,i.width,i.height);return t.readRenderTargetPixels(i,0,0,i.width,i.height,a),i.dispose(),o.geometry.dispose(),o.material.dispose(),V=0!==a[0]};class md{static instantiateRenderer(){let e=new eR.WebGLRenderer;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw Error("Can't read pixels in this browser");let e=mu(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){let t=new eR.DataTexture(this.toArray(),this.width,this.height,eR.RGBAFormat,this._type,(null==e?void 0:e.mapping)||eR.UVMapping,(null==e?void 0:e.wrapS)||eR.ClampToEdgeWrapping,(null==e?void 0:e.wrapT)||eR.ClampToEdgeWrapping,(null==e?void 0:e.magFilter)||eR.LinearFilter,(null==e?void 0:e.minFilter)||eR.LinearFilter,(null==e?void 0:e.anisotropy)||1,eR.LinearSRGBColorSpace);return t.generateMipmaps=(null==e?void 0:e.generateMipmaps)!==void 0&&(null==e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof eR.ShaderMaterial&&Object.values(this.material.uniforms).forEach(e=>{e.value instanceof eR.Texture&&e.value.dispose()}),Object.values(this.material).forEach(e=>{e instanceof eR.Texture&&e.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}constructor(e){var t,r,n,i,o,a,s,l,c,u,h,d,A,f,p,m;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;let g={format:eR.RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:(null===(t=e.renderTargetOptions)||void 0===t?void 0:t.anisotropy)!==void 0?null===(r=e.renderTargetOptions)||void 0===r?void 0:r.anisotropy:1,generateMipmaps:(null===(n=e.renderTargetOptions)||void 0===n?void 0:n.generateMipmaps)!==void 0&&(null===(i=e.renderTargetOptions)||void 0===i?void 0:i.generateMipmaps),magFilter:(null===(o=e.renderTargetOptions)||void 0===o?void 0:o.magFilter)!==void 0?null===(a=e.renderTargetOptions)||void 0===a?void 0:a.magFilter:eR.LinearFilter,minFilter:(null===(s=e.renderTargetOptions)||void 0===s?void 0:s.minFilter)!==void 0?null===(l=e.renderTargetOptions)||void 0===l?void 0:l.minFilter:eR.LinearFilter,samples:(null===(c=e.renderTargetOptions)||void 0===c?void 0:c.samples)!==void 0?null===(u=e.renderTargetOptions)||void 0===u?void 0:u.samples:void 0,wrapS:(null===(h=e.renderTargetOptions)||void 0===h?void 0:h.wrapS)!==void 0?null===(d=e.renderTargetOptions)||void 0===d?void 0:d.wrapS:eR.ClampToEdgeWrapping,wrapT:(null===(A=e.renderTargetOptions)||void 0===A?void 0:A.wrapT)!==void 0?null===(f=e.renderTargetOptions)||void 0===f?void 0:f.wrapT:eR.ClampToEdgeWrapping};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=md.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new eR.Scene,this._camera=new eR.OrthographicCamera,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!mh(this._type,this._renderer,this._camera,g)){let e;this._type===eR.HalfFloatType&&(e=this._renderer.extensions.has("EXT_color_buffer_float")?eR.FloatType:void 0),void 0!==e?(console.warn("This browser does not support reading pixels from ".concat(this._type," RenderTargets, switching to ").concat(eR.FloatType)),this._type=e):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new eR.Mesh(new eR.PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new eR.WebGLRenderTarget(this.width,this.height,g),this._renderTarget.texture.mapping=(null===(p=e.renderTargetOptions)||void 0===p?void 0:p.mapping)!==void 0?null===(m=e.renderTargetOptions)||void 0===m?void 0:m.mapping:eR.UVMapping}}class mA extends eR.ShaderMaterial{get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){let e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){let t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){let e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}constructor({gamma:e,offsetHdr:t,offsetSdr:r,gainMapMin:n,gainMapMax:i,maxDisplayBoost:o,hdrCapacityMin:a,hdrCapacityMax:s,sdr:l,gainMap:c}){super({name:"GainMapDecoderMaterial",vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n// min half float value\n#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )\n// max half float value\n#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )\n\nuniform sampler2D sdr;\nuniform sampler2D gainMap;\nuniform vec3 gamma;\nuniform vec3 offsetHdr;\nuniform vec3 offsetSdr;\nuniform vec3 gainMapMin;\nuniform vec3 gainMapMax;\nuniform float weightFactor;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 rgb = texture2D( sdr, vUv ).rgb;\n  vec3 recovery = texture2D( gainMap, vUv ).rgb;\n  vec3 logRecovery = pow( recovery, gamma );\n  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;\n  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;\n  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));\n  gl_FragColor = vec4( clampedHdrColor , 1.0 );\n}\n",uniforms:{sdr:{value:l},gainMap:{value:c},gamma:{value:new eR.Vector3(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new eR.Vector3().fromArray(t)},offsetSdr:{value:new eR.Vector3().fromArray(r)},gainMapMin:{value:new eR.Vector3().fromArray(n)},gainMapMax:{value:new eR.Vector3().fromArray(i)},weightFactor:{value:(Math.log2(o)-a)/(s-a)}},blending:eR.NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=o,this._hdrCapacityMin=a,this._hdrCapacityMax=s,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}}class mf extends Error{}class mp extends Error{}let mm=(e,t,r)=>{var n;let i;let o=null===(n=e.attributes.getNamedItem(t))||void 0===n?void 0:n.nodeValue;if(o)i=o;else{let n=e.getElementsByTagName(t)[0];if(n){let e=n.getElementsByTagName("rdf:li");if(3===e.length)i=Array.from(e).map(e=>e.innerHTML);else throw Error("Gainmap metadata contains an array of items for ".concat(t," but its length is not 3"))}else{if(r)return r;throw Error("Can't find ".concat(t," in gainmap metadata"))}}return i},mg=e=>{var t,r;let n;let i=(n="undefined"!=typeof TextDecoder?new TextDecoder().decode(e):e.toString()).indexOf("<x:xmpmeta"),o=new DOMParser;for(;-1!==i;){let e=n.indexOf("x:xmpmeta>",i);n.slice(i,e+10);let a=n.slice(i,e+10);try{let e=o.parseFromString(a,"text/xml").getElementsByTagName("rdf:Description")[0],n=mm(e,"hdrgm:GainMapMin","0"),i=mm(e,"hdrgm:GainMapMax"),s=mm(e,"hdrgm:Gamma","1"),l=mm(e,"hdrgm:OffsetSDR","0.015625"),c=mm(e,"hdrgm:OffsetHDR","0.015625"),u=null===(t=e.attributes.getNamedItem("hdrgm:HDRCapacityMin"))||void 0===t?void 0:t.nodeValue;u||(u="0");let h=null===(r=e.attributes.getNamedItem("hdrgm:HDRCapacityMax"))||void 0===r?void 0:r.nodeValue;if(!h)throw Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(n)?n.map(e=>parseFloat(e)):[parseFloat(n),parseFloat(n),parseFloat(n)],gainMapMax:Array.isArray(i)?i.map(e=>parseFloat(e)):[parseFloat(i),parseFloat(i),parseFloat(i)],gamma:Array.isArray(s)?s.map(e=>parseFloat(e)):[parseFloat(s),parseFloat(s),parseFloat(s)],offsetSdr:Array.isArray(l)?l.map(e=>parseFloat(e)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(e=>parseFloat(e)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(u),hdrCapacityMax:parseFloat(h)}}catch(e){}i=n.indexOf("<x:xmpmeta",e)}};class mv{extract(e){return new Promise((t,r)=>{let n;let i=this.options.debug,o=new DataView(e.buffer);if(65496!==o.getUint16(0)){r(Error("Not a valid jpeg"));return}let a=o.byteLength,s=2,l=0;for(;s<a;){if(++l>250){r(Error("Found no marker after ".concat(l," loops \uD83D\uDE35")));return}if(255!==o.getUint8(s)){r(Error("Not a valid marker at offset 0x".concat(s.toString(16),", found: 0x").concat(o.getUint8(s).toString(16))));return}if(n=o.getUint8(s+1),i&&console.log("Marker: ".concat(n.toString(16))),226===n){i&&console.log("Found APP2 marker (0xffe2)");let e=s+4;if(1297106432===o.getUint32(e)){let n;let i=e+4;if(18761===o.getUint16(i))n=!1;else if(19789===o.getUint16(i))n=!0;else{r(Error("No valid endianness marker found in TIFF header"));return}if(42!==o.getUint16(i+2,!n)){r(Error("Not valid TIFF data! (no 0x002A marker)"));return}let a=o.getUint32(i+4,!n);if(a<8){r(Error("Not valid TIFF data! (First offset less than 8)"));return}let s=i+a,l=o.getUint16(s,!n),c=s+2,u=0;for(let e=c;e<c+12*l;e+=12)45057===o.getUint16(e,!n)&&(u=o.getUint32(e+8,!n));let h=s+2+12*l+4,d=[];for(let e=h;e<h+16*u;e+=16){let t={MPType:o.getUint32(e,!n),size:o.getUint32(e+4,!n),dataOffset:o.getUint32(e+8,!n),dependantImages:o.getUint32(e+12,!n),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=i+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,d.push(t)}if(this.options.extractNonFII&&d.length){let e=new Blob([o]),r=[];for(let t of d){if(t.isFII&&!this.options.extractFII)continue;let n=e.slice(t.start,t.end+1,"image/jpeg");r.push(n)}t(r)}}}s+=2+o.getUint16(s+2)}})}constructor(e){this.options={debug:!!e&&void 0!==e.debug&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}}let my=async e=>{let t=mg(e);if(!t)throw new mp("Gain map XMP metadata not found");let r=new mv({extractFII:!0,extractNonFII:!0}),n=await r.extract(e);if(2!==n.length)throw new mf("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:t}},mE=e=>new Promise((t,r)=>{let n=document.createElement("img");n.onload=()=>{t(n)},n.onerror=e=>{r(e)},n.src=URL.createObjectURL(e)});class mC extends eR.Loader{setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");let e=new mA({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new eR.Texture,sdr:new eR.Texture});return new md({width:16,height:16,type:eR.HalfFloatType,colorSpace:eR.LinearSRGBColorSpace,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,r,n){let i,o;let a=n?new Blob([n],{type:"image/jpeg"}):void 0,s=new Blob([r],{type:"image/jpeg"}),l=!1;if("undefined"==typeof createImageBitmap){let e=await Promise.all([a?mE(a):Promise.resolve(void 0),mE(s)]);o=e[0],i=e[1],l=!0}else{let e=await Promise.all([a?createImageBitmap(a,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(s,{imageOrientation:"flipY"})]);o=e[0],i=e[1]}let c=new eR.Texture(o||new ImageData(2,2),eR.UVMapping,eR.ClampToEdgeWrapping,eR.ClampToEdgeWrapping,eR.LinearFilter,eR.LinearMipMapLinearFilter,eR.RGBAFormat,eR.UnsignedByteType,1,eR.LinearSRGBColorSpace);c.flipY=l,c.needsUpdate=!0;let u=new eR.Texture(i,eR.UVMapping,eR.ClampToEdgeWrapping,eR.ClampToEdgeWrapping,eR.LinearFilter,eR.LinearMipMapLinearFilter,eR.RGBAFormat,eR.UnsignedByteType,1,eR.SRGBColorSpace);u.flipY=l,u.needsUpdate=!0,e.width=i.width,e.height=i.height,e.material.gainMap=c,e.material.sdr=u,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new eR.LoadingManager}}class mw extends mC{load(e,t,r,n){let i,o,a,[s,l,c]=e,u=this.prepareQuadRenderer(),h=async()=>{if(i&&o&&a){try{await this.render(u,a,i,o)}catch(e){this.manager.itemError(s),this.manager.itemError(l),this.manager.itemError(c),"function"==typeof n&&n(e),u.disposeOnDemandRenderer();return}"function"==typeof t&&t(u),this.manager.itemEnd(s),this.manager.itemEnd(l),this.manager.itemEnd(c),u.disposeOnDemandRenderer()}},d=!0,A=0,f=0,p=!0,m=0,g=0,v=!0,y=0,E=0,C=()=>{if("function"==typeof r){let e=A+m+y,t=f+g+E,n=d&&p&&v;r(new ProgressEvent("progress",{lengthComputable:n,loaded:t,total:e}))}};this.manager.itemStart(s),this.manager.itemStart(l),this.manager.itemStart(c);let w=new eR.FileLoader(this._internalLoadingManager);w.setResponseType("arraybuffer"),w.setRequestHeader(this.requestHeader),w.setPath(this.path),w.setWithCredentials(this.withCredentials),w.load(s,async e=>{if("string"==typeof e)throw Error("Invalid sdr buffer");i=e,await h()},e=>{d=e.lengthComputable,f=e.loaded,A=e.total,C()},e=>{this.manager.itemError(s),"function"==typeof n&&n(e)});let B=new eR.FileLoader(this._internalLoadingManager);B.setResponseType("arraybuffer"),B.setRequestHeader(this.requestHeader),B.setPath(this.path),B.setWithCredentials(this.withCredentials),B.load(l,async e=>{if("string"==typeof e)throw Error("Invalid gainmap buffer");o=e,await h()},e=>{p=e.lengthComputable,g=e.loaded,m=e.total,C()},e=>{this.manager.itemError(l),"function"==typeof n&&n(e)});let x=new eR.FileLoader(this._internalLoadingManager);return x.setRequestHeader(this.requestHeader),x.setPath(this.path),x.setWithCredentials(this.withCredentials),x.load(c,async e=>{if("string"!=typeof e)throw Error("Invalid metadata string");a=JSON.parse(e),await h()},e=>{v=e.lengthComputable,E=e.loaded,y=e.total,C()},e=>{this.manager.itemError(c),"function"==typeof n&&n(e)}),u}}class mB extends mC{load(e,t,r,n){let i=this.prepareQuadRenderer(),o=new eR.FileLoader(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async r=>{let o,a,s;if("string"==typeof r)throw Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");let l=new Uint8Array(r);try{let e=await my(l);o=e.sdr,a=e.gainMap,s=e.metadata}catch(t){if(t instanceof mp||t instanceof mf)console.warn("Failure to reconstruct an HDR image from ".concat(e,": Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg")),s={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},o=l;else throw t}try{await this.render(i,s,o,a)}catch(t){this.manager.itemError(e),"function"==typeof n&&n(t),i.disposeOnDemandRenderer();return}"function"==typeof t&&t(i),this.manager.itemEnd(e),i.disposeOnDemandRenderer()},r,t=>{this.manager.itemError(e),"function"==typeof n&&n(t)}),i}}let mx={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},mI=e=>Array.isArray(e);function mb(){var e,t;let r,{files:n=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:i="",preset:o,encoding:a,extensions:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=null,c=!1;if(o){if(!(o in mx))throw Error("Preset must be one of: "+Object.keys(mx).join(", "));n=mx[o],i="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/"}let u=mI(n)&&6===n.length,h=mI(n)&&3===n.length&&n.some(e=>e.endsWith("json")),d=mI(n)?n[0]:n;if(c=mI(n),!(l="cube"===(r=u?"cube":h?"webp":d.startsWith("data:application/exr")?"exr":d.startsWith("data:application/hdr")?"hdr":d.startsWith("data:image/jpeg")?"jpg":null==(e=d.split(".").pop())||null==(e=e.split("?"))||null==(e=e.shift())?void 0:e.toLowerCase())?eR.CubeTextureLoader:"hdr"===r?ms:"exr"===r?mc:"jpg"===r||"jpeg"===r?mB:"webp"===r?mw:null))throw Error("useEnvironment: Unrecognized file extension: "+n);let A=(0,eP.A)(e=>e.gl),f=(0,eP.F)(l,c?[n]:n,e=>{("webp"===r||"jpg"===r||"jpeg"===r)&&e.setRenderer(A),null==e.setPath||e.setPath(i),s&&s(e)}),p=c?f[0]:f;return("jpg"===r||"jpeg"===r||"webp"===r)&&(p=null==(t=p.renderTarget)?void 0:t.texture),p.mapping=u?eR.CubeReflectionMapping:eR.EquirectangularReflectionMapping,"colorSpace"in p?p.colorSpace=(null!=a?a:u)?"srgb":"srgb-linear":p.encoding=(null!=a?a:u)?3001:3e3,p}let m_=e=>e.current&&e.current.isScene,mM=e=>m_(e)?e.current:e;function mS(e,t,r,n){var i,o,a,s,l;let c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};c={backgroundBlurriness:null!==(i=c.blur)&&void 0!==i?i:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...c};let u=mM(t||r),h=u.background,d=u.environment,A={backgroundBlurriness:u.backgroundBlurriness,backgroundIntensity:u.backgroundIntensity,backgroundRotation:null!==(o=null==(a=u.backgroundRotation)||null==a.clone?void 0:a.clone())&&void 0!==o?o:[0,0,0],environmentIntensity:u.environmentIntensity,environmentRotation:null!==(s=null==(l=u.environmentRotation)||null==l.clone?void 0:l.clone())&&void 0!==s?s:[0,0,0]};return"only"!==e&&(u.environment=n),e&&(u.background=n),(0,eP.j)(u,c),()=>{"only"!==e&&(u.environment=d),e&&(u.background=h),(0,eP.j)(u,A)}}function mT(e){let{scene:t,background:r=!1,map:n,...i}=e,o=(0,eP.A)(e=>e.scene);return eT.useLayoutEffect(()=>{if(n)return mS(r,t,o,n,i)}),null}function mD(e){let{background:t=!1,scene:r,blur:n,backgroundBlurriness:i,backgroundIntensity:o,backgroundRotation:a,environmentIntensity:s,environmentRotation:l,...c}=e,u=mb(c),h=(0,eP.A)(e=>e.scene);return eT.useLayoutEffect(()=>mS(t,r,h,u,{blur:n,backgroundBlurriness:i,backgroundIntensity:o,backgroundRotation:a,environmentIntensity:s,environmentRotation:l})),null}function mR(e){let{children:t,near:r=1,far:n=1e3,resolution:i=256,frames:o=1,map:a,background:s=!1,blur:l,backgroundBlurriness:c,backgroundIntensity:u,backgroundRotation:h,environmentIntensity:d,environmentRotation:A,scene:f,files:p,path:m,preset:g,extensions:v}=e,y=(0,eP.A)(e=>e.gl),E=(0,eP.A)(e=>e.scene),C=eT.useRef(null),[w]=eT.useState(()=>new eR.Scene),B=eT.useMemo(()=>{let e=new eR.WebGLCubeRenderTarget(i);return e.texture.type=eR.HalfFloatType,e},[i]);eT.useLayoutEffect(()=>(1===o&&C.current.update(y,w),mS(s,f,E,B.texture,{blur:l,backgroundBlurriness:c,backgroundIntensity:u,backgroundRotation:h,environmentIntensity:d,environmentRotation:A})),[t,w,B.texture,f,E,s,o,y]);let x=1;return(0,eP.C)(()=>{(o===1/0||x<o)&&(C.current.update(y,w),x++)}),eT.createElement(eT.Fragment,null,(0,eP.g)(eT.createElement(eT.Fragment,null,t,eT.createElement("cubeCamera",{ref:C,args:[r,n,B]}),p||g?eT.createElement(mD,{background:!0,files:p,preset:g,path:m,extensions:v}):a?eT.createElement(mT,{background:!0,map:a,extensions:v}):null),w))}function mP(e){var t,r,n,i;let o=mb(e),a=e.map||o;eT.useMemo(()=>(0,eP.e)({GroundProjectedEnvImpl:ma}),[]);let s=eT.useMemo(()=>[a],[a]),l=null==(t=e.ground)?void 0:t.height,c=null==(r=e.ground)?void 0:r.radius,u=null!==(n=null==(i=e.ground)?void 0:i.scale)&&void 0!==n?n:1e3;return eT.createElement(eT.Fragment,null,eT.createElement(mT,(0,eS.Z)({},e,{map:a})),eT.createElement("groundProjectedEnvImpl",{args:s,scale:u,height:l,radius:c}))}function mF(e){return e.ground?eT.createElement(mP,e):e.map?eT.createElement(mT,e):e.children?eT.createElement(mR,e):eT.createElement(mD,e)}let mQ={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    	vec4 sum = vec4( 0.0 );\n\n    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    	gl_FragColor = sum;\n\n    }\n  "},mO={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "},mL=eT.forwardRef((e,t)=>{let r,n,{scale:i=10,frames:o=1/0,opacity:a=1,width:s=1,height:l=1,blur:c=1,near:u=0,far:h=10,resolution:d=512,smooth:A=!0,color:f="#000000",depthWrite:p=!1,renderOrder:m,...g}=e,v=eT.useRef(null),y=(0,eP.A)(e=>e.scene),E=(0,eP.A)(e=>e.gl),C=eT.useRef(null);s*=Array.isArray(i)?i[0]:i||1,l*=Array.isArray(i)?i[1]:i||1;let[w,B,x,I,b,_,M]=eT.useMemo(()=>{let e=new eR.WebGLRenderTarget(d,d),t=new eR.WebGLRenderTarget(d,d);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;let r=new eR.PlaneGeometry(s,l).rotateX(Math.PI/2),n=new eR.Mesh(r),i=new eR.MeshDepthMaterial;i.depthTest=i.depthWrite=!1,i.onBeforeCompile=e=>{e.uniforms={...e.uniforms,ucolor:{value:new eR.Color(f)}},e.fragmentShader=e.fragmentShader.replace("void main() {","uniform vec3 ucolor;\n           void main() {\n          "),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};let o=new eR.ShaderMaterial(mQ),a=new eR.ShaderMaterial(mO);return a.depthTest=o.depthTest=!1,[e,r,i,n,o,a,t]},[d,s,l,i,f]),S=e=>{I.visible=!0,I.material=b,b.uniforms.tDiffuse.value=w.texture,b.uniforms.h.value=1*e/256,E.setRenderTarget(M),E.render(I,C.current),I.material=_,_.uniforms.tDiffuse.value=M.texture,_.uniforms.v.value=1*e/256,E.setRenderTarget(w),E.render(I,C.current),I.visible=!1},T=0;return(0,eP.C)(()=>{C.current&&(o===1/0||T<o)&&(T++,r=y.background,n=y.overrideMaterial,v.current.visible=!1,y.background=null,y.overrideMaterial=x,E.setRenderTarget(w),E.render(y,C.current),S(c),A&&S(.4*c),E.setRenderTarget(null),v.current.visible=!0,y.overrideMaterial=n,y.background=r)}),eT.useImperativeHandle(t,()=>v.current,[]),eT.createElement("group",(0,eS.Z)({"rotation-x":Math.PI/2},g,{ref:v}),eT.createElement("mesh",{renderOrder:m,geometry:B,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},eT.createElement("meshBasicMaterial",{transparent:!0,map:w.texture,opacity:a,depthWrite:p})),eT.createElement("orthographicCamera",{ref:C,args:[-s/2,s/2,l/2,-l/2,u,h]}))}),mk=eT.createContext(null),mU=a1({color:new eR.Color,blend:2,alphaTest:.75,opacity:0,map:null},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vUv = uv;\n   }","varying vec2 vUv;\n   uniform sampler2D map;\n   uniform vec3 color;\n   uniform float opacity;\n   uniform float alphaTest;\n   uniform float blend;\n   void main() {\n     vec4 sampledDiffuseColor = texture2D(map, vUv);\n     gl_FragColor = vec4(color * sampledDiffuseColor.r * blend, max(0.0, (1.0 - (sampledDiffuseColor.r + sampledDiffuseColor.g + sampledDiffuseColor.b) / alphaTest)) * opacity);\n     #include <tonemapping_fragment>\n     #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n   }")),mG=eT.forwardRef((e,t)=>{let{children:r,temporal:n,frames:i=40,limit:o=1/0,blend:a=20,scale:s=10,opacity:l=1,alphaTest:c=.75,color:u="black",colorBlend:h=2,resolution:d=1024,toneMapped:A=!0,...f}=e;(0,eP.e)({SoftShadowMaterial:mU});let p=(0,eP.A)(e=>e.gl),m=(0,eP.A)(e=>e.scene),g=(0,eP.A)(e=>e.camera),v=(0,eP.A)(e=>e.invalidate),y=eT.useRef(null),E=eT.useRef(null),[C]=eT.useState(()=>new mz(p,m,d));eT.useLayoutEffect(()=>{C.configure(y.current)},[]);let w=eT.useMemo(()=>({lights:new Map,temporal:!!n,frames:Math.max(2,i),blend:Math.max(2,i===1/0?a:i),count:0,getMesh:()=>y.current,reset:()=>{C.clear();let e=y.current.material;e.opacity=0,e.alphaTest=0,w.count=0},update:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=y.current.material;w.temporal?(t.opacity=Math.min(l,t.opacity+l/w.blend),t.alphaTest=Math.min(c,t.alphaTest+c/w.blend)):(t.opacity=l,t.alphaTest=c),E.current.visible=!0,C.prepare();for(let t=0;t<e;t++)w.lights.forEach(e=>e.update()),C.update(g,w.blend);E.current.visible=!1,C.finish()}}),[C,g,m,n,i,a,l,c]);return eT.useLayoutEffect(()=>{w.reset(),w.temporal||w.frames===1/0||w.update(w.blend)}),eT.useImperativeHandle(t,()=>w,[w]),(0,eP.C)(()=>{(w.temporal||w.frames===1/0)&&w.count<w.frames&&w.count<o&&(v(),w.update(),w.count++)}),eT.createElement("group",f,eT.createElement("group",{traverse:()=>null,ref:E},eT.createElement(mk.Provider,{value:w},r)),eT.createElement("mesh",{receiveShadow:!0,ref:y,scale:s,rotation:[-Math.PI/2,0,0]},eT.createElement("planeGeometry",null),eT.createElement("softShadowMaterial",{transparent:!0,depthWrite:!1,toneMapped:A,color:u,blend:h,map:C.progressiveLightMap2.texture})))}),mN=eT.forwardRef((e,t)=>{let{castShadow:r=!0,bias:n=.001,mapSize:i=512,size:o=5,near:a=.5,far:s=500,frames:l=1,position:c=[0,0,0],radius:u=1,amount:h=8,intensity:d=a5>=155?Math.PI:1,ambient:A=.5,...f}=e,p=eT.useRef(null),m=new eR.Vector3(...c).length(),g=eT.useContext(mk),v=eT.useCallback(()=>{let e;if(p.current)for(let t=0;t<p.current.children.length;t++)if(e=p.current.children[t],Math.random()>A)e.position.set(c[0]+eR.MathUtils.randFloatSpread(u),c[1]+eR.MathUtils.randFloatSpread(u),c[2]+eR.MathUtils.randFloatSpread(u));else{let t=Math.acos(2*Math.random()-1)-Math.PI/2,r=2*Math.PI*Math.random();e.position.set(Math.cos(t)*Math.cos(r)*m,Math.abs(Math.cos(t)*Math.sin(r)*m),Math.sin(t)*m)}},[u,A,m,...c]),y=eT.useMemo(()=>({update:v}),[v]);return eT.useImperativeHandle(t,()=>y,[y]),eT.useLayoutEffect(()=>{var e;let t=p.current;return g&&(null==(e=g.lights)||e.set(t.uuid,y)),()=>{var e;null==g||null==(e=g.lights)||e.delete(t.uuid)}},[g,y]),eT.createElement("group",(0,eS.Z)({ref:p},f),Array.from({length:h},(e,t)=>eT.createElement("directionalLight",{key:t,castShadow:r,"shadow-bias":n,"shadow-mapSize":[i,i],intensity:d/h},eT.createElement("orthographicCamera",{attach:"shadow-camera",args:[-o,o,o,-o,a,s]}))))});class mz{clear(){this.renderer.getClearColor(this.clearColor),this.clearAlpha=this.renderer.getClearAlpha(),this.renderer.setClearColor("black",1),this.renderer.setRenderTarget(this.progressiveLightMap1),this.renderer.clear(),this.renderer.setRenderTarget(this.progressiveLightMap2),this.renderer.clear(),this.renderer.setRenderTarget(null),this.renderer.setClearColor(this.clearColor,this.clearAlpha),this.lights=[],this.meshes=[],this.scene.traverse(e=>{e.geometry?this.meshes.push({object:e,material:e.material}):e.isLight&&this.lights.push({object:e,intensity:e.intensity})})}prepare(){this.lights.forEach(e=>e.object.intensity=0),this.meshes.forEach(e=>e.object.material=this.discardMat)}finish(){this.lights.forEach(e=>e.object.intensity=e.intensity),this.meshes.forEach(e=>e.object.material=e.material)}configure(e){this.object=e}update(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(!this.object)return;this.averagingWindow.value=t,this.object.material=this.targetMat;let r=this.buffer1Active?this.progressiveLightMap1:this.progressiveLightMap2,n=this.buffer1Active?this.progressiveLightMap2:this.progressiveLightMap1,i=this.scene.background;this.scene.background=null,this.renderer.setRenderTarget(r),this.previousShadowMap.value=n.texture,this.buffer1Active=!this.buffer1Active,this.renderer.render(this.scene,e),this.renderer.setRenderTarget(null),this.scene.background=i}constructor(e,t,r=1024){this.renderer=e,this.res=r,this.scene=t,this.buffer1Active=!1,this.lights=[],this.meshes=[],this.object=null,this.clearColor=new eR.Color,this.clearAlpha=0;let n={type:eR.HalfFloatType,magFilter:eR.NearestFilter,minFilter:eR.NearestFilter};this.progressiveLightMap1=new eR.WebGLRenderTarget(this.res,this.res,n),this.progressiveLightMap2=new eR.WebGLRenderTarget(this.res,this.res,n),this.discardMat=new pw,this.targetMat=new eR.MeshLambertMaterial({fog:!1}),this.previousShadowMap={value:this.progressiveLightMap1.texture},this.averagingWindow={value:100},this.targetMat.onBeforeCompile=e=>{e.vertexShader="varying vec2 vUv;\n"+e.vertexShader.slice(0,-1)+"vUv = uv; gl_Position = vec4((uv - 0.5) * 2.0, 1.0, 1.0); }";let t=e.fragmentShader.indexOf("void main() {");e.fragmentShader="varying vec2 vUv;\n"+e.fragmentShader.slice(0,t)+"uniform sampler2D previousShadowMap;\n	uniform float averagingWindow;\n"+e.fragmentShader.slice(t-1,-1)+"\nvec3 texelOld = texture2D(previousShadowMap, vUv).rgb;\n        gl_FragColor.rgb = mix(texelOld, gl_FragColor.rgb, 1.0/ averagingWindow);\n      }",e.uniforms.previousShadowMap=this.previousShadowMap,e.uniforms.averagingWindow=this.averagingWindow}}}let mH={rembrandt:{main:[1,2,1],fill:[-2,-.5,-2]},portrait:{main:[-1,2,.5],fill:[-1,.5,-1.5]},upfront:{main:[0,2,1],fill:[-1,.5,-1.5]},soft:{main:[-2,4,4],fill:[-1,.5,-1.5]}};function mV(e){let{radius:t,adjustCamera:r}=e,n=p8();return eT.useEffect(()=>{r&&n.refresh().clip().fit()},[t,r]),null}function mj(e){var t,r,n,i,o,a,s,l;let{children:c,center:u,adjustCamera:h=!0,intensity:d=.5,shadows:A="contact",environment:f="city",preset:p="rembrandt",...m}=e,g="string"==typeof p?mH[p]:p,[{radius:v,height:y},E]=eT.useState({radius:0,width:0,height:0,depth:0}),C=null!==(t=null==A?void 0:A.bias)&&void 0!==t?t:-.0001,w=null!==(r=null==A?void 0:A.normalBias)&&void 0!==r?r:0,B=null!==(n=null==A?void 0:A.size)&&void 0!==n?n:1024,x=null!==(i=null==A?void 0:A.offset)&&void 0!==i?i:0,I="contact"===A||(null==A?void 0:A.type)==="contact",b="accumulative"===A||(null==A?void 0:A.type)==="accumulative",_={..."object"==typeof A?A:{}},M=f?"string"==typeof f?{preset:f}:f:null,S=eT.useCallback(e=>{let{width:t,height:r,depth:n,boundingSphere:i}=e;E({radius:i.radius,width:t,height:r,depth:n}),null!=u&&u.onCentered&&u.onCentered(e)},[]);return eT.createElement(eT.Fragment,null,eT.createElement("ambientLight",{intensity:d/3}),eT.createElement("spotLight",{penumbra:1,position:[g.main[0]*v,g.main[1]*v,g.main[2]*v],intensity:2*d,castShadow:!!A,"shadow-bias":C,"shadow-normalBias":w,"shadow-mapSize":B}),eT.createElement("pointLight",{position:[g.fill[0]*v,g.fill[1]*v,g.fill[2]*v],intensity:d}),eT.createElement(p6,(0,eS.Z)({fit:!!h,clip:!!h,margin:Number(h),observe:!0},m),eT.createElement(mV,{radius:v,adjustCamera:h}),eT.createElement(fO,(0,eS.Z)({},u,{position:[0,x/2,0],onCentered:S}),c)),eT.createElement("group",{position:[0,-y/2-x/2,0]},I&&eT.createElement(mL,(0,eS.Z)({scale:4*v,far:v,blur:2},_)),b&&eT.createElement(mG,(0,eS.Z)({temporal:!0,frames:100,alphaTest:.9,toneMapped:!0,scale:4*v},_),eT.createElement(mN,{amount:null!==(o=_.amount)&&void 0!==o?o:8,radius:null!==(a=_.radius)&&void 0!==a?a:v,ambient:null!==(s=_.ambient)&&void 0!==s?s:.5,intensity:null!==(l=_.intensity)&&void 0!==l?l:1,position:[g.main[0]*v,g.main[1]*v,g.main[2]*v],size:4*v,bias:-C,mapSize:B}))),f&&eT.createElement(mF,M))}let mJ=e=>0===e?0:Math.pow(2,10*e-10);function mY(e){let{children:t,floor:r=.25,segments:n=20,receiveShadow:i,...o}=e,a=eT.useRef(null);return eT.useLayoutEffect(()=>{let e=0,t=n/n/2,i=a.current.attributes.position;for(let o=0;o<n+1;o++)for(let a=0;a<n+1;a++)i.setXYZ(e++,o/n-t+(0===o?-r:0),a/n-t,mJ(o/n));i.needsUpdate=!0,a.current.computeVertexNormals()},[n,r]),eT.createElement("group",o,eT.createElement("mesh",{receiveShadow:i,rotation:[-Math.PI/2,0,Math.PI/2]},eT.createElement("planeGeometry",{ref:a,args:[1,1,n,n]}),t))}let mW=eT.forwardRef((e,t)=>{let{fog:r=!1,renderOrder:n,depthWrite:i=!1,colorStop:o=0,color:a="black",opacity:s=.5,...l}=e,c=eT.useMemo(()=>{let e=document.createElement("canvas");e.width=128,e.height=128;let t=e.getContext("2d"),r=t.createRadialGradient(e.width/2,e.height/2,0,e.width/2,e.height/2,e.width/2);return r.addColorStop(o,new eR.Color(a).getStyle()),r.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=r,t.fillRect(0,0,e.width,e.height),e},[a,o]);return eT.createElement("mesh",(0,eS.Z)({renderOrder:n,ref:t,"rotation-x":-Math.PI/2},l),eT.createElement("planeGeometry",null),eT.createElement("meshBasicMaterial",{transparent:!0,opacity:s,fog:r,depthWrite:i,side:eR.DoubleSide},eT.createElement("canvasTexture",{attach:"map",args:[c]})))});function mq(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eR.FrontSide,t={value:new eR.Matrix4};return Object.assign(new eR.MeshNormalMaterial({side:e}),{viewMatrix:t,onBeforeCompile:e=>{e.uniforms.viewMatrix=t,e.fragmentShader="vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n           return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n         }\n"+e.fragmentShader.replace("#include <normal_fragment_maps>","#include <normal_fragment_maps>\n           normal = inverseTransformDirection( normal, viewMatrix );\n")}})}let mK=a1({causticsTexture:null,causticsTextureB:null,color:new eR.Color,lightProjMatrix:new eR.Matrix4,lightViewMatrix:new eR.Matrix4},"varying vec3 vWorldPosition;\n   void main() {\n     gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n     vec4 worldPosition = modelMatrix * vec4(position, 1.);\n     vWorldPosition = worldPosition.xyz;\n   }","varying vec3 vWorldPosition;\n  uniform vec3 color;\n  uniform sampler2D causticsTexture;\n  uniform sampler2D causticsTextureB;\n  uniform mat4 lightProjMatrix;\n  uniform mat4 lightViewMatrix;\n   void main() {\n    // Apply caustics\n    vec4 lightSpacePos = lightProjMatrix * lightViewMatrix * vec4(vWorldPosition, 1.0);\n    lightSpacePos.xyz /= lightSpacePos.w;\n    lightSpacePos.xyz = lightSpacePos.xyz * 0.5 + 0.5;\n    vec3 front = texture2D(causticsTexture, lightSpacePos.xy).rgb;\n    vec3 back = texture2D(causticsTextureB, lightSpacePos.xy).rgb;\n    gl_FragColor = vec4((front + back) * color, 1.0);\n    #include <tonemapping_fragment>\n    #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n   }")),mX=a1({cameraMatrixWorld:new eR.Matrix4,cameraProjectionMatrixInv:new eR.Matrix4,normalTexture:null,depthTexture:null,lightDir:new eR.Vector3(0,1,0),lightPlaneNormal:new eR.Vector3(0,1,0),lightPlaneConstant:0,near:.1,far:100,modelMatrix:new eR.Matrix4,worldRadius:1/40,ior:1.1,bounces:0,resolution:1024,size:10,intensity:.5},"\n  varying vec2 vUv;\n  void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  }","\n  uniform mat4 cameraMatrixWorld;\n  uniform mat4 cameraProjectionMatrixInv;\n  uniform vec3 lightDir;\n  uniform vec3 lightPlaneNormal;\n  uniform float lightPlaneConstant;\n  uniform float near;\n  uniform float far;\n  uniform float time;\n  uniform float worldRadius;\n  uniform float resolution;\n  uniform float size;\n  uniform float intensity;\n  uniform float ior;\n  precision highp isampler2D;\n  precision highp usampler2D;\n  uniform sampler2D normalTexture;\n  uniform sampler2D depthTexture;\n  uniform float bounces;\n  varying vec2 vUv;\n  vec3 WorldPosFromDepth(float depth, vec2 coord) {\n    float z = depth * 2.0 - 1.0;\n    vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n    vec4 viewSpacePosition = cameraProjectionMatrixInv * clipSpacePosition;\n    // Perspective division\n    viewSpacePosition /= viewSpacePosition.w;\n    vec4 worldSpacePosition = cameraMatrixWorld * viewSpacePosition;\n    return worldSpacePosition.xyz;\n  }\n  float sdPlane( vec3 p, vec3 n, float h ) {\n    // n must be normalized\n    return dot(p,n) + h;\n  }\n  float planeIntersect( vec3 ro, vec3 rd, vec4 p ) {\n    return -(dot(ro,p.xyz)+p.w)/dot(rd,p.xyz);\n  }\n  vec3 totalInternalReflection(vec3 ro, vec3 rd, vec3 pos, vec3 normal, float ior, out vec3 rayOrigin, out vec3 rayDirection) {\n    rayOrigin = ro;\n    rayDirection = rd;\n    rayDirection = refract(rayDirection, normal, 1.0 / ior);\n    rayOrigin = pos + rayDirection * 0.1;\n    return rayDirection;\n  }\n  void main() {\n    // Each sample consists of random offset in the x and y direction\n    float caustic = 0.0;\n    float causticTexelSize = (1.0 / resolution) * size * 2.0;\n    float texelsNeeded = worldRadius / causticTexelSize;\n    float sampleRadius = texelsNeeded / resolution;\n    float sum = 0.0;\n    if (texture2D(depthTexture, vUv).x == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec2 offset1 = vec2(-0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset2 = vec2(-0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset3 = vec2(0.5, 0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 offset4 = vec2(0.5, -0.5);//vec2(rand() - 0.5, rand() - 0.5);\n    vec2 uv1 = vUv + offset1 * sampleRadius;\n    vec2 uv2 = vUv + offset2 * sampleRadius;\n    vec2 uv3 = vUv + offset3 * sampleRadius;\n    vec2 uv4 = vUv + offset4 * sampleRadius;\n    vec3 normal1 = texture2D(normalTexture, uv1, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal2 = texture2D(normalTexture, uv2, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal3 = texture2D(normalTexture, uv3, -10.0).rgb * 2.0 - 1.0;\n    vec3 normal4 = texture2D(normalTexture, uv4, -10.0).rgb * 2.0 - 1.0;\n    float depth1 = texture2D(depthTexture, uv1, -10.0).x;\n    float depth2 = texture2D(depthTexture, uv2, -10.0).x;\n    float depth3 = texture2D(depthTexture, uv3, -10.0).x;\n    float depth4 = texture2D(depthTexture, uv4, -10.0).x;\n    // Sanity check the depths\n    if (depth1 == 1.0 || depth2 == 1.0 || depth3 == 1.0 || depth4 == 1.0) {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      return;\n    }\n    vec3 pos1 = WorldPosFromDepth(depth1, uv1);\n    vec3 pos2 = WorldPosFromDepth(depth2, uv2);\n    vec3 pos3 = WorldPosFromDepth(depth3, uv3);\n    vec3 pos4 = WorldPosFromDepth(depth4, uv4);\n    vec3 originPos1 = WorldPosFromDepth(0.0, uv1);\n    vec3 originPos2 = WorldPosFromDepth(0.0, uv2);\n    vec3 originPos3 = WorldPosFromDepth(0.0, uv3);\n    vec3 originPos4 = WorldPosFromDepth(0.0, uv4);\n    vec3 endPos1, endPos2, endPos3, endPos4;\n    vec3 endDir1, endDir2, endDir3, endDir4;\n    totalInternalReflection(originPos1, lightDir, pos1, normal1, ior, endPos1, endDir1);\n    totalInternalReflection(originPos2, lightDir, pos2, normal2, ior, endPos2, endDir2);\n    totalInternalReflection(originPos3, lightDir, pos3, normal3, ior, endPos3, endDir3);\n    totalInternalReflection(originPos4, lightDir, pos4, normal4, ior, endPos4, endDir4);\n    float lightPosArea = length(cross(originPos2 - originPos1, originPos3 - originPos1)) + length(cross(originPos3 - originPos1, originPos4 - originPos1));\n    float t1 = planeIntersect(endPos1, endDir1, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t2 = planeIntersect(endPos2, endDir2, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t3 = planeIntersect(endPos3, endDir3, vec4(lightPlaneNormal, lightPlaneConstant));\n    float t4 = planeIntersect(endPos4, endDir4, vec4(lightPlaneNormal, lightPlaneConstant));\n    vec3 finalPos1 = endPos1 + endDir1 * t1;\n    vec3 finalPos2 = endPos2 + endDir2 * t2;\n    vec3 finalPos3 = endPos3 + endDir3 * t3;\n    vec3 finalPos4 = endPos4 + endDir4 * t4;\n    float finalArea = length(cross(finalPos2 - finalPos1, finalPos3 - finalPos1)) + length(cross(finalPos3 - finalPos1, finalPos4 - finalPos1));\n    caustic += intensity * (lightPosArea / finalArea);\n    // Calculate the area of the triangle in light spaces\n    gl_FragColor = vec4(vec3(max(caustic, 0.0)), 1.0);\n  }"),mZ={depth:!0,minFilter:eR.LinearFilter,magFilter:eR.LinearFilter,type:eR.UnsignedByteType},m$={minFilter:eR.LinearMipmapLinearFilter,magFilter:eR.LinearFilter,type:eR.FloatType,generateMipmaps:!0},m0=eT.forwardRef((e,t)=>{let{debug:r,children:n,frames:i=1,ior:o=1.1,color:a="white",causticsOnly:s=!1,backside:l=!1,backsideIOR:c=1.1,worldRadius:u=.3125,intensity:h=.05,resolution:d=2024,lightSource:A=[5,5,5],...f}=e;(0,eP.e)({CausticsProjectionMaterial:mK});let p=eT.useRef(null),m=eT.useRef(null),g=eT.useRef(null),v=eT.useRef(null),y=(0,eP.A)(e=>e.gl),E=dE(r&&m,eR.CameraHelper),C=lV(d,d,mZ),w=lV(d,d,mZ),B=lV(d,d,m$),x=lV(d,d,m$),[I]=eT.useState(()=>mq()),[b]=eT.useState(()=>mq(eR.BackSide)),[_]=eT.useState(()=>new mX),[M]=eT.useState(()=>new aR(_));eT.useLayoutEffect(()=>{p.current.updateWorldMatrix(!1,!0)});let S=0,T=new eR.Vector3,D=new eR.Frustum,R=new eR.Matrix4,P=new eR.Plane,F=new eR.Vector3,Q=new eR.Vector3,O=new eR.Box3,L=new eR.Vector3,k=[],U=[],G=[],N=[],z=new eR.Vector3;for(let e=0;e<8;e++)k.push(new eR.Vector3),U.push(new eR.Vector3),G.push(new eR.Vector3),N.push(new eR.Vector3);return(0,eP.C)(()=>{if(i===1/0||S++<i){var e,t;Array.isArray(A)?F.fromArray(A).normalize():F.copy(p.current.worldToLocal(A.current.getWorldPosition(T)).normalize()),Q.copy(F).multiplyScalar(-1),null==(e=g.current.parent)||e.matrixWorld.identity(),O.setFromObject(g.current,!0),k[0].set(O.min.x,O.min.y,O.min.z),k[1].set(O.min.x,O.min.y,O.max.z),k[2].set(O.min.x,O.max.y,O.min.z),k[3].set(O.min.x,O.max.y,O.max.z),k[4].set(O.max.x,O.min.y,O.min.z),k[5].set(O.max.x,O.min.y,O.max.z),k[6].set(O.max.x,O.max.y,O.min.z),k[7].set(O.max.x,O.max.y,O.max.z);for(let e=0;e<8;e++)U[e].copy(k[e]);O.getCenter(L),k.map(e=>e.sub(L));let n=P.set(Q,0);k.map((e,t)=>n.projectPoint(e,G[t]));let i=G.reduce((e,t)=>e.add(t),T.set(0,0,0)).divideScalar(G.length),a=G.map(e=>e.distanceTo(i)).reduce((e,t)=>Math.max(e,t)),f=k.map(e=>e.dot(F)).reduce((e,t)=>Math.max(e,t));m.current.position.copy(z.copy(F).multiplyScalar(f).add(L)),m.current.lookAt(g.current.localToWorld(L));let S=R.lookAt(m.current.position,L,T.set(0,1,0));m.current.left=-a,m.current.right=a,m.current.top=a,m.current.bottom=-a;let H=T.set(0,a,0).applyMatrix4(S),V=(m.current.position.y+H.y)/F.y;m.current.near=.1,m.current.far=V,m.current.updateProjectionMatrix(),m.current.updateMatrixWorld();let j=U.map((e,t)=>e.add(N[t].copy(F).multiplyScalar(-e.y/F.y))),J=j.reduce((e,t)=>e.add(t),T.set(0,0,0)).divideScalar(j.length),Y=2*j.map(e=>Math.hypot(e.x-J.x,e.z-J.z)).reduce((e,t)=>Math.max(e,t));v.current.scale.setScalar(Y),v.current.position.copy(J),r&&(null==(t=E.current)||t.update()),b.viewMatrix.value=I.viewMatrix.value=m.current.matrixWorldInverse;let W=D.setFromProjectionMatrix(R.multiplyMatrices(m.current.projectionMatrix,m.current.matrixWorldInverse)).planes[4];_.cameraMatrixWorld=m.current.matrixWorld,_.cameraProjectionMatrixInv=m.current.projectionMatrixInverse,_.lightDir=Q,_.lightPlaneNormal=W.normal,_.lightPlaneConstant=W.constant,_.near=m.current.near,_.far=m.current.far,_.resolution=d,_.size=a,_.intensity=h,_.worldRadius=u,g.current.visible=!0,y.setRenderTarget(C),y.clear(),g.current.overrideMaterial=I,y.render(g.current,m.current),y.setRenderTarget(w),y.clear(),l&&(g.current.overrideMaterial=b,y.render(g.current,m.current)),g.current.overrideMaterial=null,_.ior=o,v.current.material.lightProjMatrix=m.current.projectionMatrix,v.current.material.lightViewMatrix=m.current.matrixWorldInverse,_.normalTexture=C.texture,_.depthTexture=C.depthTexture,y.setRenderTarget(B),y.clear(),M.render(y),_.ior=c,_.normalTexture=w.texture,_.depthTexture=w.depthTexture,y.setRenderTarget(x),y.clear(),l&&M.render(y),y.setRenderTarget(null),s&&(g.current.visible=!1)}}),eT.useImperativeHandle(t,()=>p.current,[]),eT.createElement("group",(0,eS.Z)({ref:p},f),eT.createElement("scene",{ref:g},eT.createElement("orthographicCamera",{ref:m,up:[0,1,0]}),n),eT.createElement("mesh",{renderOrder:2,ref:v,"rotation-x":-Math.PI/2},eT.createElement("planeGeometry",null),eT.createElement("causticsProjectionMaterial",{transparent:!0,color:a,causticsTexture:B.texture,causticsTextureB:x.texture,blending:eR.CustomBlending,blendSrc:eR.OneFactor,blendDst:eR.SrcAlphaFactor,depthWrite:!1}),r&&eT.createElement(st,null,eT.createElement("lineBasicMaterial",{color:"#ffff00",toneMapped:!1}))))}),m1=eT.forwardRef((e,t)=>{let{mixBlur:r=0,mixStrength:n=.5,resolution:i=256,blur:o=[0,0],args:a=[1,1],minDepthThreshold:s=.9,maxDepthThreshold:l=1,depthScale:c=0,depthToBlurRatioBias:u=.25,mirror:h=0,children:d,debug:A=0,distortion:f=1,mixContrast:p=1,distortionMap:m,...g}=e;(0,eP.e)({MeshReflectorMaterial:ph}),eT.useEffect(()=>{console.warn("Reflector has been deprecated and will be removed next major. Replace it with <MeshReflectorMaterial />!")},[]);let v=(0,eP.A)(e=>{let{gl:t}=e;return t}),y=(0,eP.A)(e=>{let{camera:t}=e;return t}),E=(0,eP.A)(e=>{let{scene:t}=e;return t}),C=(o=Array.isArray(o)?o:[o,o])[0]+o[1]>0,w=eT.useRef(null);eT.useImperativeHandle(t,()=>w.current,[]);let[B]=eT.useState(()=>new eR.Plane),[x]=eT.useState(()=>new eR.Vector3),[I]=eT.useState(()=>new eR.Vector3),[b]=eT.useState(()=>new eR.Vector3),[_]=eT.useState(()=>new eR.Matrix4),[M]=eT.useState(()=>new eR.Vector3(0,0,-1)),[S]=eT.useState(()=>new eR.Vector4),[T]=eT.useState(()=>new eR.Vector3),[D]=eT.useState(()=>new eR.Vector3),[R]=eT.useState(()=>new eR.Vector4),[P]=eT.useState(()=>new eR.Matrix4),[F]=eT.useState(()=>new eR.PerspectiveCamera),Q=eT.useCallback(()=>{if(I.setFromMatrixPosition(w.current.matrixWorld),b.setFromMatrixPosition(y.matrixWorld),_.extractRotation(w.current.matrixWorld),x.set(0,0,1),x.applyMatrix4(_),T.subVectors(I,b),T.dot(x)>0)return;T.reflect(x).negate(),T.add(I),_.extractRotation(y.matrixWorld),M.set(0,0,-1),M.applyMatrix4(_),M.add(b),D.subVectors(I,M),D.reflect(x).negate(),D.add(I),F.position.copy(T),F.up.set(0,1,0),F.up.applyMatrix4(_),F.up.reflect(x),F.lookAt(D),F.far=y.far,F.updateMatrixWorld(),F.projectionMatrix.copy(y.projectionMatrix),P.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),P.multiply(F.projectionMatrix),P.multiply(F.matrixWorldInverse),P.multiply(w.current.matrixWorld),B.setFromNormalAndCoplanarPoint(x,I),B.applyMatrix4(F.matrixWorldInverse),S.set(B.normal.x,B.normal.y,B.normal.z,B.constant);let e=F.projectionMatrix;R.x=(Math.sign(S.x)+e.elements[8])/e.elements[0],R.y=(Math.sign(S.y)+e.elements[9])/e.elements[5],R.z=-1,R.w=(1+e.elements[10])/e.elements[14],S.multiplyScalar(2/S.dot(R)),e.elements[2]=S.x,e.elements[6]=S.y,e.elements[10]=S.z+1,e.elements[14]=S.w},[]),[O,L,k,U]=eT.useMemo(()=>{let e={type:eR.HalfFloatType,minFilter:eR.LinearFilter,magFilter:eR.LinearFilter},t=new eR.WebGLRenderTarget(i,i,e);t.depthBuffer=!0,t.depthTexture=new eR.DepthTexture(i,i),t.depthTexture.format=eR.DepthFormat,t.depthTexture.type=eR.UnsignedShortType;let a=new eR.WebGLRenderTarget(i,i,e),d=new pu({gl:v,resolution:i,width:o[0],height:o[1],minDepthThreshold:s,maxDepthThreshold:l,depthScale:c,depthToBlurRatioBias:u}),g={mirror:h,textureMatrix:P,mixBlur:r,tDiffuse:t.texture,tDepth:t.depthTexture,tDiffuseBlur:a.texture,hasBlur:C,mixStrength:n,minDepthThreshold:s,maxDepthThreshold:l,depthScale:c,depthToBlurRatioBias:u,transparent:!0,debug:A,distortion:f,distortionMap:m,mixContrast:p,"defines-USE_BLUR":C?"":void 0,"defines-USE_DEPTH":c>0?"":void 0,"defines-USE_DISTORTION":m?"":void 0};return[t,a,d,g]},[v,o,P,i,h,C,r,n,s,l,c,u,A,f,m,p]);return(0,eP.C)(()=>{if(!(null!=w&&w.current))return;w.current.visible=!1;let e=v.xr.enabled,t=v.shadowMap.autoUpdate;Q(),v.xr.enabled=!1,v.shadowMap.autoUpdate=!1,v.setRenderTarget(O),v.state.buffers.depth.setMask(!0),v.autoClear||v.clear(),v.render(E,F),C&&k.render(v,O,L),v.xr.enabled=e,v.shadowMap.autoUpdate=t,w.current.visible=!0,v.setRenderTarget(null)}),eT.createElement("mesh",(0,eS.Z)({ref:w},g),eT.createElement("planeGeometry",{args:a}),d?d("meshReflectorMaterial",U):eT.createElement("meshReflectorMaterial",U))});class m2 extends eR.ShaderMaterial{constructor(){super({uniforms:{depth:{value:null},opacity:{value:1},attenuation:{value:2.5},anglePower:{value:12},spotPosition:{value:new eR.Vector3(0,0,0)},lightColor:{value:new eR.Color("white")},cameraNear:{value:0},cameraFar:{value:1},resolution:{value:new eR.Vector2(0,0)}},transparent:!0,depthWrite:!1,vertexShader:"\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n        uniform vec3 spotPosition;\n        uniform float attenuation;\n\n        #include <common>\n        #include <logdepthbuf_pars_vertex>\n\n        void main() {\n          // compute intensity\n          vNormal = normalize(normalMatrix * normal);\n          vec4 worldPosition = modelMatrix * vec4(position, 1);\n          vec4 viewPosition = viewMatrix * worldPosition;\n          vViewZ = viewPosition.z;\n\n          vIntensity = 1.0 - saturate(distance(worldPosition.xyz, spotPosition) / attenuation);\n\n          gl_Position = projectionMatrix * viewPosition;\n\n          #include <logdepthbuf_vertex>\n        }\n      ",fragmentShader:"\n        varying vec3 vNormal;\n        varying float vViewZ;\n        varying float vIntensity;\n\n        uniform vec3 lightColor;\n        uniform float anglePower;\n        uniform sampler2D depth;\n        uniform vec2 resolution;\n        uniform float cameraNear;\n        uniform float cameraFar;\n        uniform float opacity;\n\n        #include <packing>\n        #include <logdepthbuf_pars_fragment>\n\n        float readDepth(sampler2D depthSampler, vec2 uv) {\n          float fragCoordZ = texture(depthSampler, uv).r;\n\n          // https://github.com/mrdoob/three.js/issues/23072\n          #ifdef USE_LOGDEPTHBUF\n            float viewZ = 1.0 - exp2(fragCoordZ * log(cameraFar + 1.0) / log(2.0));\n          #else\n            float viewZ = perspectiveDepthToViewZ(fragCoordZ, cameraNear, cameraFar);\n          #endif\n\n          return viewZ;\n        }\n\n        void main() {\n          #include <logdepthbuf_fragment>\n\n          vec3 normal = vec3(vNormal.x, vNormal.y, abs(vNormal.z));\n          float angleIntensity = pow(dot(normal, vec3(0, 0, 1)), anglePower);\n          float intensity = vIntensity * angleIntensity;\n\n          // fades when z is close to sampled depth, meaning the cone is intersecting existing geometry\n          bool isSoft = resolution[0] > 0.0 && resolution[1] > 0.0;\n          if (isSoft) {\n            vec2 uv = gl_FragCoord.xy / resolution;\n            intensity *= smoothstep(0.0, 1.0, vViewZ - readDepth(depth, uv));\n          }\n\n          gl_FragColor = vec4(lightColor, intensity * opacity);\n\n          #include <tonemapping_fragment>\n          #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n        }\n      ")})}}let m3=e=>null==e?void 0:e.isSpotLight;function m4(e){let{opacity:t=1,radiusTop:r,radiusBottom:n,depthBuffer:i,color:o="white",distance:a=5,angle:s=.15,attenuation:l=5,anglePower:c=5}=e,u=eT.useRef(null),h=(0,eP.A)(e=>e.size),d=(0,eP.A)(e=>e.camera),A=(0,eP.A)(e=>e.viewport.dpr),[f]=eT.useState(()=>new m2),[p]=eT.useState(()=>new eR.Vector3);r=void 0===r?.1:r,n=void 0===n?7*s:n,(0,eP.C)(()=>{f.uniforms.spotPosition.value.copy(u.current.getWorldPosition(p)),u.current.lookAt(u.current.parent.target.getWorldPosition(p))});let m=eT.useMemo(()=>{let e=new eR.CylinderGeometry(r,n,a,128,64,!0);return e.applyMatrix4(new eR.Matrix4().makeTranslation(0,-a/2,0)),e.applyMatrix4(new eR.Matrix4().makeRotationX(-Math.PI/2)),e},[a,r,n]);return eT.createElement(eT.Fragment,null,eT.createElement("mesh",{ref:u,geometry:m,raycast:()=>null},eT.createElement("primitive",{object:f,attach:"material","uniforms-opacity-value":t,"uniforms-lightColor-value":o,"uniforms-attenuation-value":l,"uniforms-anglePower-value":c,"uniforms-depth-value":i,"uniforms-cameraNear-value":d.near,"uniforms-cameraFar-value":d.far,"uniforms-resolution-value":i?[h.width*A,h.height*A]:[0,0]})))}function m5(e,t,r,n,i){let[[o,a]]=eT.useState(()=>[new eR.Vector3,new eR.Vector3]);eT.useLayoutEffect(()=>{if(m3(e.current))e.current.shadow.mapSize.set(r,n),e.current.shadow.needsUpdate=!0;else throw Error("SpotlightShadow must be a child of a SpotLight")},[e,r,n]),(0,eP.C)(()=>{if(!e.current)return;let r=e.current.position,n=e.current.target.position;a.copy(n).sub(r);var s=a.length();a.normalize().multiplyScalar(s*i),o.copy(r).add(a),t.current.position.copy(o),t.current.lookAt(e.current.target.position)})}function m9(e){let{distance:t=.4,alphaTest:r=.5,map:n,shader:i="#define GLSLIFY 1\nvarying vec2 vUv;uniform sampler2D uShadowMap;uniform float uTime;void main(){vec3 color=texture2D(uShadowMap,vUv).xyz;gl_FragColor=vec4(color,1.);}",width:o=512,height:a=512,scale:s=1,children:l,...c}=e,u=eT.useRef(null),h=c.spotlightRef,d=c.debug;m5(h,u,o,a,t);let A=eT.useMemo(()=>new eR.WebGLRenderTarget(o,a,{format:eR.RGBAFormat,stencilBuffer:!1}),[o,a]),f=eT.useRef({uShadowMap:{value:n},uTime:{value:0}});eT.useEffect(()=>void(f.current.uShadowMap.value=n),[n]);let p=eT.useMemo(()=>new aR(new eR.ShaderMaterial({uniforms:f.current,vertexShader:"\n          varying vec2 vUv;\n\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n          ",fragmentShader:i})),[i]);return eT.useEffect(()=>()=>{p.material.dispose(),p.dispose()},[p]),eT.useEffect(()=>()=>A.dispose(),[A]),(0,eP.C)((e,t)=>{let{gl:r}=e;f.current.uTime.value+=t,r.setRenderTarget(A),p.render(r),r.setRenderTarget(null)}),eT.createElement(eT.Fragment,null,eT.createElement("mesh",{ref:u,scale:s,castShadow:!0},eT.createElement("planeGeometry",null),eT.createElement("meshBasicMaterial",{transparent:!0,side:eR.DoubleSide,alphaTest:r,alphaMap:A.texture,"alphaMap-wrapS":eR.RepeatWrapping,"alphaMap-wrapT":eR.RepeatWrapping,opacity:d?1:0},l)))}function m6(e){let{distance:t=.4,alphaTest:r=.5,map:n,width:i=512,height:o=512,scale:a,children:s,...l}=e,c=eT.useRef(null),u=l.spotlightRef,h=l.debug;return m5(u,c,i,o,t),eT.createElement(eT.Fragment,null,eT.createElement("mesh",{ref:c,scale:a,castShadow:!0},eT.createElement("planeGeometry",null),eT.createElement("meshBasicMaterial",{transparent:!0,side:eR.DoubleSide,alphaTest:r,alphaMap:n,"alphaMap-wrapS":eR.RepeatWrapping,"alphaMap-wrapT":eR.RepeatWrapping,opacity:h?1:0},s)))}function m8(e){return e.shader?eT.createElement(m9,e):eT.createElement(m6,e)}let m7=eT.forwardRef((e,t)=>{let{opacity:r=1,radiusTop:n,radiusBottom:i,depthBuffer:o,color:a="white",distance:s=5,angle:l=.15,attenuation:c=5,anglePower:u=5,volumetric:h=!0,debug:d=!1,children:A,...f}=e,p=eT.useRef(null);return eT.useImperativeHandle(t,()=>p.current,[]),eT.createElement("group",null,d&&p.current&&eT.createElement("spotLightHelper",{args:[p.current]}),eT.createElement("spotLight",(0,eS.Z)({ref:p,angle:l,color:a,distance:s,castShadow:!0},f),h&&eT.createElement(m4,{debug:d,opacity:r,radiusTop:n,radiusBottom:i,depthBuffer:o,color:a,distance:s,angle:l,attenuation:c,anglePower:u})),A&&eT.cloneElement(A,{spotlightRef:p,debug:d}))}),ge=eT.forwardRef((e,t)=>{let{args:r,map:n,toneMapped:i=!1,color:o="white",form:a="rect",intensity:s=1,scale:l=1,target:c,children:u,...h}=e,d=eT.useRef(null);return eT.useImperativeHandle(t,()=>d.current,[]),eT.useLayoutEffect(()=>{u||h.material||((0,eP.j)(d.current.material,{color:o}),d.current.material.color.multiplyScalar(s))},[o,s,u,h.material]),eT.useLayoutEffect(()=>{c&&d.current.lookAt(Array.isArray(c)?new eR.Vector3(...c):c)},[c]),l=Array.isArray(l)&&2===l.length?[l[0],l[1],1]:l,eT.createElement("mesh",(0,eS.Z)({ref:d,scale:l},h),"circle"===a?eT.createElement("ringGeometry",{args:[0,1,64]}):"ring"===a?eT.createElement("ringGeometry",{args:[.5,1,64]}):"rect"===a?eT.createElement("planeGeometry",null):eT.createElement(a,{args:r}),u||(h.material?null:eT.createElement("meshBasicMaterial",{toneMapped:i,map:n,side:eR.DoubleSide})))});var gt=Object.defineProperty,gr=(e,t,r)=>t in e?gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gn=(e,t,r)=>(gr(e,"symbol"!=typeof t?t+"":t,r),r);let gi={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new eR.Vector3},up:{value:new eR.Vector3(0,1,0)}},vertexShader:"\n      uniform vec3 sunPosition;\n      uniform float rayleigh;\n      uniform float turbidity;\n      uniform float mieCoefficient;\n      uniform vec3 up;\n\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      // constants for atmospheric scattering\n      const float e = 2.71828182845904523536028747135266249775724709369995957;\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      // wavelength of used primaries, according to preetham\n      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n      // mie stuff\n      // K coefficient for the primaries\n      const float v = 4.0;\n      const vec3 K = vec3( 0.686, 0.678, 0.666 );\n      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n      // earth shadow hack\n      // cutoffAngle = pi / 1.95;\n      const float cutoffAngle = 1.6110731556870734;\n      const float steepness = 1.5;\n      const float EE = 1000.0;\n\n      float sunIntensity( float zenithAngleCos ) {\n        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n      }\n\n      vec3 totalMie( float T ) {\n        float c = ( 0.2 * T ) * 10E-18;\n        return 0.434 * c * MieConst;\n      }\n\n      void main() {\n\n        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n        vWorldPosition = worldPosition.xyz;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        gl_Position.z = gl_Position.w; // set z to camera.far\n\n        vSunDirection = normalize( sunPosition );\n\n        vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n      // extinction (absorbtion + out scattering)\n      // rayleigh coefficients\n        vBetaR = totalRayleigh * rayleighCoefficient;\n\n      // mie coefficients\n        vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n      }\n    ",fragmentShader:"\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      uniform float mieDirectionalG;\n      uniform vec3 up;\n\n      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n      // constants for atmospheric scattering\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      const float n = 1.0003; // refractive index of air\n      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n      // optical length at zenith for molecules\n      const float rayleighZenithLength = 8.4E3;\n      const float mieZenithLength = 1.25E3;\n      // 66 arc seconds -> degrees, and the cosine of that\n      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n      // 3.0 / ( 16.0 * pi )\n      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n      // 1.0 / ( 4.0 * pi )\n      const float ONE_OVER_FOURPI = 0.07957747154594767;\n\n      float rayleighPhase( float cosTheta ) {\n        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n      }\n\n      float hgPhase( float cosTheta, float g ) {\n        float g2 = pow( g, 2.0 );\n        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n      }\n\n      void main() {\n\n        vec3 direction = normalize( vWorldPosition - cameraPos );\n\n      // optical length\n      // cutoff angle at 90 to avoid singularity in next formula.\n        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );\n        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n        float sR = rayleighZenithLength * inverse;\n        float sM = mieZenithLength * inverse;\n\n      // combined extinction factor\n        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n      // in scattering\n        float cosTheta = dot( direction, vSunDirection );\n\n        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n        vec3 betaRTheta = vBetaR * rPhase;\n\n        float mPhase = hgPhase( cosTheta, mieDirectionalG );\n        vec3 betaMTheta = vBetaM * mPhase;\n\n        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n      // nightsky\n        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\n        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\n        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n        vec3 L0 = vec3( 0.1 ) * Fex;\n\n      // composition + solar disc\n        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n        gl_FragColor = vec4( retColor, 1.0 );\n\n      #include <tonemapping_fragment>\n      #include <".concat(sV>=154?"colorspace_fragment":"encodings_fragment",">\n\n      }\n    ")},go=new eR.ShaderMaterial({name:"SkyShader",fragmentShader:gi.fragmentShader,vertexShader:gi.vertexShader,uniforms:eR.UniformsUtils.clone(gi.uniforms),side:eR.BackSide,depthWrite:!1});class ga extends eR.Mesh{constructor(){super(new eR.BoxGeometry(1,1,1),go)}}function gs(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new eR.Vector3,n=2*Math.PI*(t-.5);return r.x=Math.cos(n),r.y=Math.sin(Math.PI*(e-.5)),r.z=Math.sin(n),r}gn(ga,"SkyShader",gi),gn(ga,"material",go);let gl=eT.forwardRef((e,t)=>{let{inclination:r=.6,azimuth:n=.1,distance:i=1e3,mieCoefficient:o=.005,mieDirectionalG:a=.8,rayleigh:s=.5,turbidity:l=10,sunPosition:c=gs(r,n),...u}=e,h=eT.useMemo(()=>new eR.Vector3().setScalar(i),[i]),[d]=eT.useState(()=>new ga);return eT.createElement("primitive",(0,eS.Z)({object:d,ref:t,"material-uniforms-mieCoefficient-value":o,"material-uniforms-mieDirectionalG-value":a,"material-uniforms-rayleigh-value":s,"material-uniforms-sunPosition-value":c,"material-uniforms-turbidity-value":l,scale:h},u))});class gc extends eR.ShaderMaterial{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:"\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n\n        #include <tonemapping_fragment>\n	      #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n      }")})}}let gu=e=>new eR.Vector3().setFromSpherical(new eR.Spherical(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI)),gh=eT.forwardRef((e,t)=>{let{radius:r=100,depth:n=50,count:i=5e3,saturation:o=0,factor:a=4,fade:s=!1,speed:l=1}=e,c=eT.useRef(),[u,h,d]=eT.useMemo(()=>{let e=[],t=[],s=Array.from({length:i},()=>(.5+.5*Math.random())*a),l=new eR.Color,c=r+n,u=n/i;for(let r=0;r<i;r++)c-=u*Math.random(),e.push(...gu(c).toArray()),l.setHSL(r/i,o,.9),t.push(l.r,l.g,l.b);return[new Float32Array(e),new Float32Array(t),new Float32Array(s)]},[i,n,a,r,o]);(0,eP.C)(e=>c.current&&(c.current.uniforms.time.value=e.clock.getElapsedTime()*l));let[A]=eT.useState(()=>new gc);return eT.createElement("points",{ref:t},eT.createElement("bufferGeometry",null,eT.createElement("bufferAttribute",{attach:"attributes-position",args:[u,3]}),eT.createElement("bufferAttribute",{attach:"attributes-color",args:[h,3]}),eT.createElement("bufferAttribute",{attach:"attributes-size",args:[d,1]})),eT.createElement("primitive",{ref:c,object:A,attach:"material",blending:eR.AdditiveBlending,"uniforms-fade-value":s,depthWrite:!1,transparent:!0,vertexColors:!0}))});var gd={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let gA=new Uint8Array(16),gf=[];for(let e=0;e<256;++e)gf.push((e+256).toString(16).slice(1));var gp=function(e,t,r){if(gd.randomUUID&&!t&&!e)return gd.randomUUID();let n=(e=e||{}).random||(e.rng||function(){if(!j&&!(j="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return j(gA)})();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return gf[e[t+0]]+gf[e[t+1]]+gf[e[t+2]]+gf[e[t+3]]+"-"+gf[e[t+4]]+gf[e[t+5]]+"-"+gf[e[t+6]]+gf[e[t+7]]+"-"+gf[e[t+8]]+gf[e[t+9]]+"-"+gf[e[t+10]]+gf[e[t+11]]+gf[e[t+12]]+gf[e[t+13]]+gf[e[t+14]]+gf[e[t+15]]}(n)};let gm=new eR.Matrix4,gg=new eR.Vector3,gv=new eR.Quaternion,gy=new eR.Vector3,gE=new eR.Quaternion,gC=new eR.Vector3,gw=eT.createContext(null),gB=eT.forwardRef((e,t)=>{var r,n;let i,{children:o,material:a=eR.MeshLambertMaterial,texture:s="https://rawcdn.githack.com/pmndrs/drei-assets/9225a9f1fbd449d9411125c2f419b843d0308c9f/cloud.png",range:l,limit:c=200,frustumCulled:u,...h}=e,d=eT.useMemo(()=>class extends a{constructor(){super();let e=parseInt(eR.REVISION.replace(/\D+/g,""))>=154?"opaque_fragment":"output_fragment";this.onBeforeCompile=t=>{t.vertexShader="attribute float opacity;\n               varying float vOpacity;\n              "+t.vertexShader.replace("#include <fog_vertex>","#include <fog_vertex>\n                 vOpacity = opacity;\n                "),t.fragmentShader="varying float vOpacity;\n              "+t.fragmentShader.replace("#include <".concat(e,">"),"#include <".concat(e,">\n                 gl_FragColor = vec4(outgoingLight, diffuseColor.a * vOpacity);\n                "))}}},[a]);(0,eP.e)({CloudMaterial:d});let A=eT.useRef(null),f=eT.useRef([]),p=eT.useMemo(()=>new Float32Array(Array.from({length:c},()=>1)),[c]),m=eT.useMemo(()=>new Float32Array(Array.from({length:c},()=>[1,1,1]).flat()),[c]),g=a3(s),v=0,y=0,E=new eR.Quaternion,C=new eR.Vector3(0,0,1),w=new eR.Vector3;(0,eP.C)((e,t)=>{for(v=e.clock.getElapsedTime(),gm.copy(A.current.matrixWorld).invert(),e.camera.matrixWorld.decompose(gy,gE,gC),y=0;y<f.current.length;y++)(i=f.current[y]).ref.current.matrixWorld.decompose(gg,gv,gC),gg.add(w.copy(i.position).applyQuaternion(gv).multiply(gC)),gv.copy(gE).multiply(E.setFromAxisAngle(C,i.rotation+=t*i.rotationFactor)),gC.multiplyScalar(i.volume+(1+Math.sin(v*i.density*i.speed))/2*i.growth),i.matrix.compose(gg,gv,gC).premultiply(gm),i.dist=gg.distanceTo(gy);for(f.current.sort((e,t)=>t.dist-e.dist),y=0;y<f.current.length;y++)i=f.current[y],p[y]=i.opacity*(i.dist<i.fade-1?i.dist/i.fade:1),A.current.setMatrixAt(y,i.matrix),A.current.setColorAt(y,i.color);A.current.geometry.attributes.opacity.needsUpdate=!0,A.current.instanceMatrix.needsUpdate=!0,A.current.instanceColor&&(A.current.instanceColor.needsUpdate=!0)}),eT.useLayoutEffect(()=>{let e=Math.min(c,void 0!==l?l:c,f.current.length);A.current.count=e,fN(A.current.instanceMatrix,{offset:0,count:16*e}),A.current.instanceColor&&fN(A.current.instanceColor,{offset:0,count:3*e}),fN(A.current.geometry.attributes.opacity,{offset:0,count:e})});let B=[null!==(r=g.image.width)&&void 0!==r?r:1,null!==(n=g.image.height)&&void 0!==n?n:1],x=Math.max(B[0],B[1]);return B=[B[0]/x,B[1]/x],eT.createElement("group",(0,eS.Z)({ref:t},h),eT.createElement(gw.Provider,{value:f},o,eT.createElement("instancedMesh",{matrixAutoUpdate:!1,ref:A,args:[null,null,c],frustumCulled:u},eT.createElement("instancedBufferAttribute",{usage:eR.DynamicDrawUsage,attach:"instanceColor",args:[m,3]}),eT.createElement("planeGeometry",{args:[...B]},eT.createElement("instancedBufferAttribute",{usage:eR.DynamicDrawUsage,attach:"attributes-opacity",args:[p,1]})),eT.createElement("cloudMaterial",{key:a.name,map:g,transparent:!0,depthWrite:!1}))))}),gx=eT.forwardRef((e,t)=>{let{opacity:r=1,speed:n=0,bounds:i=[5,1,1],segments:o=20,color:a="#ffffff",fade:s=10,volume:l=6,smallestVolume:c=.25,distribute:u=null,growth:h=4,concentrate:d="inside",seed:A=Math.random(),...f}=e;function p(){let e=1e4*Math.sin(A++);return e-Math.floor(e)}let m=eT.useContext(gw),g=eT.useRef(null),[v]=eT.useState(()=>gp()),y=eT.useMemo(()=>[...Array(o)].map((e,t)=>({segments:o,bounds:new eR.Vector3(1,1,1),position:new eR.Vector3,uuid:v,index:t,ref:g,dist:0,matrix:new eR.Matrix4,color:new eR.Color,rotation:Math.PI/o*t})),[o,v]);return eT.useLayoutEffect(()=>{y.forEach((e,t)=>{var A;(0,eP.j)(e,{volume:l,color:a,speed:n,growth:h,opacity:r,fade:s,bounds:i,density:Math.max(.5,p()),rotationFactor:Math.max(.2,.5*p())*n});let f=null==u?void 0:u(e,t);(f||o>1)&&e.position.copy(e.bounds).multiply(null!==(A=null==f?void 0:f.point)&&void 0!==A?A:{x:2*p()-1,y:2*p()-1,z:2*p()-1});let m=Math.abs(e.position.x),g=Math.abs(e.position.y),v=Math.abs(e.position.z),y=Math.max(m,g,v);e.length=1,m===y&&(e.length-=m/e.bounds.x),g===y&&(e.length-=g/e.bounds.y),v===y&&(e.length-=v/e.bounds.z),e.volume=((null==f?void 0:f.volume)!==void 0?f.volume:Math.max(Math.max(0,c),"random"===d?p():"inside"===d?e.length:1-e.length))*l})},[d,i,s,a,r,h,l,A,o,n]),eT.useLayoutEffect(()=>(m.current=[...m.current,...y],()=>{m.current=m.current.filter(e=>e.uuid!==v)}),[y]),eT.useImperativeHandle(t,()=>g.current,[]),eT.createElement("group",(0,eS.Z)({ref:g},f))}),gI=eT.forwardRef((e,t)=>eT.useContext(gw)?eT.createElement(gx,(0,eS.Z)({ref:t},e)):eT.createElement(gB,null,eT.createElement(gx,(0,eS.Z)({ref:t},e)))),gb=a1({time:0,pixelRatio:1}," uniform float pixelRatio;\n    uniform float time;\n    attribute float size;  \n    attribute float speed;  \n    attribute float opacity;\n    attribute vec3 noise;\n    attribute vec3 color;\n    varying vec3 vColor;\n    varying float vOpacity;\n    void main() {\n      vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n      modelPosition.y += sin(time * speed + modelPosition.x * noise.x * 100.0) * 0.2;\n      modelPosition.z += cos(time * speed + modelPosition.x * noise.y * 100.0) * 0.2;\n      modelPosition.x += cos(time * speed + modelPosition.x * noise.z * 100.0) * 0.2;\n      vec4 viewPosition = viewMatrix * modelPosition;\n      vec4 projectionPostion = projectionMatrix * viewPosition;\n      gl_Position = projectionPostion;\n      gl_PointSize = size * 25. * pixelRatio;\n      gl_PointSize *= (1.0 / - viewPosition.z);\n      vColor = color;\n      vOpacity = opacity;\n    }"," varying vec3 vColor;\n    varying float vOpacity;\n    void main() {\n      float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\n      float strength = 0.05 / distanceToCenter - 0.1;\n      gl_FragColor = vec4(vColor, strength * vOpacity);\n      #include <tonemapping_fragment>\n      #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n    }")),g_=e=>e&&e.constructor===Float32Array,gM=e=>[e.r,e.g,e.b],gS=e=>e instanceof eR.Vector2||e instanceof eR.Vector3||e instanceof eR.Vector4,gT=e=>Array.isArray(e)?e:gS(e)?e.toArray():[e,e,e];function gD(e,t,r){return eT.useMemo(()=>{if(void 0!==t){if(g_(t))return t;if(t instanceof eR.Color){let r=Array.from({length:3*e},()=>gM(t)).flat();return Float32Array.from(r)}if(gS(t)||Array.isArray(t)){let r=Array.from({length:3*e},()=>gT(t)).flat();return Float32Array.from(r)}return Float32Array.from({length:e},()=>t)}return Float32Array.from({length:e},r)},[t])}let gR=eT.forwardRef((e,t)=>{let{noise:r=1,count:n=100,speed:i=1,opacity:o=1,scale:a=1,size:s,color:l,children:c,...u}=e;eT.useMemo(()=>(0,eP.e)({SparklesImplMaterial:gb}),[]);let h=eT.useRef(null),d=(0,eP.A)(e=>e.viewport.dpr),A=gT(a),f=eT.useMemo(()=>Float32Array.from(Array.from({length:n},()=>A.map(eR.MathUtils.randFloatSpread)).flat()),[n,...A]),p=gD(n,s,Math.random),m=gD(n,o),g=gD(n,i),v=gD(3*n,r),y=gD(void 0===l?3*n:n,g_(l)?l:new eR.Color(l),()=>1);return(0,eP.C)(e=>{h.current&&h.current.material&&(h.current.material.time=e.clock.elapsedTime)}),eT.useImperativeHandle(t,()=>h.current,[]),eT.createElement("points",(0,eS.Z)({key:"particle-".concat(n,"-").concat(JSON.stringify(a))},u,{ref:h}),eT.createElement("bufferGeometry",null,eT.createElement("bufferAttribute",{attach:"attributes-position",args:[f,3]}),eT.createElement("bufferAttribute",{attach:"attributes-size",args:[p,1]}),eT.createElement("bufferAttribute",{attach:"attributes-opacity",args:[m,1]}),eT.createElement("bufferAttribute",{attach:"attributes-speed",args:[g,1]}),eT.createElement("bufferAttribute",{attach:"attributes-color",args:[y,3]}),eT.createElement("bufferAttribute",{attach:"attributes-noise",args:[v,3]})),c||eT.createElement("sparklesImplMaterial",{transparent:!0,pixelRatio:d,depthWrite:!1}))});function gP(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=arguments.length>2?arguments[2]:void 0,n=(0,au.Rq)(()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/matcaps.json").then(e=>e.json()),["matcapList"]),i=n[0],o=eT.useMemo(()=>Object.keys(n).length,[]),a=eT.useMemo(()=>"string"==typeof e?e:"number"==typeof e?n[e]:null,[e]),s="".concat(a||i).concat(function(e){switch(e){case 64:return"-64px";case 128:return"-128px";case 256:return"-256px";case 512:return"-512px";default:return""}}(t),".png"),l="".concat("https://rawcdn.githack.com/emmelleppi/matcaps/9b36ccaaf0a24881a39062d05566c9e92be4aa0d","/").concat(t,"/").concat(s);return[a3(l,r),l,o]}let gF=e=>{let{children:t,id:r,format:n,onLoad:i}=e,o=gP(r,n,i);return eT.createElement(eT.Fragment,null,null==t?void 0:t(o))};function gQ(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,{repeat:n=[1,1],anisotropy:i=1,offset:o=[0,0]}=t,a=(0,au.Rq)(()=>fetch("https://cdn.jsdelivr.net/gh/pmndrs/drei-assets@master/normals/normals.json").then(e=>e.json()),["normalsList"]),s=eT.useMemo(()=>Object.keys(a).length,[]),l=a[0],c=a[e]||l,u="".concat("https://rawcdn.githack.com/pmndrs/drei-assets/7a3104997e1576f83472829815b00880d88b32fb","/normals/").concat(c),h=a3(u,r);return eT.useLayoutEffect(()=>{h&&(h.wrapS=h.wrapT=eR.RepeatWrapping,h.repeat=new eR.Vector2(n[0],n[1]),h.offset=new eR.Vector2(o[0],o[1]),h.anisotropy=i)},[h,i,n,o]),[h,u,s]}let gO=e=>{let{children:t,id:r,onLoad:n,...i}=e,o=gQ(r,i,n);return eT.createElement(eT.Fragment,null,null==t?void 0:t(o))},gL={uniforms:{strokeOpacity:1,fillOpacity:.25,fillMix:0,thickness:.05,colorBackfaces:!1,dashInvert:!0,dash:!1,dashRepeats:4,dashLength:.5,squeeze:!1,squeezeMin:.2,squeezeMax:1,stroke:new eR.Color("#ff0000"),backfaceStroke:new eR.Color("#0000ff"),fill:new eR.Color("#00ff00")},vertex:"\n	  attribute vec3 barycentric;\n	\n		varying vec3 v_edges_Barycentric;\n		varying vec3 v_edges_Position;\n\n		void initWireframe() {\n			v_edges_Barycentric = barycentric;\n			v_edges_Position = position.xyz;\n		}\n	  ",fragment:"\n		#ifndef PI\n	  	#define PI 3.1415926535897932384626433832795\n		#endif\n  \n	  varying vec3 v_edges_Barycentric;\n	  varying vec3 v_edges_Position;\n  \n	  uniform float strokeOpacity;\n	  uniform float fillOpacity;\n	  uniform float fillMix;\n	  uniform float thickness;\n	  uniform bool colorBackfaces;\n  \n	  // Dash\n	  uniform bool dashInvert;\n	  uniform bool dash;\n	  uniform bool dashOnly;\n	  uniform float dashRepeats;\n	  uniform float dashLength;\n  \n	  // Squeeze\n	  uniform bool squeeze;\n	  uniform float squeezeMin;\n	  uniform float squeezeMax;\n  \n	  // Colors\n	  uniform vec3 stroke;\n	  uniform vec3 backfaceStroke;\n	  uniform vec3 fill;\n  \n	  // This is like\n	  float wireframe_aastep(float threshold, float dist) {\n		  float afwidth = fwidth(dist) * 0.5;\n		  return smoothstep(threshold - afwidth, threshold + afwidth, dist);\n	  }\n  \n	  float wireframe_map(float value, float min1, float max1, float min2, float max2) {\n		  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n	  }\n  \n	  float getWireframe() {\n			vec3 barycentric = v_edges_Barycentric;\n		\n			// Distance from center of each triangle to its edges.\n			float d = min(min(barycentric.x, barycentric.y), barycentric.z);\n\n			// for dashed rendering, we can use this to get the 0 .. 1 value of the line length\n			float positionAlong = max(barycentric.x, barycentric.y);\n			if (barycentric.y < barycentric.x && barycentric.y < barycentric.z) {\n				positionAlong = 1.0 - positionAlong;\n			}\n\n			// the thickness of the stroke\n			float computedThickness = wireframe_map(thickness, 0.0, 1.0, 0.0, 0.34);\n\n			// if we want to shrink the thickness toward the center of the line segment\n			if (squeeze) {\n				computedThickness *= mix(squeezeMin, squeezeMax, (1.0 - sin(positionAlong * PI)));\n			}\n\n			// Create dash pattern\n			if (dash) {\n				// here we offset the stroke position depending on whether it\n				// should overlap or not\n				float offset = 1.0 / dashRepeats * dashLength / 2.0;\n				if (!dashInvert) {\n					offset += 1.0 / dashRepeats / 2.0;\n				}\n\n				// if we should animate the dash or not\n				// if (dashAnimate) {\n				// 	offset += time * 0.22;\n				// }\n\n				// create the repeating dash pattern\n				float pattern = fract((positionAlong + offset) * dashRepeats);\n				computedThickness *= 1.0 - wireframe_aastep(dashLength, pattern);\n			}\n\n			// compute the anti-aliased stroke edge  \n			float edge = 1.0 - wireframe_aastep(computedThickness, d);\n\n			return edge;\n	  }\n	  "},gk=a1(gL.uniforms,gL.vertex+"\n  	void main() {\n		initWireframe();\n		gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n	}\n  ",gL.fragment+"\n  void main () {\n		// Compute color\n\n		float edge = getWireframe();\n		vec4 colorStroke = vec4(stroke, edge);\n\n		#ifdef FLIP_SIDED\n			colorStroke.rgb = backfaceStroke;\n		#endif\n    \n		vec4 colorFill = vec4(fill, fillOpacity);\n		vec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n		gl_FragColor = outColor;\n	}\n  ");function gU(e){return(null==e?void 0:e.current)!==void 0}function gG(e){return"WireframeGeometry"===e.type}function gN(e){let t=null!=e&&e.current?e.current:e;if(null!=t&&t.isBufferGeometry)return t;{if(gG(t))throw Error("Wireframe: WireframeGeometry is not supported.");let e=t.parent;if(null!=e&&e.geometry){if(gG(e.geometry))throw Error("Wireframe: WireframeGeometry is not supported.");return e.geometry}}}function gz(e,t){if(e.index){console.warn("Wireframe: Requires non-indexed geometry, converting to non-indexed geometry.");let t=e.toNonIndexed();e.copy(t),e.setIndex(null)}let r=function(e,t){let r=e.getAttribute("position").count,n=[];for(let e=0;e<r;e++){let r=t?1:0;e%2==0?n.push(0,0,1,0,1,0,1,0,r):n.push(0,1,0,0,0,1,1,0,r)}return new eR.BufferAttribute(Float32Array.from(n),3)}(e,t);e.setAttribute("barycentric",r)}function gH(e){let{geometry:t,simplify:r=!1,...n}=e;(0,eP.e)({MeshWireframeMaterial:gk});let[i,o]=eT.useState(null);eT.useLayoutEffect(()=>{let e=gN(t);if(!e)throw Error("Wireframe: geometry prop must be a BufferGeometry or a ref to a BufferGeometry.");gz(e,r),gU(t)&&o(e)},[r,t]);let a=gU(t)?i:t;return eT.createElement(eT.Fragment,null,a&&eT.createElement("mesh",{geometry:a},eT.createElement("meshWireframeMaterial",(0,eS.Z)({attach:"material",transparent:!0,side:eR.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4},n,{extensions:{derivatives:!0,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1}}))))}function gV(e){let{simplify:t=!1,...r}=e,n=eT.useRef(null),i=eT.useMemo(()=>(function(){let e={};for(let t in gL.uniforms)e[t]={value:gL.uniforms[t]};return e})(),[gL.uniforms]);return eT.useEffect(()=>{var e;i.fillOpacity.value=null!==(e=r.fillOpacity)&&void 0!==e?e:i.fillOpacity.value},[r.fillOpacity]),eT.useEffect(()=>{var e;i.fillMix.value=null!==(e=r.fillMix)&&void 0!==e?e:i.fillMix.value},[r.fillMix]),eT.useEffect(()=>{var e;i.strokeOpacity.value=null!==(e=r.strokeOpacity)&&void 0!==e?e:i.strokeOpacity.value},[r.strokeOpacity]),eT.useEffect(()=>{var e;i.thickness.value=null!==(e=r.thickness)&&void 0!==e?e:i.thickness.value},[r.thickness]),eT.useEffect(()=>void(i.colorBackfaces.value=!!r.colorBackfaces),[r.colorBackfaces]),eT.useEffect(()=>void(i.dash.value=!!r.dash),[r.dash]),eT.useEffect(()=>void(i.dashInvert.value=!!r.dashInvert),[r.dashInvert]),eT.useEffect(()=>{var e;i.dashRepeats.value=null!==(e=r.dashRepeats)&&void 0!==e?e:i.dashRepeats.value},[r.dashRepeats]),eT.useEffect(()=>{var e;i.dashLength.value=null!==(e=r.dashLength)&&void 0!==e?e:i.dashLength.value},[r.dashLength]),eT.useEffect(()=>void(i.squeeze.value=!!r.squeeze),[r.squeeze]),eT.useEffect(()=>{var e;i.squeezeMin.value=null!==(e=r.squeezeMin)&&void 0!==e?e:i.squeezeMin.value},[r.squeezeMin]),eT.useEffect(()=>{var e;i.squeezeMax.value=null!==(e=r.squeezeMax)&&void 0!==e?e:i.squeezeMax.value},[r.squeezeMax]),eT.useEffect(()=>void(i.stroke.value=r.stroke?new eR.Color(r.stroke):i.stroke.value),[r.stroke]),eT.useEffect(()=>void(i.fill.value=r.fill?new eR.Color(r.fill):i.fill.value),[r.fill]),eT.useEffect(()=>void(i.backfaceStroke.value=r.backfaceStroke?new eR.Color(r.backfaceStroke):i.backfaceStroke.value),[r.backfaceStroke]),eT.useLayoutEffect(()=>{let e=gN(n);if(!e)throw Error("Wireframe: Must be a child of a Mesh, Line or Points object or specify a geometry prop.");let r=e.clone();return gz(e,t),()=>{e.copy(r),r.dispose()}},[t]),eT.useLayoutEffect(()=>{var e;let t=n.current.parent,r=t.material.clone();return(e=t.material).onBeforeCompile=e=>{e.uniforms={...e.uniforms,...i},e.vertexShader=e.vertexShader.replace("void main() {","\n		  ".concat(gL.vertex,"\n		  void main() {\n			initWireframe();\n		")),e.fragmentShader=e.fragmentShader.replace("void main() {","\n		  ".concat(gL.fragment,"\n		  void main() {\n		")),e.fragmentShader=e.fragmentShader.replace("#include <color_fragment>","\n		  #include <color_fragment>\n			  float edge = getWireframe();\n		  vec4 colorStroke = vec4(stroke, edge);\n		  #ifdef FLIP_SIDED\n			colorStroke.rgb = backfaceStroke;\n		  #endif\n		  vec4 colorFill = vec4(mix(diffuseColor.rgb, fill, fillMix), mix(diffuseColor.a, fillOpacity, fillMix));\n		  vec4 outColor = mix(colorFill, colorStroke, edge * strokeOpacity);\n\n		  diffuseColor.rgb = outColor.rgb;\n		  diffuseColor.a *= outColor.a;\n		")},e.side=eR.DoubleSide,e.transparent=!0,()=>{t.material.dispose(),t.material=r}},[]),eT.createElement("object3D",{ref:n})}function gj(e){let{geometry:t,...r}=e;return t?eT.createElement(gH,(0,eS.Z)({geometry:t},r)):eT.createElement(gV,r)}function gJ(e){let{opacity:t,alphaMap:r}=e,n=eT.useRef(null),i=eT.useRef(null),o=eT.useRef({value:1}),a=eT.useRef({value:null}),s=eT.useRef({value:!1});return eT.useLayoutEffect(()=>{n.current.onBeforeCompile=i.current.onBeforeCompile=e=>{let t;let r=e.fragmentShader.indexOf("void main"),n="",i=r;for(;"\n"!==t&&i<r+100;)n+=t=e.fragmentShader.charAt(i),i++;n=n.trim(),e.vertexShader=e.vertexShader.replace("void main() {","\n        varying vec2 custom_vUv;\n\n        void main() {\n          custom_vUv = uv;\n          \n        "),e.fragmentShader=e.fragmentShader.replace(n,"\n          uniform float uShadowOpacity;\n          uniform sampler2D uAlphaMap;\n          uniform bool uHasAlphaMap;\n\n          varying vec2 custom_vUv;\n  \n          float bayerDither2x2( vec2 v ) {\n            return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );\n          }\n    \n          float bayerDither4x4( vec2 v ) {\n            vec2 P1 = mod( v, 2.0 );\n            vec2 P2 = mod( floor( 0.5  * v ), 2.0 );\n            return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );\n          }\n  \n          void main() {\n            float alpha = \n              uHasAlphaMap ? \n                uShadowOpacity * texture2D(uAlphaMap, custom_vUv).x\n              : uShadowOpacity;\n\n            if( ( bayerDither4x4( floor( mod( gl_FragCoord.xy, 4.0 ) ) ) ) / 16.0 >= alpha ) discard;\n            \n          "),e.uniforms.uShadowOpacity=o.current,e.uniforms.uAlphaMap=a.current,e.uniforms.uHasAlphaMap=s.current}},[]),(0,eP.C)(()=>{var e;let i=null==(e=n.current.__r3f)?void 0:e.parent;if(i){let e=i.material;e&&(o.current.value=null!=t?t:e.opacity,!1===r?(a.current.value=null,s.current.value=!1):(a.current.value=r||e.alphaMap,s.current.value=!!a.current.value))}}),eT.createElement(eT.Fragment,null,eT.createElement("meshDepthMaterial",{ref:n,attach:"customDepthMaterial",depthPacking:eR.RGBADepthPacking}),eT.createElement("meshDistanceMaterial",{ref:i,attach:"customDistanceMaterial"}))}let gY=new eR.Matrix4,gW=new eR.Ray,gq=new eR.Sphere,gK=new eR.Vector3;class gX extends eR.Group{get geometry(){var e;return null==(e=this.instance.current)?void 0:e.geometry}raycast(e,t){var r,n;let i=this.instance.current;if(!i||!i.geometry)return;let o=i.userData.instances.indexOf(this.instanceKey);if(-1===o||o>i.geometry.drawRange.count)return;let a=null!==(r=null==(n=e.params.Points)?void 0:n.threshold)&&void 0!==r?r:1;if(gq.set(this.getWorldPosition(gK),a),!1===e.ray.intersectsSphere(gq))return;gY.copy(i.matrixWorld).invert(),gW.copy(e.ray).applyMatrix4(gY);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=gW.distanceSqToPoint(this.position);if(l<s*s){let r=new eR.Vector3;gW.closestPointToPoint(this.position,r),r.applyMatrix4(this.matrixWorld);let n=e.ray.origin.distanceTo(r);if(n<e.near||n>e.far)return;t.push({distance:n,distanceToRay:Math.sqrt(l),point:r,index:o,face:null,object:this})}}constructor(){super(),this.size=0,this.color=new eR.Color("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}}let gZ=eT.createContext(null),g$=new eR.Matrix4,g0=new eR.Vector3,g1=eT.forwardRef((e,t)=>{let{children:r,range:n,limit:i=1e3,...o}=e,a=eT.useRef(null);eT.useImperativeHandle(t,()=>a.current,[]);let[s,l]=eT.useState([]),[[c,u,h]]=eT.useState(()=>[new Float32Array(3*i),Float32Array.from({length:3*i},()=>1),Float32Array.from({length:i},()=>1)]);eT.useEffect(()=>{a.current.geometry.attributes.position.needsUpdate=!0}),(0,eP.C)(()=>{for(a.current.updateMatrix(),a.current.updateMatrixWorld(),g$.copy(a.current.matrixWorld).invert(),a.current.geometry.drawRange.count=Math.min(i,void 0!==n?n:i,s.length),J=0;J<s.length;J++)(Y=s[J].current).getWorldPosition(g0).applyMatrix4(g$),g0.toArray(c,3*J),a.current.geometry.attributes.position.needsUpdate=!0,Y.matrixWorldNeedsUpdate=!0,Y.color.toArray(u,3*J),a.current.geometry.attributes.color.needsUpdate=!0,h.set([Y.size],J),a.current.geometry.attributes.size.needsUpdate=!0});let d=eT.useMemo(()=>({getParent:()=>a,subscribe:e=>(l(t=>[...t,e]),()=>l(t=>t.filter(t=>t.current!==e.current)))}),[]);return eT.createElement("points",(0,eS.Z)({userData:{instances:s},matrixAutoUpdate:!1,ref:a,raycast:()=>null},o),eT.createElement("bufferGeometry",null,eT.createElement("bufferAttribute",{attach:"attributes-position",count:c.length/3,array:c,itemSize:3,usage:eR.DynamicDrawUsage}),eT.createElement("bufferAttribute",{attach:"attributes-color",count:u.length/3,array:u,itemSize:3,usage:eR.DynamicDrawUsage}),eT.createElement("bufferAttribute",{attach:"attributes-size",count:h.length,array:h,itemSize:1,usage:eR.DynamicDrawUsage})),eT.createElement(gZ.Provider,{value:d},r))}),g2=eT.forwardRef((e,t)=>{let{children:r,...n}=e;eT.useMemo(()=>(0,eP.e)({PositionPoint:gX}),[]);let i=eT.useRef(null);eT.useImperativeHandle(t,()=>i.current,[]);let{subscribe:o,getParent:a}=eT.useContext(gZ);return eT.useLayoutEffect(()=>o(i),[]),eT.createElement("positionPoint",(0,eS.Z)({instance:a(),instanceKey:i,ref:i},n),r)}),g3=eT.forwardRef((e,t)=>{let{children:r,positions:n,colors:i,sizes:o,stride:a=3,...s}=e,l=eT.useRef(null);return eT.useImperativeHandle(t,()=>l.current,[]),(0,eP.C)(()=>{let e=l.current.geometry.attributes;e.position.needsUpdate=!0,i&&(e.color.needsUpdate=!0),o&&(e.size.needsUpdate=!0)}),eT.createElement("points",(0,eS.Z)({ref:l},s),eT.createElement("bufferGeometry",null,eT.createElement("bufferAttribute",{attach:"attributes-position",count:n.length/a,array:n,itemSize:a,usage:eR.DynamicDrawUsage}),i&&eT.createElement("bufferAttribute",{attach:"attributes-color",count:i.length/a,array:i,itemSize:3,usage:eR.DynamicDrawUsage}),o&&eT.createElement("bufferAttribute",{attach:"attributes-size",count:o.length/a,array:o,itemSize:1,usage:eR.DynamicDrawUsage})),r)}),g4=eT.forwardRef((e,t)=>e.positions instanceof Float32Array?eT.createElement(g3,(0,eS.Z)({},e,{ref:t})):eT.createElement(g1,(0,eS.Z)({},e,{ref:t})));var g5=r(1690),g9=r(6934),g6=r(1359);let g8=eT.createContext(null),g7=eT.forwardRef((e,t)=>{eT.useMemo(()=>(0,eP.e)({SegmentObject:ve}),[]);let{limit:r=1e3,lineWidth:n=1,children:i,...o}=e,[a,s]=eT.useState([]),[l]=eT.useState(()=>new g5.w),[c]=eT.useState(()=>new g9.Y),[u]=eT.useState(()=>new g6.z),[h]=eT.useState(()=>new eR.Vector2(512,512)),[d]=eT.useState(()=>Array(6*r).fill(0)),[A]=eT.useState(()=>Array(6*r).fill(0)),f=eT.useMemo(()=>({subscribe:e=>(s(t=>[...t,e]),()=>s(t=>t.filter(t=>t.current!==e.current)))}),[]);return(0,eP.C)(()=>{for(let t=0;t<r;t++){var e;let r=null==(e=a[t])?void 0:e.current;r&&(d[6*t+0]=r.start.x,d[6*t+1]=r.start.y,d[6*t+2]=r.start.z,d[6*t+3]=r.end.x,d[6*t+4]=r.end.y,d[6*t+5]=r.end.z,A[6*t+0]=r.color.r,A[6*t+1]=r.color.g,A[6*t+2]=r.color.b,A[6*t+3]=r.color.r,A[6*t+4]=r.color.g,A[6*t+5]=r.color.b)}u.setColors(A),u.setPositions(d),l.computeLineDistances()}),eT.createElement("primitive",{object:l,ref:t},eT.createElement("primitive",{object:u,attach:"geometry"}),eT.createElement("primitive",(0,eS.Z)({object:c,attach:"material",vertexColors:!0,resolution:h,linewidth:n},o)),eT.createElement(g8.Provider,{value:f},i))});class ve{constructor(){this.color=new eR.Color("white"),this.start=new eR.Vector3(0,0,0),this.end=new eR.Vector3(0,0,0)}}let vt=e=>e instanceof eR.Vector3?e:new eR.Vector3(..."number"==typeof e?[e,e,e]:e),vr=eT.forwardRef((e,t)=>{let{color:r,start:n,end:i}=e,o=eT.useContext(g8);if(!o)throw"Segment must used inside Segments component.";let a=eT.useRef(null);return eT.useImperativeHandle(t,()=>a.current,[]),eT.useLayoutEffect(()=>o.subscribe(a),[]),eT.createElement("segmentObject",{ref:a,color:r,start:vt(n),end:vt(i)})}),vn=eT.forwardRef((e,t)=>{let{children:r,hysteresis:n=0,distances:i,...o}=e,a=eT.useRef(null);return eT.useImperativeHandle(t,()=>a.current,[]),eT.useLayoutEffect(()=>{let{current:e}=a;e.levels.length=0,e.children.forEach((t,r)=>e.levels.push({object:t,hysteresis:n,distance:i[r]}))}),(0,eP.C)(e=>{var t;return null==(t=a.current)?void 0:t.update(e.camera)}),eT.createElement("lOD",(0,eS.Z)({ref:a},o),r)});function vi(e){let{all:t,scene:r,camera:n}=e,i=(0,eP.A)(e=>{let{gl:t}=e;return t}),o=(0,eP.A)(e=>{let{camera:t}=e;return t}),a=(0,eP.A)(e=>{let{scene:t}=e;return t});return eT.useLayoutEffect(()=>{let e=[];t&&(r||a).traverse(t=>{!1===t.visible&&(e.push(t),t.visible=!0)}),i.compile(r||a,n||o);let s=new eR.WebGLCubeRenderTarget(128);new eR.CubeCamera(.01,1e5,s).update(i,r||a),s.dispose(),e.forEach(e=>e.visible=!1)},[]),null}function vo(){let e=(0,eP.A)(e=>e.gl);return(0,eT.useEffect)(()=>(e.shadowMap.autoUpdate=!1,e.shadowMap.needsUpdate=!0,()=>{e.shadowMap.autoUpdate=e.shadowMap.needsUpdate=!0}),[e.shadowMap]),null}let va=new eR.Matrix4,vs=new eR.Ray,vl=new eR.Sphere,vc=new eR.Vector3;function vu(e,t){let r=this.geometry,n=this.material,i=this.matrixWorld;void 0!==n&&(null===r.boundingSphere&&r.computeBoundingSphere(),vl.copy(r.boundingSphere),vl.applyMatrix4(i),!1!==e.ray.intersectsSphere(vl)&&(va.copy(i).invert(),vs.copy(e.ray).applyMatrix4(va),(null===r.boundingBox||null!==vs.intersectBox(r.boundingBox,vc))&&t.push({distance:vc.distanceTo(e.ray.origin),point:vc.clone(),object:this})))}function vh(e){let{pixelated:t}=e,r=(0,eP.A)(e=>e.gl),n=(0,eP.A)(e=>e.internal.active),i=(0,eP.A)(e=>e.performance.current),o=(0,eP.A)(e=>e.viewport.initialDpr),a=(0,eP.A)(e=>e.setDpr);return eT.useEffect(()=>{let e=r.domElement;return()=>{n&&a(o),t&&e&&(e.style.imageRendering="auto")}},[]),eT.useEffect(()=>{a(i*o),t&&r.domElement&&(r.domElement.style.imageRendering=1===i?"auto":"pixelated")},[i]),null}function vd(){let e=(0,eP.A)(e=>e.get),t=(0,eP.A)(e=>e.setEvents),r=(0,eP.A)(e=>e.performance.current);return eT.useEffect(()=>{let r=e().events.enabled;return()=>t({enabled:r})},[]),eT.useEffect(()=>t({enabled:1===r}),[r]),null}let vA=(0,eT.createContext)(null);function vf(e){let{iterations:t=10,ms:r=250,threshold:n=.75,step:i=.1,factor:o=.5,flipflops:a=1/0,bounds:s=e=>e>100?[60,100]:[40,60],onIncline:l,onDecline:c,onChange:u,onFallback:h,children:d}=e,[A,f]=(0,eT.useState)(()=>({fps:0,index:0,factor:o,flipped:0,refreshrate:0,fallback:!1,frames:[],averages:[],subscriptions:new Map,subscribe:e=>{let t=Symbol();return A.subscriptions.set(t,e.current),()=>void A.subscriptions.delete(t)}})),p=0;return(0,eP.C)(()=>{let{frames:e,averages:o}=A;if(!A.fallback&&o.length<t){e.push(performance.now());let d=e[e.length-1]-e[0];if(d>=r){if(A.fps=Math.round(e.length/d*1e3)/1,A.refreshrate=Math.max(A.refreshrate,A.fps),o[A.index++%t]=A.fps,o.length===t){let[e,r]=s(A.refreshrate),d=o.filter(e=>e>=r),f=o.filter(t=>t<e);d.length>t*n&&(A.factor=Math.min(1,A.factor+i),A.flipped++,l&&l(A),A.subscriptions.forEach(e=>e.onIncline&&e.onIncline(A))),f.length>t*n&&(A.factor=Math.max(0,A.factor-i),A.flipped++,c&&c(A),A.subscriptions.forEach(e=>e.onDecline&&e.onDecline(A))),p!==A.factor&&(p=A.factor,u&&u(A),A.subscriptions.forEach(e=>e.onChange&&e.onChange(A))),A.flipped>a&&!A.fallback&&(A.fallback=!0,h&&h(A),A.subscriptions.forEach(e=>e.onFallback&&e.onFallback(A))),A.averages=[]}A.frames=[]}}}),eT.createElement(vA.Provider,{value:A},d)}function vp(e){let{onIncline:t,onDecline:r,onChange:n,onFallback:i}=e,o=(0,eT.useContext)(vA),a=(0,eT.useRef)({onIncline:t,onDecline:r,onChange:n,onFallback:i});(0,eT.useLayoutEffect)(()=>{a.current.onIncline=t,a.current.onDecline=r,a.current.onChange=n,a.current.onFallback=i},[t,r,n,i]),(0,eT.useLayoutEffect)(()=>o.subscribe(a),[o])}let vm=eT.forwardRef((e,t)=>{let{children:r,compute:n,width:i,height:o,samples:a=8,renderPriority:s=0,eventPriority:l=0,frames:c=1/0,stencilBuffer:u=!1,depthBuffer:h=!0,generateMipmaps:d=!1,...A}=e,{size:f,viewport:p}=(0,eP.A)(),m=lV((i||f.width)*p.dpr,(o||f.height)*p.dpr,{samples:a,stencilBuffer:u,depthBuffer:h,generateMipmaps:d}),[g]=eT.useState(()=>new eR.Scene),v=eT.useCallback((e,t,r)=>{var n,i;let o=null==(n=m.texture)?void 0:n.__r3f.parent;for(;o&&!(o instanceof eR.Object3D);)o=o.__r3f.parent;if(!o)return!1;r.raycaster.camera||r.events.compute(e,r,null==(i=r.previousRoot)?void 0:i.getState());let[a]=r.raycaster.intersectObject(o);if(!a)return!1;let s=a.uv;if(!s)return!1;t.raycaster.setFromCamera(t.pointer.set(2*s.x-1,2*s.y-1),t.camera)},[]);return eT.useImperativeHandle(t,()=>m.texture,[m]),eT.createElement(eT.Fragment,null,(0,eP.g)(eT.createElement(vg,{renderPriority:s,frames:c,fbo:m},r,eT.createElement("group",{onPointerOver:()=>null})),g,{events:{compute:n||v,priority:l}}),eT.createElement("primitive",(0,eS.Z)({object:m.texture},A)))});function vg(e){let t,r,n,i,{frames:o,renderPriority:a,children:s,fbo:l}=e,c=0;return(0,eP.C)(e=>{(o===1/0||c<o)&&(t=e.gl.autoClear,r=e.gl.xr.enabled,n=e.gl.getRenderTarget(),i=e.gl.xr.isPresenting,e.gl.autoClear=!0,e.gl.xr.enabled=!1,e.gl.xr.isPresenting=!1,e.gl.setRenderTarget(l),e.gl.render(e.scene,e.camera),e.gl.setRenderTarget(n),e.gl.autoClear=t,e.gl.xr.enabled=r,e.gl.xr.isPresenting=i,c++)},a),eT.createElement(eT.Fragment,null,s)}let vv=eT.forwardRef((e,t)=>{let{children:r,compute:n,renderPriority:i=-1,eventPriority:o=0,frames:a=1/0,stencilBuffer:s=!1,depthBuffer:l=!0,generateMipmaps:c=!1,resolution:u=896,near:h=.1,far:d=1e3,flip:A=!1,position:f,rotation:p,scale:m,quaternion:g,matrix:v,matrixAutoUpdate:y,...E}=e,{size:C,viewport:w}=(0,eP.A)(),B=eT.useRef(null),x=eT.useMemo(()=>{let e=new eR.WebGLCubeRenderTarget(Math.max((u||C.width)*w.dpr,(u||C.height)*w.dpr),{stencilBuffer:s,depthBuffer:l,generateMipmaps:c});return e.texture.isRenderTargetTexture=!A,e.texture.flipY=!0,e.texture.type=eR.HalfFloatType,e},[u,A]);eT.useEffect(()=>()=>x.dispose(),[x]);let[I]=eT.useState(()=>new eR.Scene);return eT.useImperativeHandle(t,()=>({scene:I,fbo:x,camera:B.current}),[x]),eT.createElement(eT.Fragment,null,(0,eP.g)(eT.createElement(vy,{renderPriority:i,frames:a,camera:B},r,eT.createElement("group",{onPointerOver:()=>null})),I,{events:{compute:n,priority:o}}),eT.createElement("primitive",(0,eS.Z)({object:x.texture},E)),eT.createElement("cubeCamera",{ref:B,args:[h,d,x],position:f,rotation:p,scale:m,quaternion:g,matrix:v,matrixAutoUpdate:y}))});function vy(e){let{frames:t,renderPriority:r,children:n,camera:i}=e,o=0;return(0,eP.C)(e=>{(t===1/0||o<t)&&(i.current.update(e.gl,e.scene),o++)},r),eT.createElement(eT.Fragment,null,n)}let vE=eT.forwardRef((e,t)=>{let{id:r=1,colorWrite:n=!1,depthWrite:i=!1,...o}=e,a=eT.useRef(null),s=eT.useMemo(()=>({colorWrite:n,depthWrite:i,stencilWrite:!0,stencilRef:r,stencilFunc:eR.AlwaysStencilFunc,stencilFail:eR.ReplaceStencilOp,stencilZFail:eR.ReplaceStencilOp,stencilZPass:eR.ReplaceStencilOp}),[r,n,i]);return eT.useLayoutEffect(()=>{Object.assign(a.current.material,s)}),eT.useImperativeHandle(t,()=>a.current,[]),eT.createElement("mesh",(0,eS.Z)({ref:a,renderOrder:-r},o))});function vC(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{stencilWrite:!0,stencilRef:e,stencilFunc:t?eR.NotEqualStencilFunc:eR.EqualStencilFunc,stencilFail:eR.KeepStencilOp,stencilZFail:eR.KeepStencilOp,stencilZPass:eR.KeepStencilOp}}function vw(e){let{renderPriority:t=1,zoom:r=0,segments:n=64,children:i,resolution:o=896,...a}=e,s=eT.useRef(null),l=eT.useRef(null),{width:c,height:u}=(0,eP.A)(e=>e.size),[h]=eT.useState(()=>new eR.OrthographicCamera);eT.useLayoutEffect(()=>{h.position.set(0,0,100),h.zoom=100,h.left=-(c/2),h.right=c/2,h.top=u/2,h.bottom=-(u/2),h.updateProjectionMatrix()},[c,u]);let d=Math.sqrt(c*c+u*u)/100*(.5+r/2),A=new eR.Vector3,f=new eR.Sphere(new eR.Vector3,d),p=new eR.Matrix3,m=eT.useCallback((e,t,r)=>{t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,h),t.raycaster.ray.intersectSphere(f,A)&&(A.normalize(),p.getNormalMatrix(l.current.camera.matrixWorld),l.current.camera.getWorldPosition(t.raycaster.ray.origin),t.raycaster.ray.direction.set(0,0,1).reflect(A),t.raycaster.ray.direction.x*=-1,t.raycaster.ray.direction.applyNormalMatrix(p).multiplyScalar(-1))},[]);return(0,eP.C)(e=>{t&&e.gl.render(s.current,h)},t),eT.createElement(eT.Fragment,null,eT.createElement("mesh",(0,eS.Z)({ref:s},a,{scale:d}),eT.createElement("sphereGeometry",{args:[1,n,n]}),eT.createElement("meshBasicMaterial",null,eT.createElement(vv,{compute:m,attach:"envMap",flip:!0,resolution:o,ref:l},i,eT.createElement(vB,{api:l})))))}function vB(e){let{api:t}=e,r=new eR.Vector3,n=new eR.Quaternion,i=new eR.Vector3,o=new eR.Euler(0,Math.PI,0);return(0,eP.C)(e=>{e.camera.matrixWorld.decompose(r,n,i),t.current.camera.position.copy(r),t.current.camera.quaternion.setFromEuler(o).premultiply(n)}),null}let vx=a1({blur:0,map:null,sdf:null,blend:0,size:0,resolution:new eR.Vector2},"varying vec2 vUv;\n   void main() {\n     gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n     vUv = uv;\n   }","uniform sampler2D sdf;\n   uniform sampler2D map;\n   uniform float blur;\n   uniform float size;\n   uniform float time;\n   uniform vec2 resolution;\n   varying vec2 vUv;\n   #include <packing>\n   void main() {\n     vec2 uv = gl_FragCoord.xy / resolution.xy;\n     vec4 t = texture2D(map, uv);\n     float k = blur;\n     float d = texture2D(sdf, vUv).r/size;\n     float alpha = 1.0 - smoothstep(0.0, 1.0, clamp(d/k + 1.0, 0.0, 1.0));\n     gl_FragColor = vec4(t.rgb, blur == 0.0 ? t.a : t.a * alpha);\n     #include <tonemapping_fragment>\n     #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n   }")),vI=eT.forwardRef((e,t)=>{let{children:r,events:n,blur:i=0,eventPriority:o=0,renderPriority:a=0,worldUnits:s=!1,resolution:l=512,...c}=e;(0,eP.e)({PortalMaterialImpl:vx});let u=eT.useRef(null),{scene:h,gl:d,size:A,viewport:f,setEvents:p}=(0,eP.A)(),m=lV(l,l),[g,v]=eT.useState(0);(0,eP.C)(()=>{let e=u.current.blend>0?Math.max(1,a):0;g!==e&&v(e)}),eT.useEffect(()=>{void 0!==n&&p({enabled:!n})},[n]);let[y,E]=eT.useState(!0),C=f_(E);eT.useLayoutEffect(()=>{var e;C.current=null==(e=u.current)?void 0:e.__r3f.parent},[]),eT.useLayoutEffect(()=>{if(C.current&&i&&null===u.current.sdf){let e=new eR.Mesh(C.current.geometry,new eR.MeshBasicMaterial),t=new eR.Box3().setFromBufferAttribute(e.geometry.attributes.position),r=new eR.OrthographicCamera(t.min.x*(1+2/l),t.max.x*(1+2/l),t.max.y*(1+2/l),t.min.y*(1+2/l),.1,1e3);r.position.set(0,0,1),r.lookAt(0,0,0),d.setRenderTarget(m),d.render(e,r);let n=v_(l,l,d)(m.texture),i=new Float32Array(l*l);d.readRenderTargetPixels(n,0,0,l,l,i);let o=1/0;for(let e=0;e<i.length;e++)i[e]<o&&(o=i[e]);o=-o,u.current.size=o,u.current.sdf=n.texture,d.setRenderTarget(null)}},[l,i]),eT.useImperativeHandle(t,()=>u.current);let w=eT.useCallback((e,t,r)=>{var n;if(!C.current)return!1;if(t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera),(null==(n=u.current)?void 0:n.blend)===0){let[e]=t.raycaster.intersectObject(C.current);if(!e)return t.raycaster.camera=void 0,!1}},[]);return eT.createElement("portalMaterialImpl",(0,eS.Z)({ref:u,blur:i,blend:0,resolution:[A.width*f.dpr,A.height*f.dpr],attach:"material"},c),eT.createElement(vm,{attach:"map",frames:y?1/0:0,eventPriority:o,renderPriority:a,compute:w},r,eT.createElement(vb,{events:n,rootScene:h,priority:g,material:u,worldUnits:s})))});function vb(e){let{events:t,rootScene:r,material:n,priority:i,worldUnits:o}=e,a=(0,eP.A)(e=>e.scene),s=(0,eP.A)(e=>e.setEvents),l=lV(),c=lV();eT.useLayoutEffect(()=>{a.matrixAutoUpdate=!1},[]),eT.useEffect(()=>{void 0!==t&&s({enabled:t})},[t]);let[u,h]=eT.useMemo(()=>{let e={value:0};return[new aR(new eR.ShaderMaterial({uniforms:{a:{value:l.texture},b:{value:c.texture},blend:e},vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n          }",fragmentShader:"\n          uniform sampler2D a;\n          uniform sampler2D b;\n          uniform float blend;\n          varying vec2 vUv;\n          #include <packing>\n          void main() {\n            vec4 ta = texture2D(a, vUv);\n            vec4 tb = texture2D(b, vUv);\n            gl_FragColor = mix(tb, ta, blend);\n            #include <tonemapping_fragment>\n            #include <".concat(a5>=154?"colorspace_fragment":"encodings_fragment",">\n          }")})),e]},[]);return(0,eP.C)(e=>{var t,s,d,A,f;let p=null==n||null==(t=n.current)?void 0:t.__r3f.parent;p&&(o?a.matrixWorld.identity():(i&&(null==(s=n.current)?void 0:s.blend)===1&&p.updateWorldMatrix(!0,!1),a.matrixWorld.copy(p.matrixWorld)),i&&((null==(d=n.current)?void 0:d.blend)>0&&(null==(A=n.current)?void 0:A.blend)<1?(h.value=n.current.blend,e.gl.setRenderTarget(l),e.gl.render(a,e.camera),e.gl.setRenderTarget(c),e.gl.render(r,e.camera),e.gl.setRenderTarget(null),u.render(e.gl)):(null==(f=n.current)?void 0:f.blend)===1&&e.gl.render(a,e.camera)))},i),eT.createElement(eT.Fragment,null)}let v_=(e,t,r)=>{let n=new eR.WebGLRenderTarget(e,t,{minFilter:eR.LinearMipmapLinearFilter,magFilter:eR.LinearFilter,type:eR.FloatType,format:eR.RedFormat,generateMipmaps:!0}),i=new eR.WebGLRenderTarget(e,t,{minFilter:eR.NearestFilter,magFilter:eR.NearestFilter}),o=new eR.WebGLRenderTarget(e,t,{minFilter:eR.NearestFilter,magFilter:eR.NearestFilter}),a=new eR.WebGLRenderTarget(e,t,{minFilter:eR.NearestFilter,magFilter:eR.NearestFilter}),s=new eR.WebGLRenderTarget(e,t,{minFilter:eR.NearestFilter,magFilter:eR.NearestFilter}),l=new eR.WebGLRenderTarget(e,t,{minFilter:eR.NearestFilter,magFilter:eR.NearestFilter,type:eR.FloatType,format:eR.RedFormat}),c=new eR.WebGLRenderTarget(e,t,{minFilter:eR.NearestFilter,magFilter:eR.NearestFilter,type:eR.FloatType,format:eR.RedFormat}),u=new aR(new eR.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (round(texture2D(tex, vUv).x)));\n        }"})),h=new aR(new eR.ShaderMaterial({uniforms:{tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        uniform sampler2D tex;\n        varying vec2 vUv;\n        #include <packing>\n        void main() {\n          gl_FragColor = pack2HalfToRGBA(vUv * (1.0 - round(texture2D(tex, vUv).x)));\n        }"})),d=new aR(new eR.ShaderMaterial({uniforms:{tex:{value:null},offset:{value:0},level:{value:0},maxSteps:{value:0}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform float offset;\n        uniform float level;\n        uniform float maxSteps;\n        #include <packing>\n        void main() {\n          float closestDist = 9999999.9;\n          vec2 closestPos = vec2(0.0);\n          for (float x = -1.0; x <= 1.0; x += 1.0) {\n            for (float y = -1.0; y <= 1.0; y += 1.0) {\n              vec2 voffset = vUv;\n              voffset += vec2(x, y) * vec2(".concat(1/e,", ").concat(1/t,") * offset;\n              vec2 pos = unpackRGBATo2Half(texture2D(tex, voffset));\n              float dist = distance(pos.xy, vUv);\n              if(pos.x != 0.0 && pos.y != 0.0 && dist < closestDist) {\n                closestDist = dist;\n                closestPos = pos;\n              }\n            }\n          }\n          gl_FragColor = pack2HalfToRGBA(closestPos);\n        }")})),A=new aR(new eR.ShaderMaterial({uniforms:{tex:{value:null},size:{value:new eR.Vector2(e,t)}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D tex;\n        uniform vec2 size;\n        #include <packing>\n        void main() {\n          gl_FragColor = vec4(distance(size * unpackRGBATo2Half(texture2D(tex, vUv)), size * vUv), 0.0, 0.0, 0.0);\n        }"})),f=new aR(new eR.ShaderMaterial({uniforms:{inside:{value:c.texture},outside:{value:l.texture},tex:{value:null}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"\n        varying vec2 vUv;\n        uniform sampler2D inside;\n        uniform sampler2D outside;\n        uniform sampler2D tex;\n        #include <packing>\n        void main() {\n          float i = texture2D(inside, vUv).x;\n          float o =texture2D(outside, vUv).x;\n          if (texture2D(tex, vUv).x == 0.0) {\n            gl_FragColor = vec4(o, 0.0, 0.0, 0.0);\n          } else {\n            gl_FragColor = vec4(-i, 0.0, 0.0, 0.0);\n          }\n        }"}));return p=>{p.minFilter=eR.NearestFilter,p.magFilter=eR.NearestFilter,u.material.uniforms.tex.value=p,r.setRenderTarget(i),u.render(r);let m=Math.ceil(Math.log(Math.max(e,t))/Math.log(2)),g=i,v=null;for(let e=0;e<m;e++){let t=Math.pow(2,m-e-1);v=g===i?a:i,d.material.uniforms.level.value=e,d.material.uniforms.maxSteps.value=m,d.material.uniforms.offset.value=t,d.material.uniforms.tex.value=g.texture,r.setRenderTarget(v),d.render(r),g=v}r.setRenderTarget(l),A.material.uniforms.tex.value=v.texture,A.render(r),h.material.uniforms.tex.value=p,r.setRenderTarget(o),h.render(r),g=o;for(let e=0;e<m;e++){let t=Math.pow(2,m-e-1);v=g===o?s:o,d.material.uniforms.level.value=e,d.material.uniforms.maxSteps.value=m,d.material.uniforms.offset.value=t,d.material.uniforms.tex.value=g.texture,r.setRenderTarget(v),d.render(r),g=v}return r.setRenderTarget(c),A.material.uniforms.tex.value=v.texture,A.render(r),r.setRenderTarget(n),f.material.uniforms.tex.value=p,f.render(r),r.setRenderTarget(null),n}},vM=e=>{let t;let r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=n?n:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,o={setState:n,getState:i,getInitialState:()=>a,subscribe:e=>(r.add(e),()=>r.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},a=t=e(n,i,o);return o},vS=e=>e?vM(e):vM;var vT=r(9292);let{useDebugValue:vD}=eT,{useSyncExternalStoreWithSelector:vR}=vT,vP=!1,vF=e=>e,vQ=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?vS(e):e,r=(e,r)=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vF,r=arguments.length>2?arguments[2]:void 0;r&&!vP&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),vP=!0);let n=vR(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return vD(n),n})(t,e,r);return Object.assign(r,t),r},vO=e=>e?vQ(e):vQ,vL="undefined"!=typeof window&&(null!=(e_=window.document)&&e_.createElement||(null==(eM=window.navigator)?void 0:eM.product)==="ReactNative")?eT.useLayoutEffect:eT.useEffect,vk=e=>e&&e.isOrthographicCamera,vU=new eR.Color,vG=function(){let e=vO(e=>({current:[],version:0,set:e}));return{In:t=>{let{children:r}=t,n=e(e=>e.set),i=e(e=>e.version);return vL(()=>{n(e=>({version:e.version+1}))},[]),vL(()=>(n(e=>{let{current:t}=e;return{current:[...t,r]}}),()=>n(e=>{let{current:t}=e;return{current:t.filter(e=>e!==r)}})),[r,i]),null},Out:()=>{let t=e(e=>e.current);return eT.createElement(eT.Fragment,null,t)}}}();function vN(e,t){let{right:r,top:n,left:i,bottom:o,width:a,height:s}=t,l=t.bottom<0||n>e.height||r<0||t.left>e.width;if("top"in e){let t=e.top+e.height;return{position:{width:a,height:s,left:i-e.left,top:n,bottom:t-o,right:r},isOffscreen:l}}return{position:{width:a,height:s,top:n,left:i,bottom:e.height-o,right:r},isOffscreen:l}}function vz(e,t){let r,{left:n,bottom:i,width:o,height:a}=t,s=o/a;return vk(e.camera)?(e.camera.left!==-(o/2)||e.camera.right!==o/2||e.camera.top!==a/2||e.camera.bottom!==-(a/2))&&(Object.assign(e.camera,{left:-(o/2),right:o/2,top:a/2,bottom:-(a/2)}),e.camera.updateProjectionMatrix()):e.camera.aspect!==s&&(e.camera.aspect=s,e.camera.updateProjectionMatrix()),r=e.gl.autoClear,e.gl.autoClear=!1,e.gl.setViewport(n,i,o,a),e.gl.setScissor(n,i,o,a),e.gl.setScissorTest(!0),r}function vH(e,t){e.gl.setScissorTest(!1),e.gl.autoClear=t}function vV(e){e.gl.getClearColor(vU),e.gl.setClearColor(vU,e.gl.getClearAlpha()),e.gl.clear(!0,!0)}function vj(e){let{visible:t=!0,canvasSize:r,scene:n,index:i,children:o,frames:a,rect:s,track:l}=e,c=(0,eP.A)(),[u,h]=eT.useState(!1),d=0;return(0,eP.C)(e=>{if(a===1/0||d<=a){var i;l&&(s.current=null==(i=l.current)?void 0:i.getBoundingClientRect()),d++}if(s.current){let{position:i,isOffscreen:a}=vN(r,s.current);if(u!==a&&h(a),t&&!u&&s.current){let t=vz(e,i);e.gl.render(o?e.scene:n,e.camera),vH(e,t)}}},i),eT.useLayoutEffect(()=>{let e=s.current;if(e&&(!t||!u)){let{position:t}=vN(r,e),n=vz(c,t);vV(c),vH(c,n)}},[t,u]),eT.useEffect(()=>{if(!l)return;let e=s.current,t=c.get().events.connected;return c.setEvents({connected:l.current}),()=>{if(e){let{position:t}=vN(r,e),n=vz(c,t);vV(c),vH(c,n)}c.setEvents({connected:t})}},[l]),eT.useEffect(()=>{"top"in r||console.warn("Detected @react-three/fiber canvas size does not include position information. <View /> may not work as expected. Upgrade to @react-three/fiber ^8.1.0 for support.\n See https://github.com/pmndrs/drei/issues/944")},[]),eT.createElement(eT.Fragment,null,o,eT.createElement("group",{onPointerOver:()=>null}))}let vJ=eT.forwardRef((e,t)=>{var r,n,i,o;let{track:a,visible:s=!0,index:l=1,id:c,style:u,className:h,frames:d=1/0,children:A,...f}=e,p=eT.useRef(null),{size:m,scene:g}=(0,eP.A)(),[v]=eT.useState(()=>new eR.Scene),[y,E]=eT.useReducer(()=>!0,!1),C=eT.useCallback((e,t)=>{if(p.current&&a&&a.current&&e.target===a.current){let{width:r,height:n,left:i,top:o}=p.current,a=e.clientX-i,s=e.clientY-o;t.pointer.set(a/r*2-1,-(s/n*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}},[p,a]);return eT.useEffect(()=>{var e;a&&(p.current=null==(e=a.current)?void 0:e.getBoundingClientRect()),E()},[a]),eT.createElement("group",(0,eS.Z)({ref:t},f),y&&(0,eP.g)(eT.createElement(vj,{visible:s,canvasSize:m,frames:d,scene:g,track:a,rect:p,index:l},A),v,{events:{compute:C,priority:l},size:{width:null==(r=p.current)?void 0:r.width,height:null==(n=p.current)?void 0:n.height,top:null==(i=p.current)?void 0:i.top,left:null==(o=p.current)?void 0:o.left}}))}),vY=eT.forwardRef((e,t)=>{let{as:r="div",id:n,visible:i,className:o,style:a,index:s=1,track:l,frames:c=1/0,children:u,...h}=e,d=eT.useId(),A=eT.useRef(null);return eT.useImperativeHandle(t,()=>A.current),eT.createElement(eT.Fragment,null,eT.createElement(r,(0,eS.Z)({ref:A,id:n,className:o,style:a},h)),eT.createElement(vG.In,null,eT.createElement(vJ,{visible:i,key:d,track:A,frames:c,index:s},u)))}),vW=eT.forwardRef((e,t)=>eT.useContext(eP.f)?eT.createElement(vJ,(0,eS.Z)({ref:t},e)):eT.createElement(vY,(0,eS.Z)({ref:t},e)));vW.Port=()=>eT.createElement(vG.Out,null);let vq=eT.createContext(null),vK=new eR.Vector3,vX=new eR.Vector3,vZ=(e,t,r,n)=>{let i=t.dot(t),o=t.dot(e)-t.dot(r),a=t.dot(n);return 0===a?-o/i:(vK.copy(n).multiplyScalar(i/a).sub(t),vX.copy(n).multiplyScalar(o/a).add(r).sub(e),-vK.dot(vX)/vK.dot(vK))},v$=new eR.Vector3(0,1,0),v0=new eR.Matrix4,v1=e=>{let{direction:t,axis:r}=e,{translation:n,translationLimits:i,annotations:o,annotationsClass:a,depthTest:s,scale:l,lineWidth:c,fixed:u,axisColors:h,hoveredColor:d,opacity:A,onDragStart:f,onDrag:p,onDragEnd:m,userData:g}=eT.useContext(vq),v=(0,eP.A)(e=>e.controls),y=eT.useRef(null),E=eT.useRef(null),C=eT.useRef(null),w=eT.useRef(0),[B,x]=eT.useState(!1),I=eT.useCallback(e=>{o&&(y.current.innerText="".concat(n.current[r].toFixed(2)),y.current.style.display="block"),e.stopPropagation();let i=new eR.Matrix4().extractRotation(E.current.matrixWorld),a=e.point.clone(),s=new eR.Vector3().setFromMatrixPosition(E.current.matrixWorld),l=t.clone().applyMatrix4(i).normalize();C.current={clickPoint:a,dir:l},w.current=n.current[r],f({component:"Arrow",axis:r,origin:s,directions:[l]}),v&&(v.enabled=!1),e.target.setPointerCapture(e.pointerId)},[o,t,v,f,n,r]),b=eT.useCallback(e=>{if(e.stopPropagation(),B||x(!0),C.current){let{clickPoint:t,dir:a}=C.current,[s,l]=(null==i?void 0:i[r])||[void 0,void 0],c=vZ(t,a,e.ray.origin,e.ray.direction);void 0!==s&&(c=Math.max(c,s-w.current)),void 0!==l&&(c=Math.min(c,l-w.current)),n.current[r]=w.current+c,o&&(y.current.innerText="".concat(n.current[r].toFixed(2))),v0.makeTranslation(a.x*c,a.y*c,a.z*c),p(v0)}},[o,p,B,n,i,r]),_=eT.useCallback(e=>{o&&(y.current.style.display="none"),e.stopPropagation(),C.current=null,m(),v&&(v.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[o,v,m]),M=eT.useCallback(e=>{e.stopPropagation(),x(!1)},[]),{cylinderLength:S,coneWidth:T,coneLength:D,matrixL:R}=eT.useMemo(()=>{let e=u?c/l*1.6:l/20,r=u?.2:l/5,n=u?1-r:l-r,i=new eR.Quaternion().setFromUnitVectors(v$,t.clone().normalize());return{cylinderLength:n,coneWidth:e,coneLength:r,matrixL:new eR.Matrix4().makeRotationFromQuaternion(i)}},[t,l,c,u]),P=B?d:h[r];return eT.createElement("group",{ref:E},eT.createElement("group",{matrix:R,matrixAutoUpdate:!1,onPointerDown:I,onPointerMove:b,onPointerUp:_,onPointerOut:M},o&&eT.createElement(eH,{position:[0,-D,0]},eT.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:a,ref:y})),eT.createElement("mesh",{visible:!1,position:[0,(S+D)/2,0],userData:g},eT.createElement("cylinderGeometry",{args:[1.4*T,1.4*T,S+D,8,1]})),eT.createElement(an.x,{transparent:!0,raycast:()=>null,depthTest:s,points:[0,0,0,0,S,0],lineWidth:c,side:eR.DoubleSide,color:P,opacity:A,polygonOffset:!0,renderOrder:1,polygonOffsetFactor:-10,fog:!1}),eT.createElement("mesh",{raycast:()=>null,position:[0,S+D/2,0],renderOrder:500},eT.createElement("coneGeometry",{args:[T,D,24,1]}),eT.createElement("meshBasicMaterial",{transparent:!0,depthTest:s,color:P,opacity:A,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))))},v2=new eR.Vector3,v3=new eR.Vector3,v4=e=>180*e/Math.PI,v5=e=>e*Math.PI/180,v9=(e,t,r,n,i)=>{v2.copy(e).sub(r),v3.copy(t).sub(r);let o=n.dot(n),a=i.dot(i),s=v2.dot(n)/o,l=v2.dot(i)/a,c=v3.dot(n)/o;return Math.atan2(v3.dot(i)/a,c)-Math.atan2(l,s)},v6=(e,t)=>{let r=Math.floor(e/t);return e-(r=r<0?r+1:r)*t},v8=e=>{let t=v6(e,2*Math.PI);return 1e-6>Math.abs(t)?0:(t<0&&(t+=2*Math.PI),t)},v7=new eR.Matrix4,ye=new eR.Vector3,yt=new eR.Ray,yr=new eR.Vector3,yn=e=>{let{dir1:t,dir2:r,axis:n}=e,{rotationLimits:i,annotations:o,annotationsClass:a,depthTest:s,scale:l,lineWidth:c,fixed:u,axisColors:h,hoveredColor:d,opacity:A,onDragStart:f,onDrag:p,onDragEnd:m,userData:g}=eT.useContext(vq),v=(0,eP.A)(e=>e.controls),y=eT.useRef(null),E=eT.useRef(null),C=eT.useRef(0),w=eT.useRef(0),B=eT.useRef(null),[x,I]=eT.useState(!1),b=eT.useCallback(e=>{o&&(y.current.innerText="".concat(v4(w.current).toFixed(0),"\xba"),y.current.style.display="block"),e.stopPropagation();let t=e.point.clone(),r=new eR.Vector3().setFromMatrixPosition(E.current.matrixWorld),i=new eR.Vector3().setFromMatrixColumn(E.current.matrixWorld,0).normalize(),a=new eR.Vector3().setFromMatrixColumn(E.current.matrixWorld,1).normalize(),s=new eR.Vector3().setFromMatrixColumn(E.current.matrixWorld,2).normalize(),l=new eR.Plane().setFromNormalAndCoplanarPoint(s,r);B.current={clickPoint:t,origin:r,e1:i,e2:a,normal:s,plane:l},f({component:"Rotator",axis:n,origin:r,directions:[i,a,s]}),v&&(v.enabled=!1),e.target.setPointerCapture(e.pointerId)},[o,v,f,n]),_=eT.useCallback(e=>{if(e.stopPropagation(),x||I(!0),B.current){let{clickPoint:t,origin:r,e1:a,e2:s,normal:l,plane:c}=B.current,[u,h]=(null==i?void 0:i[n])||[void 0,void 0];yt.copy(e.ray),yt.intersectPlane(c,yr),yt.direction.negate(),yt.intersectPlane(c,yr);let d=v9(t,yr,r,a,s),A=v4(d);e.shiftKey&&(d=v5(A=10*Math.round(A/10))),void 0!==u&&void 0!==h&&h-u<2*Math.PI?(d=(d=v8(d))>Math.PI?d-2*Math.PI:d,d=eR.MathUtils.clamp(d,u-C.current,h-C.current),w.current=C.current+d):(w.current=v8(C.current+d),w.current=w.current>Math.PI?w.current-2*Math.PI:w.current),o&&(A=v4(w.current),y.current.innerText="".concat(A.toFixed(0),"\xba")),v7.makeRotationAxis(l,d),ye.copy(r).applyMatrix4(v7).sub(r).negate(),v7.setPosition(ye),p(v7)}},[o,p,x,i,n]),M=eT.useCallback(e=>{o&&(y.current.style.display="none"),e.stopPropagation(),C.current=w.current,B.current=null,m(),v&&(v.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[o,v,m]),S=eT.useCallback(e=>{e.stopPropagation(),I(!1)},[]),T=eT.useMemo(()=>{let e=t.clone().normalize(),n=r.clone().normalize();return new eR.Matrix4().makeBasis(e,n,e.clone().cross(n))},[t,r]),D=u?.65:.65*l,R=eT.useMemo(()=>{let e=[];for(let t=0;t<=32;t++){let r=Math.PI/2*t/32;e.push(new eR.Vector3(Math.cos(r)*D,Math.sin(r)*D,0))}return e},[D]);return eT.createElement("group",{ref:E,onPointerDown:b,onPointerMove:_,onPointerUp:M,onPointerOut:S,matrix:T,matrixAutoUpdate:!1},o&&eT.createElement(eH,{position:[D,D,0]},eT.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:a,ref:y})),eT.createElement(an.x,{points:R,lineWidth:4*c,visible:!1,userData:g}),eT.createElement(an.x,{transparent:!0,raycast:()=>null,depthTest:s,points:R,lineWidth:c,side:eR.DoubleSide,color:x?d:h[n],opacity:A,polygonOffset:!0,polygonOffsetFactor:-10,fog:!1}))},yi=(e,t,r)=>{let n=Math.abs(e.x)>=Math.abs(e.y)&&Math.abs(e.x)>=Math.abs(e.z)?0:Math.abs(e.y)>=Math.abs(e.x)&&Math.abs(e.y)>=Math.abs(e.z)?1:2,i=[0,1,2].sort((e,r)=>Math.abs(t.getComponent(r))-Math.abs(t.getComponent(e))),o=n===i[0]?i[1]:i[0],a=e.getComponent(n),s=e.getComponent(o),l=t.getComponent(n),c=t.getComponent(o),u=r.getComponent(n),h=(r.getComponent(o)-s/a*u)/(c-s/a*l);return[(u-h*l)/a,h]},yo=new eR.Ray,ya=new eR.Vector3,ys=new eR.Matrix4,yl=e=>{let{dir1:t,dir2:r,axis:n}=e,{translation:i,translationLimits:o,annotations:a,annotationsClass:s,depthTest:l,scale:c,lineWidth:u,fixed:h,axisColors:d,hoveredColor:A,opacity:f,onDragStart:p,onDrag:m,onDragEnd:g,userData:v}=eT.useContext(vq),y=(0,eP.A)(e=>e.controls),E=eT.useRef(null),C=eT.useRef(null),w=eT.useRef(null),B=eT.useRef(0),x=eT.useRef(0),[I,b]=eT.useState(!1),_=eT.useCallback(e=>{a&&(E.current.innerText="".concat(i.current[(n+1)%3].toFixed(2),", ").concat(i.current[(n+2)%3].toFixed(2)),E.current.style.display="block"),e.stopPropagation();let t=e.point.clone(),r=new eR.Vector3().setFromMatrixPosition(C.current.matrixWorld),o=new eR.Vector3().setFromMatrixColumn(C.current.matrixWorld,0).normalize(),s=new eR.Vector3().setFromMatrixColumn(C.current.matrixWorld,1).normalize(),l=new eR.Vector3().setFromMatrixColumn(C.current.matrixWorld,2).normalize(),c=new eR.Plane().setFromNormalAndCoplanarPoint(l,r);w.current={clickPoint:t,e1:o,e2:s,plane:c},B.current=i.current[(n+1)%3],x.current=i.current[(n+2)%3],p({component:"Slider",axis:n,origin:r,directions:[o,s,l]}),y&&(y.enabled=!1),e.target.setPointerCapture(e.pointerId)},[a,y,p,n]),M=eT.useCallback(e=>{if(e.stopPropagation(),I||b(!0),w.current){let{clickPoint:t,e1:r,e2:s,plane:l}=w.current,[c,u]=(null==o?void 0:o[(n+1)%3])||[void 0,void 0],[h,d]=(null==o?void 0:o[(n+2)%3])||[void 0,void 0];yo.copy(e.ray),yo.intersectPlane(l,ya),yo.direction.negate(),yo.intersectPlane(l,ya),ya.sub(t);let[A,f]=yi(r,s,ya);void 0!==c&&(A=Math.max(A,c-B.current)),void 0!==u&&(A=Math.min(A,u-B.current)),void 0!==h&&(f=Math.max(f,h-x.current)),void 0!==d&&(f=Math.min(f,d-x.current)),i.current[(n+1)%3]=B.current+A,i.current[(n+2)%3]=x.current+f,a&&(E.current.innerText="".concat(i.current[(n+1)%3].toFixed(2),", ").concat(i.current[(n+2)%3].toFixed(2))),ys.makeTranslation(A*r.x+f*s.x,A*r.y+f*s.y,A*r.z+f*s.z),m(ys)}},[a,m,I,i,o,n]),S=eT.useCallback(e=>{a&&(E.current.style.display="none"),e.stopPropagation(),w.current=null,g(),y&&(y.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[a,y,g]),T=eT.useCallback(e=>{e.stopPropagation(),b(!1)},[]),D=eT.useMemo(()=>{let e=t.clone().normalize(),n=r.clone().normalize();return new eR.Matrix4().makeBasis(e,n,e.clone().cross(n))},[t,r]),R=h?1/7:c/7,P=h?.225:.225*c,F=I?A:d[n],Q=eT.useMemo(()=>[new eR.Vector3(0,0,0),new eR.Vector3(0,P,0),new eR.Vector3(P,P,0),new eR.Vector3(P,0,0),new eR.Vector3(0,0,0)],[P]);return eT.createElement("group",{ref:C,matrix:D,matrixAutoUpdate:!1},a&&eT.createElement(eH,{position:[0,0,0]},eT.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:s,ref:E})),eT.createElement("group",{position:[1.7*R,1.7*R,0]},eT.createElement("mesh",{visible:!0,onPointerDown:_,onPointerMove:M,onPointerUp:S,onPointerOut:T,scale:P,userData:v},eT.createElement("planeGeometry",null),eT.createElement("meshBasicMaterial",{transparent:!0,depthTest:l,color:F,polygonOffset:!0,polygonOffsetFactor:-10,side:eR.DoubleSide,fog:!1})),eT.createElement(an.x,{position:[-P/2,-P/2,0],transparent:!0,depthTest:l,points:Q,lineWidth:u,color:F,opacity:f,polygonOffset:!0,polygonOffsetFactor:-10,userData:v,fog:!1})))},yc=new eR.Vector3,yu=new eR.Vector3,yh=(e,t,r,n)=>{let i=t.dot(t),o=t.dot(e)-t.dot(r),a=t.dot(n);return 0===a?-o/i:(yc.copy(n).multiplyScalar(i/a).sub(t),yu.copy(n).multiplyScalar(o/a).add(r).sub(e),-yc.dot(yu)/yc.dot(yc))},yd=new eR.Vector3(0,1,0),yA=new eR.Vector3,yf=new eR.Matrix4,yp=e=>{let{direction:t,axis:r}=e,{scaleLimits:n,annotations:i,annotationsClass:o,depthTest:a,scale:s,lineWidth:l,fixed:c,axisColors:u,hoveredColor:h,opacity:d,onDragStart:A,onDrag:f,onDragEnd:p,userData:m}=eT.useContext(vq),g=(0,eP.A)(e=>e.size),v=(0,eP.A)(e=>e.controls),y=eT.useRef(null),E=eT.useRef(null),C=eT.useRef(null),w=eT.useRef(1),B=eT.useRef(1),x=eT.useRef(null),[I,b]=eT.useState(!1),_=c?1.2:1.2*s,M=eT.useCallback(e=>{i&&(y.current.innerText="".concat(B.current.toFixed(2)),y.current.style.display="block"),e.stopPropagation();let n=new eR.Matrix4().extractRotation(E.current.matrixWorld),o=e.point.clone(),a=new eR.Vector3().setFromMatrixPosition(E.current.matrixWorld),l=t.clone().applyMatrix4(n).normalize(),u=E.current.matrixWorld.clone(),h=u.clone().invert(),d=c?1/ae(E.current.getWorldPosition(yc),s,e.camera,g):1;x.current={clickPoint:o,dir:l,mPLG:u,mPLGInv:h,offsetMultiplier:d},A({component:"Sphere",axis:r,origin:a,directions:[l]}),v&&(v.enabled=!1),e.target.setPointerCapture(e.pointerId)},[i,v,t,A,r,c,s,g]),S=eT.useCallback(e=>{if(e.stopPropagation(),I||b(!0),x.current){let{clickPoint:t,dir:o,mPLG:a,mPLGInv:l,offsetMultiplier:u}=x.current,[h,d]=(null==n?void 0:n[r])||[1e-5,void 0],A=yh(t,o,e.ray.origin,e.ray.direction)*u,p=Math.pow(2,.2*(c?A:A/s));e.shiftKey&&(p=Math.round(10*p)/10),p=Math.max(p,h/w.current),void 0!==d&&(p=Math.min(p,d/w.current)),B.current=w.current*p,C.current.position.set(0,_+A,0),i&&(y.current.innerText="".concat(B.current.toFixed(2))),yA.set(1,1,1),yA.setComponent(r,p),yf.makeScale(yA.x,yA.y,yA.z).premultiply(a).multiply(l),f(yf)}},[i,_,f,I,n,r]),T=eT.useCallback(e=>{i&&(y.current.style.display="none"),e.stopPropagation(),w.current=B.current,x.current=null,C.current.position.set(0,_,0),p(),v&&(v.enabled=!0),e.target.releasePointerCapture(e.pointerId)},[i,v,p,_]),D=eT.useCallback(e=>{e.stopPropagation(),b(!1)},[]),{radius:R,matrixL:P}=eT.useMemo(()=>{let e=c?l/s*1.8:s/22.5,r=new eR.Quaternion().setFromUnitVectors(yd,t.clone().normalize());return{radius:e,matrixL:new eR.Matrix4().makeRotationFromQuaternion(r)}},[t,s,l,c]),F=I?h:u[r];return eT.createElement("group",{ref:E},eT.createElement("group",{matrix:P,matrixAutoUpdate:!1,onPointerDown:M,onPointerMove:S,onPointerUp:T,onPointerOut:D},i&&eT.createElement(eH,{position:[0,_/2,0]},eT.createElement("div",{style:{display:"none",background:"#151520",color:"white",padding:"6px 8px",borderRadius:7,whiteSpace:"nowrap"},className:o,ref:y})),eT.createElement("mesh",{ref:C,position:[0,_,0],renderOrder:500,userData:m},eT.createElement("sphereGeometry",{args:[R,12,12]}),eT.createElement("meshBasicMaterial",{transparent:!0,depthTest:a,color:F,opacity:d,polygonOffset:!0,polygonOffsetFactor:-10}))))},ym=new eR.Matrix4,yg=new eR.Matrix4,yv=new eR.Matrix4,yy=new eR.Matrix4,yE=new eR.Matrix4,yC=new eR.Matrix4,yw=new eR.Matrix4,yB=new eR.Matrix4,yx=new eR.Matrix4,yI=new eR.Box3,yb=new eR.Box3,y_=new eR.Vector3,yM=new eR.Vector3,yS=new eR.Vector3,yT=new eR.Vector3,yD=new eR.Vector3,yR=new eR.Vector3(1,0,0),yP=new eR.Vector3(0,1,0),yF=new eR.Vector3(0,0,1),yQ=eT.forwardRef((e,t)=>{let{enabled:r=!0,matrix:n,onDragStart:i,onDrag:o,onDragEnd:a,autoTransform:s=!0,anchor:l,disableAxes:c=!1,disableSliders:u=!1,disableRotations:h=!1,disableScaling:d=!1,activeAxes:A=[!0,!0,!0],offset:f=[0,0,0],rotation:p=[0,0,0],scale:m=1,lineWidth:g=4,fixed:v=!1,translationLimits:y,rotationLimits:E,scaleLimits:C,depthTest:w=!0,axisColors:B=["#ff2060","#20df80","#2080ff"],hoveredColor:x="#ffff40",annotations:I=!1,annotationsClass:b,opacity:_=1,visible:M=!0,userData:S,children:T,...D}=e,R=(0,eP.A)(e=>e.invalidate),P=eT.useRef(null),F=eT.useRef(null),Q=eT.useRef(null),O=eT.useRef(null),L=eT.useRef([0,0,0]),k=eT.useRef(new eR.Vector3(1,1,1)),U=eT.useRef(new eR.Vector3(1,1,1));eT.useLayoutEffect(()=>{l&&(O.current.updateWorldMatrix(!0,!0),yy.copy(O.current.matrixWorld).invert(),yI.makeEmpty(),O.current.traverse(e=>{e.geometry&&(e.geometry.boundingBox||e.geometry.computeBoundingBox(),yC.copy(e.matrixWorld).premultiply(yy),yb.copy(e.geometry.boundingBox),yb.applyMatrix4(yC),yI.union(yb))}),y_.copy(yI.max).add(yI.min).multiplyScalar(.5),yM.copy(yI.max).sub(yI.min).multiplyScalar(.5),yS.copy(yM).multiply(new eR.Vector3(...l)).add(y_),yT.set(...f).add(yS),Q.current.position.copy(yT),R())});let G=eT.useMemo(()=>({onDragStart:e=>{ym.copy(F.current.matrix),yg.copy(F.current.matrixWorld),i&&i(e),R()},onDrag:e=>{yv.copy(P.current.matrixWorld),yy.copy(yv).invert(),yE.copy(yg).premultiply(e),yC.copy(yE).premultiply(yy),yw.copy(ym).invert(),yB.copy(yC).multiply(yw),s&&F.current.matrix.copy(yC),o&&o(yC,yB,yE,e),R()},onDragEnd:()=>{a&&a(),R()},translation:L,translationLimits:y,rotationLimits:E,axisColors:B,hoveredColor:x,opacity:_,scale:m,lineWidth:g,fixed:v,depthTest:w,userData:S,annotations:I,annotationsClass:b}),[i,o,a,L,y,E,C,w,m,g,v,...B,x,_,S,s,I,b]),N=new eR.Vector3;return(0,eP.C)(e=>{if(v){let t=ae(Q.current.getWorldPosition(N),m,e.camera,e.size);k.current.setScalar(t)}n&&n instanceof eR.Matrix4&&(F.current.matrix=n),F.current.updateWorldMatrix(!0,!0),yx.makeRotationFromEuler(Q.current.rotation).setPosition(Q.current.position).premultiply(F.current.matrixWorld),U.current.setFromMatrixScale(yx),yD.copy(k.current).divide(U.current),(Math.abs(Q.current.scale.x-yD.x)>1e-4||Math.abs(Q.current.scale.y-yD.y)>1e-4||Math.abs(Q.current.scale.z-yD.z)>1e-4)&&(Q.current.scale.copy(yD),e.invalidate())}),eT.useImperativeHandle(t,()=>F.current,[]),eT.createElement(vq.Provider,{value:G},eT.createElement("group",{ref:P},eT.createElement("group",(0,eS.Z)({ref:F,matrix:n,matrixAutoUpdate:!1},D),eT.createElement("group",{visible:M,ref:Q,position:f,rotation:p},r&&eT.createElement(eT.Fragment,null,!c&&A[0]&&eT.createElement(v1,{axis:0,direction:yR}),!c&&A[1]&&eT.createElement(v1,{axis:1,direction:yP}),!c&&A[2]&&eT.createElement(v1,{axis:2,direction:yF}),!u&&A[0]&&A[1]&&eT.createElement(yl,{axis:2,dir1:yR,dir2:yP}),!u&&A[0]&&A[2]&&eT.createElement(yl,{axis:1,dir1:yF,dir2:yR}),!u&&A[2]&&A[1]&&eT.createElement(yl,{axis:0,dir1:yP,dir2:yF}),!h&&A[0]&&A[1]&&eT.createElement(yn,{axis:2,dir1:yR,dir2:yP}),!h&&A[0]&&A[2]&&eT.createElement(yn,{axis:1,dir1:yF,dir2:yR}),!h&&A[2]&&A[1]&&eT.createElement(yn,{axis:0,dir1:yP,dir2:yF}),!d&&A[0]&&eT.createElement(yp,{axis:0,direction:yR}),!d&&A[1]&&eT.createElement(yp,{axis:1,direction:yP}),!d&&A[2]&&eT.createElement(yp,{axis:2,direction:yF}))),eT.createElement("group",{ref:O},T))))});var yO=r(6101);let yL=(0,eT.createContext)({}),yk={basePath:"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.8/wasm",options:{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},runningMode:"VIDEO",outputFaceBlendshapes:!0,outputFacialTransformationMatrixes:!0}};function yU(e){let{basePath:t=yk.basePath,options:n=yk.options,children:i}=e,o=JSON.stringify(n),a=(0,au.Rq)(async()=>{let{FilesetResolver:e,FaceLandmarker:i}=await r.e(547).then(r.bind(r,1599)),o=await e.forVisionTasks(t);return i.createFromOptions(o,n)},[t,o]);return(0,eT.useEffect)(()=>()=>{null==a||a.close(),(0,au.ZH)([t,o])},[a,t,o]),eT.createElement(yL.Provider,{value:a},i)}function yG(){return(0,eT.useContext)(yL)}function yN(e,t){return e.clone().add(t).multiplyScalar(.5)}function yz(e,t,r){let n=e.localToWorld(t);return r.worldToLocal(n)}let yH=(0,eT.createContext)({}),yV=(0,eT.forwardRef)((e,t)=>{var r,n;let{camera:i,autostart:o=!0,webcam:a=!0,webcamVideoTextureSrc:s,manualUpdate:l=!1,manualDetect:c=!1,onVideoFrame:u,smoothTime:h=.25,offset:d=!0,offsetScalar:A=80,eyes:f=!1,eyesAsOrigin:p=!0,depth:m=.15,debug:g=!1,facemesh:v,makeDefault:y}=e,E=(0,eP.A)(e=>e.scene),C=(0,eP.A)(e=>e.camera),w=(0,eP.A)(e=>e.set),B=(0,eP.A)(e=>e.get),x=i||C,I=(0,eT.useRef)(null),b=(0,eT.useRef)(null),[_]=(0,eT.useState)(()=>new eR.Object3D),[M]=(0,eT.useState)(()=>new eR.Vector3),[S]=(0,eT.useState)(()=>new eR.Vector3),[T]=(0,eT.useState)(()=>new eR.Vector3),[D]=(0,eT.useState)(()=>new eR.Vector3),R=(0,eT.useCallback)(()=>{_.parent=x.parent;let e=b.current;if(e){let{outerRef:t,eyeRightRef:r,eyeLeftRef:n}=e;if(r.current&&n.current){let{irisDirRef:e}=r.current,{irisDirRef:i}=n.current;e.current&&i.current&&t.current&&(M.copy(yz(e.current,new eR.Vector3(0,0,0),t.current)),S.copy(yz(i.current,new eR.Vector3(0,0,0),t.current)),_.position.copy(yz(t.current,yN(M,S),x.parent||E)),T.copy(yz(e.current,new eR.Vector3(0,0,1),t.current)),D.copy(yz(i.current,new eR.Vector3(0,0,1),t.current)),_.lookAt(t.current.localToWorld(yN(T,D))))}else t.current&&(_.position.copy(yz(t.current,new eR.Vector3(0,0,0),x.parent||E)),_.lookAt(t.current.localToWorld(new eR.Vector3(0,0,1))))}return _},[x,S,D,M,T,E,_]),[P]=(0,eT.useState)(()=>new eR.Object3D),F=(0,eT.useCallback)(function(e,t){if(x){var r;null!==(r=t)&&void 0!==r||(t=R()),h>0?(rH.damp3(P.position,t.position,h,e,void 0,void 0,1e-9),rH.dampE(P.rotation,t.rotation,h,e,void 0,void 0,1e-9)):(P.position.copy(t.position),P.rotation.copy(t.rotation)),x.position.copy(P.position),x.rotation.copy(P.rotation)}},[x,R,h,P.position,P.rotation]),[Q,O]=(0,eT.useState)(),L=yG(),k=(0,eT.useCallback)((e,t)=>{O(null==L?void 0:L.detectForVideo(e,t))},[L]);(0,eP.C)((e,t)=>{l||F(t)});let U=(0,eT.useMemo)(()=>Object.assign(Object.create(eR.EventDispatcher.prototype),{detect:k,computeTarget:R,update:F,facemeshApiRef:b,webcamApiRef:I,play:()=>{var e;null==(e=I.current)||null==(e=e.videoTextureApiRef.current)||e.texture.source.data.play()},pause:()=>{var e;null==(e=I.current)||null==(e=e.videoTextureApiRef.current)||e.texture.source.data.pause()}}),[k,R,F]);(0,eT.useImperativeHandle)(t,()=>U,[U]),(0,eT.useEffect)(()=>{let e=e=>{c||k(e.texture.source.data,e.time),u&&u(e)};return U.addEventListener("videoFrame",e),()=>{U.removeEventListener("videoFrame",e)}},[U,k,L,c,u]),(0,eT.useEffect)(()=>{if(y){let e=B().controls;return w({controls:U}),()=>w({controls:e})}},[y,U,B,w]);let G=null==Q?void 0:Q.faceLandmarks[0],N=null==Q||null==(r=Q.facialTransformationMatrixes)?void 0:r[0],z=null==Q||null==(n=Q.faceBlendshapes)?void 0:n[0];return eT.createElement(yH.Provider,{value:U},a&&eT.createElement(eT.Suspense,{fallback:null},eT.createElement(yJ,{ref:I,autostart:o,videoTextureSrc:s})),eT.createElement(yO.vQ,(0,eS.Z)({ref:b},v,{points:G,depth:m,facialTransformationMatrix:N,faceBlendshapes:z,eyes:f,eyesAsOrigin:p,offset:d,offsetScalar:A,debug:g,"rotation-z":Math.PI,visible:g}),eT.createElement("meshBasicMaterial",{side:eR.DoubleSide})))}),yj=()=>(0,eT.useContext)(yH),yJ=(0,eT.forwardRef)((e,t)=>{let{videoTextureSrc:r,autostart:n=!0}=e,i=(0,eT.useRef)(null),o=yj(),a=(0,au.Rq)(async()=>r?Promise.resolve(null):await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}}),[r]);(0,eT.useEffect)(()=>(o.dispatchEvent({type:"stream",stream:a}),()=>{null==a||a.getTracks().forEach(e=>e.stop()),(0,au.ZH)([r])}),[a,o,r]);let s=(0,eT.useMemo)(()=>({videoTextureApiRef:i}),[]);return(0,eT.useImperativeHandle)(t,()=>s,[s]),eT.createElement(eT.Suspense,{fallback:null},eT.createElement(yY,{ref:i,src:r||a,start:n}))}),yY=(0,eT.forwardRef)((e,t)=>{let{src:r,start:n}=e,i=df(r,{start:n}),o=i.source.data,a=yj();yW(o,(0,eT.useCallback)(e=>{a.dispatchEvent({type:"videoFrame",texture:i,time:e})},[i,a]));let s=(0,eT.useMemo)(()=>({texture:i}),[i]);return(0,eT.useImperativeHandle)(t,()=>s,[s]),eT.createElement(eT.Fragment,null)}),yW=(e,t)=>{(0,eT.useEffect)(()=>{let r;if(e&&e.requestVideoFrameCallback)return e.requestVideoFrameCallback(function n(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];t(...o),r=e.requestVideoFrameCallback(n)}),()=>e.cancelVideoFrameCallback(r)},[e,t])}},2930:function(e,t,r){"use strict";let n,i,o;r.d(t,{A:function(){return ef},B:function(){return _},C:function(){return ep},D:function(){return em},E:function(){return M},F:function(){return ey},a:function(){return I},b:function(){return e_},c:function(){return X},d:function(){return eT},e:function(){return E},f:function(){return ee},g:function(){return eD},h:function(){return eB},i:function(){return x},j:function(){return ex},k:function(){return L},l:function(){return eC},m:function(){return ew},n:function(){return ea},o:function(){return es},p:function(){return el},q:function(){return eu},r:function(){return eM},s:function(){return P},t:function(){return v},u:function(){return b},v:function(){return eP},w:function(){return O},x:function(){return eE},y:function(){return ed},z:function(){return eA}});var a,s,l=r(6376),c=r(2265),u=r(7777),h=r(8132),d=r(4812),A=r.n(d),f=r(4566),p=r(5736),m=r(7437),g=r(9079),v=Object.freeze({__proto__:null});let y={},E=e=>void Object.assign(y,e),C=e=>"colorSpace"in e||"outputColorSpace"in e,w=()=>{var e;return null!=(e=y.ColorManagement)?e:null},B=e=>e&&e.isOrthographicCamera,x=e=>e&&e.hasOwnProperty("current"),I="undefined"!=typeof window&&(null!=(a=window.document)&&a.createElement||(null==(s=window.navigator)?void 0:s.product)==="ReactNative")?c.useLayoutEffect:c.useEffect;function b(e){let t=c.useRef(e);return I(()=>void(t.current=e),[e]),t}function _(e){let{set:t}=e;return I(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class M extends c.Component{componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}constructor(...e){super(...e),this.state={error:!1}}}M.getDerivedStateFromError=()=>({error:!0});let S="__default",T=new Map,D=e=>e&&!!e.memoized&&!!e.changes;function R(e){var t;let r="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}let P=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function F(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}let Q={obj:e=>e===Object(e)&&!Q.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let r,{arrays:n="shallow",objects:i="reference",strict:o=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!=typeof t||!!e!=!!t)return!1;if(Q.str(e)||Q.num(e)||Q.boo(e))return e===t;let a=Q.obj(e);if(a&&"reference"===i)return e===t;let s=Q.arr(e);if(s&&"reference"===n)return e===t;if((s||a)&&e===t)return!0;for(r in e)if(!(r in t))return!1;if(a&&"shallow"===n&&"shallow"===i){for(r in o?t:e)if(!Q.equ(e[r],t[r],{strict:o,objects:"reference"}))return!1}else for(r in o?t:e)if(e[r]!==t[r])return!1;if(Q.und(r)){if(s&&0===e.length&&0===t.length||a&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function O(e){let t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}function L(e){for(let t in e.dispose&&"Scene"!==e.type&&e.dispose(),e)null==t.dispose||t.dispose(),delete e[t]}function k(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function U(e,t){let r=e;if(!t.includes("-"))return{target:r,key:t};{let n=t.split("-"),i=n.pop();return{target:r=n.reduce((e,t)=>e[t],e),key:i}}}let G=/-\d+$/;function N(e,t,r){if(Q.str(r)){if(G.test(r)){let{target:t,key:n}=U(e,r.replace(G,""));Array.isArray(t[n])||(t[n]=[])}let{target:n,key:i}=U(e,r);t.__r3f.previousAttach=n[i],n[i]=t}else t.__r3f.previousAttach=r(e,t)}function z(e,t,r){var n,i;if(Q.str(r)){let{target:n,key:i}=U(e,r),o=t.__r3f.previousAttach;void 0===o?delete n[i]:n[i]=o}else null==(n=t.__r3f)||null==n.previousAttach||n.previousAttach(e,t);null==(i=t.__r3f)||delete i.previousAttach}function H(e,t){let{children:r,key:n,ref:i,...o}=t,{children:a,key:s,ref:l,...c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],h=e.__r3f,d=Object.entries(o),A=[];if(u){let e=Object.keys(c);for(let t=0;t<e.length;t++)o.hasOwnProperty(e[t])||d.unshift([e[t],S+"remove"])}d.forEach(t=>{var r;let[n,i]=t;if(null!=(r=e.__r3f)&&r.primitive&&"object"===n||Q.equ(i,c[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return A.push([n,i,!0,[]]);let a=[];for(let e in n.includes("-")&&(a=n.split("-")),A.push([n,i,!1,a]),o){let t=o[e];e.startsWith("".concat(n,"-"))&&A.push([e,t,!1,e.split("-")])}});let f={...o};return null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.args&&(f.args=h.memoizedProps.args),null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.attach&&(f.attach=h.memoizedProps.attach),{memoized:f,changes:A}}let V=void 0!==g&&!1;function j(e,t){var r;let n=e.__r3f,i=null==n?void 0:n.root,o=null==i?void 0:null==i.getState?void 0:i.getState(),{memoized:a,changes:s}=D(t)?t:H(e,t),c=null==n?void 0:n.eventCount;e.__r3f&&(e.__r3f.memoizedProps=a);for(let t=0;t<s.length;t++){let[r,i,a,c]=s[t];if(C(e)){let e="srgb",t="srgb-linear";"encoding"===r?(r="colorSpace",i=3001===i?e:t):"outputEncoding"===r&&(r="outputColorSpace",i=3001===i?e:t)}let u=e,h=u[r];if(c.length&&!((h=c.reduce((e,t)=>e[t],e))&&h.set)){let[t,...n]=c.reverse();u=n.reverse().reduce((e,t)=>e[t],e),r=t}if(i===S+"remove"){if(u.constructor){let e=T.get(u.constructor);e||(e=new u.constructor,T.set(u.constructor,e)),i=e[r]}else i=0}if(a&&n)i?n.handlers[r]=i:delete n.handlers[r],n.eventCount=Object.keys(n.handlers).length;else if(h&&h.set&&(h.copy||h instanceof l.Layers)){if(Array.isArray(i))h.fromArray?h.fromArray(i):h.set(...i);else if(h.copy&&i&&i.constructor&&(V?h.constructor.name===i.constructor.name:h.constructor===i.constructor))h.copy(i);else if(void 0!==i){let e=h instanceof l.Color;!e&&h.setScalar?h.setScalar(i):h instanceof l.Layers&&i instanceof l.Layers?h.mask=i.mask:h.set(i),!w()&&o&&!o.linear&&e&&h.convertSRGBToLinear()}}else if(u[r]=i,u[r]instanceof l.Texture&&u[r].format===l.RGBAFormat&&u[r].type===l.UnsignedByteType&&o){let e=u[r];C(e)&&C(o.gl)?e.colorSpace=o.gl.outputColorSpace:e.encoding=o.gl.outputEncoding}J(e)}if(n&&n.parent&&e.raycast&&c!==n.eventCount){let t=F(e).getState().internal,r=t.interaction.indexOf(e);r>-1&&t.interaction.splice(r,1),n.eventCount&&t.interaction.push(e)}return!(1===s.length&&"onUpdate"===s[0][0])&&s.length&&null!=(r=e.__r3f)&&r.parent&&Y(e),e}function J(e){var t,r;let n=null==(t=e.__r3f)?void 0:null==(r=t.root)?void 0:null==r.getState?void 0:r.getState();n&&0===n.internal.frames&&n.invalidate()}function Y(e){null==e.onUpdate||e.onUpdate(e)}function W(e,t){e.manual||(B(e)?(e.left=-(t.width/2),e.right=t.width/2,e.top=t.height/2,e.bottom=-(t.height/2)):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function q(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function K(e,t,r,n){let i=r.get(t);i&&(r.delete(t),0===r.size&&(e.delete(n),i.target.releasePointerCapture(n)))}function X(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var r;return null==(r=e.__r3f)?void 0:r.handlers["onPointer"+t]}))}function r(t){let{internal:r}=e.getState();for(let e of r.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){let n=e.eventObject.__r3f,i=null==n?void 0:n.handlers;if(r.hovered.delete(q(e)),null!=n&&n.eventCount){let r={...e,intersections:t};null==i.onPointerOut||i.onPointerOut(r),null==i.onPointerLeave||i.onPointerLeave(r)}}}function n(e,t){for(let r=0;r<t.length;r++){let n=t[r].__r3f;null==n||null==n.handlers.onPointerMissed||n.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return t=>{let{internal:n}=e.getState();"pointerId"in t&&n.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{n.capturedMap.has(t.pointerId)&&(n.capturedMap.delete(t.pointerId),r([]))})}}return function(o){let{onPointerMissed:a,internal:s}=e.getState();s.lastEvent.current=o;let c="onPointerMove"===i,u="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,h=function(t,r){let n=e.getState(),i=new Set,o=[],a=r?r(n.internal.interaction):n.internal.interaction;for(let e=0;e<a.length;e++){let t=P(a[e]);t&&(t.raycaster.camera=void 0)}n.previousRoot||null==n.events.compute||n.events.compute(t,n);let s=a.flatMap(function(e){let r=P(e);if(!r||!r.events.enabled||null===r.raycaster.camera)return[];if(void 0===r.raycaster.camera){var n;null==r.events.compute||r.events.compute(t,r,null==(n=r.previousRoot)?void 0:n.getState()),void 0===r.raycaster.camera&&(r.raycaster.camera=null)}return r.raycaster.camera?r.raycaster.intersectObject(e,!0):[]}).sort((e,t)=>{let r=P(e.object),n=P(t.object);return r&&n&&n.events.priority-r.events.priority||e.distance-t.distance}).filter(e=>{let t=q(e);return!i.has(t)&&(i.add(t),!0)});for(let e of(n.events.filter&&(s=n.events.filter(s,n)),s)){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&o.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&n.internal.capturedMap.has(t.pointerId))for(let e of n.internal.capturedMap.get(t.pointerId).values())i.has(q(e.intersection))||o.push(e.intersection);return o}(o,c?t:void 0),d=u?function(t){let{internal:r}=e.getState(),n=t.offsetX-r.initialClick[0],i=t.offsetY-r.initialClick[1];return Math.round(Math.sqrt(n*n+i*i))}(o):0;"onPointerDown"===i&&(s.initialClick=[o.offsetX,o.offsetY],s.initialHits=h.map(e=>e.eventObject)),u&&!h.length&&d<=2&&(n(o,s.interaction),a&&a(o)),c&&r(h),function(t,n,i,o){let a=e.getState();if(t.length){let e={stopped:!1};for(let s of t){let{raycaster:c,pointer:u,camera:h,internal:d}=P(s.object)||a,A=new l.Vector3(u.x,u.y,0).unproject(h),f=e=>{var t,r;return null!=(t=null==(r=d.capturedMap.get(e))?void 0:r.has(s.eventObject))&&t},p=e=>{let t={intersection:s,target:n.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(s.eventObject,t):d.capturedMap.set(e,new Map([[s.eventObject,t]])),n.target.setPointerCapture(e)},m=e=>{let t=d.capturedMap.get(e);t&&K(d.capturedMap,s.eventObject,t,e)},g={};for(let e in n){let t=n[e];"function"!=typeof t&&(g[e]=t)}let v={...s,...g,pointer:u,intersections:t,stopped:e.stopped,delta:i,unprojectedPoint:A,ray:c.ray,camera:h,stopPropagation(){let i="pointerId"in n&&d.capturedMap.get(n.pointerId);(!i||i.has(s.eventObject))&&(v.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find(e=>e.eventObject===s.eventObject)&&r([...t.slice(0,t.indexOf(s)),s]))},target:{hasPointerCapture:f,setPointerCapture:p,releasePointerCapture:m},currentTarget:{hasPointerCapture:f,setPointerCapture:p,releasePointerCapture:m},nativeEvent:n};if(o(v),!0===e.stopped)break}}}(h,o,d,function(e){let t=e.eventObject,r=t.__r3f,a=null==r?void 0:r.handlers;if(null!=r&&r.eventCount){if(c){if(a.onPointerOver||a.onPointerEnter||a.onPointerOut||a.onPointerLeave){let t=q(e),r=s.hovered.get(t);r?r.stopped&&e.stopPropagation():(s.hovered.set(t,e),null==a.onPointerOver||a.onPointerOver(e),null==a.onPointerEnter||a.onPointerEnter(e))}null==a.onPointerMove||a.onPointerMove(e)}else{let r=a[i];r?(!u||s.initialHits.includes(t))&&(n(o,s.interaction.filter(e=>!s.initialHits.includes(e))),r(e)):u&&s.initialHits.includes(t)&&n(o,s.interaction.filter(e=>!s.initialHits.includes(e)))}}})}}}}let Z=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],$=e=>!!(null!=e&&e.render),ee=c.createContext(null),et=(e,t)=>{let r=(0,h.Z)((r,n)=>{let i;let o=new l.Vector3,a=new l.Vector3,s=new l.Vector3;function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n().size,{width:i,height:c,top:u,left:h}=r,d=i/c;t instanceof l.Vector3?s.copy(t):s.set(...t);let A=e.getWorldPosition(o).distanceTo(s);if(B(e))return{width:i/e.zoom,height:c/e.zoom,top:u,left:h,factor:1,distance:A,aspect:d};{let t=2*Math.tan(e.fov*Math.PI/180/2)*A,r=i/c*t;return{width:r,height:t,top:u,left:h,factor:i/r,distance:A,aspect:d}}}let h=e=>r(t=>({performance:{...t.performance,current:e}})),d=new l.Vector2;return{set:r,get:n,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(n(),t)},advance:(e,r)=>t(e,r,n()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new l.Clock,pointer:d,mouse:d,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let e=n();i&&clearTimeout(i),e.performance.current!==e.performance.min&&h(e.performance.min),i=setTimeout(()=>h(n().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:u},setEvents:e=>r(t=>({...t,events:{...t.events,...e}})),setSize:(e,t,i,o,s)=>{let l=n().camera,c={width:e,height:t,top:o||0,left:s||0,updateStyle:i};r(e=>({size:c,viewport:{...e.viewport,...u(l,a,c)}}))},setDpr:e=>r(t=>{let r=R(e);return{viewport:{...t.viewport,dpr:r,initialDpr:t.viewport.initialDpr||r}}}),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always",t=n().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),r(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:c.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,r)=>{let i=n().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:r}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{let r=n().internal;null!=r&&r.subscribers&&(r.priority=r.priority-(t>0?1:0),r.subscribers=r.subscribers.filter(t=>t.ref!==e))}}}}}),n=r.getState(),i=n.size,o=n.viewport.dpr,a=n.camera;return r.subscribe(()=>{let{camera:e,size:t,viewport:n,gl:s,set:l}=r.getState();if(t.width!==i.width||t.height!==i.height||n.dpr!==o){var c;i=t,o=n.dpr,W(e,t),s.setPixelRatio(n.dpr);let r=null!=(c=t.updateStyle)?c:"undefined"!=typeof HTMLCanvasElement&&s.domElement instanceof HTMLCanvasElement;s.setSize(t.width,t.height,r)}e!==a&&(a=e,l(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),r.subscribe(t=>e(t)),r};function er(e,t){let r={callback:e};return t.add(r),()=>void t.delete(r)}let en=new Set,ei=new Set,eo=new Set,ea=e=>er(e,en),es=e=>er(e,ei),el=e=>er(e,eo);function ec(e,t){if(e.size)for(let{callback:r}of e.values())r(t)}function eu(e,t){switch(e){case"before":return ec(en,t);case"after":return ec(ei,t);case"tail":return ec(eo,t)}}function eh(e,t,r){let a=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(a=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),i=t.internal.subscribers,n=0;n<i.length;n++)(o=i[n]).ref.current(o.store.getState(),a,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function ed(e){let t=c.useRef(null);return I(()=>void(t.current=e.current.__r3f),[e]),t}function eA(){let e=c.useContext(ee);if(!e)throw Error("R3F: Hooks can only be used within the Canvas component!");return e}function ef(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return eA()(e,t)}function ep(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=eA(),n=r.getState().internal.subscribe,i=b(e);return I(()=>n(i,t,r),[t,n,r]),null}function em(e){return c.useMemo(()=>O(e),[e])}let eg=new WeakMap;function ev(e,t){return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];let a=eg.get(r);return a||(a=new r,eg.set(r,a)),e&&e(a),Promise.all(i.map(e=>new Promise((r,n)=>a.load(e,e=>{e.scene&&Object.assign(e,O(e.scene)),r(e)},t,t=>n(Error("Could not load ".concat(e,": ").concat(null==t?void 0:t.message)))))))}}function ey(e,t,r,n){let i=Array.isArray(t)?t:[t],o=(0,p.Rq)(ev(r,n),[e,...i],{equal:Q.equ});return Array.isArray(t)?o:o[0]}ey.preload=function(e,t,r){let n=Array.isArray(t)?t:[t];return(0,p.MA)(ev(r),[e,...n])},ey.clear=function(e,t){let r=Array.isArray(t)?t:[t];return(0,p.ZH)([e,...r])};let eE=new Map,{invalidate:eC,advance:ew}=function(e){let t,r,n,i=!1,o=!1;function a(s){for(let c of(r=requestAnimationFrame(a),i=!0,t=0,eu("before",s),o=!0,e.values())){var l;(n=c.store.getState()).internal.active&&("always"===n.frameloop||n.internal.frames>0)&&!(null!=(l=n.gl.xr)&&l.isPresenting)&&(t+=eh(s,n))}if(o=!1,eu("after",s),0===t)return eu("tail",s),i=!1,cancelAnimationFrame(r)}return{loop:a,invalidate:function t(r){var n;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!r)return e.forEach(e=>t(e.store.getState(),s));null!=(n=r.gl.xr)&&n.isPresenting||!r.internal.active||"never"===r.frameloop||(s>1?r.internal.frames=Math.min(60,r.internal.frames+s):o?r.internal.frames=2:r.internal.frames=1,i||(i=!0,requestAnimationFrame(a)))},advance:function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(r&&eu("before",t),n)eh(t,n,i);else for(let r of e.values())eh(t,r.store.getState());r&&eu("after",t)}}}(eE),{reconciler:eB,applyProps:ex}=function(e,t){function r(e,t,r){let n,{args:i=[],attach:o,...a}=t,s="".concat(e[0].toUpperCase()).concat(e.slice(1));if("primitive"===e){if(void 0===a.object)throw Error("R3F: Primitives without 'object' are invalid!");n=k(a.object,{type:e,root:r,attach:o,primitive:!0})}else{let t=y[s];if(!t)throw Error("R3F: ".concat(s," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if(!Array.isArray(i))throw Error("R3F: The args prop must be an array!");n=k(new t(...i),{type:e,root:r,attach:o,memoizedProps:{args:i}})}return void 0===n.__r3f.attach&&(n instanceof l.BufferGeometry?n.__r3f.attach="geometry":n instanceof l.Material&&(n.__r3f.attach="material")),"inject"!==s&&j(n,a),n}function n(e,t){let r=!1;if(t){var n,i;null!=(n=t.__r3f)&&n.attach?N(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),r=!0),r||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||k(t,{}),t.__r3f.parent=e,Y(t),J(t)}}function i(e,t,r){let n=!1;if(t){var i,o;if(null!=(i=t.__r3f)&&i.attach)N(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});let i=e.children.filter(e=>e!==t),o=i.indexOf(r);e.children=[...i.slice(0,o),t,...i.slice(o)],n=!0}n||null==(o=e.__r3f)||o.objects.push(t),t.__r3f||k(t,{}),t.__r3f.parent=e,Y(t),J(t)}}function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach(e=>a(t,e,r))}function a(e,t,r){if(t){var n,i,a,s,l;t.__r3f&&(t.__r3f.parent=null),null!=(n=e.__r3f)&&n.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(i=t.__r3f)&&i.attach?z(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.remove(t),null!=(s=t.__r3f)&&s.root&&function(e,t){let{internal:r}=e.getState();r.interaction=r.interaction.filter(e=>e!==t),r.initialHits=r.initialHits.filter(e=>e!==t),r.hovered.forEach((e,n)=>{(e.eventObject===t||e.object===t)&&r.hovered.delete(n)}),r.capturedMap.forEach((e,n)=>{K(r.capturedMap,t,e,n)})}(F(t),t));let c=null==(a=t.__r3f)?void 0:a.primitive,u=!c&&(void 0===r?null!==t.dispose:r);if(c||(o(null==(l=t.__r3f)?void 0:l.objects,t,u),o(t.children,t,u)),delete t.__r3f,u&&t.dispose&&"Scene"!==t.type){let e=()=>{try{t.dispose()}catch(e){}};"undefined"==typeof IS_REACT_ACT_ENVIRONMENT?(0,f.unstable_scheduleCallback)(f.unstable_IdlePriority,e):e()}J(e)}}let s=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:A()({createInstance:r,removeChild:a,appendChild:n,appendInitialChild:n,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;let r=e.getState().scene;r.__r3f&&(r.__r3f.root=e,n(r,t))},removeChildFromContainer:(e,t)=>{t&&a(e.getState().scene,t)},insertInContainerBefore:(e,t,r)=>{if(!t||!r)return;let n=e.getState().scene;n.__r3f&&i(n,t,r)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;return!!(null!=(t=null==e?void 0:e.__r3f)?t:{}).handlers},prepareUpdate(e,t,r,n){var i;if((null!=(i=null==e?void 0:e.__r3f)?i:{}).primitive&&n.object&&n.object!==e)return[!0];{let{args:t=[],children:i,...o}=n,{args:a=[],children:s,...l}=r;if(!Array.isArray(t))throw Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==a[t]))return[!0];let c=H(e,o,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,i,o,s,l){let[c,u]=t;c?function(e,t,i,o){var s;let l=null==(s=e.__r3f)?void 0:s.parent;if(!l)return;let c=r(t,i,e.__r3f.root);if(e.children){for(let t of e.children)t.__r3f&&n(c,t);e.children=e.children.filter(e=>!e.__r3f)}e.__r3f.objects.forEach(e=>n(c,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||a(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),n(l,c),c.raycast&&c.__r3f.eventCount&&F(c).getState().internal.interaction.push(c),[o,o.alternate].forEach(e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))})}(e,i,s,l):j(e,u)},commitMount(e,t,r,n){var i;let o=null!=(i=e.__r3f)?i:{};e.raycast&&o.handlers&&o.eventCount&&F(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>k(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;let{attach:r,parent:n}=null!=(t=e.__r3f)?t:{};r&&n&&z(n,e,r),e.isObject3D&&(e.visible=!1),J(e)},unhideInstance(e,t){var r;let{attach:n,parent:i}=null!=(r=e.__r3f)?r:{};n&&i&&N(i,e,n),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),J(e)},createTextInstance:s,hideTextInstance:s,unhideTextInstance:s,getCurrentEventPriority:()=>t?t():u.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&Q.fun(performance.now)?performance.now:Q.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Q.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Q.fun(clearTimeout)?clearTimeout:void 0}),applyProps:j}}(0,function(){var e;let t="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!t)return u.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return u.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return u.ContinuousEventPriority;default:return u.DefaultEventPriority}}),eI={objects:"shallow",strict:!1},eb=(e,t)=>{let r="function"==typeof e?e(t):e;return $(r)?r:new l.WebGLRenderer({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function e_(e){let t,r;let n=eE.get(e),i=null==n?void 0:n.fiber,o=null==n?void 0:n.store;n&&console.warn("R3F.createRoot should only be called once!");let a="function"==typeof reportError?reportError:console.error,s=o||et(eC,ew),c=i||eB.createContainer(s,u.ConcurrentRoot,null,!1,null,"",a,null);n||eE.set(e,{fiber:c,store:s});let h=!1;return{configure(){var n,i;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:a,size:c,scene:u,events:d,onCreated:A,shadows:f=!1,linear:p=!1,flat:m=!1,legacy:g=!1,orthographic:v=!1,frameloop:y="always",dpr:E=[1,2],performance:C,raycaster:B,camera:x,onPointerMissed:I}=o,b=s.getState(),_=b.gl;b.gl||b.set({gl:_=eb(a,e)});let M=b.raycaster;M||b.set({raycaster:M=new l.Raycaster});let{params:S,...T}=B||{};if(Q.equ(T,M,eI)||ex(M,{...T}),Q.equ(S,M.params,eI)||ex(M,{params:{...M.params,...S}}),!b.camera||b.camera===r&&!Q.equ(r,x,eI)){r=x;let e=x instanceof l.Camera,t=e?x:v?new l.OrthographicCamera(0,0,0,0,.1,1e3):new l.PerspectiveCamera(75,0,.1,1e3);e||(t.position.z=5,x&&(ex(t,x),("aspect"in x||"left"in x||"right"in x||"bottom"in x||"top"in x)&&(t.manual=!0,t.updateProjectionMatrix())),b.camera||null!=x&&x.rotation||t.lookAt(0,0,0)),b.set({camera:t}),M.camera=t}if(!b.scene){let e;u instanceof l.Scene?e=u:(e=new l.Scene,u&&ex(e,u)),b.set({scene:k(e)})}if(!b.xr){let e=(e,t)=>{let r=s.getState();"never"!==r.frameloop&&ew(e,!0,r,t)},t=()=>{let t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||eC(t)},r={connect(){let e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){let e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(n=_.xr)?void 0:n.addEventListener)&&r.connect(),b.set({xr:r})}if(_.shadowMap){let e=_.shadowMap.enabled,t=_.shadowMap.type;if(_.shadowMap.enabled=!!f,Q.boo(f))_.shadowMap.type=l.PCFSoftShadowMap;else if(Q.str(f)){let e={basic:l.BasicShadowMap,percentage:l.PCFShadowMap,soft:l.PCFSoftShadowMap,variance:l.VSMShadowMap};_.shadowMap.type=null!=(i=e[f])?i:l.PCFSoftShadowMap}else Q.obj(f)&&Object.assign(_.shadowMap,f);(e!==_.shadowMap.enabled||t!==_.shadowMap.type)&&(_.shadowMap.needsUpdate=!0)}let D=w();D&&("enabled"in D?D.enabled=!g:"legacyMode"in D&&(D.legacyMode=g)),h||ex(_,{outputEncoding:p?3e3:3001,toneMapping:m?l.NoToneMapping:l.ACESFilmicToneMapping}),b.legacy!==g&&b.set(()=>({legacy:g})),b.linear!==p&&b.set(()=>({linear:p})),b.flat!==m&&b.set(()=>({flat:m})),!a||Q.fun(a)||$(a)||Q.equ(a,_,eI)||ex(_,a),d&&!b.events.handlers&&b.set({events:d(s)});let P=function(e,t){let r="undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){let{width:e,height:n,top:i,left:o,updateStyle:a=r}=t;return{width:e,height:n,top:i,left:o,updateStyle:a}}if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){let{width:t,height:n,top:i,left:o}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:o,updateStyle:r}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:r}:{width:0,height:0,top:0,left:0}}(e,c);return Q.equ(P,b.size,eI)||b.setSize(P.width,P.height,P.updateStyle,P.top,P.left),E&&b.viewport.dpr!==R(E)&&b.setDpr(E),b.frameloop!==y&&b.setFrameloop(y),b.onPointerMissed||b.set({onPointerMissed:I}),C&&!Q.equ(C,b.performance,eI)&&b.set(e=>({performance:{...e.performance,...C}})),t=A,h=!0,this},render(r){return h||this.configure(),eB.updateContainer((0,m.jsx)(eS,{store:s,children:r,onCreated:t,rootElement:e}),c,null,()=>void 0),s},unmount(){eT(e)}}}function eM(e,t,r){console.warn("R3F.render is no longer supported in React 18. Use createRoot instead!");let n=e_(t);return n.configure(r),n.render(e)}function eS(e){let{store:t,children:r,onCreated:n,rootElement:i}=e;return I(()=>{let e=t.getState();e.set(e=>({internal:{...e.internal,active:!0}})),n&&n(e),t.getState().events.connected||null==e.events.connect||e.events.connect(i)},[]),(0,m.jsx)(ee.Provider,{value:t,children:r})}function eT(e,t){let r=eE.get(e),n=null==r?void 0:r.fiber;if(n){let i=null==r?void 0:r.store.getState();i&&(i.internal.active=!1),eB.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var r,n,o,a;null==i.events.disconnect||i.events.disconnect(),null==(r=i.gl)||null==(n=r.renderLists)||null==n.dispose||n.dispose(),null==(o=i.gl)||null==o.forceContextLoss||o.forceContextLoss(),null!=(a=i.gl)&&a.xr&&i.xr.disconnect(),L(i),eE.delete(e),t&&t(e)}catch(e){}},500)})}}function eD(e,t,r){return(0,m.jsx)(eR,{children:e,container:t,state:r},t.uuid)}function eR(e){let{state:t={},children:r,container:n}=e,{events:i,size:o,...a}=t,s=eA(),[u]=c.useState(()=>new l.Raycaster),[d]=c.useState(()=>new l.Vector2),A=c.useCallback((e,t)=>{let r;let c={...e};if(Object.keys(e).forEach(r=>{(Z.includes(r)||e[r]!==t[r]&&t[r])&&delete c[r]}),t&&o){let n=t.camera;r=e.viewport.getCurrentViewport(n,new l.Vector3,o),n!==e.camera&&W(n,o)}return{...c,scene:n,raycaster:u,pointer:d,mouse:d,previousRoot:s,events:{...e.events,...null==t?void 0:t.events,...i},size:{...e.size,...o},viewport:{...e.viewport,...r},...a}},[t]),[f]=c.useState(()=>{let e=s.getState();return(0,h.Z)((t,r)=>({...e,scene:n,raycaster:u,pointer:d,mouse:d,previousRoot:s,events:{...e.events,...i},size:{...e.size,...o},...a,set:t,get:r,setEvents:e=>t(t=>({...t,events:{...t.events,...e}}))}))});return c.useEffect(()=>{let e=s.subscribe(e=>f.setState(t=>A(e,t)));return()=>{e()}},[A]),c.useEffect(()=>{f.setState(e=>A(s.getState(),e))},[A]),c.useEffect(()=>()=>{f.destroy()},[]),(0,m.jsx)(m.Fragment,{children:eB.createPortal((0,m.jsx)(ee.Provider,{value:f,children:r}),f,null)})}eB.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:c.version});let eP=c.unstable_act},9631:function(e,t,r){"use strict";r.r(t),r.d(t,{Canvas:function(){return S},ReactThreeFiber:function(){return o.t},_roots:function(){return o.x},act:function(){return o.v},addAfterEffect:function(){return o.o},addEffect:function(){return o.n},addTail:function(){return o.p},advance:function(){return o.m},applyProps:function(){return o.j},buildGraph:function(){return o.w},context:function(){return o.f},createEvents:function(){return o.c},createPortal:function(){return o.g},createRoot:function(){return o.b},dispose:function(){return o.k},events:function(){return _},extend:function(){return o.e},flushGlobalEffects:function(){return o.q},getRootState:function(){return o.s},invalidate:function(){return o.l},reconciler:function(){return o.h},render:function(){return o.r},unmountComponentAtNode:function(){return o.d},useFrame:function(){return o.C},useGraph:function(){return o.D},useInstanceHandle:function(){return o.y},useLoader:function(){return o.F},useStore:function(){return o.z},useThree:function(){return o.A}});var n,i,o=r(2930),a=r(2265),s=r(6376),l=r(3802),c=r.n(l);let u=["x","y","top","bottom","left","right","width","height"],h=(e,t)=>u.every(r=>e[r]===t[r]);var d=Object.defineProperty,A=Object.defineProperties,f=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,v=(e,t,r)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y=(e,t)=>{for(var r in t||(t={}))m.call(t,r)&&v(e,r,t[r]);if(p)for(var r of p(t))g.call(t,r)&&v(e,r,t[r]);return e},E=(e,t)=>A(e,f(t));function C(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}"undefined"!=typeof window&&((null==(n=window.document)?void 0:n.createElement)||(null==(i=window.navigator)?void 0:i.product)==="ReactNative")?a.useLayoutEffect:a.useEffect;let w=console.error;console.error=function(){let e=[...arguments].join("");if((null==e?void 0:e.startsWith("Warning:"))&&e.includes("useContext")){console.error=w;return}return w.apply(this,arguments)};let B=C(a.createContext(null));class x extends a.Component{render(){return a.createElement(B.Provider,{value:this._reactInternals},this.props.children)}}var I=r(7437);r(7777),r(4812),r(4566);let b={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function _(e){let{handlePointer:t}=(0,o.c)(e);return{priority:1,enabled:!0,compute(e,t,r){t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(b).reduce((e,r)=>({...e,[r]:t(r)}),{}),update:()=>{var t;let{events:r,internal:n}=e.getState();null!=(t=n.lastEvent)&&t.current&&r.handlers&&r.handlers.onPointerMove(n.lastEvent.current)},connect:t=>{var r;let{set:n,events:i}=e.getState();null==i.disconnect||i.disconnect(),n(e=>({events:{...e.events,connected:t}})),Object.entries(null!=(r=i.handlers)?r:[]).forEach(e=>{let[r,n]=e,[i,o]=b[r];t.addEventListener(i,n,{passive:o})})},disconnect:()=>{let{set:t,events:r}=e.getState();if(r.connected){var n;Object.entries(null!=(n=r.handlers)?n:[]).forEach(e=>{let[t,n]=e;if(r&&r.connected instanceof HTMLElement){let[e]=b[t];r.connected.removeEventListener(e,n)}}),t(e=>({events:{...e.events,connected:void 0}}))}}}}let M=a.forwardRef(function(e,t){let{children:r,fallback:n,resize:i,style:l,gl:u,events:d=_,eventSource:A,eventPrefix:f,shadows:p,linear:m,flat:g,legacy:v,orthographic:w,frameloop:b,dpr:M,performance:S,raycaster:T,camera:D,scene:R,onPointerMissed:P,onCreated:F,...Q}=e;a.useMemo(()=>(0,o.e)(s),[]);let O=function(){let e=function(){let e=function(){let e=a.useContext(B);if(null===e)throw Error("its-fine: useFiber must be called within a <FiberProvider />!");let t=a.useId();return a.useMemo(()=>{for(let r of[e,null==e?void 0:e.alternate]){if(!r)continue;let e=function e(t,r,n){if(!t)return;if(!0===n(t))return t;let i=r?t.return:t.child;for(;i;){let t=e(i,r,n);if(t)return t;i=r?null:i.sibling}}(r,!1,e=>{let r=e.memoizedState;for(;r;){if(r.memoizedState===t)return!0;r=r.next}});if(e)return e}},[e,t])}(),[t]=a.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&"object"==typeof r.type){let e=void 0===r.type._context&&r.type.Provider===r.type?r.type:r.type._context;e&&e!==B&&!t.has(e)&&t.set(e,a.useContext(C(e)))}r=r.return}return t}();return a.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>a.createElement(t,null,a.createElement(r.Provider,E(y({},n),{value:e.get(r)}))),e=>a.createElement(x,y({},e))),[e])}(),[L,k]=function(e){var t;let{debounce:r,scroll:n,polyfill:i,offsetSize:o}=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e,s=i||("undefined"==typeof window?class{}:window.ResizeObserver);if(!s)throw Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[l,u]=(0,a.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),d=(0,a.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l}),A=r?"number"==typeof r?r:r.scroll:null,f=r?"number"==typeof r?r:r.resize:null,p=(0,a.useRef)(!1);(0,a.useEffect)(()=>(p.current=!0,()=>void(p.current=!1)));let[m,g,v]=(0,a.useMemo)(()=>{let e=()=>{if(!d.current.element)return;let{left:e,top:t,width:r,height:n,bottom:i,right:a,x:s,y:l}=d.current.element.getBoundingClientRect(),c={left:e,top:t,width:r,height:n,bottom:i,right:a,x:s,y:l};d.current.element instanceof HTMLElement&&o&&(c.height=d.current.element.offsetHeight,c.width=d.current.element.offsetWidth),Object.freeze(c),p.current&&!h(d.current.lastBounds,c)&&u(d.current.lastBounds=c)};return[e,f?c()(e,f):e,A?c()(e,A):e]},[u,o,A,f]);function y(){d.current.scrollContainers&&(d.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",v,!0)),d.current.scrollContainers=null),d.current.resizeObserver&&(d.current.resizeObserver.disconnect(),d.current.resizeObserver=null)}function E(){d.current.element&&(d.current.resizeObserver=new s(v),d.current.resizeObserver.observe(d.current.element),n&&d.current.scrollContainers&&d.current.scrollContainers.forEach(e=>e.addEventListener("scroll",v,{capture:!0,passive:!0})))}return t=!!n,(0,a.useEffect)(()=>{if(t)return window.addEventListener("scroll",v,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",v,!0)},[v,t]),(0,a.useEffect)(()=>(window.addEventListener("resize",g),()=>void window.removeEventListener("resize",g)),[g]),(0,a.useEffect)(()=>{y(),E()},[n,v,g]),(0,a.useEffect)(()=>y,[]),[e=>{e&&e!==d.current.element&&(y(),d.current.element=e,d.current.scrollContainers=function e(t){let r=[];if(!t||t===document.body)return r;let{overflow:n,overflowX:i,overflowY:o}=window.getComputedStyle(t);return[n,i,o].some(e=>"auto"===e||"scroll"===e)&&r.push(t),[...r,...e(t.parentElement)]}(e),E())},l,m]}({scroll:!0,debounce:{scroll:50,resize:0},...i}),U=a.useRef(null),G=a.useRef(null);a.useImperativeHandle(t,()=>U.current);let N=(0,o.u)(P),[z,H]=a.useState(!1),[V,j]=a.useState(!1);if(z)throw z;if(V)throw V;let J=a.useRef(null);(0,o.a)(()=>{let e=U.current;k.width>0&&k.height>0&&e&&(J.current||(J.current=(0,o.b)(e)),J.current.configure({gl:u,events:d,shadows:p,linear:m,flat:g,legacy:v,orthographic:w,frameloop:b,dpr:M,performance:S,raycaster:T,camera:D,scene:R,size:k,onPointerMissed:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return null==N.current?void 0:N.current(...t)},onCreated:e=>{null==e.events.connect||e.events.connect(A?(0,o.i)(A)?A.current:A:G.current),f&&e.setEvents({compute:(e,t)=>{let r=e[f+"X"],n=e[f+"Y"];t.pointer.set(r/t.size.width*2-1,-(n/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==F||F(e)}}),J.current.render((0,I.jsx)(O,{children:(0,I.jsx)(o.E,{set:j,children:(0,I.jsx)(a.Suspense,{fallback:(0,I.jsx)(o.B,{set:H}),children:r})})})))}),a.useEffect(()=>{let e=U.current;if(e)return()=>(0,o.d)(e)},[]);let Y=A?"none":"auto";return(0,I.jsx)("div",{ref:G,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Y,...l},...Q,children:(0,I.jsx)("div",{ref:L,style:{width:"100%",height:"100%"},children:(0,I.jsx)("canvas",{ref:U,style:{display:"block"},children:n})})})}),S=a.forwardRef(function(e,t){return(0,I.jsx)(x,{children:(0,I.jsx)(M,{...e,ref:t})})})},5630:function(e,t){"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function r(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,i=e[n];if(0<o(i,t))e[n]=t,e[r]=i,r=n;else break}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,i=e.length,a=i>>>1;n<a;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,r))c<i&&0>o(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else if(c<i&&0>o(u,r))e[n]=u,e[c]=r,n=c;else break}}return t}function o(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a,s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],h=[],d=1,A=null,f=3,p=!1,m=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,E="undefined"!=typeof setImmediate?setImmediate:null;function C(e){for(var t=n(h);null!==t;){if(null===t.callback)i(h);else if(t.startTime<=e)i(h),t.sortIndex=t.expirationTime,r(u,t);else break;t=n(h)}}function w(e){if(g=!1,C(e),!m){if(null!==n(u))m=!0,P(B);else{var t=n(h);null!==t&&F(w,t.startTime-e)}}}function B(e,r){m=!1,g&&(g=!1,y(b),b=-1),p=!0;var o=f;try{for(C(r),A=n(u);null!==A&&(!(A.expirationTime>r)||e&&!S());){var a=A.callback;if("function"==typeof a){A.callback=null,f=A.priorityLevel;var s=a(A.expirationTime<=r);r=t.unstable_now(),"function"==typeof s?A.callback=s:A===n(u)&&i(u),C(r)}else i(u);A=n(u)}if(null!==A)var l=!0;else{var c=n(h);null!==c&&F(w,c.startTime-r),l=!1}return l}finally{A=null,f=o,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x=!1,I=null,b=-1,_=5,M=-1;function S(){return!(t.unstable_now()-M<_)}function T(){if(null!==I){var e=t.unstable_now();M=e;var r=!0;try{r=I(!0,e)}finally{r?a():(x=!1,I=null)}}else x=!1}if("function"==typeof E)a=function(){E(T)};else if("undefined"!=typeof MessageChannel){var D=new MessageChannel,R=D.port2;D.port1.onmessage=T,a=function(){R.postMessage(null)}}else a=function(){v(T,0)};function P(e){I=e,x||(x=!0,a())}function F(e,r){b=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,P(B))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?a+o:a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=o+s,e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s,sortIndex:-1},o>a?(e.sortIndex=o,r(h,e),null===n(u)&&e===n(h)&&(g?(y(b),b=-1):g=!0,F(w,o-a))):(e.sortIndex=s,r(u,e),m||p||(m=!0,P(B))),e},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},4566:function(e,t,r){"use strict";e.exports=r(5630)},6033:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,o=l(e),a=o[0],s=o[1],c=new i((a+s)*3/4-s),u=0,h=s>0?a-4:a;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[u++]=255&t),1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(function(e,t,n){for(var i,o=[],a=t;a<n;a+=3)o.push(r[(i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}(e,a,a+16383>s?s:a+16383));return 1===i?o.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&o.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=o.length;a<s;++a)r[a]=o[a],n[o.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},3663:function(e,t,r){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */let n=r(6033),i=r(1531),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!s.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|f(e,t),n=a(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(L(e,Uint8Array)){let t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(L(e,ArrayBuffer)||e&&L(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(L(e,SharedArrayBuffer)||e&&L(e.buffer,SharedArrayBuffer)))return d(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);let i=function(e){var t;if(s.isBuffer(e)){let t=0|A(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?a(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),a(e<0?0:0|A(e))}function h(e){let t=e.length<0?0:0|A(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e,t,r){let n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),s.prototype),n}function A(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function f(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||L(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Q(e).length;default:if(i)return n?-1:F(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){let n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=k[e[n]];return i}(this,t,r);case"utf8":case"utf-8":return y(this,t,r);case"ascii":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":var o,a;return o=t,a=r,0===o&&a===this.length?n.fromByteArray(this):n.fromByteArray(this.slice(o,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){let n=e.slice(t,r),i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}(this,t,r);default:if(i)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function m(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function g(e,t,r,n,i){var o;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(o=r=+r)!=o&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return -1;r=e.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){let o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*a}else -1!==n&&(o-=o-n),n=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){let r=!0;for(let n=0;n<l;n++)if(c(e,o+n)!==c(t,n)){r=!1;break}if(r)return o}return -1}function y(e,t,r){r=Math.min(e.length,r);let n=[],i=t;for(;i<r;){let t=e[i],o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:(192&(r=e[i+1]))==128&&(l=(31&t)<<6|63&r)>127&&(o=l);break;case 3:r=e[i+1],n=e[i+2],(192&r)==128&&(192&n)==128&&(l=(15&t)<<12|(63&r)<<6|63&n)>2047&&(l<55296||l>57343)&&(o=l);break;case 4:r=e[i+1],n=e[i+2],s=e[i+3],(192&r)==128&&(192&n)==128&&(192&s)==128&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&s)>65535&&l<1114112&&(o=l)}}null===o?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=a}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function E(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function C(e,t,r,n,i,o){if(!s.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function w(e,t,r,n,i){T(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function B(e,t,r,n,i){T(t,n,i,e,r,7);let o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function x(e,t,r,n,i,o){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function I(e,t,r,n,o){return t=+t,r>>>=0,o||x(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function b(e,t,r,n,o){return t=+t,r>>>=0,o||x(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}t.lW=s,t.h2=50,s.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,r){return(c(e),e<=0)?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)},s.allocUnsafe=function(e){return u(e)},s.allocUnsafeSlow=function(e){return u(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(L(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),L(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let n=s.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){let t=e[r];if(L(t,Uint8Array))i+t.length>n.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else if(s.isBuffer(t))t.copy(n,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=t.length}return n},s.byteLength=f,s.prototype._isBuffer=!0,s.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},s.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},s.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},s.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?y(this,0,e):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let e="",r=t.h2;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(s.prototype[o]=s.prototype.inspect),s.prototype.compare=function(e,t,r,n,i){if(L(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;let o=i-n,a=r-t,l=Math.min(o,a),c=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<l;++e)if(c[e]!==u[e]){o=c[e],a=u[e];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return g(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return g(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){var i,o,a,s,l,c,u,h;if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-t;if((void 0===r||r>d)&&(r=d),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let A=!1;for(;;)switch(n){case"hex":return function(e,t,r,n){let i;r=Number(r)||0;let o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;let a=t.length;for(n>a/2&&(n=a/2),i=0;i<n;++i){let n=parseInt(t.substr(2*i,2),16);if(n!=n)break;e[r+i]=n}return i}(this,e,t,r);case"utf8":case"utf-8":return i=t,o=r,O(F(e,this.length-i),this,i,o);case"ascii":case"latin1":case"binary":return a=t,s=r,O(function(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,a,s);case"base64":return l=t,c=r,O(Q(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,h=r,O(function(e,t){let r,n;let i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,i.push(r%256),i.push(n);return i}(e,this.length-u),this,u,h);default:if(A)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),A=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(e,t){let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=U(function(e){D(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&R(e,this.length-8);let n=t+256*this[++e]+65536*this[++e]+16777216*this[++e],i=this[++e]+256*this[++e]+65536*this[++e]+16777216*r;return BigInt(n)+(BigInt(i)<<BigInt(32))}),s.prototype.readBigUInt64BE=U(function(e){D(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&R(e,this.length-8);let n=16777216*t+65536*this[++e]+256*this[++e]+this[++e],i=16777216*this[++e]+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e],i=1,o=0;for(;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=t,i=1,o=this[e+--n];for(;n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return(e>>>=0,t||E(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||E(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||E(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=U(function(e){D(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&R(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),s.prototype.readBigInt64BE=U(function(e){D(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&R(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+r)}),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||E(e,4,this.length),i.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||E(e,4,this.length),i.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||E(e,8,this.length),i.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||E(e,8,this.length),i.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;C(this,e,t,r,n,0)}let i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;C(this,e,t,r,n,0)}let i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=U(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return w(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=U(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);C(this,e,t,r,n-1,-n)}let i=0,o=1,a=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);C(this,e,t,r,n-1,-n)}let i=r-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=U(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return w(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=U(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return b(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return b(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);let i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},s.prototype.fill=function(e,t,r,n){let i;if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){let t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{let o=s.isBuffer(e)?e:s.from(e,n),a=o.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%a]}return this};let _={};function M(e,t,r){_[e]=class extends r{get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name="".concat(this.name," [").concat(e,"]"),this.stack,delete this.name}}}function S(e){let t="",r=e.length,n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function T(e,t,r,n,i,o){if(e>r||e<t){let n;let i="bigint"==typeof t?"n":"";throw n=o>3?0===t||t===BigInt(0)?">= 0".concat(i," and < 2").concat(i," ** ").concat((o+1)*8).concat(i):">= -(2".concat(i," ** ").concat((o+1)*8-1).concat(i,") and < 2 ** ")+"".concat((o+1)*8-1).concat(i):">= ".concat(t).concat(i," and <= ").concat(r).concat(i),new _.ERR_OUT_OF_RANGE("value",n,e)}D(i,"offset"),(void 0===n[i]||void 0===n[i+o])&&R(i,n.length-(o+1))}function D(e,t){if("number"!=typeof e)throw new _.ERR_INVALID_ARG_TYPE(t,"number",e)}function R(e,t,r){if(Math.floor(e)!==e)throw D(e,r),new _.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new _.ERR_BUFFER_OUT_OF_BOUNDS;throw new _.ERR_OUT_OF_RANGE(r||"offset",">= ".concat(r?1:0," and <= ").concat(t),e)}M("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"},RangeError),M("ERR_INVALID_ARG_TYPE",function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)},TypeError),M("ERR_OUT_OF_RANGE",function(e,t,r){let n='The value of "'.concat(e,'" is out of range.'),i=r;return Number.isInteger(r)&&Math.abs(r)>4294967296?i=S(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=S(i)),i+="n"),n+=" It must be ".concat(t,". Received ").concat(i)},RangeError);let P=/[^+/0-9A-Za-z-_]/g;function F(e,t){let r;t=t||1/0;let n=e.length,i=null,o=[];for(let a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319||a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return o}function Q(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function O(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function L(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let k=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function U(e){return"undefined"==typeof BigInt?G:e}function G(){throw Error("BigInt not supported")}},3802:function(e){"use strict";function t(e,t,r){function n(){var c=Date.now()-s;c<t&&c>=0?i=setTimeout(n,t-c):(i=null,r||(l=e.apply(a,o),a=o=null))}null==t&&(t=100);var i,o,a,s,l,c=function(){a=this,o=arguments,s=Date.now();var c=r&&!i;return i||(i=setTimeout(n,t)),c&&(l=e.apply(a,o),a=o=null),l};return c.clear=function(){i&&(clearTimeout(i),i=null)},c.flush=function(){i&&(l=e.apply(a,o),a=o=null,clearTimeout(i),i=null)},c}t.debounce=t,e.exports=t},1531:function(e,t){"use strict";/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?i-1:0,d=r?-1:1,A=e[t+h];for(h+=d,o=A&(1<<-u)-1,A>>=-u,u+=s;u>0;o=256*o+e[t+h],h+=d,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(A?-1:1);a+=Math.pow(2,n),o-=c}return(A?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?5960464477539062e-23:0,A=n?0:o-1,f=n?1:-1,p=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+h>=1?t+=d/l:t+=d*Math.pow(2,1-h),t*l>=2&&(a++,l/=2),a+h>=u?(s=0,a=u):a+h>=1?(s=(t*l-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+A]=255&s,A+=f,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+A]=255&a,A+=f,a/=256,c-=8);e[r+A-f]|=128*p}},8792:function(e,t,r){"use strict";r.d(t,{default:function(){return i.a}});var n=r(5250),i=r.n(n)},7907:function(e,t,r){"use strict";var n=r(5313);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}})},9079:function(e,t,r){"use strict";var n,i;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(i=r.g.process)?void 0:i.env)?r.g.process:r(3127)},2956:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLocale",{enumerable:!0,get:function(){return n}}),r(2139);let n=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6406:function(e,t,r){"use strict";function n(e,t,r,n){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return n}}),r(2139),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5250:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return E}});let n=r(6921),i=r(7437),o=n._(r(2265)),a=r(4542),s=r(7434),l=r(1030),c=r(6874),u=r(2956),h=r(6993),d=r(8599),A=r(5291),f=r(6406),p=r(5786),m=r(1414),g=new Set;function v(e,t,r,n,i,o){if("undefined"!=typeof window&&(o||(0,s.isLocalURL)(t))){if(!n.bypassPrefetchedCheck){let i=t+"%"+r+"%"+(void 0!==n.locale?n.locale:"locale"in e?e.locale:void 0);if(g.has(i))return;g.add(i)}Promise.resolve(o?e.prefetch(t,i):e.prefetch(t,r,n)).catch(e=>{})}}function y(e){return"string"==typeof e?e:(0,l.formatUrl)(e)}let E=o.default.forwardRef(function(e,t){let r,n;let{href:l,as:g,children:E,prefetch:C=null,passHref:w,replace:B,shallow:x,scroll:I,locale:b,onClick:_,onMouseEnter:M,onTouchStart:S,legacyBehavior:T=!1,...D}=e;r=E,T&&("string"==typeof r||"number"==typeof r)&&(r=(0,i.jsx)("a",{children:r}));let R=o.default.useContext(h.RouterContext),P=o.default.useContext(d.AppRouterContext),F=null!=R?R:P,Q=!R,O=!1!==C,L=null===C?m.PrefetchKind.AUTO:m.PrefetchKind.FULL,{href:k,as:U}=o.default.useMemo(()=>{if(!R){let e=y(l);return{href:e,as:g?y(g):e}}let[e,t]=(0,a.resolveHref)(R,l,!0);return{href:e,as:g?(0,a.resolveHref)(R,g):t||e}},[R,l,g]),G=o.default.useRef(k),N=o.default.useRef(U);T&&(n=o.default.Children.only(r));let z=T?n&&"object"==typeof n&&n.ref:t,[H,V,j]=(0,A.useIntersection)({rootMargin:"200px"}),J=o.default.useCallback(e=>{(N.current!==U||G.current!==k)&&(j(),N.current=U,G.current=k),H(e),z&&("function"==typeof z?z(e):"object"==typeof z&&(z.current=e))},[U,z,k,j,H]);o.default.useEffect(()=>{F&&V&&O&&v(F,k,U,{locale:b},{kind:L},Q)},[U,k,V,b,O,null==R?void 0:R.locale,F,Q,L]);let Y={ref:J,onClick(e){T||"function"!=typeof _||_(e),T&&n.props&&"function"==typeof n.props.onClick&&n.props.onClick(e),F&&!e.defaultPrevented&&function(e,t,r,n,i,a,l,c,u){let{nodeName:h}=e.currentTarget;if("A"===h.toUpperCase()&&(function(e){let t=e.currentTarget.getAttribute("target");return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!u&&!(0,s.isLocalURL)(r)))return;e.preventDefault();let d=()=>{let e=null==l||l;"beforePopState"in t?t[i?"replace":"push"](r,n,{shallow:a,locale:c,scroll:e}):t[i?"replace":"push"](n||r,{scroll:e})};u?o.default.startTransition(d):d()}(e,F,k,U,B,x,I,b,Q)},onMouseEnter(e){T||"function"!=typeof M||M(e),T&&n.props&&"function"==typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),F&&(O||!Q)&&v(F,k,U,{locale:b,priority:!0,bypassPrefetchedCheck:!0},{kind:L},Q)},onTouchStart(e){T||"function"!=typeof S||S(e),T&&n.props&&"function"==typeof n.props.onTouchStart&&n.props.onTouchStart(e),F&&(O||!Q)&&v(F,k,U,{locale:b,priority:!0,bypassPrefetchedCheck:!0},{kind:L},Q)}};if((0,c.isAbsoluteUrl)(U))Y.href=U;else if(!T||w||"a"===n.type&&!("href"in n.props)){let e=void 0!==b?b:null==R?void 0:R.locale,t=(null==R?void 0:R.isLocaleDomain)&&(0,f.getDomainLocale)(U,e,null==R?void 0:R.locales,null==R?void 0:R.domainLocales);Y.href=t||(0,p.addBasePath)((0,u.addLocale)(U,e,null==R?void 0:R.defaultLocale))}return T?o.default.cloneElement(n,Y):(0,i.jsx)("a",{...D,...Y,children:r})});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},2185:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{requestIdleCallback:function(){return r},cancelIdleCallback:function(){return n}});let r="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},n="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4542:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"resolveHref",{enumerable:!0,get:function(){return h}});let n=r(5770),i=r(1030),o=r(4544),a=r(6874),s=r(2139),l=r(7434),c=r(2360),u=r(6735);function h(e,t,r){let h;let d="string"==typeof t?t:(0,i.formatWithValidation)(t),A=d.match(/^[a-zA-Z]{1,}:\/\//),f=A?d.slice(A[0].length):d;if((f.split("?",1)[0]||"").match(/(\/\/|\\)/)){console.error("Invalid href '"+d+"' passed to next/router in page: '"+e.pathname+"'. Repeated forward-slashes (//) or backslashes \\ are not valid in the href.");let t=(0,a.normalizeRepeatedSlashes)(f);d=(A?A[0]:"")+t}if(!(0,l.isLocalURL)(d))return r?[d]:d;try{h=new URL(d.startsWith("#")?e.asPath:e.pathname,"http://n")}catch(e){h=new URL("/","http://n")}try{let e=new URL(d,h);e.pathname=(0,s.normalizePathTrailingSlash)(e.pathname);let t="";if((0,c.isDynamicRoute)(e.pathname)&&e.searchParams&&r){let r=(0,n.searchParamsToUrlQuery)(e.searchParams),{result:a,params:s}=(0,u.interpolateAs)(e.pathname,e.pathname,r);a&&(t=(0,i.formatWithValidation)({pathname:a,hash:e.hash,query:(0,o.omit)(r,s)}))}let a=e.origin===h.origin?e.href.slice(e.origin.length):e.href;return r?[a,t||a]:a}catch(e){return r?[d]:d}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5291:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return l}});let n=r(2265),i=r(2185),o="function"==typeof IntersectionObserver,a=new Map,s=[];function l(e){let{rootRef:t,rootMargin:r,disabled:l}=e,c=l||!o,[u,h]=(0,n.useState)(!1),d=(0,n.useRef)(null),A=(0,n.useCallback)(e=>{d.current=e},[]);return(0,n.useEffect)(()=>{if(o){if(c||u)return;let e=d.current;if(e&&e.tagName)return function(e,t,r){let{id:n,observer:i,elements:o}=function(e){let t;let r={root:e.root||null,margin:e.rootMargin||""},n=s.find(e=>e.root===r.root&&e.margin===r.margin);if(n&&(t=a.get(n)))return t;let i=new Map;return t={id:r,observer:new IntersectionObserver(e=>{e.forEach(e=>{let t=i.get(e.target),r=e.isIntersecting||e.intersectionRatio>0;t&&r&&t(r)})},e),elements:i},s.push(r),a.set(r,t),t}(r);return o.set(e,t),i.observe(e),function(){if(o.delete(e),i.unobserve(e),0===o.size){i.disconnect(),a.delete(n);let e=s.findIndex(e=>e.root===n.root&&e.margin===n.margin);e>-1&&s.splice(e,1)}}}(e,e=>e&&h(e),{root:null==t?void 0:t.current,rootMargin:r})}else if(!u){let e=(0,i.requestIdleCallback)(()=>h(!0));return()=>(0,i.cancelIdleCallback)(e)}},[c,r,t,u,d.current]),[A,u,(0,n.useCallback)(()=>{h(!1)},[])]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3127:function(e){"use strict";!function(){var t={229:function(e){var t,r,n,i=e.exports={};function o(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l=[],c=!1,u=-1;function h(){c&&n&&(c=!1,n.length?l=n.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=s(h);c=!0;for(var t=l.length;t;){for(n=l,l=[];++u<t;)n&&n[u].run();u=-1,t=l.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function A(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new A(e,t)),1!==l.length||c||s(d)},A.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var o=r[e]={exports:{}},a=!0;try{t[e](o,o.exports,n),a=!1}finally{a&&delete r[e]}return o.exports}n.ab="//";var i=n(229);e.exports=i}()},2202:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"escapeStringRegexp",{enumerable:!0,get:function(){return i}});let r=/[|\\{}()[\]^$+*?.-]/,n=/[|\\{}()[\]^$+*?.-]/g;function i(e){return r.test(e)?e.replace(n,"\\$&"):e}},6993:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return n}});let n=r(6921)._(r(2265)).default.createContext(null)},1030:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{formatUrl:function(){return o},urlObjectKeys:function(){return a},formatWithValidation:function(){return s}});let n=r(1884)._(r(5770)),i=/https?|ftp|gopher|file/;function o(e){let{auth:t,hostname:r}=e,o=e.protocol||"",a=e.pathname||"",s=e.hash||"",l=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?"["+r+"]":r),e.port&&(c+=":"+e.port)),l&&"object"==typeof l&&(l=String(n.urlQueryToSearchParams(l)));let u=e.search||l&&"?"+l||"";return o&&!o.endsWith(":")&&(o+=":"),e.slashes||(!o||i.test(o))&&!1!==c?(c="//"+(c||""),a&&"/"!==a[0]&&(a="/"+a)):c||(c=""),s&&"#"!==s[0]&&(s="#"+s),u&&"?"!==u[0]&&(u="?"+u),""+o+c+(a=a.replace(/[?#]/g,encodeURIComponent))+(u=u.replace("#","%23"))+s}let a=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function s(e){return o(e)}},2360:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getSortedRoutes:function(){return n.getSortedRoutes},isDynamicRoute:function(){return i.isDynamicRoute}});let n=r(7409),i=r(1305)},6735:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"interpolateAs",{enumerable:!0,get:function(){return o}});let n=r(2395),i=r(9935);function o(e,t,r){let o="",a=(0,i.getRouteRegex)(e),s=a.groups,l=(t!==e?(0,n.getRouteMatcher)(a)(t):"")||r;o=e;let c=Object.keys(s);return c.every(e=>{let t=l[e]||"",{repeat:r,optional:n}=s[e],i="["+(r?"...":"")+e+"]";return n&&(i=(t?"":"/")+"["+i+"]"),r&&!Array.isArray(t)&&(t=[t]),(n||e in l)&&(o=o.replace(i,r?t.map(e=>encodeURIComponent(e)).join("/"):encodeURIComponent(t))||"/")})||(o=""),{params:c,result:o}}},1305:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isDynamicRoute",{enumerable:!0,get:function(){return o}});let n=r(4749),i=/\/\[[^/]+?\](?=\/|$)/;function o(e){return(0,n.isInterceptionRouteAppPath)(e)&&(e=(0,n.extractInterceptionRouteInformation)(e).interceptedRoute),i.test(e)}},7434:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isLocalURL",{enumerable:!0,get:function(){return o}});let n=r(6874),i=r(7379);function o(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let t=(0,n.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,i.hasBasePath)(r.pathname)}catch(e){return!1}}},4544:function(e,t){"use strict";function r(e,t){let r={};return Object.keys(e).forEach(n=>{t.includes(n)||(r[n]=e[n])}),r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"omit",{enumerable:!0,get:function(){return r}})},5770:function(e,t){"use strict";function r(e){let t={};return e.forEach((e,r)=>{void 0===t[r]?t[r]=e:Array.isArray(t[r])?t[r].push(e):t[r]=[t[r],e]}),t}function n(e){return"string"!=typeof e&&("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let t=new URLSearchParams;return Object.entries(e).forEach(e=>{let[r,i]=e;Array.isArray(i)?i.forEach(e=>t.append(r,n(e))):t.set(r,n(i))}),t}function o(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.forEach(t=>{Array.from(t.keys()).forEach(t=>e.delete(t)),t.forEach((t,r)=>e.append(r,t))}),e}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{searchParamsToUrlQuery:function(){return r},urlQueryToSearchParams:function(){return i},assign:function(){return o}})},2395:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getRouteMatcher",{enumerable:!0,get:function(){return i}});let n=r(6874);function i(e){let{re:t,groups:r}=e;return e=>{let i=t.exec(e);if(!i)return!1;let o=e=>{try{return decodeURIComponent(e)}catch(e){throw new n.DecodeError("failed to decode param")}},a={};return Object.keys(r).forEach(e=>{let t=r[e],n=i[t.pos];void 0!==n&&(a[e]=~n.indexOf("/")?n.split("/").map(e=>o(e)):t.repeat?[o(n)]:o(n))}),a}}},9935:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{getRouteRegex:function(){return l},getNamedRouteRegex:function(){return h},getNamedMiddlewareRegex:function(){return d}});let n=r(4749),i=r(2202),o=r(5868);function a(e){let t=e.startsWith("[")&&e.endsWith("]");t&&(e=e.slice(1,-1));let r=e.startsWith("...");return r&&(e=e.slice(3)),{key:e,repeat:r,optional:t}}function s(e){let t=(0,o.removeTrailingSlash)(e).slice(1).split("/"),r={},s=1;return{parameterizedRoute:t.map(e=>{let t=n.INTERCEPTION_ROUTE_MARKERS.find(t=>e.startsWith(t)),o=e.match(/\[((?:\[.*\])|.+)\]/);if(t&&o){let{key:e,optional:n,repeat:l}=a(o[1]);return r[e]={pos:s++,repeat:l,optional:n},"/"+(0,i.escapeStringRegexp)(t)+"([^/]+?)"}if(!o)return"/"+(0,i.escapeStringRegexp)(e);{let{key:e,repeat:t,optional:n}=a(o[1]);return r[e]={pos:s++,repeat:t,optional:n},t?n?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)"}}).join(""),groups:r}}function l(e){let{parameterizedRoute:t,groups:r}=s(e);return{re:RegExp("^"+t+"(?:/)?$"),groups:r}}function c(e){let{interceptionMarker:t,getSafeRouteKey:r,segment:n,routeKeys:o,keyPrefix:s}=e,{key:l,optional:c,repeat:u}=a(n),h=l.replace(/\W/g,"");s&&(h=""+s+h);let d=!1;(0===h.length||h.length>30)&&(d=!0),isNaN(parseInt(h.slice(0,1)))||(d=!0),d&&(h=r()),s?o[h]=""+s+l:o[h]=l;let A=t?(0,i.escapeStringRegexp)(t):"";return u?c?"(?:/"+A+"(?<"+h+">.+?))?":"/"+A+"(?<"+h+">.+?)":"/"+A+"(?<"+h+">[^/]+?)"}function u(e,t){let r;let a=(0,o.removeTrailingSlash)(e).slice(1).split("/"),s=(r=0,()=>{let e="",t=++r;for(;t>0;)e+=String.fromCharCode(97+(t-1)%26),t=Math.floor((t-1)/26);return e}),l={};return{namedParameterizedRoute:a.map(e=>{let r=n.INTERCEPTION_ROUTE_MARKERS.some(t=>e.startsWith(t)),o=e.match(/\[((?:\[.*\])|.+)\]/);if(r&&o){let[r]=e.split(o[0]);return c({getSafeRouteKey:s,interceptionMarker:r,segment:o[1],routeKeys:l,keyPrefix:t?"nxtI":void 0})}return o?c({getSafeRouteKey:s,segment:o[1],routeKeys:l,keyPrefix:t?"nxtP":void 0}):"/"+(0,i.escapeStringRegexp)(e)}).join(""),routeKeys:l}}function h(e,t){let r=u(e,t);return{...l(e),namedRegex:"^"+r.namedParameterizedRoute+"(?:/)?$",routeKeys:r.routeKeys}}function d(e,t){let{parameterizedRoute:r}=s(e),{catchAll:n=!0}=t;if("/"===r)return{namedRegex:"^/"+(n?".*":"")+"$"};let{namedParameterizedRoute:i}=u(e,!1);return{namedRegex:"^"+i+(n?"(?:(/.*)?)":"")+"$"}}},7409:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getSortedRoutes",{enumerable:!0,get:function(){return n}});class r{insert(e){this._insert(e.split("/").filter(Boolean),[],!1)}smoosh(){return this._smoosh()}_smoosh(e){void 0===e&&(e="/");let t=[...this.children.keys()].sort();null!==this.slugName&&t.splice(t.indexOf("[]"),1),null!==this.restSlugName&&t.splice(t.indexOf("[...]"),1),null!==this.optionalRestSlugName&&t.splice(t.indexOf("[[...]]"),1);let r=t.map(t=>this.children.get(t)._smoosh(""+e+t+"/")).reduce((e,t)=>[...e,...t],[]);if(null!==this.slugName&&r.push(...this.children.get("[]")._smoosh(e+"["+this.slugName+"]/")),!this.placeholder){let t="/"===e?"/":e.slice(0,-1);if(null!=this.optionalRestSlugName)throw Error('You cannot define a route with the same specificity as a optional catch-all route ("'+t+'" and "'+t+"[[..."+this.optionalRestSlugName+']]").');r.unshift(t)}return null!==this.restSlugName&&r.push(...this.children.get("[...]")._smoosh(e+"[..."+this.restSlugName+"]/")),null!==this.optionalRestSlugName&&r.push(...this.children.get("[[...]]")._smoosh(e+"[[..."+this.optionalRestSlugName+"]]/")),r}_insert(e,t,n){if(0===e.length){this.placeholder=!1;return}if(n)throw Error("Catch-all must be the last part of the URL.");let i=e[0];if(i.startsWith("[")&&i.endsWith("]")){let r=i.slice(1,-1),a=!1;if(r.startsWith("[")&&r.endsWith("]")&&(r=r.slice(1,-1),a=!0),r.startsWith("...")&&(r=r.substring(3),n=!0),r.startsWith("[")||r.endsWith("]"))throw Error("Segment names may not start or end with extra brackets ('"+r+"').");if(r.startsWith("."))throw Error("Segment names may not start with erroneous periods ('"+r+"').");function o(e,r){if(null!==e&&e!==r)throw Error("You cannot use different slug names for the same dynamic path ('"+e+"' !== '"+r+"').");t.forEach(e=>{if(e===r)throw Error('You cannot have the same slug name "'+r+'" repeat within a single dynamic path');if(e.replace(/\W/g,"")===i.replace(/\W/g,""))throw Error('You cannot have the slug names "'+e+'" and "'+r+'" differ only by non-word symbols within a single dynamic path')}),t.push(r)}if(n){if(a){if(null!=this.restSlugName)throw Error('You cannot use both an required and optional catch-all route at the same level ("[...'+this.restSlugName+']" and "'+e[0]+'" ).');o(this.optionalRestSlugName,r),this.optionalRestSlugName=r,i="[[...]]"}else{if(null!=this.optionalRestSlugName)throw Error('You cannot use both an optional and required catch-all route at the same level ("[[...'+this.optionalRestSlugName+']]" and "'+e[0]+'").');o(this.restSlugName,r),this.restSlugName=r,i="[...]"}}else{if(a)throw Error('Optional route parameters are not yet supported ("'+e[0]+'").');o(this.slugName,r),this.slugName=r,i="[]"}}this.children.has(i)||this.children.set(i,new r),this.children.get(i)._insert(e.slice(1),t,n)}constructor(){this.placeholder=!0,this.children=new Map,this.slugName=null,this.restSlugName=null,this.optionalRestSlugName=null}}function n(e){let t=new r;return e.forEach(e=>t.insert(e)),t.smoosh()}},6874:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{WEB_VITALS:function(){return r},execOnce:function(){return n},isAbsoluteUrl:function(){return o},getLocationOrigin:function(){return a},getURL:function(){return s},getDisplayName:function(){return l},isResSent:function(){return c},normalizeRepeatedSlashes:function(){return u},loadGetInitialProps:function(){return h},SP:function(){return d},ST:function(){return A},DecodeError:function(){return f},NormalizeError:function(){return p},PageNotFoundError:function(){return m},MissingStaticPage:function(){return g},MiddlewareNotFoundError:function(){return v},stringifyError:function(){return y}});let r=["CLS","FCP","FID","INP","LCP","TTFB"];function n(e){let t,r=!1;return function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return r||(r=!0,t=e(...i)),t}}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,o=e=>i.test(e);function a(){let{protocol:e,hostname:t,port:r}=window.location;return e+"//"+t+(r?":"+r:"")}function s(){let{href:e}=window.location,t=a();return e.substring(t.length)}function l(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function c(e){return e.finished||e.headersSent}function u(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?"?"+t.slice(1).join("?"):"")}async function h(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await h(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&c(r))return n;if(!n)throw Error('"'+l(e)+'.getInitialProps()" should resolve to an object. But found "'+n+'" instead.');return n}let d="undefined"!=typeof performance,A=d&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class f extends Error{}class p extends Error{}class m extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+e}}class g extends Error{constructor(e,t){super(),this.message="Failed to load static file for page: "+e+" "+t}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function y(e){return JSON.stringify({message:e.message,stack:e.stack})}},8314:function(e,t,r){"use strict";var n=r(1811);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},4404:function(e,t,r){"use strict";e.exports=r(8314)()},1811:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},8025:function(e,t){"use strict";/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},7777:function(e,t,r){"use strict";e.exports=r(8025)},4812:function(e,t,r){"use strict";e.exports=r(5224)},2818:function(e,t){"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function r(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,i=e[n];if(0<o(i,t))e[n]=t,e[r]=i,r=n;else break}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,i=e.length,a=i>>>1;n<a;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,r))c<i&&0>o(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else if(c<i&&0>o(u,r))e[n]=u,e[c]=r,n=c;else break}}return t}function o(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var a,s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],h=[],d=1,A=null,f=3,p=!1,m=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,E="undefined"!=typeof setImmediate?setImmediate:null;function C(e){for(var t=n(h);null!==t;){if(null===t.callback)i(h);else if(t.startTime<=e)i(h),t.sortIndex=t.expirationTime,r(u,t);else break;t=n(h)}}function w(e){if(g=!1,C(e),!m){if(null!==n(u))m=!0,P(B);else{var t=n(h);null!==t&&F(w,t.startTime-e)}}}function B(e,r){m=!1,g&&(g=!1,y(b),b=-1),p=!0;var o=f;try{for(C(r),A=n(u);null!==A&&(!(A.expirationTime>r)||e&&!S());){var a=A.callback;if("function"==typeof a){A.callback=null,f=A.priorityLevel;var s=a(A.expirationTime<=r);r=t.unstable_now(),"function"==typeof s?A.callback=s:A===n(u)&&i(u),C(r)}else i(u);A=n(u)}if(null!==A)var l=!0;else{var c=n(h);null!==c&&F(w,c.startTime-r),l=!1}return l}finally{A=null,f=o,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x=!1,I=null,b=-1,_=5,M=-1;function S(){return!(t.unstable_now()-M<_)}function T(){if(null!==I){var e=t.unstable_now();M=e;var r=!0;try{r=I(!0,e)}finally{r?a():(x=!1,I=null)}}else x=!1}if("function"==typeof E)a=function(){E(T)};else if("undefined"!=typeof MessageChannel){var D=new MessageChannel,R=D.port2;D.port1.onmessage=T,a=function(){R.postMessage(null)}}else a=function(){v(T,0)};function P(e){I=e,x||(x=!0,a())}function F(e,r){b=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,P(B))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?a+o:a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=o+s,e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s,sortIndex:-1},o>a?(e.sortIndex=o,r(h,e),null===n(u)&&e===n(h)&&(g?(y(b),b=-1):g=!0,F(w,o-a))):(e.sortIndex=s,r(u,e),m||p||(m=!0,P(B))),e},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},8239:function(e,t,r){"use strict";e.exports=r(2818)},3028:function(e){"use strict";var t;e.exports=((t=function(){function e(e){return i.appendChild(e.dom),e}function r(e){for(var t=0;t<i.children.length;t++)i.children[t].style.display=t===e?"block":"none";n=e}var n=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(e){e.preventDefault(),r(++n%i.children.length)},!1);var o=(performance||Date).now(),a=o,s=0,l=e(new t.Panel("FPS","#0ff","#002")),c=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=e(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:i,addPanel:e,showPanel:r,begin:function(){o=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(c.update(e-o,200),e>a+1e3&&(l.update(1e3*s/(e-a),100),a=e,s=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){o=this.end()},domElement:i,setMode:r}}).Panel=function(e,t,r){var n=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,l=48*a,c=3*a,u=2*a,h=3*a,d=15*a,A=74*a,f=30*a,p=document.createElement("canvas");p.width=s,p.height=l,p.style.cssText="width:80px;height:48px";var m=p.getContext("2d");return m.font="bold "+9*a+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=r,m.fillRect(0,0,s,l),m.fillStyle=t,m.fillText(e,c,u),m.fillRect(h,d,A,f),m.fillStyle=r,m.globalAlpha=.9,m.fillRect(h,d,A,f),{dom:p,update:function(l,g){n=Math.min(n,l),i=Math.max(i,l),m.fillStyle=r,m.globalAlpha=1,m.fillRect(0,0,s,d),m.fillStyle=t,m.fillText(o(l)+" "+e+" ("+o(n)+"-"+o(i)+")",c,u),m.drawImage(p,h+a,d,A-a,f,h,d,A-a,f),m.fillRect(h+A-a,d,a,f),m.fillStyle=r,m.globalAlpha=.9,m.fillRect(h+A-a,d,a,o((1-l/g)*f))}}},t)},5736:function(e,t,r){"use strict";r.d(t,{MA:function(){return l},Rq:function(){return s},ZH:function(){return c}});let n=e=>"object"==typeof e&&"function"==typeof e.then,i=[];function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;let n=e.length;if(t.length!==n)return!1;for(let i=0;i<n;i++)if(!r(e[i],t[i]))return!1;return!0}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(let n of(null===t&&(t=[e]),i))if(o(t,n.keys,n.equal)){if(r)return;if(Object.prototype.hasOwnProperty.call(n,"error"))throw n.error;if(Object.prototype.hasOwnProperty.call(n,"response"))return a.lifespan&&a.lifespan>0&&(n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(n.remove,a.lifespan)),n.response;if(!r)throw n.promise}let s={keys:t,equal:a.equal,remove:()=>{let e=i.indexOf(s);-1!==e&&i.splice(e,1)},promise:(n(e)?e:e(...t)).then(e=>{s.response=e,a.lifespan&&a.lifespan>0&&(s.timeout=setTimeout(s.remove,a.lifespan))}).catch(e=>s.error=e)};if(i.push(s),!r)throw s.promise}let s=(e,t,r)=>a(e,t,!1,r),l=(e,t,r)=>void a(e,t,!0,r),c=e=>{if(void 0===e||0===e.length)i.splice(0,i.length);else{let t=i.find(t=>o(e,t.keys,t.equal));t&&t.remove()}}},8943:function(e,t,r){"use strict";r.d(t,{B$:function(){return function e(t,r){let i=function(e){let t=JSON.stringify(e,A),r=p.get(t);return null==r&&p.set(t,r=++f),r}(r),m=c.get(t);if(m||c.set(t,m=Object.create(null)),m[i])return new m[i];let g="_onBeforeCompile".concat(i),v=function(e,n){t.onBeforeCompile.call(this,e,n);let a=this.customProgramCacheKey()+"|"+e.vertexShader+"|"+e.fragmentShader,c=u[a];if(!c){let t=function(e,t,r,n){let{vertexShader:i,fragmentShader:a}=t,{vertexDefs:s,vertexMainIntro:l,vertexMainOutro:c,vertexTransform:u,fragmentDefs:h,fragmentMainIntro:A,fragmentMainOutro:f,fragmentColorTransform:p,customRewriter:m,timeUniform:g}=r;if(s=s||"",l=l||"",c=c||"",h=h||"",A=A||"",f=f||"",(u||m)&&(i=o(i)),(p||m)&&(a=o(a=a.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"))),m){let e=m({vertexShader:i,fragmentShader:a});i=e.vertexShader,a=e.fragmentShader}if(p){let e=[];a=a.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,t=>(e.push(t),"")),f="".concat(p,"\n").concat(e.join("\n"),"\n").concat(f)}if(g){let e="\nuniform float ".concat(g,";\n");s=e+s,h=e+h}return u&&(i="vec3 troika_position_".concat(n,";\nvec3 troika_normal_").concat(n,";\nvec2 troika_uv_").concat(n,";\n").concat(i,"\n"),s="".concat(s,"\nvoid troikaVertexTransform").concat(n,"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  ").concat(u,"\n}\n"),l="\ntroika_position_".concat(n," = vec3(position);\ntroika_normal_").concat(n," = vec3(normal);\ntroika_uv_").concat(n," = vec2(uv);\ntroikaVertexTransform").concat(n,"(troika_position_").concat(n,", troika_normal_").concat(n,", troika_uv_").concat(n,");\n").concat(l,"\n"),i=i.replace(/\b(position|normal|uv)\b/g,(e,t,r,i)=>/\battribute\s+vec[23]\s+$/.test(i.substr(0,r))?t:"troika_".concat(t,"_").concat(n)),e.map&&e.map.channel>0||(i=i.replace(/\bMAP_UV\b/g,"troika_uv_".concat(n)))),{vertexShader:i=d(i,n,s,l,c),fragmentShader:a=d(a,n,h,A,f)}}(this,e,r,i);c=u[a]=t}e.vertexShader=c.vertexShader,e.fragmentShader=c.fragmentShader,s(e.uniforms,this.uniforms),r.timeUniform&&(e.uniforms[r.timeUniform]={get value(){return Date.now()-l}}),this[g]&&this[g](e)},y=function(){return E(r.chained?t:t.clone())},E=function(e){let n=Object.create(e,C);return Object.defineProperty(n,"baseMaterial",{value:t}),Object.defineProperty(n,"id",{value:h++}),n.uuid=function(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(a[255&e]+a[e>>8&255]+a[e>>16&255]+a[e>>24&255]+"-"+a[255&t]+a[t>>8&255]+"-"+a[t>>16&15|64]+a[t>>24&255]+"-"+a[63&r|128]+a[r>>8&255]+"-"+a[r>>16&255]+a[r>>24&255]+a[255&n]+a[n>>8&255]+a[n>>16&255]+a[n>>24&255]).toUpperCase()}(),n.uniforms=s({},e.uniforms,r.uniforms),n.defines=s({},e.defines,r.defines),n.defines["TROIKA_DERIVED_MATERIAL_".concat(i)]="",n.extensions=s({},e.extensions,r.extensions),n._listeners=void 0,n},C={constructor:{value:y},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+i}},onBeforeCompile:{get:()=>v,set(e){this[g]=e}},copy:{writable:!0,configurable:!0,value:function(e){return t.copy.call(this,e),t.isShaderMaterial||t.isDerivedMaterial||(s(this.extensions,e.extensions),s(this.defines,e.defines),s(this.uniforms,n.UniformsUtils.clone(e.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){return E(new t.constructor).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let i=this._depthMaterial;return i||((i=this._depthMaterial=e(t.isDerivedMaterial?t.getDepthMaterial():new n.MeshDepthMaterial({depthPacking:n.RGBADepthPacking}),r)).defines.IS_DEPTH_MATERIAL="",i.uniforms=this.uniforms),i}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let i=this._distanceMaterial;return i||((i=this._distanceMaterial=e(t.isDerivedMaterial?t.getDistanceMaterial():new n.MeshDistanceMaterial,r)).defines.IS_DISTANCE_MATERIAL="",i.uniforms=this.uniforms),i}},dispose:{writable:!0,configurable:!0,value(){let{_depthMaterial:e,_distanceMaterial:r}=this;e&&e.dispose(),r&&r.dispose(),t.dispose.call(this)}}};return m[i]=y,new y}},MW:function(){return i}});var n=r(6376);let i=/\bvoid\s+main\s*\(\s*\)\s*{/g;function o(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(e,t){let r=n.ShaderChunk[t];return r?o(r):e})}let a=[];for(let e=0;e<256;e++)a[e]=(e<16?"0":"")+e.toString(16);let s=Object.assign||function(){let e=arguments[0];for(let t=1,r=arguments.length;t<r;t++){let r=arguments[t];if(r)for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},l=Date.now(),c=new WeakMap,u=new Map,h=1e10;function d(e,t,r,n,o){return(n||o||r)&&(e=e.replace(i,"\n".concat(r,"\nvoid troikaOrigMain").concat(t,"() {"))+"\nvoid main() {\n  ".concat(n,"\n  troikaOrigMain").concat(t,"();\n  ").concat(o,"\n}")),e}function A(e,t){return"uniforms"===e?void 0:"function"==typeof t?t.toString():t}let f=0,p=new Map;n.DoubleSide},8187:function(e,t,r){"use strict";function n(){var e=Object.create(null);function t(e,t){var r=void 0;self.troikaDefine=function(e){return r=e};var n=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+t+"\n)"],{type:"application/javascript"}));try{importScripts(n)}catch(e){console.error(e)}return URL.revokeObjectURL(n),delete self.troikaDefine,r}self.addEventListener("message",function(r){var n=r.data,i=n.messageId,o=n.action,a=n.data;try{"registerModule"===o&&function r(n,i){var o=n.id,a=n.name,s=n.dependencies;void 0===s&&(s=[]);var l=n.init;void 0===l&&(l=function(){});var c=n.getTransferables;if(void 0===c&&(c=null),!e[o])try{s=s.map(function(t){return t&&t.isWorkerModule&&(r(t,function(e){if(e instanceof Error)throw e}),t=e[t.id].value),t}),l=t("<"+a+">.init",l),c&&(c=t("<"+a+">.getTransferables",c));var u=null;"function"==typeof l?u=l.apply(void 0,s):console.error("worker module init function failed to rehydrate"),e[o]={id:o,value:u,getTransferables:c},i(u)}catch(e){e&&e.noLog||console.error(e),i(e)}}(a,function(e){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:{isCallable:"function"==typeof e}})}),"callModule"===o&&function(t,r){var n,i=t.id,o=t.args;e[i]&&"function"==typeof e[i].value||r(Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var a=(n=e[i]).value.apply(n,o);a&&"function"==typeof a.then?a.then(s,function(e){return r(e instanceof Error?e:Error(""+e))}):s(a)}catch(e){r(e)}function s(t){try{var n=e[i].getTransferables&&e[i].getTransferables(t);n&&Array.isArray(n)&&n.length||(n=void 0),r(t,n)}catch(e){console.error(e),r(e)}}}(a,function(e,t){e instanceof Error?postMessage({messageId:i,success:!1,error:e.message}):postMessage({messageId:i,success:!0,result:e},t||void 0)})}catch(e){postMessage({messageId:i,success:!1,error:e.stack})}})}r.d(t,{Ae:function(){return h},Ch:function(){return function e(t){if((!t||"function"!=typeof t.init)&&!s)throw Error("requires `options.init` function");var r,n=t.dependencies,a=t.init,l=t.getTransferables,u=t.workerId;if(!i())return(r=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return r._getInitResult().then(function(t){if("function"==typeof t)return t.apply(void 0,e);throw Error("Worker module function was called but `init` did not return a callable function")})})._getInitResult=function(){var e=t.dependencies,n=t.init,i=Promise.all(e=Array.isArray(e)?e.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[]).then(function(e){return n.apply(null,e)});return r._getInitResult=function(){return i},i},r;null==u&&(u="#default");var h="workerModule"+ ++o,f=t.name||h,p=null;function m(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(!p){p=A(u,"registerModule",m.workerModuleData);var r=function(){p=null,c[u].delete(r)};(c[u]||(c[u]=new Set)).add(r)}return p.then(function(t){if(t.isCallable)return A(u,"callModule",{id:h,args:e});throw Error("Worker module function was called but `init` did not return a callable function")})}return n=n&&n.map(function(t){return"function"!=typeof t||t.workerModuleData||(s=!0,t=e({workerId:u,name:"<"+f+"> function dependency: "+t.name,init:"function(){return (\n"+d(t)+"\n)}"}),s=!1),t&&t.workerModuleData&&(t=t.workerModuleData),t}),m.workerModuleData={isWorkerModule:!0,id:h,name:f,dependencies:n,init:d(a),getTransferables:l&&d(l)},m}}}),r(9079);var i=function(){var e=!1;if("undefined"!=typeof window&&void 0!==window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(e){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+e.message+"]")}return i=function(){return e},e},o=0,a=0,s=!1,l=Object.create(null),c=Object.create(null),u=Object.create(null);function h(e){c[e]&&c[e].forEach(function(e){e()}),l[e]&&(l[e].terminate(),delete l[e])}function d(e){var t=e.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function A(e,t,r){return new Promise(function(i,o){var s=++a;u[s]=function(e){e.success?i(e.result):o(Error("Error in worker "+t+" call: "+e.error))},(function(e){var t=l[e];if(!t){var r=d(n);(t=l[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+r+")()"],{type:"application/javascript"})))).onmessage=function(e){var t=e.data,r=t.messageId,n=u[r];if(!n)throw Error("WorkerModule response with empty or unknown messageId");delete u[r],n(t)}}return t})(e).postMessage({messageId:s,action:t,data:r})})}},699:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=n.useState,a=n.useEffect,s=n.useLayoutEffect,l=n.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!i(e,r)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),n=o({inst:{value:r,getSnapshot:t}}),i=n[0].inst,u=n[1];return s(function(){i.value=r,i.getSnapshot=t,c(i)&&u({inst:i})},[e,r,t]),a(function(){return c(i)&&u({inst:i}),e(function(){c(i)&&u({inst:i})})},[e]),l(r),r};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:u},220:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),i=r(2362),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=i.useSyncExternalStore,s=n.useRef,l=n.useEffect,c=n.useMemo,u=n.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var h=s(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;var A=a(e,(h=c(function(){function e(e){if(!l){if(l=!0,a=e,e=n(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return s=t}return s=e}if(t=s,o(a,e))return t;var r=n(e);return void 0!==i&&i(t,r)?t:(a=e,s=r)}var a,s,l=!1,c=void 0===r?null:r;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,r,n,i]))[0],h[1]);return l(function(){d.hasValue=!0,d.value=A},[A]),u(A),A}},2362:function(e,t,r){"use strict";e.exports=r(699)},9292:function(e,t,r){"use strict";e.exports=r(220)},8132:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(2265);let i="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?n.useEffect:n.useLayoutEffect;function o(e){let t="function"==typeof e?function(e){let t;let r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(i!==t){let e=t;t=n?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,o=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let a=n(t);function s(){let r=n(t);if(!o(a,r)){let t=a;e(a=r,t)}}return r.add(s),()=>r.delete(s)},a={setState:n,getState:i,subscribe:(e,t,n)=>t||n?o(e,t,n):(r.add(e),()=>r.delete(e)),destroy:()=>r.clear()};return t=e(n,i,a),a}(e):e,r=function(){let e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,[,a]=(0,n.useReducer)(e=>e+1,0),s=t.getState(),l=(0,n.useRef)(s),c=(0,n.useRef)(r),u=(0,n.useRef)(o),h=(0,n.useRef)(!1),d=(0,n.useRef)();void 0===d.current&&(d.current=r(s));let A=!1;(l.current!==s||c.current!==r||u.current!==o||h.current)&&(e=r(s),A=!o(d.current,e)),i(()=>{A&&(d.current=e),l.current=s,c.current=r,u.current=o,h.current=!1});let f=(0,n.useRef)(s);i(()=>{let e=()=>{try{let e=t.getState(),r=c.current(e);u.current(d.current,r)||(l.current=e,d.current=r,a())}catch(e){h.current=!0,a()}},r=t.subscribe(e);return t.getState()!==f.current&&e(),r},[]);let p=A?e:d.current;return(0,n.useDebugValue)(p),p};return Object.assign(r,t),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let e=[r,t];return{next(){let t=e.length<=0;return{value:e.shift(),done:t}}}},r}},1542:function(e){e.exports={style:{fontFamily:"'__Cormorant_Garamond_3b8174', '__Cormorant_Garamond_Fallback_3b8174'",fontWeight:300,fontStyle:"normal"},className:"__className_3b8174",variable:"__variable_3b8174"}},786:function(e){e.exports={style:{fontFamily:"'__Exo_1e998c', '__Exo_Fallback_1e998c'",fontStyle:"normal"},className:"__className_1e998c",variable:"__variable_1e998c"}},6293:function(e){e.exports={style:{fontFamily:"'__Noto_Sans_90df87', '__Noto_Sans_Fallback_90df87'",fontStyle:"normal"},className:"__className_90df87",variable:"__variable_90df87"}},2110:function(e,t,r){"use strict";function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}r.d(t,{Z:function(){return n}})},2470:function(e,t,r){"use strict";r.r(t),r.d(t,{Any:function(){return tB},BailSignal:function(){return tZ},Controller:function(){return rc},FrameValue:function(){return t2},Globals:function(){return h},Interpolation:function(){return rQ},Spring:function(){return rR},SpringContext:function(){return rg},SpringRef:function(){return ry},SpringValue:function(){return t7},Trail:function(){return rP},Transition:function(){return rF},a:function(){return rH},animated:function(){return rH},config:function(){return tU},createInterpolator:function(){return ev},easings:function(){return ew},inferTo:function(){return tR},interpolate:function(){return rG},to:function(){return rU},update:function(){return rN},useChain:function(){return tk},useInView:function(){return rD},useIsomorphicLayoutEffect:function(){return e7},useReducedMotion:function(){return to},useResize:function(){return rS},useScroll:function(){return rM},useSpring:function(){return rC},useSpringRef:function(){return rB},useSpringValue:function(){return rx},useSprings:function(){return rE},useTrail:function(){return rI},useTransition:function(){return rb}});var n,i,o,a,s,l=r(2930),c=r(2265),u=Object.defineProperty,h={};((e,t)=>{for(var r in t)u(e,r,{get:t[r],enumerable:!0})})(h,{assign:()=>H,colors:()=>G,createStringInterpolator:()=>n,skipAnimation:()=>N,to:()=>i,willAdvance:()=>z});var d=M(),A=e=>x(e,d),f=M();A.write=e=>x(e,f);var p=M();A.onStart=e=>x(e,p);var m=M();A.onFrame=e=>x(e,m);var g=M();A.onFinish=e=>x(e,g);var v=[];A.setTimeout=(e,t)=>{let r=A.now()+t,n=()=>{let e=v.findIndex(e=>e.cancel==n);~e&&v.splice(e,1),w-=~e?1:0},i={time:r,handler:e,cancel:n};return v.splice(y(r),0,i),w+=1,I(),i};var y=e=>~(~v.findIndex(t=>t.time>e)||~v.length);A.cancel=e=>{p.delete(e),m.delete(e),g.delete(e),d.delete(e),f.delete(e)},A.sync=e=>{B=!0,A.batchedUpdates(e),B=!1},A.throttle=e=>{let t;function r(){try{e(...t)}finally{t=null}}function n(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];t=n,A.onStart(r)}return n.handler=e,n.cancel=()=>{p.delete(r),t=null},n};var E="undefined"!=typeof window?window.requestAnimationFrame:()=>{};A.use=e=>E=e,A.now="undefined"!=typeof performance?()=>performance.now():Date.now,A.batchedUpdates=e=>e(),A.catch=console.error,A.frameLoop="always",A.advance=()=>{"demand"!==A.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):_()};var C=-1,w=0,B=!1;function x(e,t){B?(t.delete(e),e(0)):(t.add(e),I())}function I(){C<0&&(C=0,"demand"!==A.frameLoop&&E(b))}function b(){~C&&(E(b),A.batchedUpdates(_))}function _(){let e=C,t=y(C=A.now());if(t&&(S(v.splice(0,t),e=>e.handler()),w-=t),!w){C=-1;return}p.flush(),d.flush(e?Math.min(64,C-e):16.667),m.flush(),f.flush(),g.flush()}function M(){let e=new Set,t=e;return{add(r){w+=t!=e||e.has(r)?0:1,e.add(r)},delete:r=>(w-=t==e&&e.has(r)?1:0,e.delete(r)),flush(r){t.size&&(e=new Set,w-=t.size,S(t,t=>t(r)&&e.add(t)),w+=e.size,t=e)}}}function S(e,t){e.forEach(e=>{try{t(e)}catch(e){A.catch(e)}})}function T(){}var D=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),R={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function P(e,t){if(R.arr(e)){if(!R.arr(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return e===t}var F=(e,t)=>e.forEach(t);function Q(e,t,r){if(R.arr(e)){for(let n=0;n<e.length;n++)t.call(r,e[n],"".concat(n));return}for(let n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n)}var O=e=>R.und(e)?[]:R.arr(e)?e:[e];function L(e,t){if(e.size){let r=Array.from(e);e.clear(),F(r,t)}}var k=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return L(e,e=>e(...r))},U=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),G=null,N=!1,z=T,H=e=>{e.to&&(i=e.to),e.now&&(A.now=e.now),void 0!==e.colors&&(G=e.colors),null!=e.skipAnimation&&(N=e.skipAnimation),e.createStringInterpolator&&(n=e.createStringInterpolator),e.requestAnimationFrame&&A.use(e.requestAnimationFrame),e.batchedUpdates&&(A.batchedUpdates=e.batchedUpdates),e.willAdvance&&(z=e.willAdvance),e.frameLoop&&(A.frameLoop=e.frameLoop)},V=new Set,j=[],J=[],Y=0,W={get idle(){return!V.size&&!j.length},start(e){Y>e.priority?(V.add(e),A.onStart(q)):(K(e),A(Z))},advance:Z,sort(e){if(Y)A.onFrame(()=>W.sort(e));else{let t=j.indexOf(e);~t&&(j.splice(t,1),X(e))}},clear(){j=[],V.clear()}};function q(){V.forEach(K),V.clear(),A(Z)}function K(e){j.includes(e)||X(e)}function X(e){j.splice(function(e,t){let r=e.findIndex(t);return r<0?e.length:r}(j,t=>t.priority>e.priority),0,e)}function Z(e){let t=J;for(let r=0;r<j.length;r++){let n=j[r];Y=n.priority,n.idle||(z(n),n.advance(e),n.idle||t.push(n))}return Y=0,(J=j).length=0,(j=t).length>0}var $=(e,t,r)=>Math.min(Math.max(r,e),t),ee="[-+]?\\d*\\.?\\d+",et=ee+"%";function er(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var en=RegExp("rgb"+er(ee,ee,ee)),ei=RegExp("rgba"+er(ee,ee,ee,ee)),eo=RegExp("hsl"+er(ee,et,et)),ea=RegExp("hsla"+er(ee,et,et,ee)),es=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,el=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ec=/^#([0-9a-fA-F]{6})$/,eu=/^#([0-9a-fA-F]{8})$/;function eh(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function ed(e,t,r){let n=r<.5?r*(1+t):r+t-r*t,i=2*r-n;return Math.round(255*eh(i,n,e+1/3))<<24|Math.round(255*eh(i,n,e))<<16|Math.round(255*eh(i,n,e-1/3))<<8}function eA(e){let t=parseInt(e,10);return t<0?0:t>255?255:t}function ef(e){return(parseFloat(e)%360+360)%360/360}function ep(e){let t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function em(e){let t=parseFloat(e);return t<0?0:t>100?1:t/100}function eg(e){let t;let r="number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=ec.exec(e))?parseInt(t[1]+"ff",16)>>>0:G&&void 0!==G[e]?G[e]:(t=en.exec(e))?(eA(t[1])<<24|eA(t[2])<<16|eA(t[3])<<8|255)>>>0:(t=ei.exec(e))?(eA(t[1])<<24|eA(t[2])<<16|eA(t[3])<<8|ep(t[4]))>>>0:(t=es.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=eu.exec(e))?parseInt(t[1],16)>>>0:(t=el.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=eo.exec(e))?(255|ed(ef(t[1]),em(t[2]),em(t[3])))>>>0:(t=ea.exec(e))?(ed(ef(t[1]),em(t[2]),em(t[3]))|ep(t[4]))>>>0:null;if(null===r)return e;let n=(4278190080&(r=r||0))>>>24,i=(16711680&r)>>>16,o=(65280&r)>>>8,a=(255&r)/255;return"rgba(".concat(n,", ").concat(i,", ").concat(o,", ").concat(a,")")}var ev=(e,t,r)=>{if(R.fun(e))return e;if(R.arr(e))return ev({range:e,output:t,extrapolate:r});if(R.str(e.output[0]))return n(e);let i=e.output,o=e.range||[0,1],a=e.extrapolateLeft||e.extrapolate||"extend",s=e.extrapolateRight||e.extrapolate||"extend",l=e.easing||(e=>e);return t=>{let r=function(e,t){for(var r=1;r<t.length-1&&!(t[r]>=e);++r);return r-1}(t,o);return function(e,t,r,n,i,o,a,s,l){let c=l?l(e):e;if(c<t){if("identity"===a)return c;"clamp"===a&&(c=t)}if(c>r){if("identity"===s)return c;"clamp"===s&&(c=r)}return n===i?n:t===r?e<=t?n:i:(t===-1/0?c=-c:r===1/0?c-=t:c=(c-t)/(r-t),c=o(c),n===-1/0?c=-c:i===1/0?c+=n:c=c*(i-n)+n,c)}(t,o[r],o[r+1],i[r],i[r+1],l,a,s,e.map)}},ey=2*Math.PI/3,eE=2*Math.PI/4.5,eC=e=>e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375,ew={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>1-(1-e)*(1-e),easeInOutQuad:e=>e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2,easeInCubic:e=>e*e*e,easeOutCubic:e=>1-Math.pow(1-e,3),easeInOutCubic:e=>e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2,easeInQuart:e=>e*e*e*e,easeOutQuart:e=>1-Math.pow(1-e,4),easeInOutQuart:e=>e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2,easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>1-Math.pow(1-e,5),easeInOutQuint:e=>e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2,easeInSine:e=>1-Math.cos(e*Math.PI/2),easeOutSine:e=>Math.sin(e*Math.PI/2),easeInOutSine:e=>-(Math.cos(Math.PI*e)-1)/2,easeInExpo:e=>0===e?0:Math.pow(2,10*e-10),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2,easeInCirc:e=>1-Math.sqrt(1-Math.pow(e,2)),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2,easeInBack:e=>2.70158*e*e*e-1.70158*e*e,easeOutBack:e=>1+2.70158*Math.pow(e-1,3)+1.70158*Math.pow(e-1,2),easeInOutBack:e=>e<.5?Math.pow(2*e,2)*(7.189819*e-2.5949095)/2:(Math.pow(2*e-2,2)*(3.5949095*(2*e-2)+2.5949095)+2)/2,easeInElastic:e=>0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*ey),easeOutElastic:e=>0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*ey)+1,easeInOutElastic:e=>0===e?0:1===e?1:e<.5?-(Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*eE))/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*eE)/2+1,easeInBounce:e=>1-eC(1-e),easeOutBounce:eC,easeInOutBounce:e=>e<.5?(1-eC(1-2*e))/2:(1+eC(2*e-1))/2,steps:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end";return r=>{let n=(r="end"===t?Math.min(r,.999):Math.max(r,.001))*e;return $(0,1,("end"===t?Math.floor(n):Math.ceil(n))/e)}}},eB=Symbol.for("FluidValue.get"),ex=Symbol.for("FluidValue.observers"),eI=e=>!!(e&&e[eB]),eb=e=>e&&e[eB]?e[eB]():e,e_=e=>e[ex]||null;function eM(e,t){let r=e[ex];r&&r.forEach(e=>{e.eventObserved?e.eventObserved(t):e(t)})}var eS=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");eT(this,e)}},eT=(e,t)=>eP(e,eB,t);function eD(e,t){if(e[eB]){let r=e[ex];r||eP(e,ex,r=new Set),!r.has(t)&&(r.add(t),e.observerAdded&&e.observerAdded(r.size,t))}return t}function eR(e,t){let r=e[ex];if(r&&r.has(t)){let n=r.size-1;n?r.delete(t):e[ex]=null,e.observerRemoved&&e.observerRemoved(n,t)}}var eP=(e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0}),eF=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,eQ=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,eO=RegExp("(".concat(eF.source,")(%|[a-z]+)"),"i"),eL=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,ek=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,eU=e=>{let[t,r]=eG(e);if(!t||U())return e;let n=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(n)return n.trim();if(r&&r.startsWith("--")){let e=window.getComputedStyle(document.documentElement).getPropertyValue(r);if(e)return e}else if(r&&ek.test(r))return eU(r);else if(r)return r;return e},eG=e=>{let t=ek.exec(e);if(!t)return[,];let[,r,n]=t;return[r,n]},eN=(e,t,r,n,i)=>"rgba(".concat(Math.round(t),", ").concat(Math.round(r),", ").concat(Math.round(n),", ").concat(i,")"),ez=e=>{o||(o=G?RegExp("(".concat(Object.keys(G).join("|"),")(?!\\w)"),"g"):/^\b$/);let t=e.output.map(e=>eb(e).replace(ek,eU).replace(eQ,eg).replace(o,eg)),r=t.map(e=>e.match(eF).map(Number)),n=r[0].map((e,t)=>r.map(e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})).map(t=>ev({...e,output:t}));return e=>{var r;let i=!eO.test(t[0])&&(null===(r=t.find(e=>eO.test(e)))||void 0===r?void 0:r.replace(eF,"")),o=0;return t[0].replace(eF,()=>"".concat(n[o++](e)).concat(i||"")).replace(eL,eN)}},eH="react-spring: ",eV=e=>{let t=!1;if("function"!=typeof e)throw TypeError("".concat(eH,"once requires a function parameter"));return function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];t||(e(...n),t=!0)}},ej=eV(console.warn);function eJ(){ej("".concat(eH,'The "interpolate" function is deprecated in v9 (use "to" instead)'))}var eY=eV(console.warn);function eW(e){return R.str(e)&&("#"==e[0]||/\d/.test(e)||!U()&&ek.test(e)||e in(G||{}))}var eq=new WeakMap,eK=e=>e.forEach(e=>{var t;let{target:r,contentRect:n}=e;return null===(t=eq.get(r))||void 0===t?void 0:t.forEach(e=>e(n))}),eX=new Set,eZ=()=>{let e=()=>{eX.forEach(e=>e({width:window.innerWidth,height:window.innerHeight}))};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},e$=e=>(eX.add(e),s||(s=eZ()),()=>{eX.delete(e),!eX.size&&s&&(s(),s=void 0)}),e0=function(e){let{container:t=document.documentElement}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t===document.documentElement)return e$(e);{let r;return a||"undefined"==typeof ResizeObserver||(a=new ResizeObserver(eK)),(r=eq.get(t))||(r=new Set,eq.set(t,r)),r.add(e),a&&a.observe(t),()=>{let r=eq.get(t);r&&(r.delete(e),!r.size&&a&&a.unobserve(t))}}},e1=(e,t,r)=>t-e==0?1:(r-e)/(t-e),e2={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}},e3=class{constructor(e,t){this.createAxis=()=>({current:0,progress:0,scrollLength:0}),this.updateAxis=e=>{let t=this.info[e],{length:r,position:n}=e2[e];t.current=this.container["scroll".concat(n)],t.scrollLength=this.container["scroll"+r]-this.container["client"+r],t.progress=e1(0,t.scrollLength,t.current)},this.update=()=>{this.updateAxis("x"),this.updateAxis("y")},this.sendEvent=()=>{this.callback(this.info)},this.advance=()=>{this.update(),this.sendEvent()},this.callback=e,this.container=t,this.info={time:0,x:this.createAxis(),y:this.createAxis()}}},e4=new WeakMap,e5=new WeakMap,e9=new WeakMap,e6=e=>e===document.documentElement?window:e,e8=function(e){let{container:t=document.documentElement}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e9.get(t);r||(r=new Set,e9.set(t,r));let n=new e3(e,t);if(r.add(n),!e4.has(t)){let e=()=>(null==r||r.forEach(e=>e.advance()),!0);e4.set(t,e);let n=e6(t);window.addEventListener("resize",e,{passive:!0}),t!==document.documentElement&&e5.set(t,e0(e,{container:t})),n.addEventListener("scroll",e,{passive:!0})}let i=e4.get(t);return A(i),()=>{A.cancel(i);let e=e9.get(t);if(!e||(e.delete(n),e.size))return;let r=e4.get(t);if(e4.delete(t),r){var o;e6(t).removeEventListener("scroll",r),window.removeEventListener("resize",r),null===(o=e5.get(t))||void 0===o||o()}}},e7=U()?c.useEffect:c.useLayoutEffect,te=()=>{let e=(0,c.useRef)(!1);return e7(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function tt(){let e=(0,c.useState)()[1],t=te();return()=>{t.current&&e(Math.random())}}var tr=e=>(0,c.useEffect)(e,tn),tn=[];function ti(e){let t=(0,c.useRef)();return(0,c.useEffect)(()=>{t.current=e}),t.current}var to=()=>{let[e,t]=(0,c.useState)(null);return e7(()=>{let e=window.matchMedia("(prefers-reduced-motion)"),r=e=>{t(e.matches),H({skipAnimation:e.matches})};return r(e),e.addEventListener("change",r),()=>{e.removeEventListener("change",r)}},[]),e},ta=Symbol.for("Animated:node"),ts=e=>!!e&&e[ta]===e,tl=e=>e&&e[ta],tc=(e,t)=>D(e,ta,t),tu=e=>e&&e[ta]&&e[ta].getPayload(),th=class{getPayload(){return this.payload||[]}constructor(){tc(this,this)}},td=class extends th{static create(e){return new td(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return R.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){let{done:e}=this;this.done=!1,R.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,R.num(this._value)&&(this.lastPosition=this._value)}},tA=class extends td{static create(e){return new tA(e)}getValue(){let e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(R.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=ev({output:[this.getValue(),e]})),this._value=0,super.reset()}constructor(e){super(0),this._string=null,this._toString=ev({output:[e,e]})}},tf={dependencies:null},tp=class extends th{getValue(e){let t={};return Q(this.source,(r,n)=>{ts(r)?t[n]=r.getValue(e):eI(r)?t[n]=eb(r):e||(t[n]=r)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&F(this.payload,e=>e.reset())}_makePayload(e){if(e){let t=new Set;return Q(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){tf.dependencies&&eI(e)&&tf.dependencies.add(e);let t=tu(e);t&&F(t,e=>this.add(e))}constructor(e){super(),this.source=e,this.setValue(e)}},tm=class extends tp{static create(e){return new tm(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){let t=this.getPayload();return e.length==t.length?t.map((t,r)=>t.setValue(e[r])).some(Boolean):(super.setValue(e.map(tg)),!0)}constructor(e){super(e)}};function tg(e){return(eW(e)?tA:td).create(e)}function tv(e){let t=tl(e);return t?t.constructor:R.arr(e)?tm:eW(e)?tA:td}var ty=(e,t)=>{let r=!R.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,c.forwardRef)((n,i)=>{let o=(0,c.useRef)(null),a=r&&(0,c.useCallback)(e=>{o.current=(i&&(R.fun(i)?i(e):i.current=e),e)},[i]),[s,l]=function(e,t){let r=new Set;return tf.dependencies=r,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)}),e=new tp(e),tf.dependencies=null,[e,r]}(n,t),u=tt(),h=()=>{let e=o.current;(!r||e)&&!1===(!!e&&t.applyAnimatedValues(e,s.getValue(!0)))&&u()},d=new tE(h,l),f=(0,c.useRef)();e7(()=>(f.current=d,F(l,e=>eD(e,d)),()=>{f.current&&(F(f.current.deps,e=>eR(e,f.current)),A.cancel(f.current.update))})),(0,c.useEffect)(h,[]),tr(()=>()=>{let e=f.current;F(e.deps,t=>eR(t,e))});let p=t.getComponentProps(s.getValue());return c.createElement(e,{...p,ref:a})})},tE=class{eventObserved(e){"change"==e.type&&A.write(this.update)}constructor(e,t){this.update=e,this.deps=t}},tC=Symbol.for("AnimatedComponent"),tw=e=>R.str(e)?e:e&&R.str(e.displayName)?e.displayName:R.fun(e)&&e.name||null,tB=class{};function tx(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return R.fun(e)?e(...r):e}var tI=(e,t)=>!0===e||!!(t&&e&&(R.fun(e)?e(t):O(e).includes(t))),tb=(e,t)=>R.obj(e)?t&&e[t]:e,t_=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,tM=e=>e,tS=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tM,r=tT;e.default&&!0!==e.default&&(r=Object.keys(e=e.default));let n={};for(let i of r){let r=t(e[i],i);R.und(r)||(n[i]=r)}return n},tT=["config","onProps","onStart","onChange","onPause","onResume","onRest"],tD={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function tR(e){let t=function(e){let t={},r=0;if(Q(e,(e,n)=>{!tD[n]&&(t[n]=e,r++)}),r)return t}(e);if(t){let r={to:t};return Q(e,(e,n)=>n in t||(r[n]=e)),r}return{...e}}function tP(e){return e=eb(e),R.arr(e)?e.map(tP):eW(e)?h.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function tF(e){for(let t in e)return!0;return!1}function tQ(e){return R.fun(e)||R.arr(e)&&R.obj(e[0])}function tO(e,t){var r;null===(r=e.ref)||void 0===r||r.delete(e),null==t||t.delete(e)}function tL(e,t){if(t&&e.ref!==t){var r;null===(r=e.ref)||void 0===r||r.delete(e),t.add(e),e.ref=t}}function tk(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;e7(()=>{if(t){let n=0;F(e,(e,i)=>{let o=e.current;if(o.length){let a=r*t[i];isNaN(a)?a=n:n=a,F(o,e=>{F(e.queue,e=>{let t=e.delay;e.delay=e=>a+tx(t||0,e)})}),e.start()}})}else{let t=Promise.resolve();F(e,e=>{let r=e.current;if(r.length){let n=r.map(e=>{let t=e.queue;return e.queue=[],t});t=t.then(()=>(F(r,(e,t)=>F(n[t]||[],t=>e.queue.push(t))),Promise.all(e.start())))}})}})}var tU={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},tG={...tU.default,mass:1,damping:1,easing:ew.linear,clamp:!1},tN=class{constructor(){this.velocity=0,Object.assign(this,tG)}};function tz(e,t){if(R.und(t.decay)){let r=!R.und(t.tension)||!R.und(t.friction);!r&&R.und(t.frequency)&&R.und(t.damping)&&R.und(t.mass)||(e.duration=void 0,e.decay=void 0),r&&(e.frequency=void 0)}else e.duration=void 0}var tH=[],tV=class{constructor(){this.changed=!1,this.values=tH,this.toValues=null,this.fromValues=tH,this.config=new tN,this.immediate=!1}};function tj(e,t){let{key:r,props:n,defaultProps:i,state:o,actions:a}=t;return new Promise((t,s)=>{var l;let c,u;let d=tI(null!==(l=n.cancel)&&void 0!==l?l:null==i?void 0:i.cancel,r);if(d)m();else{R.und(n.pause)||(o.paused=tI(n.pause,r));let e=null==i?void 0:i.pause;!0!==e&&(e=o.paused||tI(e,r)),c=tx(n.delay||0,r),e?(o.resumeQueue.add(p),a.pause()):(a.resume(),p())}function f(){o.resumeQueue.add(p),o.timeouts.delete(u),u.cancel(),c=u.time-A.now()}function p(){c>0&&!h.skipAnimation?(o.delayed=!0,u=A.setTimeout(m,c),o.pauseQueue.add(f),o.timeouts.add(u)):m()}function m(){o.delayed&&(o.delayed=!1),o.pauseQueue.delete(f),o.timeouts.delete(u),e<=(o.cancelId||0)&&(d=!0);try{a.start({...n,callId:e,cancel:d},t)}catch(e){s(e)}}})}var tJ=(e,t)=>1==t.length?t[0]:t.some(e=>e.cancelled)?tq(e.get()):t.every(e=>e.noop)?tY(e.get()):tW(e.get(),t.every(e=>e.finished)),tY=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),tW=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{value:e,finished:t,cancelled:r}},tq=e=>({value:e,cancelled:!0,finished:!1});function tK(e,t,r,n){let{callId:i,parentId:o,onRest:a}=t,{asyncTo:s,promise:l}=r;return o||e!==s||t.reset?r.promise=(async()=>{let c,u,d;r.asyncId=i,r.asyncTo=e;let f=tS(t,(e,t)=>"onRest"===t?void 0:e),p=new Promise((e,t)=>(c=e,u=t)),m=e=>{let t=i<=(r.cancelId||0)&&tq(n)||i!==r.asyncId&&tW(n,!1);if(t)throw e.result=t,u(e),e},g=(e,t)=>{let o=new tZ,a=new t$;return(async()=>{if(h.skipAnimation)throw tX(r),a.result=tW(n,!1),u(a),a;m(o);let s=R.obj(e)?{...e}:{...t,to:e};s.parentId=i,Q(f,(e,t)=>{R.und(s[t])&&(s[t]=e)});let l=await n.start(s);return m(o),r.paused&&await new Promise(e=>{r.resumeQueue.add(e)}),l})()};if(h.skipAnimation)return tX(r),tW(n,!1);try{let t;t=R.arr(e)?(async e=>{for(let t of e)await g(t)})(e):Promise.resolve(e(g,n.stop.bind(n))),await Promise.all([t.then(c),p]),d=tW(n.get(),!0,!1)}catch(e){if(e instanceof tZ)d=e.result;else if(e instanceof t$)d=e.result;else throw e}finally{i==r.asyncId&&(r.asyncId=o,r.asyncTo=o?s:void 0,r.promise=o?l:void 0)}return R.fun(a)&&A.batchedUpdates(()=>{a(d,n,n.item)}),d})():l}function tX(e,t){L(e.timeouts,e=>e.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var tZ=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},t$=class extends Error{constructor(){super("SkipAnimationSignal")}},t0=e=>e instanceof t2,t1=1,t2=class extends eS{get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){let e=tl(this);return e&&e.getValue()}to(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return h.to(this,t)}interpolate(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return eJ(),h.to(this,t)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];eM(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||W.sort(this),eM(this,{type:"priority",parent:this,priority:e})}constructor(){super(...arguments),this.id=t1++,this._priority=0}},t3=Symbol.for("SpringPhase"),t4=e=>(1&e[t3])>0,t5=e=>(2&e[t3])>0,t9=e=>(4&e[t3])>0,t6=(e,t)=>t?e[t3]|=3:e[t3]&=-3,t8=(e,t)=>t?e[t3]|=4:e[t3]&=-5,t7=class extends t2{get idle(){return!(t5(this)||this._state.asyncTo)||t9(this)}get goal(){return eb(this.animation.to)}get velocity(){let e=tl(this);return e instanceof td?e.lastVelocity||0:e.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return t4(this)}get isAnimating(){return t5(this)}get isPaused(){return t9(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,r=!1,n=this.animation,{toValues:i}=n,{config:o}=n,a=tu(n.to);!a&&eI(n.to)&&(i=O(eb(n.to))),n.values.forEach((s,l)=>{if(s.done)return;let c=s.constructor==tA?1:a?a[l].lastPosition:i[l],u=n.immediate,h=c;if(!u){let t;if(h=s.lastPosition,o.tension<=0){s.done=!0;return}let r=s.elapsedTime+=e,i=n.fromValues[l],a=null!=s.v0?s.v0:s.v0=R.arr(o.velocity)?o.velocity[l]:o.velocity,d=o.precision||(i==c?.005:Math.min(1,.001*Math.abs(c-i)));if(R.und(o.duration)){if(o.decay){let e=!0===o.decay?.998:o.decay,n=Math.exp(-(1-e)*r);h=i+a/(1-e)*(1-n),u=Math.abs(s.lastPosition-h)<=d,t=a*n}else{t=null==s.lastVelocity?a:s.lastVelocity;let r=o.restVelocity||d/10,n=o.clamp?0:o.bounce,l=!R.und(n),A=i==c?s.v0>0:i<c,f=Math.ceil(e/1);for(let e=0;e<f&&!(!(Math.abs(t)>r)&&(u=Math.abs(c-h)<=d));++e){l&&(h==c||h>c==A)&&(t=-t*n,h=c);let e=(-(1e-6*o.tension)*(h-c)+-(.001*o.friction)*t)/o.mass;t+=1*e,h+=1*t}}}else{let n=1;o.duration>0&&(this._memoizedDuration!==o.duration&&(this._memoizedDuration=o.duration,s.durationProgress>0&&(s.elapsedTime=o.duration*s.durationProgress,r=s.elapsedTime+=e)),n=(n=(o.progress||0)+r/this._memoizedDuration)>1?1:n<0?0:n,s.durationProgress=n),t=((h=i+o.easing(n)*(c-i))-s.lastPosition)/e,u=1==n}s.lastVelocity=t,Number.isNaN(h)&&(console.warn("Got NaN while animating:",this),u=!0)}a&&!a[l].done&&(u=!1),u?s.done=!0:t=!1,s.setValue(h,o.round)&&(r=!0)});let s=tl(this),l=s.getValue();if(t){let e=eb(n.to);(l!==e||r)&&!o.decay?(s.setValue(e),this._onChange(e)):r&&o.decay&&this._onChange(l),this._stop()}else r&&this._onChange(l)}set(e){return A.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(t5(this)){let{to:e,config:t}=this.animation;A.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){return(this.queue||(this.queue=[])).push(e),this}start(e,t){let r;return R.und(e)?(r=this.queue||[],this.queue=[]):r=[R.obj(e)?e:{...t,to:e}],Promise.all(r.map(e=>this._update(e))).then(e=>tJ(this,e))}stop(e){let{to:t}=this.animation;return this._focus(this.get()),tX(this._state,e&&this._lastCallId),A.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){let t=this.key||"",{to:r,from:n}=e;(null==(r=R.obj(r)?r[t]:r)||tQ(r))&&(r=void 0),null==(n=R.obj(n)?n[t]:n)&&(n=void 0);let i={to:r,from:n};return t4(this)||(e.reverse&&([r,n]=[n,r]),n=eb(n),R.und(n)?tl(this)||this._set(r):this._set(n)),i}_update(e,t){let{...r}=e,{key:n,defaultProps:i}=this;r.default&&Object.assign(i,tS(r,(e,t)=>/^on/.test(t)?tb(e,n):e)),ro(this,r,"onProps"),ra(this,"onProps",r,this);let o=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let a=this._state;return tj(++this._lastCallId,{key:n,props:r,defaultProps:i,state:a,actions:{pause:()=>{t9(this)||(t8(this,!0),k(a.pauseQueue),ra(this,"onPause",tW(this,re(this,this.animation.to)),this))},resume:()=>{t9(this)&&(t8(this,!1),t5(this)&&this._resume(),k(a.resumeQueue),ra(this,"onResume",tW(this,re(this,this.animation.to)),this))},start:this._merge.bind(this,o)}}).then(e=>{if(r.loop&&e.finished&&!(t&&e.noop)){let e=rt(r);if(e)return this._update(e,!0)}return e})}_merge(e,t,r){if(t.cancel)return this.stop(!0),r(tq(this));let n=!R.und(e.to),i=!R.und(e.from);if(n||i){if(!(t.callId>this._lastToId))return r(tq(this));this._lastToId=t.callId}let{key:o,defaultProps:a,animation:s}=this,{to:l,from:c}=s,{to:u=l,from:h=c}=e;i&&!n&&(!t.default||R.und(u))&&(u=h),t.reverse&&([u,h]=[h,u]);let d=!P(h,c);d&&(s.from=h),h=eb(h);let f=!P(u,l);f&&this._focus(u);let p=tQ(t.to),{config:m}=s,{decay:g,velocity:v}=m;(n||i)&&(m.velocity=0),t.config&&!p&&function(e,t,r){for(let n in r&&(tz(r={...r},t),t={...r,...t}),tz(e,t),Object.assign(e,t),tG)null==e[n]&&(e[n]=tG[n]);let{frequency:n,damping:i}=e,{mass:o}=e;R.und(n)||(n<.01&&(n=.01),i<0&&(i=0),e.tension=Math.pow(2*Math.PI/n,2)*o,e.friction=4*Math.PI*i*o/n)}(m,tx(t.config,o),t.config!==a.config?tx(a.config,o):void 0);let y=tl(this);if(!y||R.und(u))return r(tW(this,!0));let E=R.und(t.reset)?i&&!t.default:!R.und(h)&&tI(t.reset,o),C=E?h:this.get(),w=tP(u),B=R.num(w)||R.arr(w)||eW(w),x=!p&&(!B||tI(a.immediate||t.immediate,o));if(f){let e=tv(u);if(e!==y.constructor){if(x)y=this._set(w);else throw Error("Cannot animate between ".concat(y.constructor.name," and ").concat(e.name,', as the "to" prop suggests'))}}let I=y.constructor,b=eI(u),_=!1;if(!b){let e=E||!t4(this)&&d;(f||e)&&(b=!(_=P(tP(C),w))),(P(s.immediate,x)||x)&&P(m.decay,g)&&P(m.velocity,v)||(b=!0)}if(_&&t5(this)&&(s.changed&&!E?b=!0:b||this._stop(l)),!p&&((b||eI(l))&&(s.values=y.getPayload(),s.toValues=eI(u)?null:I==tA?[1]:O(w)),s.immediate==x||(s.immediate=x,x||E||this._set(l)),b)){let{onRest:e}=s;F(ri,e=>ro(this,t,e));let n=tW(this,re(this,l));k(this._pendingCalls,n),this._pendingCalls.add(r),s.changed&&A.batchedUpdates(()=>{if(s.changed=!E,null==e||e(n,this),E)tx(a.onRest,n);else{var t;null===(t=s.onStart)||void 0===t||t.call(s,n,this)}})}E&&this._set(C),p?r(tK(t.to,t,this._state,this)):b?this._start():t5(this)&&!f?this._pendingCalls.add(r):r(tY(C))}_focus(e){let t=this.animation;e!==t.to&&(e_(this)&&this._detach(),t.to=e,e_(this)&&this._attach())}_attach(){let e=0,{to:t}=this.animation;eI(t)&&(eD(t,this),t0(t)&&(e=t.priority+1)),this.priority=e}_detach(){let{to:e}=this.animation;eI(e)&&eR(e,this)}_set(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=eb(e);if(!R.und(r)){let e=tl(this);if(!e||!P(r,e.getValue())){let n=tv(r);e&&e.constructor==n?e.setValue(r):tc(this,n.create(r)),e&&A.batchedUpdates(()=>{this._onChange(r,t)})}}return tl(this)}_onStart(){let e=this.animation;e.changed||(e.changed=!0,ra(this,"onStart",tW(this,re(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),tx(this.animation.onChange,e,this)),tx(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){let e=this.animation;tl(this).reset(eb(e.to)),e.immediate||(e.fromValues=e.values.map(e=>e.lastPosition)),t5(this)||(t6(this,!0),t9(this)||this._resume())}_resume(){h.skipAnimation?this.finish():W.start(this)}_stop(e,t){if(t5(this)){t6(this,!1);let r=this.animation;F(r.values,e=>{e.done=!0}),r.toValues&&(r.onChange=r.onPause=r.onResume=void 0),eM(this,{type:"idle",parent:this});let n=t?tq(this.get()):tW(this.get(),re(this,null!=e?e:r.to));k(this._pendingCalls,n),r.changed&&(r.changed=!1,ra(this,"onRest",n,this))}}constructor(e,t){if(super(),this.animation=new tV,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!R.und(e)||!R.und(t)){let r=R.obj(e)?{...e}:{...t,from:e};R.und(r.default)&&(r.default=!0),this.start(r)}}};function re(e,t){let r=tP(t);return P(tP(e.get()),r)}function rt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.loop,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.to,n=tx(t);if(n){let i=!0!==n&&tR(n),o=(i||e).reverse,a=!i||i.reset;return rr({...e,loop:t,default:!1,pause:void 0,to:!o||tQ(r)?r:void 0,from:a?e.from:void 0,reset:a,...i})}}function rr(e){let{to:t,from:r}=e=tR(e),n=new Set;return R.obj(t)&&rn(t,n),R.obj(r)&&rn(r,n),e.keys=n.size?Array.from(n):null,e}function rn(e,t){Q(e,(e,r)=>null!=e&&t.add(r))}var ri=["onStart","onRest","onChange","onPause","onResume"];function ro(e,t,r){e.animation[r]=t[r]!==t_(t,r)?tb(t[r],e.key):void 0}function ra(e,t){for(var r,n,i,o,a=arguments.length,s=Array(a>2?a-2:0),l=2;l<a;l++)s[l-2]=arguments[l];null===(r=(n=e.animation)[t])||void 0===r||r.call(n,...s),null===(i=(o=e.defaultProps)[t])||void 0===i||i.call(o,...s)}var rs=["onStart","onChange","onRest"],rl=1,rc=class{get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){let e={};return this.each((t,r)=>e[r]=t.get()),e}set(e){for(let t in e){let r=e[t];R.und(r)||this.springs[t].set(r)}}update(e){return e&&this.queue.push(rr(e)),this}start(e){let{queue:t}=this;return(e?t=O(e).map(rr):this.queue=[],this._flush)?this._flush(this,t):(rm(this,t),ru(this,t))}stop(e,t){if(!!e!==e&&(t=e),t){let r=this.springs;F(O(t),t=>r[t].stop(!!e))}else tX(this._state,this._lastAsyncId),this.each(t=>t.stop(!!e));return this}pause(e){if(R.und(e))this.start({pause:!0});else{let t=this.springs;F(O(e),e=>t[e].pause())}return this}resume(e){if(R.und(e))this.start({pause:!1});else{let t=this.springs;F(O(e),e=>t[e].resume())}return this}each(e){Q(this.springs,e)}_onFrame(){let{onStart:e,onChange:t,onRest:r}=this._events,n=this._active.size>0,i=this._changed.size>0;(n&&!this._started||i&&!this._started)&&(this._started=!0,L(e,e=>{let[t,r]=e;r.value=this.get(),t(r,this,this._item)}));let o=!n&&this._started,a=i||o&&r.size?this.get():null;i&&t.size&&L(t,e=>{let[t,r]=e;r.value=a,t(r,this,this._item)}),o&&(this._started=!1,L(r,e=>{let[t,r]=e;r.value=a,t(r,this,this._item)}))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}A.onFrame(this._onFrame)}constructor(e,t){this.id=rl++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}};function ru(e,t){return Promise.all(t.map(t=>rh(e,t))).then(t=>tJ(e,t))}async function rh(e,t,r){let{keys:n,to:i,from:o,loop:a,onRest:s,onResolve:l}=t,c=R.obj(t.default)&&t.default;a&&(t.loop=!1),!1===i&&(t.to=null),!1===o&&(t.from=null);let u=R.arr(i)||R.fun(i)?i:void 0;u?(t.to=void 0,t.onRest=void 0,c&&(c.onRest=void 0)):F(rs,r=>{let n=t[r];if(R.fun(n)){let i=e._events[r];t[r]=e=>{let{finished:t,cancelled:r}=e,o=i.get(n);o?(t||(o.finished=!1),r&&(o.cancelled=!0)):i.set(n,{value:null,finished:t||!1,cancelled:r||!1})},c&&(c[r]=t[r])}});let h=e._state;!h.paused===t.pause?(h.paused=t.pause,k(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);let d=(n||Object.keys(e.springs)).map(r=>e.springs[r].start(t)),f=!0===t.cancel||!0===t_(t,"cancel");(u||f&&h.asyncId)&&d.push(tj(++e._lastAsyncId,{props:t,state:h,actions:{pause:T,resume:T,start(t,r){f?(tX(h,e._lastAsyncId),r(tq(e))):(t.onRest=s,r(tK(u,t,h,e)))}}})),h.paused&&await new Promise(e=>{h.resumeQueue.add(e)});let p=tJ(e,await Promise.all(d));if(a&&p.finished&&!(r&&p.noop)){let r=rt(t,a,i);if(r)return rm(e,[r]),rh(e,r,!0)}return l&&A.batchedUpdates(()=>l(p,e,e.item)),p}function rd(e,t){let r={...e.springs};return t&&F(O(t),e=>{R.und(e.keys)&&(e=rr(e)),R.obj(e.to)||(e={...e,to:void 0}),rp(r,e,e=>rf(e))}),rA(e,r),r}function rA(e,t){Q(t,(t,r)=>{e.springs[r]||(e.springs[r]=t,eD(t,e))})}function rf(e,t){let r=new t7;return r.key=e,t&&eD(r,t),r}function rp(e,t,r){t.keys&&F(t.keys,n=>{(e[n]||(e[n]=r(n)))._prepareNode(t)})}function rm(e,t){F(t,t=>{rp(e.springs,t,t=>rf(t,e))})}var rg=e=>{let{children:t,...r}=e,n=(0,c.useContext)(rv),i=r.pause||!!n.pause,o=r.immediate||!!n.immediate;r=function(e,t){let[r]=(0,c.useState)(()=>({inputs:t,result:e()})),n=(0,c.useRef)(),i=n.current,o=i;return o?t&&o.inputs&&function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(t,o.inputs)||(o={inputs:t,result:e()}):o=r,(0,c.useEffect)(()=>{n.current=o,i==r&&(r.inputs=r.result=void 0)},[o]),o.result}(()=>({pause:i,immediate:o}),[i,o]);let{Provider:a}=rv;return c.createElement(a,{value:r},t)},rv=(Object.assign(rg,c.createContext({})),rg.Provider._context=rg,rg.Consumer._context=rg,rg);rg.Provider=rv.Provider,rg.Consumer=rv.Consumer;var ry=()=>{let e=[],t=function(t){eY("".concat(eH,'Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions'));let n=[];return F(e,(e,i)=>{if(R.und(t))n.push(e.start());else{let o=r(t,e,i);o&&n.push(e.start(o))}}),n};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){let r=e.indexOf(t);~r&&e.splice(r,1)},t.pause=function(){return F(e,e=>e.pause(...arguments)),this},t.resume=function(){return F(e,e=>e.resume(...arguments)),this},t.set=function(t){F(e,(e,r)=>{let n=R.fun(t)?t(r,e):t;n&&e.set(n)})},t.start=function(t){let r=[];return F(e,(e,n)=>{if(R.und(t))r.push(e.start());else{let i=this._getProps(t,e,n);i&&r.push(e.start(i))}}),r},t.stop=function(){return F(e,e=>e.stop(...arguments)),this},t.update=function(t){return F(e,(e,r)=>e.update(this._getProps(t,e,r))),this};let r=function(e,t,r){return R.fun(e)?e(r,t):e};return t._getProps=r,t};function rE(e,t,r){let n=R.fun(t)&&t;n&&!r&&(r=[]);let i=(0,c.useMemo)(()=>n||3==arguments.length?ry():void 0,[]),o=(0,c.useRef)(0),a=tt(),s=(0,c.useMemo)(()=>({ctrls:[],queue:[],flush(e,t){let r=rd(e,t);return!(o.current>0)||s.queue.length||Object.keys(r).some(t=>!e.springs[t])?new Promise(n=>{rA(e,r),s.queue.push(()=>{n(ru(e,t))}),a()}):ru(e,t)}}),[]),l=(0,c.useRef)([...s.ctrls]),u=[],h=ti(e)||0;function d(e,r){for(let i=e;i<r;i++){let e=l.current[i]||(l.current[i]=new rc(null,s.flush)),r=n?n(i,e):t[i];r&&(u[i]=function(e){let t=rr(e);return R.und(t.default)&&(t.default=tS(t)),t}(r))}}(0,c.useMemo)(()=>{F(l.current.slice(e,h),e=>{tO(e,i),e.stop(!0)}),l.current.length=e,d(h,e)},[e]),(0,c.useMemo)(()=>{d(0,Math.min(h,e))},r);let A=l.current.map((e,t)=>rd(e,u[t])),f=(0,c.useContext)(rg),p=ti(f),m=f!==p&&tF(f);e7(()=>{o.current++,s.ctrls=l.current;let{queue:e}=s;e.length&&(s.queue=[],F(e,e=>e())),F(l.current,(e,t)=>{null==i||i.add(e),m&&e.start({default:f});let r=u[t];r&&(tL(e,r.ref),e.ref?e.queue.push(r):e.start(r))})}),tr(()=>()=>{F(s.ctrls,e=>e.stop(!0))});let g=A.map(e=>({...e}));return i?[g,i]:g}function rC(e,t){let r=R.fun(e),[[n],i]=rE(1,r?e:[e],r?t||[]:t);return r||2==arguments.length?[n,i]:n}var rw=()=>ry(),rB=()=>(0,c.useState)(rw)[0],rx=(e,t)=>{let r=function(e){let t=(0,c.useRef)(null);return null===t.current&&(t.current=e()),t.current}(()=>new t7(e,t));return tr(()=>()=>{r.stop()}),r};function rI(e,t,r){let n;let i=R.fun(t)&&t;i&&!r&&(r=[]);let o=!0,a=rE(e,(e,r)=>{let a=i?i(e,r):t;return n=a.ref,o=o&&a.reverse,a},r||[{}]);if(e7(()=>{F(a[1].current,(e,t)=>{let r=a[1].current[t+(o?1:-1)];if(tL(e,n),e.ref){r&&e.update({to:r.springs});return}r?e.start({to:r.springs}):e.start()})},r),i||3==arguments.length){let e=null!=n?n:a[1];return e._getProps=(t,r,n)=>{let i=R.fun(t)?t(n,r):t;if(i){let t=e.current[n+(i.reverse?1:-1)];return t&&(i.to=t.springs),i}},a}return a[0]}function rb(e,t,r){let n=R.fun(t)&&t,{reset:i,sort:o,trail:a=0,expires:s=!0,exitBeforeEnter:l=!1,onDestroyed:u,ref:h,config:d}=n?n():t,A=(0,c.useMemo)(()=>n||3==arguments.length?ry():void 0,[]),f=O(e),p=[],m=(0,c.useRef)(null),g=i?null:m.current;e7(()=>{m.current=p}),tr(()=>(F(p,e=>{null==A||A.add(e.ctrl),e.ctrl.ref=A}),()=>{F(m.current,e=>{e.expired&&clearTimeout(e.expirationId),tO(e.ctrl,A),e.ctrl.stop(!0)})}));let v=function(e,t,r){let{key:n,keys:i=n}=t;if(null===i){let t=new Set;return e.map(e=>{let n=r&&r.find(r=>r.item===e&&"leave"!==r.phase&&!t.has(r));return n?(t.add(n),n.key):r_++})}return R.und(i)?e:R.fun(i)?e.map(i):O(i)}(f,n?n():t,g),y=i&&m.current||[];e7(()=>F(y,e=>{let{ctrl:t,item:r,key:n}=e;tO(t,A),tx(u,r,n)}));let E=[];if(g&&F(g,(e,t)=>{e.expired?(clearTimeout(e.expirationId),y.push(e)):~(t=E[t]=v.indexOf(e.key))&&(p[t]=e)}),F(f,(e,t)=>{p[t]||(p[t]={key:v[t],item:e,phase:"mount",ctrl:new rc},p[t].ctrl.item=e)}),E.length){let e=-1,{leave:r}=n?n():t;F(E,(t,n)=>{let i=g[n];~t?(e=p.indexOf(i),p[e]={...i,item:f[t]}):r&&p.splice(++e,0,i)})}R.fun(o)&&p.sort((e,t)=>o(e.item,t.item));let C=-a,w=tt(),B=tS(t),x=new Map,I=(0,c.useRef)(new Map),b=(0,c.useRef)(!1);F(p,(e,r)=>{let i,o;let c=e.key,u=e.phase,A=n?n():t,f=tx(A.delay||0,c);if("mount"==u)i=A.enter,o="enter";else{let e=0>v.indexOf(c);if("leave"!=u){if(e)i=A.leave,o="leave";else{if(!(i=A.update))return;o="update"}}else{if(e)return;i=A.enter,o="enter"}}if(i=tx(i,e.item,r),!(i=R.obj(i)?tR(i):{to:i}).config){let t=d||B.config;i.config=tx(t,e.item,r,o)}C+=a;let p={...B,delay:f+C,ref:h,immediate:A.immediate,reset:!1,...i};if("enter"==o&&R.und(p.from)){let i=n?n():t,o=R.und(i.initial)||g?i.from:i.initial;p.from=tx(o,e.item,r)}let{onResolve:y}=p;p.onResolve=e=>{tx(y,e);let t=m.current,r=t.find(e=>e.key===c);if(r){if(e.cancelled&&"update"!=r.phase)return;if(r.ctrl.idle){let e=t.every(e=>e.ctrl.idle);if("leave"==r.phase){let t=tx(s,r.item);if(!1!==t){let n=!0===t?0:t;if(r.expired=!0,!e&&n>0){n<=2147483647&&(r.expirationId=setTimeout(w,n));return}}}e&&t.some(e=>e.expired)&&(I.current.delete(r),l&&(b.current=!0),w())}}};let E=rd(e.ctrl,p);"leave"===o&&l?I.current.set(e,{phase:o,springs:E,payload:p}):x.set(e,{phase:o,springs:E,payload:p})});let _=(0,c.useContext)(rg),M=ti(_),S=_!==M&&tF(_);e7(()=>{S&&F(p,e=>{e.ctrl.start({default:_})})},[_]),F(x,(e,t)=>{if(I.current.size){let e=p.findIndex(e=>e.key===t.key);p.splice(e,1)}}),e7(()=>{F(I.current.size?I.current:x,(e,t)=>{let{phase:r,payload:n}=e,{ctrl:i}=t;t.phase=r,null==A||A.add(i),S&&"enter"==r&&i.start({default:_}),n&&(tL(i,n.ref),(i.ref||A)&&!b.current?i.update(n):(i.start(n),b.current&&(b.current=!1)))})},i?void 0:r);let T=e=>c.createElement(c.Fragment,null,p.map((t,r)=>{let{springs:n}=x.get(t)||t.ctrl,i=e({...n},t.item,t,r);return i&&i.type?c.createElement(i.type,{...i.props,key:R.str(t.key)||R.num(t.key)?t.key:t.ctrl.id,ref:i.ref}):i}));return A?[T,A]:T}var r_=1,rM=function(){let{container:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[r,n]=rC(()=>({scrollX:0,scrollY:0,scrollXProgress:0,scrollYProgress:0,...t}),[]);return e7(()=>{let t=e8(e=>{let{x:t,y:r}=e;n.start({scrollX:t.current,scrollXProgress:t.progress,scrollY:r.current,scrollYProgress:r.progress})},{container:(null==e?void 0:e.current)||void 0});return()=>{F(Object.values(r),e=>e.stop()),t()}},[]),r},rS=e=>{let{container:t,...r}=e,[n,i]=rC(()=>({width:0,height:0,...r}),[]);return e7(()=>{let e=e0(e=>{let{width:t,height:r}=e;i.start({width:t,height:r,immediate:0===n.width.get()||0===n.height.get()})},{container:(null==t?void 0:t.current)||void 0});return()=>{F(Object.values(n),e=>e.stop()),e()}},[]),n},rT={any:0,all:1};function rD(e,t){let[r,n]=(0,c.useState)(!1),i=(0,c.useRef)(),o=R.fun(e)&&e,{to:a={},from:s={},...l}=o?o():{},u=o?t:e,[h,d]=rC(()=>({from:s,...l}),[]);return(e7(()=>{let e=i.current,{root:t,once:o,amount:l="any",...c}=null!=u?u:{};if(!e||o&&r||"undefined"==typeof IntersectionObserver)return;let h=new WeakMap,A=()=>(a&&d.start(a),n(!0),o?void 0:()=>{s&&d.start(s),n(!1)}),f=new IntersectionObserver(e=>{e.forEach(e=>{let t=h.get(e.target);if(!!t!==e.isIntersecting){if(e.isIntersecting){let t=A();R.fun(t)?h.set(e.target,t):f.unobserve(e.target)}else t&&(t(),h.delete(e.target))}})},{root:t&&t.current||void 0,threshold:"number"==typeof l||Array.isArray(l)?l:rT[l],...c});return f.observe(e),()=>f.unobserve(e)},[u]),o)?[i,h]:[i,r]}function rR(e){let{children:t,...r}=e;return t(rC(r))}function rP(e){let{items:t,children:r,...n}=e,i=rI(t.length,n);return t.map((e,t)=>{let n=r(e,t);return R.fun(n)?n(i[t]):n})}function rF(e){let{items:t,children:r,...n}=e;return rb(t,n)(r)}var rQ=class extends t2{advance(e){let t=this._get();P(t,this.get())||(tl(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&rL(this._active)&&rk(this)}_get(){let e=R.arr(this.source)?this.source.map(eb):O(eb(this.source));return this.calc(...e)}_start(){this.idle&&!rL(this._active)&&(this.idle=!1,F(tu(this),e=>{e.done=!1}),h.skipAnimation?(A.batchedUpdates(()=>this.advance()),rk(this)):W.start(this))}_attach(){let e=1;F(O(this.source),t=>{eI(t)&&eD(t,this),t0(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){F(O(this.source),e=>{eI(e)&&eR(e,this)}),this._active.clear(),rk(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=O(this.source).reduce((e,t)=>Math.max(e,(t0(t)?t.priority:0)+1),0))}constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=ev(...t);let r=this._get();tc(this,tv(r).create(r))}};function rO(e){return!1!==e.idle}function rL(e){return!e.size||Array.from(e).every(rO)}function rk(e){e.idle||(e.idle=!0,F(tu(e),e=>{e.done=!0}),eM(e,{type:"idle",parent:e}))}var rU=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return new rQ(e,r)},rG=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return eJ(),new rQ(e,r)};h.assign({createStringInterpolator:ez,to:(e,t)=>new rQ(e,t)});var rN=W.advance,rz=["primitive"].concat(Object.keys(r(6376)).filter(e=>/^[A-Z]/.test(e)).map(e=>e[0].toLowerCase()+e.slice(1)));h.assign({createStringInterpolator:ez,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},frameLoop:"demand"}),(0,l.n)(()=>{A.advance()});var rH=function(e){let{applyAnimatedValues:t=()=>!1,createAnimatedStyle:r=e=>new tp(e),getComponentProps:n=e=>e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={applyAnimatedValues:t,createAnimatedStyle:r,getComponentProps:n},o=e=>{let t=tw(e)||"Anonymous";return(e=R.str(e)?o[e]||(o[e]=ty(e,i)):e[tC]||(e[tC]=ty(e,i))).displayName="Animated(".concat(t,")"),e};return Q(e,(t,r)=>{R.arr(e)&&(r=tw(t)),o[r]=o(t)}),{animated:o}}(rz,{applyAnimatedValues:l.j}).animated},2775:function(e,t){"use strict";t.Z=function(){return function(e){var t,r,n,i,o={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},a={},s={};a.L=1,s[1]="L",Object.keys(o).forEach(function(e,t){a[e]=1<<t+1,s[a[e]]=e}),Object.freeze(a);var l=a.LRI|a.RLI|a.FSI,c=a.L|a.R|a.AL,u=a.B|a.S|a.WS|a.ON|a.FSI|a.LRI|a.RLI|a.PDI,h=a.BN|a.RLE|a.LRE|a.RLO|a.LRO|a.PDF,d=a.S|a.WS|a.B|l|a.PDI|h,A=null;function f(e){return!function(){if(!A){A=new Map;var e=function(e){if(o.hasOwnProperty(e)){var t=0;o[e].split(",").forEach(function(r){var n=r.split("+"),i=n[0],o=n[1];i=parseInt(i,36),o=o?parseInt(o,36):0,A.set(t+=i,a[e]);for(var s=0;s<o;s++)A.set(++t,a[e])})}};for(var t in o)e(t)}}(),A.get(e.codePointAt(0))||a.L}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(e,t){var r,n=0,i=new Map,o=t&&new Map;return e.split(",").forEach(function e(a){if(-1!==a.indexOf("+"))for(var s=+a;s--;)e(r);else{r=a;var l=a.split(">"),c=l[0],u=l[1];c=String.fromCodePoint(n+=parseInt(c,36)),u=String.fromCodePoint(n+=parseInt(u,36)),i.set(c,u),t&&o.set(u,c)}}),{map:i,reverseMap:o}}function g(){if(!t){var e=m(p.pairs,!0),i=e.map,o=e.reverseMap;t=i,r=o,n=m(p.canonical,!1).map}}function v(e){return g(),t.get(e)||null}function y(e){return g(),r.get(e)||null}function E(e){return g(),n.get(e)||null}var C=a.L,w=a.R,B=a.EN,x=a.ES,I=a.ET,b=a.AN,_=a.CS,M=a.B,S=a.S,T=a.ON,D=a.BN,R=a.NSM,P=a.AL,F=a.LRO,Q=a.RLO,O=a.LRE,L=a.RLE,k=a.PDF,U=a.LRI,G=a.RLI,N=a.FSI,z=a.PDI;function H(e){return!function(){if(!i){var e=m("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0),t=e.map;e.reverseMap.forEach(function(e,r){t.set(r,e)}),i=t}}(),i.get(e)||null}function V(e,t,r,n){var i=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(i-1,null==n?i-1:+n);var o=[];return t.paragraphs.forEach(function(i){var a=Math.max(r,i.start),s=Math.min(n,i.end);if(a<s){for(var l=t.levels.slice(a,s+1),c=s;c>=a&&f(e[c])&d;c--)l[c]=i.level;for(var u=i.level,h=1/0,A=0;A<l.length;A++){var p=l[A];p>u&&(u=p),p<h&&(h=1|p)}for(var m=u;m>=h;m--)for(var g=0;g<l.length;g++)if(l[g]>=m){for(var v=g;g+1<l.length&&l[g+1]>=m;)g++;g>v&&o.push([v+a,g+a])}}}),o}function j(e,t,r,n){for(var i=V(e,t,r,n),o=[],a=0;a<e.length;a++)o[a]=a;return i.forEach(function(e){for(var t=e[0],r=e[1],n=o.slice(t,r+1),i=n.length;i--;)o[r-i]=n[i]}),o}return e.closingToOpeningBracket=y,e.getBidiCharType=f,e.getBidiCharTypeName=function(e){return s[f(e)]},e.getCanonicalBracket=E,e.getEmbeddingLevels=function(e,t){for(var r=new Uint32Array(e.length),n=0;n<e.length;n++)r[n]=f(e[n]);var i=new Map;function o(e,t){var n=r[e];r[e]=t,i.set(n,i.get(n)-1),n&u&&i.set(u,i.get(u)-1),i.set(t,(i.get(t)||0)+1),t&u&&i.set(u,(i.get(u)||0)+1)}for(var a=new Uint8Array(e.length),s=new Map,A=[],p=null,m=0;m<e.length;m++)p||A.push(p={start:m,end:e.length-1,level:"rtl"===t?1:"ltr"===t?0:tT(m,!1)}),r[m]&M&&(p.end=m,p=null);for(var g=L|O|Q|F|l|z|k|M,H=function(e){return e+(1&e?1:2)},V=function(e){return e+(1&e?2:1)},j=0;j<A.length;j++){var J=[{_level:(p=A[j]).level,_override:0,_isolate:0}],Y=void 0,W=0,q=0,K=0;i.clear();for(var X=p.start;X<=p.end;X++){var Z=r[X];if(Y=J[J.length-1],i.set(Z,(i.get(Z)||0)+1),Z&u&&i.set(u,(i.get(u)||0)+1),Z&g){if(Z&(L|O)){a[X]=Y._level;var $=(Z===L?V:H)(Y._level);!($<=125)||W||q?!W&&q++:J.push({_level:$,_override:0,_isolate:0})}else if(Z&(Q|F)){a[X]=Y._level;var ee=(Z===Q?V:H)(Y._level);!(ee<=125)||W||q?!W&&q++:J.push({_level:ee,_override:Z&Q?w:C,_isolate:0})}else if(Z&l){Z&N&&(Z=1===tT(X+1,!0)?G:U),a[X]=Y._level,Y._override&&o(X,Y._override);var et=(Z===G?V:H)(Y._level);et<=125&&0===W&&0===q?(K++,J.push({_level:et,_override:0,_isolate:1,_isolInitIndex:X})):W++}else if(Z&z){if(W>0)W--;else if(K>0){for(q=0;!J[J.length-1]._isolate;)J.pop();var er=J[J.length-1]._isolInitIndex;null!=er&&(s.set(er,X),s.set(X,er)),J.pop(),K--}Y=J[J.length-1],a[X]=Y._level,Y._override&&o(X,Y._override)}else Z&k?(0===W&&(q>0?q--:!Y._isolate&&J.length>1&&(J.pop(),Y=J[J.length-1])),a[X]=Y._level):Z&M&&(a[X]=p.level)}else a[X]=Y._level,Y._override&&Z!==D&&o(X,Y._override)}for(var en=[],ei=null,eo=p.start;eo<=p.end;eo++){var ea=r[eo];if(!(ea&h)){var es=a[eo],el=ea&l,ec=ea===z;ei&&es===ei._level?(ei._end=eo,ei._endsWithIsolInit=el):en.push(ei={_start:eo,_end:eo,_level:es,_startsWithPDI:ec,_endsWithIsolInit:el})}}for(var eu=[],eh=0;eh<en.length;eh++){var ed=en[eh];if(!ed._startsWithPDI||ed._startsWithPDI&&!s.has(ed._start)){for(var eA=[ei=ed],ef=void 0;ei&&ei._endsWithIsolInit&&null!=(ef=s.get(ei._end));)for(var ep=eh+1;ep<en.length;ep++)if(en[ep]._start===ef){eA.push(ei=en[ep]);break}for(var em=[],eg=0;eg<eA.length;eg++)for(var ev=eA[eg],ey=ev._start;ey<=ev._end;ey++)em.push(ey);for(var eE=a[em[0]],eC=p.level,ew=em[0]-1;ew>=0;ew--)if(!(r[ew]&h)){eC=a[ew];break}var eB=em[em.length-1],ex=a[eB],eI=p.level;if(!(r[eB]&l)){for(var eb=eB+1;eb<=p.end;eb++)if(!(r[eb]&h)){eI=a[eb];break}}eu.push({_seqIndices:em,_sosType:Math.max(eC,eE)%2?w:C,_eosType:Math.max(eI,ex)%2?w:C})}}for(var e_=0;e_<eu.length;e_++){var eM=eu[e_],eS=eM._seqIndices,eT=eM._sosType,eD=eM._eosType,eR=1&a[eS[0]]?w:C;if(i.get(R))for(var eP=0;eP<eS.length;eP++){var eF=eS[eP];if(r[eF]&R){for(var eQ=eT,eO=eP-1;eO>=0;eO--)if(!(r[eS[eO]]&h)){eQ=r[eS[eO]];break}o(eF,eQ&(l|z)?T:eQ)}}if(i.get(B))for(var eL=0;eL<eS.length;eL++){var ek=eS[eL];if(r[ek]&B)for(var eU=eL-1;eU>=-1;eU--){var eG=-1===eU?eT:r[eS[eU]];if(eG&c){eG===P&&o(ek,b);break}}}if(i.get(P))for(var eN=0;eN<eS.length;eN++){var ez=eS[eN];r[ez]&P&&o(ez,w)}if(i.get(x)||i.get(_))for(var eH=1;eH<eS.length-1;eH++){var eV=eS[eH];if(r[eV]&(x|_)){for(var ej=0,eJ=0,eY=eH-1;eY>=0&&(ej=r[eS[eY]])&h;eY--);for(var eW=eH+1;eW<eS.length&&(eJ=r[eS[eW]])&h;eW++);ej===eJ&&(r[eV]===x?ej===B:ej&(B|b))&&o(eV,ej)}}if(i.get(B)){for(var eq=0;eq<eS.length;eq++)if(r[eS[eq]]&B){for(var eK=eq-1;eK>=0&&r[eS[eK]]&(I|h);eK--)o(eS[eK],B);for(eq++;eq<eS.length&&r[eS[eq]]&(I|h|B);eq++)r[eS[eq]]!==B&&o(eS[eq],B)}}if(i.get(I)||i.get(x)||i.get(_))for(var eX=0;eX<eS.length;eX++){var eZ=eS[eX];if(r[eZ]&(I|x|_)){o(eZ,T);for(var e$=eX-1;e$>=0&&r[eS[e$]]&h;e$--)o(eS[e$],T);for(var e0=eX+1;e0<eS.length&&r[eS[e0]]&h;e0++)o(eS[e0],T)}}if(i.get(B))for(var e1=0,e2=eT;e1<eS.length;e1++){var e3=eS[e1],e4=r[e3];e4&B?e2===C&&o(e3,C):e4&c&&(e2=e4)}if(i.get(u)){for(var e5=w|B|b,e9=e5|C,e6=[],e8=[],e7=0;e7<eS.length;e7++)if(r[eS[e7]]&u){var te=e[eS[e7]],tt=void 0;if(null!==v(te)){if(e8.length<63)e8.push({char:te,seqIndex:e7});else break}else if(null!==(tt=y(te)))for(var tr=e8.length-1;tr>=0;tr--){var tn=e8[tr].char;if(tn===tt||tn===y(E(te))||v(E(tn))===te){e6.push([e8[tr].seqIndex,e7]),e8.length=tr;break}}}e6.sort(function(e,t){return e[0]-t[0]});for(var ti=0;ti<e6.length;ti++){for(var to=e6[ti],ta=to[0],ts=to[1],tl=!1,tc=0,tu=ta+1;tu<ts;tu++){var th=eS[tu];if(r[th]&e9){tl=!0;var td=r[th]&e5?w:C;if(td===eR){tc=td;break}}}if(tl&&!tc){tc=eT;for(var tA=ta-1;tA>=0;tA--){var tf=eS[tA];if(r[tf]&e9){var tp=r[tf]&e5?w:C;tc=tp!==eR?tp:eR;break}}}if(tc){if(r[eS[ta]]=r[eS[ts]]=tc,tc!==eR){for(var tm=ta+1;tm<eS.length;tm++)if(!(r[eS[tm]]&h)){f(e[eS[tm]])&R&&(r[eS[tm]]=tc);break}}if(tc!==eR){for(var tg=ts+1;tg<eS.length;tg++)if(!(r[eS[tg]]&h)){f(e[eS[tg]])&R&&(r[eS[tg]]=tc);break}}}}for(var tv=0;tv<eS.length;tv++)if(r[eS[tv]]&u){for(var ty=tv,tE=tv,tC=eT,tw=tv-1;tw>=0;tw--)if(r[eS[tw]]&h)ty=tw;else{tC=r[eS[tw]]&e5?w:C;break}for(var tB=eD,tx=tv+1;tx<eS.length;tx++)if(r[eS[tx]]&(u|h))tE=tx;else{tB=r[eS[tx]]&e5?w:C;break}for(var tI=ty;tI<=tE;tI++)r[eS[tI]]=tC===tB?tC:eR;tv=tE}}}for(var tb=p.start;tb<=p.end;tb++){var t_=a[tb],tM=r[tb];if(1&t_?tM&(C|B|b)&&a[tb]++:tM&w?a[tb]++:tM&(b|B)&&(a[tb]+=2),tM&h&&(a[tb]=0===tb?p.level:a[tb-1]),tb===p.end||f(e[tb])&(S|M))for(var tS=tb;tS>=0&&f(e[tS])&d;tS--)a[tS]=p.level}}return{levels:a,paragraphs:A};function tT(t,n){for(var i=t;i<e.length;i++){var o=r[i];if(o&(w|P))return 1;if(o&(M|C)||n&&o===z)break;if(o&l){var a=function(t){for(var n=1,i=t+1;i<e.length;i++){var o=r[i];if(o&M)break;if(o&z){if(0==--n)return i}else o&l&&n++}return -1}(i);i=-1===a?e.length:a}}return 0}},e.getMirroredCharacter=H,e.getMirroredCharactersMap=function(e,t,r,n){var i=e.length;r=Math.max(0,null==r?0:+r),n=Math.min(i-1,null==n?i-1:+n);for(var o=new Map,a=r;a<=n;a++)if(1&t[a]){var s=H(e[a]);null!==s&&o.set(a,s)}return o},e.getReorderSegments=V,e.getReorderedIndices=j,e.getReorderedString=function(e,t,r,n){var i=j(e,t,r,n),o=[].concat(e);return i.forEach(function(r,n){o[n]=(1&t.levels[r]?H(e[r]):null)||e[r]}),o.join("")},e.openingToClosingBracket=v,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}},1690:function(e,t,r){"use strict";r.d(t,{w:function(){return a}});var n=r(7934),i=r(674),o=r(6934);class a extends n.w{constructor(e=new i.L,t=new o.Y({color:16777215*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}},674:function(e,t,r){"use strict";r.d(t,{L:function(){return i}});var n=r(1359);class i extends n.z{setPositions(e){let t=e.length-3,r=new Float32Array(2*t);for(let n=0;n<t;n+=3)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];return super.setPositions(r),this}setColors(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=e.length-t,n=new Float32Array(2*r);if(3===t)for(let i=0;i<r;i+=t)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];else for(let i=0;i<r;i+=t)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5],n[2*i+6]=e[i+6],n[2*i+7]=e[i+7];return super.setColors(n,t),this}fromLine(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}}},6934:function(e,t,r){"use strict";r.d(t,{Y:function(){return i}});var n=r(6376);class i extends n.ShaderMaterial{constructor(e){super({type:"LineMaterial",uniforms:n.UniformsUtils.clone(n.UniformsUtils.merge([n.UniformsLib.common,n.UniformsLib.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new n.Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:"\n				#include <common>\n				#include <fog_pars_vertex>\n				#include <logdepthbuf_pars_vertex>\n				#include <clipping_planes_pars_vertex>\n\n				uniform float linewidth;\n				uniform vec2 resolution;\n\n				attribute vec3 instanceStart;\n				attribute vec3 instanceEnd;\n\n				#ifdef USE_COLOR\n					#ifdef USE_LINE_COLOR_ALPHA\n						varying vec4 vLineColor;\n						attribute vec4 instanceColorStart;\n						attribute vec4 instanceColorEnd;\n					#else\n						varying vec3 vLineColor;\n						attribute vec3 instanceColorStart;\n						attribute vec3 instanceColorEnd;\n					#endif\n				#endif\n\n				#ifdef WORLD_UNITS\n\n					varying vec4 worldPos;\n					varying vec3 worldStart;\n					varying vec3 worldEnd;\n\n					#ifdef USE_DASH\n\n						varying vec2 vUv;\n\n					#endif\n\n				#else\n\n					varying vec2 vUv;\n\n				#endif\n\n				#ifdef USE_DASH\n\n					uniform float dashScale;\n					attribute float instanceDistanceStart;\n					attribute float instanceDistanceEnd;\n					varying float vLineDistance;\n\n				#endif\n\n				void trimSegment( const in vec4 start, inout vec4 end ) {\n\n					// trim end segment so it terminates between the camera plane and the near plane\n\n					// conservative estimate of the near plane\n					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n					float nearEstimate = - 0.5 * b / a;\n\n					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n					end.xyz = mix( start.xyz, end.xyz, alpha );\n\n				}\n\n				void main() {\n\n					#ifdef USE_COLOR\n\n						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n					#endif\n\n					#ifdef USE_DASH\n\n						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n						vUv = uv;\n\n					#endif\n\n					float aspect = resolution.x / resolution.y;\n\n					// camera space\n					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n					#ifdef WORLD_UNITS\n\n						worldStart = start.xyz;\n						worldEnd = end.xyz;\n\n					#else\n\n						vUv = uv;\n\n					#endif\n\n					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n					// perhaps there is a more elegant solution -- WestLangley\n\n					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n					if ( perspective ) {\n\n						if ( start.z < 0.0 && end.z >= 0.0 ) {\n\n							trimSegment( start, end );\n\n						} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n							trimSegment( end, start );\n\n						}\n\n					}\n\n					// clip space\n					vec4 clipStart = projectionMatrix * start;\n					vec4 clipEnd = projectionMatrix * end;\n\n					// ndc space\n					vec3 ndcStart = clipStart.xyz / clipStart.w;\n					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n					// direction\n					vec2 dir = ndcEnd.xy - ndcStart.xy;\n\n					// account for clip-space aspect ratio\n					dir.x *= aspect;\n					dir = normalize( dir );\n\n					#ifdef WORLD_UNITS\n\n						// get the offset direction as perpendicular to the view vector\n						vec3 worldDir = normalize( end.xyz - start.xyz );\n						vec3 offset;\n						if ( position.y < 0.5 ) {\n\n							offset = normalize( cross( start.xyz, worldDir ) );\n\n						} else {\n\n							offset = normalize( cross( end.xyz, worldDir ) );\n\n						}\n\n						// sign flip\n						if ( position.x < 0.0 ) offset *= - 1.0;\n\n						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n						// don't extend the line if we're rendering dashes because we\n						// won't be rendering the endcaps\n						#ifndef USE_DASH\n\n							// extend the line bounds to encompass  endcaps\n							start.xyz += - worldDir * linewidth * 0.5;\n							end.xyz += worldDir * linewidth * 0.5;\n\n							// shift the position of the quad so it hugs the forward edge of the line\n							offset.xy -= dir * forwardOffset;\n							offset.z += 0.5;\n\n						#endif\n\n						// endcaps\n						if ( position.y > 1.0 || position.y < 0.0 ) {\n\n							offset.xy += dir * 2.0 * forwardOffset;\n\n						}\n\n						// adjust for linewidth\n						offset *= linewidth * 0.5;\n\n						// set the world position\n						worldPos = ( position.y < 0.5 ) ? start : end;\n						worldPos.xyz += offset;\n\n						// project the worldpos\n						vec4 clip = projectionMatrix * worldPos;\n\n						// shift the depth of the projected points so the line\n						// segments overlap neatly\n						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n						clip.z = clipPose.z * clip.w;\n\n					#else\n\n						vec2 offset = vec2( dir.y, - dir.x );\n						// undo aspect ratio adjustment\n						dir.x /= aspect;\n						offset.x /= aspect;\n\n						// sign flip\n						if ( position.x < 0.0 ) offset *= - 1.0;\n\n						// endcaps\n						if ( position.y < 0.0 ) {\n\n							offset += - dir;\n\n						} else if ( position.y > 1.0 ) {\n\n							offset += dir;\n\n						}\n\n						// adjust for linewidth\n						offset *= linewidth;\n\n						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n						offset /= resolution.y;\n\n						// select end\n						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n						// back to clip space\n						offset *= clip.w;\n\n						clip.xy += offset;\n\n					#endif\n\n					gl_Position = clip;\n\n					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n					#include <logdepthbuf_vertex>\n					#include <clipping_planes_vertex>\n					#include <fog_vertex>\n\n				}\n			",fragmentShader:"\n				uniform vec3 diffuse;\n				uniform float opacity;\n				uniform float linewidth;\n\n				#ifdef USE_DASH\n\n					uniform float dashOffset;\n					uniform float dashSize;\n					uniform float gapSize;\n\n				#endif\n\n				varying float vLineDistance;\n\n				#ifdef WORLD_UNITS\n\n					varying vec4 worldPos;\n					varying vec3 worldStart;\n					varying vec3 worldEnd;\n\n					#ifdef USE_DASH\n\n						varying vec2 vUv;\n\n					#endif\n\n				#else\n\n					varying vec2 vUv;\n\n				#endif\n\n				#include <common>\n				#include <fog_pars_fragment>\n				#include <logdepthbuf_pars_fragment>\n				#include <clipping_planes_pars_fragment>\n\n				#ifdef USE_COLOR\n					#ifdef USE_LINE_COLOR_ALPHA\n						varying vec4 vLineColor;\n					#else\n						varying vec3 vLineColor;\n					#endif\n				#endif\n\n				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n					float mua;\n					float mub;\n\n					vec3 p13 = p1 - p3;\n					vec3 p43 = p4 - p3;\n\n					vec3 p21 = p2 - p1;\n\n					float d1343 = dot( p13, p43 );\n					float d4321 = dot( p43, p21 );\n					float d1321 = dot( p13, p21 );\n					float d4343 = dot( p43, p43 );\n					float d2121 = dot( p21, p21 );\n\n					float denom = d2121 * d4343 - d4321 * d4321;\n\n					float numer = d1343 * d4321 - d1321 * d4343;\n\n					mua = numer / denom;\n					mua = clamp( mua, 0.0, 1.0 );\n					mub = ( d1343 + d4321 * ( mua ) ) / d4343;\n					mub = clamp( mub, 0.0, 1.0 );\n\n					return vec2( mua, mub );\n\n				}\n\n				void main() {\n\n					#include <clipping_planes_fragment>\n\n					#ifdef USE_DASH\n\n						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n					#endif\n\n					float alpha = opacity;\n\n					#ifdef WORLD_UNITS\n\n						// Find the closest points on the view ray and the line segment\n						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n						vec3 lineDir = worldEnd - worldStart;\n						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n						vec3 p1 = worldStart + lineDir * params.x;\n						vec3 p2 = rayEnd * params.y;\n						vec3 delta = p1 - p2;\n						float len = length( delta );\n						float norm = len / linewidth;\n\n						#ifndef USE_DASH\n\n							#ifdef USE_ALPHA_TO_COVERAGE\n\n								float dnorm = fwidth( norm );\n								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n							#else\n\n								if ( norm > 0.5 ) {\n\n									discard;\n\n								}\n\n							#endif\n\n						#endif\n\n					#else\n\n						#ifdef USE_ALPHA_TO_COVERAGE\n\n							// artifacts appear on some hardware if a derivative is taken within a conditional\n							float a = vUv.x;\n							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n							float len2 = a * a + b * b;\n							float dlen = fwidth( len2 );\n\n							if ( abs( vUv.y ) > 1.0 ) {\n\n								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n							}\n\n						#else\n\n							if ( abs( vUv.y ) > 1.0 ) {\n\n								float a = vUv.x;\n								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n								float len2 = a * a + b * b;\n\n								if ( len2 > 1.0 ) discard;\n\n							}\n\n						#endif\n\n					#endif\n\n					vec4 diffuseColor = vec4( diffuse, alpha );\n					#ifdef USE_COLOR\n						#ifdef USE_LINE_COLOR_ALPHA\n							diffuseColor *= vLineColor;\n						#else\n							diffuseColor.rgb *= vLineColor;\n						#endif\n					#endif\n\n					#include <logdepthbuf_fragment>\n\n					gl_FragColor = diffuseColor;\n\n					#include <tonemapping_fragment>\n					#include <".concat(parseInt(n.REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment",">\n					#include <fog_fragment>\n					#include <premultiplied_alpha_fragment>\n\n				}\n			"),clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(e){this.uniforms.diffuse.value=e}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(e){this.uniforms.linewidth.value=e}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(e){!!e!="USE_DASH"in this.defines&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(e){this.uniforms.dashScale.value=e}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(e){this.uniforms.dashSize.value=e}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(e){this.uniforms.gapSize.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(e){!!e!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}},7934:function(e,t,r){"use strict";let n,i,o,a;r.d(t,{w:function(){return B}});var s=r(6376),l=r(1359),c=r(6934);let u=new s.Vector3,h=new s.Vector3,d=new s.Vector4,A=new s.Vector4,f=new s.Vector4,p=new s.Vector3,m=new s.Matrix4,g=new s.Line3,v=new s.Vector3,y=new s.Box3,E=new s.Sphere,C=new s.Vector4;function w(e,t,r){return C.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),C.multiplyScalar(1/C.w),C.x=a/r.width,C.y=a/r.height,C.applyMatrix4(e.projectionMatrixInverse),C.multiplyScalar(1/C.w),Math.abs(Math.max(C.x,C.y))}class B extends s.Mesh{computeLineDistances(){let e=this.geometry,t=e.attributes.instanceStart,r=e.attributes.instanceEnd,n=new Float32Array(2*t.count);for(let e=0,i=0,o=t.count;e<o;e++,i+=2)u.fromBufferAttribute(t,e),h.fromBufferAttribute(r,e),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+u.distanceTo(h);let i=new s.InstancedInterleavedBuffer(n,2,1);return e.setAttribute("instanceDistanceStart",new s.InterleavedBufferAttribute(i,1,0)),e.setAttribute("instanceDistanceEnd",new s.InterleavedBufferAttribute(i,1,1)),this}raycast(e,t){let r,l;let c=this.material.worldUnits,u=e.camera;null!==u||c||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');let h=void 0!==e.params.Line2&&e.params.Line2.threshold||0;n=e.ray;let C=this.matrixWorld,B=this.geometry,x=this.material;if(a=x.linewidth+h,i=B.attributes.instanceStart,o=B.attributes.instanceEnd,null===B.boundingSphere&&B.computeBoundingSphere(),E.copy(B.boundingSphere).applyMatrix4(C),c)r=.5*a;else{let e=Math.max(u.near,E.distanceToPoint(n.origin));r=w(u,e,x.resolution)}if(E.radius+=r,!1!==n.intersectsSphere(E)){if(null===B.boundingBox&&B.computeBoundingBox(),y.copy(B.boundingBox).applyMatrix4(C),c)l=.5*a;else{let e=Math.max(u.near,y.distanceToPoint(n.origin));l=w(u,e,x.resolution)}y.expandByScalar(l),!1!==n.intersectsBox(y)&&(c?function(e,t){for(let r=0,l=i.count;r<l;r++){g.start.fromBufferAttribute(i,r),g.end.fromBufferAttribute(o,r);let l=new s.Vector3,c=new s.Vector3;n.distanceSqToSegment(g.start,g.end,c,l),c.distanceTo(l)<.5*a&&t.push({point:c,pointOnLine:l,distance:n.origin.distanceTo(c),object:e,face:null,faceIndex:r,uv:null,uv2:null})}}(this,t):function(e,t,r){let i=t.projectionMatrix,o=e.material.resolution,l=e.matrixWorld,c=e.geometry,u=c.attributes.instanceStart,h=c.attributes.instanceEnd,y=-t.near;n.at(1,f),f.w=1,f.applyMatrix4(t.matrixWorldInverse),f.applyMatrix4(i),f.multiplyScalar(1/f.w),f.x*=o.x/2,f.y*=o.y/2,f.z=0,p.copy(f),m.multiplyMatrices(t.matrixWorldInverse,l);for(let t=0,c=u.count;t<c;t++){if(d.fromBufferAttribute(u,t),A.fromBufferAttribute(h,t),d.w=1,A.w=1,d.applyMatrix4(m),A.applyMatrix4(m),d.z>y&&A.z>y)continue;if(d.z>y){let e=d.z-A.z,t=(d.z-y)/e;d.lerp(A,t)}else if(A.z>y){let e=A.z-d.z,t=(A.z-y)/e;A.lerp(d,t)}d.applyMatrix4(i),A.applyMatrix4(i),d.multiplyScalar(1/d.w),A.multiplyScalar(1/A.w),d.x*=o.x/2,d.y*=o.y/2,A.x*=o.x/2,A.y*=o.y/2,g.start.copy(d),g.start.z=0,g.end.copy(A),g.end.z=0;let c=g.closestPointToPointParameter(p,!0);g.at(c,v);let f=s.MathUtils.lerp(d.z,A.z,c),E=f>=-1&&f<=1,C=p.distanceTo(v)<.5*a;if(E&&C){g.start.fromBufferAttribute(u,t),g.end.fromBufferAttribute(h,t),g.start.applyMatrix4(l),g.end.applyMatrix4(l);let i=new s.Vector3,o=new s.Vector3;n.distanceSqToSegment(g.start,g.end,o,i),r.push({point:o,pointOnLine:i,distance:n.origin.distanceTo(o),object:e,face:null,faceIndex:t,uv:null,uv2:null})}}}(this,u,t))}}constructor(e=new l.z,t=new c.Y({color:16777215*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}}},1359:function(e,t,r){"use strict";r.d(t,{z:function(){return a}});var n=r(6376);let i=new n.Box3,o=new n.Vector3;class a extends n.InstancedBufferGeometry{applyMatrix4(e){let t=this.attributes.instanceStart,r=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),r.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let r=new n.InstancedInterleavedBuffer(t,6,1);return this.setAttribute("instanceStart",new n.InterleavedBufferAttribute(r,3,0)),this.setAttribute("instanceEnd",new n.InterleavedBufferAttribute(r,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));let i=new n.InstancedInterleavedBuffer(t,2*r,1);return this.setAttribute("instanceColorStart",new n.InterleavedBufferAttribute(i,r,0)),this.setAttribute("instanceColorEnd",new n.InterleavedBufferAttribute(i,r,r)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new n.WireframeGeometry(e.geometry)),this}fromLineSegments(e){let t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new n.Box3);let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),i.setFromBufferAttribute(t),this.boundingBox.union(i))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new n.Sphere),null===this.boundingBox&&this.computeBoundingBox();let e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){let r=this.boundingSphere.center;this.boundingBox.getCenter(r);let n=0;for(let i=0,a=e.count;i<a;i++)o.fromBufferAttribute(e,i),n=Math.max(n,r.distanceToSquared(o)),o.fromBufferAttribute(t,i),n=Math.max(n,r.distanceToSquared(o));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new n.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new n.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}}},8177:function(e,t,r){"use strict";function n(){return function(e){function t(e,t){for(var r,n,i,o,a,s=/([MLQCZ])([^MLQCZ]*)/g;r=s.exec(e);){var l=r[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(e){return parseFloat(e)});switch(r[1]){case"M":o=n=l[0],a=i=l[1];break;case"L":(l[0]!==o||l[1]!==a)&&t("L",o,a,o=l[0],a=l[1]);break;case"Q":t("Q",o,a,o=l[2],a=l[3],l[0],l[1]);break;case"C":t("C",o,a,o=l[4],a=l[5],l[0],l[1],l[2],l[3]);break;case"Z":(o!==n||a!==i)&&t("L",o,a,n,i)}}}function r(e,r,n){void 0===n&&(n=16);var i={x:0,y:0};t(e,function(e,t,o,a,s,l,c,u,h){switch(e){case"L":r(t,o,a,s);break;case"Q":for(var d=t,A=o,f=1;f<n;f++)!function(e,t,r,n,i,o,a,s){var l=1-a;s.x=l*l*e+2*l*a*r+a*a*i,s.y=l*l*t+2*l*a*n+a*a*o}(t,o,l,c,a,s,f/(n-1),i),r(d,A,i.x,i.y),d=i.x,A=i.y;break;case"C":for(var p=t,m=o,g=1;g<n;g++)!function(e,t,r,n,i,o,a,s,l,c){var u=1-l;c.x=u*u*u*e+3*u*u*l*r+3*u*l*l*i+l*l*l*a,c.y=u*u*u*t+3*u*u*l*n+3*u*l*l*o+l*l*l*s}(t,o,l,c,u,h,a,s,g/(n-1),i),r(p,m,i.x,i.y),p=i.x,m=i.y}})}var n="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",i=new WeakMap,o={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function a(e,t){var r=e.getContext?e.getContext("webgl",o):e,n=i.get(r);if(!n){var a="undefined"!=typeof WebGL2RenderingContext&&r instanceof WebGL2RenderingContext,s={},l={},c={},u=-1,h=[];function d(e){var t=s[e];if(!t&&!(t=s[e]=r.getExtension(e)))throw Error(e+" not supported");return t}function A(e,t){var n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),n}function f(){s={},l={},c={},u=-1,h.length=0}r.canvas.addEventListener("webglcontextlost",function(e){f(),e.preventDefault()},!1),i.set(r,n={gl:r,isWebGL2:a,getExtension:d,withProgram:function(e,t,n,i){if(!l[e]){var o={},s={},c=r.createProgram();r.attachShader(c,A(t,r.VERTEX_SHADER)),r.attachShader(c,A(n,r.FRAGMENT_SHADER)),r.linkProgram(c),l[e]={program:c,transaction:function(e){r.useProgram(c),e({setUniform:function(e,t){for(var n=[],i=arguments.length-2;i-- >0;)n[i]=arguments[i+2];var o=s[t]||(s[t]=r.getUniformLocation(c,t));r["uniform"+e].apply(r,[o].concat(n))},setAttribute:function(e,t,n,i,s){var l=o[e];l||(l=o[e]={buf:r.createBuffer(),loc:r.getAttribLocation(c,e),data:null}),r.bindBuffer(r.ARRAY_BUFFER,l.buf),r.vertexAttribPointer(l.loc,t,r.FLOAT,!1,0,0),r.enableVertexAttribArray(l.loc),a?r.vertexAttribDivisor(l.loc,i):d("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(l.loc,i),s!==l.data&&(r.bufferData(r.ARRAY_BUFFER,s,n),l.data=s)}})}}}l[e].transaction(i)},withTexture:function(e,t){u++;try{r.activeTexture(r.TEXTURE0+u);var n=c[e];n||(n=c[e]=r.createTexture(),r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST)),r.bindTexture(r.TEXTURE_2D,n),t(n,u)}finally{u--}},withTextureFramebuffer:function(e,t,n){var i=r.createFramebuffer();h.push(i),r.bindFramebuffer(r.FRAMEBUFFER,i),r.activeTexture(r.TEXTURE0+t),r.bindTexture(r.TEXTURE_2D,e),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);try{n(i)}finally{r.deleteFramebuffer(i),r.bindFramebuffer(r.FRAMEBUFFER,h[--h.length-1]||null)}},handleContextLoss:f})}t(n)}function s(e,t,r,i,o,s,l,c){void 0===l&&(l=15),void 0===c&&(c=null),a(e,function(e){var a=e.gl,u=e.withProgram;(0,e.withTexture)("copy",function(e,h){a.texImage2D(a.TEXTURE_2D,0,a.RGBA,o,s,0,a.RGBA,a.UNSIGNED_BYTE,t),u("copy",n,"precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",function(e){var t=e.setUniform;(0,e.setAttribute)("aUV",2,a.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),t("1i","image",h),a.bindFramebuffer(a.FRAMEBUFFER,c||null),a.disable(a.BLEND),a.colorMask(8&l,4&l,2&l,1&l),a.viewport(r,i,o,s),a.scissor(r,i,o,s),a.drawArrays(a.TRIANGLES,0,3)})})})}var l=Object.freeze({__proto__:null,withWebGLContext:a,renderImageData:s,resizeWebGLCanvasWithoutClearing:function(e,t,r){var n=e.width,i=e.height;a(e,function(o){var a=o.gl,l=new Uint8Array(n*i*4);a.readPixels(0,0,n,i,a.RGBA,a.UNSIGNED_BYTE,l),e.width=t,e.height=r,s(a,l,0,0,n,i)})}});function c(e,t,n,i,o,a){void 0===a&&(a=1);var s=new Uint8Array(e*t),l=i[2]-i[0],c=i[3]-i[1],u=[];r(n,function(e,t,r,n){u.push({x1:e,y1:t,x2:r,y2:n,minX:Math.min(e,r),minY:Math.min(t,n),maxX:Math.max(e,r),maxY:Math.max(t,n)})}),u.sort(function(e,t){return e.maxX-t.maxX});for(var h=0;h<e;h++)for(var d=0;d<t;d++){var A=function(e,t){for(var r=1/0,n=1/0,i=u.length;i--;){var o=u[i];if(o.maxX+n<=e)break;if(e+n>o.minX&&t-n<o.maxY&&t+n>o.minY){var a=function(e,t,r,n,i,o){var a=i-r,s=o-n,l=a*a+s*s,c=l?Math.max(0,Math.min(1,((e-r)*a+(t-n)*s)/l)):0,u=e-(r+c*a),h=t-(n+c*s);return u*u+h*h}(e,t,o.x1,o.y1,o.x2,o.y2);a<r&&(n=Math.sqrt(r=a))}}return function(e,t){for(var r=0,n=u.length;n--;){var i=u[n];if(i.maxX<=e)break;i.y1>t!=i.y2>t&&e<(i.x2-i.x1)*(t-i.y1)/(i.y2-i.y1)+i.x1&&(r+=i.y1<i.y2?1:-1)}return 0!==r}(e,t)&&(n=-n),n}(i[0]+l*(h+.5)/e,i[1]+c*(d+.5)/t),f=Math.pow(1-Math.abs(A)/o,a)/2;A<0&&(f=1-f),f=Math.max(0,Math.min(255,Math.round(255*f))),s[d*e+h]=f}return s}function u(e,t,r,n,i,o,a,s,l,c){void 0===o&&(o=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=0),h(e,t,r,n,i,o,a,null,s,l,c)}function h(e,t,r,n,i,o,a,l,u,h,d){void 0===o&&(o=1),void 0===u&&(u=0),void 0===h&&(h=0),void 0===d&&(d=0);for(var A=c(e,t,r,n,i,o),f=new Uint8Array(4*A.length),p=0;p<A.length;p++)f[4*p+d]=A[p];s(a,f,u,h,e,t,1<<3-d,l)}var d=Object.freeze({__proto__:null,generate:c,generateIntoCanvas:u,generateIntoFramebuffer:h}),A=new Float32Array([0,0,2,0,0,2]),f=null,p=!1,m={},g=new WeakMap;function v(e){if(!p&&!w(e))throw Error("WebGL generation not supported")}function y(e,t,r,n,i,o,s){if(void 0===o&&(o=1),void 0===s&&(s=null),!s&&!(s=f)){var l="function"==typeof OffscreenCanvas?new OffscreenCanvas(1,1):"undefined"!=typeof document?document.createElement("canvas"):null;if(!l)throw Error("OffscreenCanvas or DOM canvas not supported");s=f=l.getContext("webgl",{depth:!1})}v(s);var c=new Uint8Array(e*t*4);a(s,function(a){var s=a.gl,l=a.withTexture,u=a.withTextureFramebuffer;l("readable",function(a,l){s.texImage2D(s.TEXTURE_2D,0,s.RGBA,e,t,0,s.RGBA,s.UNSIGNED_BYTE,null),u(a,l,function(a){C(e,t,r,n,i,o,s,a,0,0,0),s.readPixels(0,0,e,t,s.RGBA,s.UNSIGNED_BYTE,c)})})});for(var u=new Uint8Array(e*t),h=0,d=0;h<c.length;h+=4)u[d++]=c[h];return u}function E(e,t,r,n,i,o,a,s,l,c){void 0===o&&(o=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=0),C(e,t,r,n,i,o,a,null,s,l,c)}function C(e,t,i,o,s,l,c,u,h,d,f){void 0===l&&(l=1),void 0===h&&(h=0),void 0===d&&(d=0),void 0===f&&(f=0),v(c);var p=[];r(i,function(e,t,r,n){p.push(e,t,r,n)}),p=new Float32Array(p),a(c,function(r){var i=r.gl,a=r.isWebGL2,c=r.getExtension,m=r.withProgram,g=r.withTexture,v=r.withTextureFramebuffer,y=r.handleContextLoss;if(g("rawDistances",function(r,g){(e!==r._lastWidth||t!==r._lastHeight)&&i.texImage2D(i.TEXTURE_2D,0,i.RGBA,r._lastWidth=e,r._lastHeight=t,0,i.RGBA,i.UNSIGNED_BYTE,null),m("main","precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}","precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",function(n){var u=n.setAttribute,h=n.setUniform,d=!a&&c("ANGLE_instanced_arrays"),f=!a&&c("EXT_blend_minmax");u("aUV",2,i.STATIC_DRAW,0,A),u("aLineSegment",4,i.DYNAMIC_DRAW,1,p),h.apply(void 0,["4f","uGlyphBounds"].concat(o)),h("1f","uMaxDistance",s),h("1f","uExponent",l),v(r,g,function(r){i.enable(i.BLEND),i.colorMask(!0,!0,!0,!0),i.viewport(0,0,e,t),i.scissor(0,0,e,t),i.blendFunc(i.ONE,i.ONE),i.blendEquationSeparate(i.FUNC_ADD,a?i.MAX:f.MAX_EXT),i.clear(i.COLOR_BUFFER_BIT),a?i.drawArraysInstanced(i.TRIANGLES,0,3,p.length/4):d.drawArraysInstancedANGLE(i.TRIANGLES,0,3,p.length/4)})}),m("post",n,"precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",function(r){r.setAttribute("aUV",2,i.STATIC_DRAW,0,A),r.setUniform("1i","tex",g),i.bindFramebuffer(i.FRAMEBUFFER,u),i.disable(i.BLEND),i.colorMask(0===f,1===f,2===f,3===f),i.viewport(h,d,e,t),i.scissor(h,d,e,t),i.drawArrays(i.TRIANGLES,0,3)})}),i.isContextLost())throw y(),Error("webgl context lost")})}function w(e){var t=e&&e!==f?e.canvas||e:m,r=g.get(t);if(void 0===r){p=!0;var n=null;try{var i=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],o=y(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,e);(r=o&&i.length===o.length&&o.every(function(e,t){return e===i[t]}))||(n="bad trial run results",console.info(i,o))}catch(e){r=!1,n=e.message}n&&console.warn("WebGL SDF generation not supported:",n),p=!1,g.set(t,r)}return r}var B=Object.freeze({__proto__:null,generate:y,generateIntoCanvas:E,generateIntoFramebuffer:C,isSupported:w});return e.forEachPathCommand=t,e.generate=function(e,t,r,n,i,o){void 0===i&&(i=Math.max(n[2]-n[0],n[3]-n[1])/2),void 0===o&&(o=1);try{return y.apply(B,arguments)}catch(e){return console.info("WebGL SDF generation failed, falling back to JS",e),c.apply(d,arguments)}},e.generateIntoCanvas=function(e,t,r,n,i,o,a,s,l,c){void 0===i&&(i=Math.max(n[2]-n[0],n[3]-n[1])/2),void 0===o&&(o=1),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=0);try{return E.apply(B,arguments)}catch(e){return console.info("WebGL SDF generation failed, falling back to JS",e),u.apply(d,arguments)}},e.javascript=d,e.pathToLineSegments=r,e.webgl=B,e.webglUtils=l,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}r.d(t,{Z:function(){return n}})}}]);